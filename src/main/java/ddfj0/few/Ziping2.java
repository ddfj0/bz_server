package ddfj0.few;

import java.util.ArrayList;
import java.util.Calendar;
import java.util.List;

import com.alibaba.fastjson.JSON;

public class Ziping2 {
    
//#region 旧版本变量 

    public Integer feGanJin;
    public Integer feGanMu;
    public Integer feGanShui;
    public Integer feGanHuo;
    public Integer feGanTu;

    public Integer shenGuan;
    public Integer shenSha;
    public Integer shenYin;
    public Integer shenXiao;
    public Integer shenBi;
    public Integer shenJie;
    public Integer shenShi;
    public Integer shenShang;
    public Integer shenCaiz;
    public Integer shenCaip;

    public Integer zpSheng;
    public Integer zpKe;
    public String  xiYong;
    public String  shenXyz;
    public String  shenXyp;
    
    public Integer yearShow;

//#endregion
    public BaZiFateAge bazi;

    public Integer predictLiuNianBegin;  //// 预测流年的起始年，今年起前三年内。
    public Integer predictLiuNianEnd;    //// 预测流年的截至年，收费用户预测未来三年。

    /// 五行金木水火土的数量。
    public Integer feJin;
    public Integer feMu;
    public Integer feShui;
    public Integer feHuo;
    public Integer feTu;


//#region 新版本变量 
    public Boolean m_bProfessional;

    String  m_feUse1 = "";
    String  m_feUse2 = "";
    Integer m_selfStrength = 0;   /// 日元强弱， 1 强，0 平，-1 弱
    Boolean m_pay;

//#endregion

    public Ziping2(BaZiFateAge baZiFateAge, boolean pay, boolean bProfessional) {
        bazi = baZiFateAge;
        
        fnBaZiDataProcess();

        Calendar cal = Calendar.getInstance();
        int year = cal.get(Calendar.YEAR);

        predictLiuNianBegin = year - 3;
        if( pay ) {
            predictLiuNianEnd = year + 2;
        }
        else {
            predictLiuNianEnd = year - 1;
        }

        m_bProfessional = bProfessional;
        m_pay = pay;

    }


//#region 新版工具 20240913
public void fnBaZiDataProcess() {
    // 计算八字的五行，十神的个数

//#region 计算八字的五行个数
    feJin = 0;
    feMu = 0;
    feShui = 0;
    feHuo = 0;
    feTu = 0;

    feGanJin = 0;
    feGanMu = 0;
    feGanShui = 0;
    feGanHuo = 0;
    feGanTu = 0;


    if( bazi.hourGan.equals("甲") || bazi.hourGan.equals("乙") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;
    }
    if( bazi.hourGan.equals("丙") || bazi.hourGan.equals("丁") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( bazi.hourGan.equals("戊") || bazi.hourGan.equals("己") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( bazi.hourGan.equals("庚") || bazi.hourGan.equals("辛") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( bazi.hourGan.equals("壬") || bazi.hourGan.equals("癸") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }

    if( bazi.hourZhi.equals("子") || bazi.hourZhi.equals("亥") ) {
        feShui = feShui + 1;
    }
    if( bazi.hourZhi.equals("寅") || bazi.hourZhi.equals("卯") ) {
        feMu = feMu + 1;
    }
    if( bazi.hourZhi.equals("丑") || bazi.hourZhi.equals("辰") ||bazi.hourZhi.equals("戌") ||  bazi.hourZhi.equals("未") ) {
        feTu = feTu + 1;
    }
    if( bazi.hourZhi.equals("巳") || bazi.hourZhi.equals("午") ) {
        feHuo = feHuo + 1;
    }
    if( bazi.hourZhi.equals("申") || bazi.hourZhi.equals("酉") ) {
        feJin = feJin + 1;
    }

    if( bazi.dayGan.equals("甲") || bazi.dayGan.equals("乙") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;
    }
    if( bazi.dayGan.equals("丙") || bazi.dayGan.equals("丁") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( bazi.dayGan.equals("戊") || bazi.dayGan.equals("己") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( bazi.dayGan.equals("庚") || bazi.dayGan.equals("辛") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( bazi.dayGan.equals("壬") || bazi.dayGan.equals("癸") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }

    if( bazi.dayZhi.equals("子") || bazi.dayZhi.equals("亥") ) {
        feShui = feShui + 1;
    }
    if( bazi.dayZhi.equals("寅") || bazi.dayZhi.equals("卯") ) {
        feMu = feMu + 1;
    }
    if( bazi.dayZhi.equals("丑") || bazi.dayZhi.equals("辰") ||bazi.dayZhi.equals("戌") ||  bazi.dayZhi.equals("未") ) {
        feTu = feTu + 1;
    }
    if( bazi.dayZhi.equals("巳") || bazi.dayZhi.equals("午") ) {
        feHuo = feHuo + 1;
    }
    if( bazi.dayZhi.equals("申") || bazi.dayZhi.equals("酉") ) {
        feJin = feJin + 1;
    }

    if( bazi.monthGan.equals("甲") || bazi.monthGan.equals("乙") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;
    }
    if( bazi.monthGan.equals("丙") || bazi.monthGan.equals("丁") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( bazi.monthGan.equals("戊") || bazi.monthGan.equals("己") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( bazi.monthGan.equals("庚") || bazi.monthGan.equals("辛") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( bazi.monthGan.equals("壬") || bazi.monthGan.equals("癸") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }

    if( bazi.monthZhi.equals("子") || bazi.monthZhi.equals("亥") ) {
        feShui = feShui + 1;
    }
    if( bazi.monthZhi.equals("寅") || bazi.monthZhi.equals("卯") ) {
        feMu = feMu + 1;
    }
    if( bazi.monthZhi.equals("丑") || bazi.monthZhi.equals("辰") ||bazi.monthZhi.equals("戌") ||  bazi.monthZhi.equals("未") ) {
        feTu = feTu + 1;
    }
    if( bazi.monthZhi.equals("巳") || bazi.monthZhi.equals("午") ) {
        feHuo = feHuo + 1;
    }
    if( bazi.monthZhi.equals("申") || bazi.monthZhi.equals("酉") ) {
        feJin = feJin + 1;
    }

    if( bazi.yearGan.equals("甲") || bazi.yearGan.equals("乙") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;
    }
    if( bazi.yearGan.equals("丙") || bazi.yearGan.equals("丁") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( bazi.yearGan.equals("戊") || bazi.yearGan.equals("己") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( bazi.yearGan.equals("庚") || bazi.yearGan.equals("辛") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( bazi.yearGan.equals("壬") || bazi.yearGan.equals("癸") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }

    if( bazi.yearZhi.equals("子") || bazi.yearZhi.equals("亥") ) {
        feShui = feShui + 1;
    }
    if( bazi.yearZhi.equals("寅") || bazi.yearZhi.equals("卯") ) {
        feMu = feMu + 1;
    }
    if( bazi.yearZhi.equals("丑") || bazi.yearZhi.equals("辰") ||bazi.yearZhi.equals("戌") ||  bazi.yearZhi.equals("未") ) {
        feTu = feTu + 1;
    }
    if( bazi.yearZhi.equals("巳") || bazi.yearZhi.equals("午") ) {
        feHuo = feHuo + 1;
    }
    if( bazi.yearZhi.equals("申") || bazi.yearZhi.equals("酉") ) {
        feJin = feJin + 1;
    }
//#endregion

//#region 计算十神 
    shenGuan = 0;
    shenSha = 0;
    shenYin = 0;
    shenXiao = 0;
    shenBi = 0;
    shenJie = 0;
    shenCaiz = 0;
    shenCaip = 0;
    shenShi = 0;
    shenShang = 0;

    if( bazi.shenHourGan.equals("比") ) {
            shenBi = shenBi + 1;
        }
    if( bazi.shenHourGan.equals("劫") ) {
        shenJie = shenJie + 1;
    }
    if( bazi.shenHourGan.equals("官") ) {
        shenGuan = shenGuan + 1;
    }
    if( bazi.shenHourGan.equals("煞") ) {
        shenSha = shenSha + 1;
    }
    if( bazi.shenHourGan.equals("印") ) {
        shenYin = shenYin + 1;
    }
    if( bazi.shenHourGan.equals("枭") ) {
        shenXiao = shenXiao + 1;
    }
    if( bazi.shenHourGan.equals("食") ) {
        shenShi = shenShi + 1;
    }
    if( bazi.shenHourGan.equals("伤") ) {
        shenShang = shenShang + 1;
    }
    if( bazi.shenHourGan.equals("财") ) {
        shenCaiz = shenCaiz + 1;
    }
    if( bazi.shenHourGan.equals("才") ) {
        shenCaip = shenCaip + 1;
    }

    if( bazi.shenHourZhi.equals("比") ) {
        shenBi = shenBi + 1;
    }
    if( bazi.shenHourZhi.equals("劫") ) {
        shenJie = shenJie + 1;
    }
    if( bazi.shenHourZhi.equals("官") ) {
        shenGuan = shenGuan + 1;
    }
    if( bazi.shenHourZhi.equals("煞") ) {
        shenSha = shenSha + 1;
    }
    if( bazi.shenHourZhi.equals("印") ) {
        shenYin = shenYin + 1;
    }
    if( bazi.shenHourZhi.equals("枭") ) {
        shenXiao = shenXiao + 1;
    }
    if( bazi.shenHourZhi.equals("食") ) {
        shenShi = shenShi + 1;
    }
    if( bazi.shenHourZhi.equals("伤") ) {
        shenShang = shenShang + 1;
    }
    if( bazi.shenHourZhi.equals("财") ) {
        shenCaiz = shenCaiz + 1;
    }
    if( bazi.shenHourZhi.equals("才") ) {
        shenCaip = shenCaip + 1;
    }

    if( bazi.shenDayZhi.equals("比") ) {
        shenBi = shenBi + 1;
    }
    if( bazi.shenDayZhi.equals("劫") ) {
        shenJie = shenJie + 1;
    }
    if( bazi.shenDayZhi.equals("官") ) {
        shenGuan = shenGuan + 1;
    }
    if( bazi.shenDayZhi.equals("煞") ) {
        shenSha = shenSha + 1;
    }
    if( bazi.shenDayZhi.equals("印") ) {
        shenYin = shenYin + 1;
    }
    if( bazi.shenDayZhi.equals("枭") ) {
        shenXiao = shenXiao + 1;
    }
    if( bazi.shenDayZhi.equals("食") ) {
        shenShi = shenShi + 1;
    }
    if( bazi.shenDayZhi.equals("伤") ) {
        shenShang = shenShang + 1;
    }
    if( bazi.shenDayZhi.equals("财") ) {
        shenCaiz = shenCaiz + 1;
    }
    if( bazi.shenDayZhi.equals("才") ) {
        shenCaip = shenCaip + 1;
    }

    if( bazi.shenMonthGan.equals("比") ) {
        shenBi = shenBi + 1;
    }
    if( bazi.shenMonthGan.equals("劫") ) {
        shenJie = shenJie + 1;
    }
    if( bazi.shenMonthGan.equals("官") ) {
        shenGuan = shenGuan + 1;
    }
    if( bazi.shenMonthGan.equals("煞") ) {
        shenSha = shenSha + 1;
    }
    if( bazi.shenMonthGan.equals("印") ) {
        shenYin = shenYin + 1;
    }
    if( bazi.shenMonthGan.equals("枭") ) {
        shenXiao = shenXiao + 1;
    }
    if( bazi.shenMonthGan.equals("食") ) {
        shenShi = shenShi + 1;
    }
    if( bazi.shenMonthGan.equals("伤") ) {
        shenShang = shenShang + 1;
    }
    if( bazi.shenMonthGan.equals("财") ) {
        shenCaiz = shenCaiz + 1;
    }
    if( bazi.shenMonthGan.equals("才") ) {
        shenCaip = shenCaip + 1;
    }

    if( bazi.shenMonthZhi.equals("比") ) {
        shenBi = shenBi + 1;
    }
    if( bazi.shenMonthZhi.equals("劫") ) {
        shenJie = shenJie + 1;
    }
    if( bazi.shenMonthZhi.equals("官") ) {
        shenGuan = shenGuan + 1;
    }
    if( bazi.shenMonthZhi.equals("煞") ) {
        shenSha = shenSha + 1;
    }
    if( bazi.shenMonthZhi.equals("印") ) {
        shenYin = shenYin + 1;
    }
    if( bazi.shenMonthZhi.equals("枭") ) {
        shenXiao = shenXiao + 1;
    }
    if( bazi.shenMonthZhi.equals("食") ) {
        shenShi = shenShi + 1;
    }
    if( bazi.shenMonthZhi.equals("伤") ) {
        shenShang = shenShang + 1;
    }
    if( bazi.shenMonthZhi.equals("财") ) {
        shenCaiz = shenCaiz + 1;
    }
    if( bazi.shenMonthZhi.equals("才") ) {
        shenCaip = shenCaip + 1;
    }

    if( bazi.shenYearGan.equals("比") ) {
        shenBi = shenBi + 1;
    }
    if( bazi.shenYearGan.equals("劫") ) {
        shenJie = shenJie + 1;
    }
    if( bazi.shenYearGan.equals("官") ) {
        shenGuan = shenGuan + 1;
    }
    if( bazi.shenYearGan.equals("煞") ) {
        shenSha = shenSha + 1;
    }
    if( bazi.shenYearGan.equals("印") ) {
        shenYin = shenYin + 1;
    }
    if( bazi.shenYearGan.equals("枭") ) {
        shenXiao = shenXiao + 1;
    }
    if( bazi.shenYearGan.equals("食") ) {
        shenShi = shenShi + 1;
    }
    if( bazi.shenYearGan.equals("伤") ) {
        shenShang = shenShang + 1;
    }
    if( bazi.shenYearGan.equals("财") ) {
        shenCaiz = shenCaiz + 1;
    }
    if( bazi.shenYearGan.equals("才") ) {
        shenCaip = shenCaip + 1;
    }

    if( bazi.shenYearZhi.equals("比") ) {
        shenBi = shenBi + 1;
    }
    if( bazi.shenYearZhi.equals("劫") ) {
        shenJie = shenJie + 1;
    }
    if( bazi.shenYearZhi.equals("官") ) {
        shenGuan = shenGuan + 1;
    }
    if( bazi.shenYearZhi.equals("煞") ) {
        shenSha = shenSha + 1;
    }
    if( bazi.shenYearZhi.equals("印") ) {
        shenYin = shenYin + 1;
    }
    if( bazi.shenYearZhi.equals("枭") ) {
        shenXiao = shenXiao + 1;
    }
    if( bazi.shenYearZhi.equals("食") ) {
        shenShi = shenShi + 1;
    }
    if( bazi.shenYearZhi.equals("伤") ) {
        shenShang = shenShang + 1;
    }
    if( bazi.shenYearZhi.equals("财") ) {
        shenCaiz = shenCaiz + 1;
    }
    if( bazi.shenYearZhi.equals("才") ) {
        shenCaip = shenCaip + 1;
    }
//#endregion

    zpSheng = fnComputeShengKe("生");
    zpKe = fnComputeShengKe("克");

}

public String fnSelfDayGan(String dayGan, String yearZhi, String monthZhi, String dayZhi, String hourZhi, String sex) {
    // 日干分析
    String benMing = fnGz2Wu(dayGan);
  
    // 日主旺衰，喜忌
    String str = "本命为" + dayGan + "(" + benMing + ")。";

    if( dayGan.equals("甲")) {
        str = str + "似参天之木，乐于助人，有上进心，处事负责，不屈服，不变通，多劳苦。";
        if( monthZhi.equals("子") || monthZhi.equals("丑") || monthZhi.equals("寅") ) {
            str = str + "，生冬季";
            if(feHuo > 0) {
                str = str + "有火得温，一生多顺。";
            }
            else {
                str = str + "无火，运中带火时较顺。";
            }
        }
    }
    else if( dayGan.equals("乙")) {
        str = str + "似花草之木，性情柔和，有同情心，敏感，无主见，占有欲强。";
        if( feShui > 0 && feTu > 0 && feHuo > 0) {
                str = str + "有土，有水，有火，靓丽多姿，秀美可爱。";
        }
    }
    else if( dayGan.equals("丙")) {
        str = str + "似猛烈之火，热情，大方，易冲动。";            
    }
    else if( dayGan.equals("丁")) {
        str = str + "似油灯之火，外柔，内刚，思维缜密，多愁疑。";             
    }
    else if( dayGan.equals("戊")) {
        str = str + "似高原之土，稳重，守诺，较保守。";            
    }
    else if( dayGan.equals("己")) {
        str = str + "似田园之土，仁慈，心细，多才多艺，多忧郁。";            
    }
    else if( dayGan.equals("庚")) {
        str = str + "似剑斧之金，爽快，义气，多直率。";            
    }
    else if( dayGan.equals("辛")) {
        str = str + "似首饰之金，温顺，灵秀，重感情，好面子，多敏感。";            
    }
    else if( dayGan.equals("壬")) {
        str = str + "似江海之水，深沉，随和，大度，包容，有勇气，依赖性强，漫不经心。";
    }
    else if( dayGan.equals("癸")) {
        str = str + "似雨露之水，平静柔和，内向，外冷，内热，爱猜疑，重情调，不务实，易悲观。";
    }

    if( yearZhi.equals("子") || monthZhi.equals("子") || dayZhi.equals("子") || hourZhi.equals("子") ) {
        str = str + "机敏，无主见，易从事技术性职业，喜欢随波逐流。";

        int fe = 0;
        if( yearZhi.equals("子") ) fe++;
        if( monthZhi.equals("子") ) fe++;
        if( dayZhi.equals("子") ) fe++;
        if( hourZhi.equals("子") ) fe++;
        if( fe > 1 ) {
            str = str + "狡猾，花心，情感不顺，多灾多病。";
        }
    }

    if( yearZhi.equals("丑") || monthZhi.equals("丑") || dayZhi.equals("丑") || hourZhi.equals("丑") ) {
        str = str + "易从政或者从事金融业，稳重而务实，不喜权力。";
        if( sex.equals("女") ) str = str + "易为怨妇。";
    } 

    if( yearZhi.equals("寅") || monthZhi.equals("寅") || dayZhi.equals("寅") || hourZhi.equals("寅") ) {
        str = str + "有学识，易从事高科技行业，乐于冒险，充满激情，领悟能力强。";
    } 

    if( yearZhi.equals("卯") || monthZhi.equals("卯") || dayZhi.equals("卯") || hourZhi.equals("卯") ) {
        str = str + "体贴，忠诚，喜欢宁静合舒适。";

        int fe = 0;
        if( yearZhi.equals("卯") ) fe++;
        if( monthZhi.equals("卯") ) fe++;
        if( dayZhi.equals("卯") ) fe++;
        if( hourZhi.equals("卯") ) fe++;
        if( fe > 1 ) {
            str = str + "好斗嘴，婚姻不和睦。";
        }
    } 

    if( yearZhi.equals("辰") || monthZhi.equals("辰") || dayZhi.equals("辰") || hourZhi.equals("辰") ) {
        str = str + "易从事执法行业，性格激昂、强大而独立。";
    }

    if( yearZhi.equals("巳") || monthZhi.equals("巳") || dayZhi.equals("巳") || hourZhi.equals("巳") ) {
        str = str + "明智，健谈，迷人，倔强，自私，爱生闷气。";
    }

    if( yearZhi.equals("午") || monthZhi.equals("午") || dayZhi.equals("午") || hourZhi.equals("午") ) {
        str = str + "虚荣急躁，不安定，亲情不睦。";

        int fe = 0;
        if( yearZhi.equals("午") ) fe++;
        if( monthZhi.equals("午") ) fe++;
        if( dayZhi.equals("午") ) fe++;
        if( hourZhi.equals("午") ) fe++;
        if( fe > 1 ) {
            str = str + "易有精神压力。";
        }
    }

    if( yearZhi.equals("未") || monthZhi.equals("未") || dayZhi.equals("未") || hourZhi.equals("未") ) {
        str = str + "多愁善感，爱喝酒，缺少独立性。";

        int fe = 0;
        if( yearZhi.equals("未") ) fe++;
        if( monthZhi.equals("未") ) fe++;
        if( dayZhi.equals("未") ) fe++;
        if( hourZhi.equals("未") ) fe++;
        if( fe > 1 ) {
            str = str + "易忐忑不安。";
        }
    }

    if( yearZhi.equals("申") || monthZhi.equals("申") || dayZhi.equals("申") || hourZhi.equals("申") ) {
        str = str + "易从事执法行业，好奇心重，上进心强。";

        int fe = 0;
        if( yearZhi.equals("申") ) fe++;
        if( monthZhi.equals("申") ) fe++;
        if( dayZhi.equals("申") ) fe++;
        if( hourZhi.equals("申") ) fe++;
        if( fe > 1 ) {
            str = str + "易婚姻不顺。";
        }
    }

    if( yearZhi.equals("酉") || monthZhi.equals("酉") || dayZhi.equals("酉") || hourZhi.equals("酉") ) {
        str = str + "易从事美容行业，骄傲，专横，自命不凡。";

        int fe = 0;
        if( yearZhi.equals("酉") ) fe++;
        if( monthZhi.equals("酉") ) fe++;
        if( dayZhi.equals("酉") ) fe++;
        if( hourZhi.equals("酉") ) fe++;
        if( fe > 1 ) {
            str = str + "精于算计，行事诡秘，理性思维。";
        }
    }

    if( yearZhi.equals("戌") || monthZhi.equals("戌") || dayZhi.equals("戌") || hourZhi.equals("戌") ) {
        str = str + "易孤寡，易从事宗教迷信工作，真诚，正直，值得信赖。";
    }

    if( yearZhi.equals("亥") || monthZhi.equals("亥") || dayZhi.equals("亥") || hourZhi.equals("亥") ) {
        str = str + "易从事服务行业，易不守本分。";

        int fe = 0;
        if( yearZhi.equals("亥") ) fe++;
        if( monthZhi.equals("亥") ) fe++;
        if( dayZhi.equals("亥") ) fe++;
        if( hourZhi.equals("亥") ) fe++;
        if( fe > 1 ) {
            str = str + "有文学书法绘画等方面的才艺。";
        }
    }
    
    return str;
}

public Integer fnComputeShengKe(String sk) {
    Integer rtn = 0;
    Integer sheng = 1;
    Integer ke = 0;
    if(fnComputeShengKeShen(bazi.shenDayZhi) > 0) {
        sheng = sheng + 1;
    } else {
        ke = ke + 1;
    }
    if(fnComputeShengKeShen(bazi.shenMonthGan) > 0) {
        sheng = sheng + 1;
    } else {
        ke = ke + 1;
    }
    if(fnComputeShengKeShen(bazi.shenMonthZhi) > 0) {
        sheng = sheng + 1;
    } else {
        ke = ke + 1;
    }
    if(fnComputeShengKeShen(bazi.shenYearGan) > 0) {
        sheng = sheng + 1;
    } else {
        ke = ke + 1;
    }
    if(fnComputeShengKeShen(bazi.shenYearZhi) > 0) {
        sheng = sheng + 1;
    } else {
        ke = ke + 1;
    }
    if(fnComputeShengKeShen(bazi.shenHourGan) > 0) {
        sheng = sheng + 1;
    } else {
        ke = ke + 1;
    }
    if(fnComputeShengKeShen(bazi.shenHourZhi) > 0) {
        sheng = sheng + 1;
    } else {
        ke = ke + 1;
    }
    if(sk.equals("生")) {
        rtn = sheng;
    }
    if(sk.equals("克")) {
        rtn = ke;
    }
    return rtn;
}

public Integer fnComputeShengKeShen(String shen) {
    Integer rtn = 0;
    switch(shen) {
        case "比":
            rtn = 1;
            break;
        case "劫":
            rtn = 1;
            break;
        case "官":
            rtn = -1;
            break;
        case "煞":
            rtn = -1;
            break;
        case "印":
            rtn = 1;
            break;
        case "枭":
            rtn = 1;
            break;
        case "食":
            rtn = -1;
            break;
        case "伤":
            rtn = -1;
            break;
        case "财":
            rtn = -1;
            break;
        case "才":
            rtn = -1;
            break;
        default:
            break;
    }
    return rtn;    
}

public String fnComputeXiYong2( String feSelf, Integer Strength) {
    String rtn = "";
    if(Strength <= 0) {  /// 身弱用印比 
        if(feSelf.equals("甲") || feSelf.equals("乙")) {
            rtn = "水";
            shenXyz = "印";
            shenXyp = "枭";
        }
        if(feSelf.equals("丙") || feSelf.equals("丁")) {
            rtn = "木";
            shenXyz = "印";
            shenXyp = "枭";
        }
        if(feSelf.equals("戊") || feSelf.equals("己")) {
            rtn = "火";
            shenXyz = "印";
            shenXyp = "枭";
        }
        if(feSelf.equals("庚") || feSelf.equals("辛")) {
            rtn = "土";
            shenXyz = "印";
            shenXyp = "枭";
        }
        if(feSelf.equals("壬") || feSelf.equals("癸")) {
            rtn = "金";
            shenXyz = "印";
            shenXyp = "枭";
        }
    } else { /// 身强 
        if( (shenBi + shenJie + 1) >= (shenYin + shenXiao) ) { /// 比劫多于印，用财冲比劫，克印
            if( (shenCaip + shenCaiz) < (shenShi + shenShang) ) {  /// 比劫多，食伤多，用财 
                if(feSelf.equals("甲") || feSelf.equals("乙")) {
                    rtn = "土";
                    shenXyz = "财";
                    shenXyp = "才";
                }
                if(feSelf.equals("丙") || feSelf.equals("丁")) {
                    rtn = "金";
                    shenXyz = "财";
                    shenXyp = "才";
                }
                if(feSelf.equals("戊") || feSelf.equals("己")) {
                    rtn = "水";
                    shenXyz = "财";
                    shenXyp = "才";
                }
                if(feSelf.equals("庚") || feSelf.equals("辛")) {
                    rtn = "木";
                    shenXyz = "财";
                    shenXyp = "才";
                }
                if(feSelf.equals("壬") || feSelf.equals("癸")) {
                    rtn = "火";
                    shenXyz = "财";
                    shenXyp = "才";
                }
            }
            else if( (shenCaip + shenCaiz) > (shenShi + shenShang) ) {  /// 比劫多，财多，用食伤生财 
                if(feSelf.equals("甲") || feSelf.equals("乙")) {
                    rtn = "火";
                    shenXyz = "食";
                    shenXyp = "伤";
                }
                if(feSelf.equals("丙") || feSelf.equals("丁")) {
                    rtn = "土";
                    shenXyz = "食";
                    shenXyp = "伤";
                }
                if(feSelf.equals("戊") || feSelf.equals("己")) {
                    rtn = "金";
                    shenXyz = "食";
                    shenXyp = "伤";
                }
                if(feSelf.equals("庚") || feSelf.equals("辛")) {
                    rtn = "水";
                    shenXyz = "食";
                    shenXyp = "伤";
                }
                if(feSelf.equals("壬") || feSelf.equals("癸")) {
                    rtn = "木";
                    shenXyz = "食";
                    shenXyp = "伤";
                }    
            }
            else { /// 财食相等，用官， 都是官的情况下用财  
                if( (shenCaip + shenCaiz) == 0 ) {  /// 命强，都是官，用财来升官 
                    if(feSelf.equals("甲") || feSelf.equals("乙")) {
                        rtn = "金";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                    if(feSelf.equals("丙") || feSelf.equals("丁")) {
                        rtn = "水";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                    if(feSelf.equals("戊") || feSelf.equals("己")) {
                        rtn = "木";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                    if(feSelf.equals("庚") || feSelf.equals("辛")) {
                        rtn = "火";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                    if(feSelf.equals("壬") || feSelf.equals("癸")) {
                        rtn = "土";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                }
                else {  /// 有财，有官，用官 
                    if(feSelf.equals("甲") || feSelf.equals("乙")) {
                        rtn = "金";
                        shenXyz = "官";
                        shenXyp = "煞";
                    }
                    if(feSelf.equals("丙") || feSelf.equals("丁")) {
                        rtn = "水";
                        shenXyz = "官";
                        shenXyp = "煞";
                    }
                    if(feSelf.equals("戊") || feSelf.equals("己")) {
                        rtn = "木";
                        shenXyz = "官";
                        shenXyp = "煞";
                    }
                    if(feSelf.equals("庚") || feSelf.equals("辛")) {
                        rtn = "火";
                        shenXyz = "官";
                        shenXyp = "煞";
                    }
                    if(feSelf.equals("壬") || feSelf.equals("癸")) {
                        rtn = "土";
                        shenXyz = "官";
                        shenXyp = "煞";
                    } 
                }
            }
        }
        else { /// 印多
            if( (shenCaip + shenCaiz) > (shenShi + shenShang) ) {  ///印多， 财多于食伤, 用食伤 
                if(feSelf.equals("甲") || feSelf.equals("乙")) {
                    rtn = "火";
                    shenXyz = "食";
                    shenXyp = "伤";
                }
                if(feSelf.equals("丙") || feSelf.equals("丁")) {
                    rtn = "土";
                    shenXyz = "食";
                    shenXyp = "伤";
                }
                if(feSelf.equals("戊") || feSelf.equals("己")) {
                    rtn = "金";
                    shenXyz = "食";
                    shenXyp = "伤";
                }
                if(feSelf.equals("庚") || feSelf.equals("辛")) {
                    rtn = "水";
                    shenXyz = "食";
                    shenXyp = "伤";
                }
                if(feSelf.equals("壬") || feSelf.equals("癸")) {
                    rtn = "木";
                    shenXyz = "食";
                    shenXyp = "伤";
                }
    
            }
            else if( (shenShi + shenShang) > (shenCaip + shenCaiz) ) { /// 印多， 食伤大于财，用财
                if(feSelf.equals("甲") || feSelf.equals("乙")) {
                    rtn = "土";
                    shenXyz = "财";
                    shenXyp = "才";
                }
                if(feSelf.equals("丙") || feSelf.equals("丁")) {
                    rtn = "金";
                    shenXyz = "财";
                    shenXyp = "才";
                }
                if(feSelf.equals("戊") || feSelf.equals("己")) {
                    rtn = "水";
                    shenXyz = "财";
                    shenXyp = "才";
                }
                if(feSelf.equals("庚") || feSelf.equals("辛")) {
                    rtn = "木";
                    shenXyz = "财";
                    shenXyp = "才";
                }
                if(feSelf.equals("壬") || feSelf.equals("癸")) {
                    rtn = "火";
                    shenXyz = "财";
                    shenXyp = "才";
                }
            }
            else { /// 印多，食伤和财相等，多                 
                if( (shenGuan + shenSha) > (shenCaip + shenCaiz) ) {  /// 有食伤，有官，无财
                    if(feSelf.equals("甲") || feSelf.equals("乙")) {
                        rtn = "土";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                    if(feSelf.equals("丙") || feSelf.equals("丁")) {
                        rtn = "金";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                    if(feSelf.equals("戊") || feSelf.equals("己")) {
                        rtn = "水";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                    if(feSelf.equals("庚") || feSelf.equals("辛")) {
                        rtn = "木";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                    if(feSelf.equals("壬") || feSelf.equals("癸")) {
                        rtn = "火";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                }
                else if( (shenCaip + shenCaiz) > (shenGuan + shenSha)  ) {  //// 有食伤，有财多于官，用官
                    if(feSelf.equals("甲") || feSelf.equals("乙")) {
                        rtn = "金";
                        shenXyz = "官";
                        shenXyp = "煞";
                    }
                    if(feSelf.equals("丙") || feSelf.equals("丁")) {
                        rtn = "水";
                        shenXyz = "官";
                        shenXyp = "煞";
                    }
                    if(feSelf.equals("戊") || feSelf.equals("己")) {
                        rtn = "木";
                        shenXyz = "官";
                        shenXyp = "煞";
                    }
                    if(feSelf.equals("庚") || feSelf.equals("辛")) {
                        rtn = "火";
                        shenXyz = "官";
                        shenXyp = "煞";
                    }
                    if(feSelf.equals("壬") || feSelf.equals("癸")) {
                        rtn = "土";
                        shenXyz = "官";
                        shenXyp = "煞";
                    }
                }
                else {  /// 印多，财官食相等，或者等于0则用财，或者等于1也用财，财克印
                    if(feSelf.equals("甲") || feSelf.equals("乙")) {
                        rtn = "土";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                    if(feSelf.equals("丙") || feSelf.equals("丁")) {
                        rtn = "金";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                    if(feSelf.equals("戊") || feSelf.equals("己")) {
                        rtn = "水";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                    if(feSelf.equals("庚") || feSelf.equals("辛")) {
                        rtn = "木";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                    if(feSelf.equals("壬") || feSelf.equals("癸")) {
                        rtn = "火";
                        shenXyz = "财";
                        shenXyp = "才";
                    }    
                }    
            }     
        }
    }
    return rtn;
}

public String fnGz2Wu2(String gz) {  /// 干支转五行，不带阴阳
    String rtn = "";
    switch(gz) {
        case "甲":
            rtn = "木";
            break;
        case "乙":
            rtn = "木";
            break;
        case "丙":
            rtn = "火";
            break;
        case "丁":
            rtn = "火";
            break;
        case "戊":
            rtn = "土";
            break;
        case "己":
            rtn = "土";
            break;
        case "庚":
            rtn = "金";
            break;
        case "辛":
            rtn = "金";
            break;
        case "壬":
            rtn = "水";
            break;
        case "癸":
            rtn = "水";
            break;
        case "子":
            rtn = "水";
            break;
        case "丑":
            rtn = "土";
            break;
        case "寅":
            rtn = "木";
            break;
        case "卯":
            rtn = "木";
            break;
        case "辰":
            rtn = "土";
            break;
        case "巳":
            rtn = "火";
            break;
        case "午":
            rtn = "火";
            break;
        case "未":
            rtn = "土";
            break;
        case "申":
            rtn = "金";
            break;
        case "酉":
            rtn = "金";
            break;
        case "戌":
            rtn = "土";
            break;
        case "亥":
            rtn = "水";
            break;
        default:
            break;
    }
    return rtn;
}

public boolean fnComputeTianYi(String dayTg, String zhi) {
    /// 计算天乙贵人
    boolean bRtn = false;
    switch(dayTg) {
        case "甲":
        case "戊":
        case "庚":
            if(zhi.equals("丑") || zhi.equals("未") ) {
                bRtn = true;
            }
            break;
        case "乙":
        case "己":
            if(zhi.equals("子") || zhi.equals("申") ) {
                bRtn = true;
            }
            break;
        case "丙":
        case "丁":
            if(zhi.equals("酉") || zhi.equals("亥") ) {
                bRtn = true;
            }
            break;
    case "辛":
            if(zhi.equals("寅") || zhi.equals("午") ) {
                bRtn = true;
            }
            break;
        case "壬":
        case "癸":
            if(zhi.equals("卯") || zhi.equals("巳") ) {
                bRtn = true;
            }
            break;
    }
    return bRtn;
}

public boolean fnComputeYiMa(String dayZhi, String zhi) {
    boolean bRtn = false;
    /// 用12地址法计算驿马
    switch(dayZhi) {
        case "子":
        case "辰":
        case "申":
            if(zhi.equals("寅") ) {
                bRtn = true;
            }
            break;
        case "丑":
        case "巳":
        case "酉":
            if(zhi.equals("亥") ) {
                bRtn = true;
            }
            break;
        case "寅":
        case "午":
        case "戌":
            if(zhi.equals("申") ) {
                bRtn = true;
            }
            break;
        case "卯":
        case "未":
        case "亥":
            if(zhi.equals("巳") ) {
                bRtn = true;
            }
            break;
    }
    return bRtn;
}

public String fnSelfDayZhiMonthGanHourGan2(String sex, 
    String shenDayZhi, String shenMonthGan, String shenHourGan,
    String dayGan, String dayZhi, String monthGan, String hourGan) {
    
    //// 日支，月支，时干分析    
    String str = "";
    if( sex.equals("男") ) {
        if( shenDayZhi.equals("财") ) {
            if ((shenCaiz + shenCaip) > 1 ) {
                str = str + "虽然有多段情感，但是妻子在婚宫，夫妻感情和睦。";
            }
            else {
                str = str + "妻子在婚宫，夫妻感情和睦。";
            }
        }
        else if( shenMonthGan.equals("财") || 
                shenHourGan.equals("财") 
            )
        {
            if ((shenCaiz + shenCaip) > 1 ) {
                str = str + "虽然有多段情感，但是与妻子关系良好。";
            }
            else {
                str = str + "与妻子关系良好。";
            }
        }
        else if( shenDayZhi.equals("才") ) {
            if(  (shenCaiz ) > 0 ) {
                str = str + "有多段感情，或者宠爱情人冷落妻子，或者后面的感情才能长久。";
            }
            else {
                if ((shenCaiz + shenCaip) > 1 ) {
                    str = str + "虽然有多段情感，但是妻子在婚宫，夫妻感情和睦。";
                }
                else {
                    str = str + "妻子在婚宫，夫妻感情和睦。";
                }
            }
        }
        else if( shenMonthGan.equals("才") || 
                shenHourGan.equals("才") 
            )
        {
            if ((shenCaiz + shenCaip) > 1 ) {
                str = str + "有多段情感，与情人关系较好。";
            }
            else {
                str = str + "与妻子关系良好。";
            }
        }
        else {
            if( (shenCaiz + shenCaip) > 0 ) {
                str = str + "妻子与日主较远，可表现为夫妻感情淡薄，或者夫妻的家庭不在一地。";
            }
        }

        //// 判断婚宫
        if( shenDayZhi.equals("官") || shenDayZhi.equals("煞")) {
            str = str + "妻子较强势。";
        }
        else if( shenDayZhi.equals("印") || shenDayZhi.equals("枭")) {
            str = str + "妻子对丈夫有帮助。";
        }
        else if( shenDayZhi.equals("比") || shenDayZhi.equals("劫")) {
            str = str + "妻子的性格较独立。";
        }
        else if( shenDayZhi.equals("食") ) {
            str = str + "丈夫对妻子有帮助。";
        }
        else if( shenDayZhi.equals("伤")) {
            str = str + "妻子对丈夫不利。";
        }
    }
    else {
        if( shenDayZhi.equals("官") ) {
            if( (shenGuan + shenSha) > 1 ) {
                str = str + "虽然有多段情感，但是夫妻感情和睦。";
            }
            else {
                str = str + "夫妻感情和睦。";
            }
        }
        else if( shenMonthGan.equals("官") || 
                shenHourGan.equals("官") 
            )
        {
            if( (shenGuan + shenSha) > 1 ) {
                str = str + "虽然有多段情感，但是夫妻感情良好。";
            }
            else {
                str = str + "夫妻感情良好。";
            }
        }
        else if( shenDayZhi.equals("煞") ) {
            if(  (shenGuan ) > 0 ) {
                str = str + "有多段感情，或者宠爱情人冷落丈夫，或者后面的感情才能长久。";
            }
            else {
                if( (shenGuan + shenSha) > 1 ) {
                    str = str + "虽然有多段情感，但是夫在婚宫，夫妻感情和睦。";
                }
                else {
                    str = str + "夫在婚宫，夫妻感情和睦。";
                }
            }
        }
        else {
            if( (shenCaiz + shenCaip) > 0 ) {
                str = str + "丈夫与日主较远，可表现为夫妻感情淡薄，或者夫妻的家庭不在一地。";
            }
        }
    
        if( shenDayZhi.equals("财") || shenDayZhi.equals("才")) {
            str = str + "丈夫较强势。";
        }
        else if( shenDayZhi.equals("印") || shenDayZhi.equals("枭")) {
            str = str + "丈夫对妻子有帮助。";
        }
        else if( shenDayZhi.equals("比") || shenDayZhi.equals("劫")) {
            str = str + "夫妻之间互相较独立。";
        }
        else if( shenDayZhi.equals("食") || shenDayZhi.equals("伤") ) {
            str = str + "妻子对丈夫有帮助。";
        }
    
    }
    
    //// 戊癸
    if( dayGan.equals("戊") && (dayZhi.equals("子") ||
        hourGan.equals("癸") || monthGan.equals("癸") ) ) {
        str = str + "丈夫年龄大于妻年龄好几岁。";
    }
    
    return str;
}

public String fnShenHe(String shenOld, String shenNew) {  /// 大运，流年的时候再看。
    String rtn = "";

    switch (shenOld) {
        case "官":
        case "煞":
            switch (shenNew) {
                case "印":
                case "枭":
                    
                    break;
            
                default:
                    break;
            }
            break;
        case "印":
            
            break;
        default:
            break;
    }

    return rtn;
}

public String fnSelfPayShiShen2(boolean key, String sex) {
    String str = "";

    if( (shenBi + shenJie) > 1 ) {
        str = str + (key == true ? "多比劫，": "") + "性格具有强硬一面，容易被亲友所累。";
        if( (shenCaiz + shenCaip) == 1) {
            str = str + "易发生比劫夺食，与朋友合作时多保护自己。";
        }
        if( shenJie > 0 ) {
            str = str + "性格豪爽。";
        }
        if( (shenBi + shenJie) >= 3 ) {
            if( sex.equals("男")) {
                str = str + "可能会克妻，克父。";
            }
            else {
                str = str + "可能会克父。";
            }
        }
    }

    if( (shenYin + shenXiao) > 1 ) {
        if( (shenYin + shenXiao) >= 3 && (shenShang + shenShi) < 2) {
            str = str + "胆小，不肯吃苦，不是很聪明，不适合做技术类工作。";
        }
        else {
            str = str + (key == true ? "多印枭，" : "" ) + "兴趣广泛，易受宠爱，子女缘薄，适合文职，技术，手艺性质的工作。智商高。";
            if( (shenShang + shenShi) > 1 ) {
                if( (shenYin + shenXiao) > (shenShang + shenShi) ) {
                    str = str + "印克制食伤，仕途有保护，同时也限制了财运。";
                    str = str + "适合从官不易做生意，具体情况视大运流年的不同而变化。";
                }
                else if( (shenYin + shenXiao) < (shenShang + shenShi) ) {
                    str = str + (key == true ? "食伤大于印，" : "") + "不适合从官。";
                }
            }
            if( (shenCaip + shenCaiz) > 1 ) {
                str = str + (key == true ? "印星被财所克，" : "");
                if( bazi.sex.equals("男")) {
                    str = str + "易婆媳关系不好，";
                }
                if( (shenYin + shenXiao) > (shenCaip + shenCaiz) ) {
                    str = str + (key == true ? "印大于财，" : "") + "有能力而没能赚到更多的钱。";
                }
                else if( (shenYin + shenXiao) > (shenCaip + shenCaiz) ) {
                    str = str + (key == true ? "印小于财，" : "" ) + "能力不够导致赚不到更多的钱。";
                }
                else {
                    str = str + "有机会赚钱。";
                }
            }
            if( (shenGuan + shenSha) > 1 ) {
                str = str + (key == true ? "官升印，印生身，" : "" ) + "适合从事官场工作。";
            }
        }
    }

    if( (shenShang + shenShi) > 1 ) {
        str = str + (key == true ? "多食伤，" : "") + "性格外向，表达能力好，情商高。";
        if( zpKe > zpSheng ) {
            str = str + "易身弱，易得伤病。";
        }
    }     
    
    if( (shenCaip + shenCaiz) > 1 ) {
        str = str + (key == true ? "多财，" : "" ) + "赚钱途径多变化。";
        if( zpKe > zpSheng ) {
            str = str + (key == true ? "财多身弱，" : "") + "不易赚到钱，或者赚钱很辛苦，或者赚钱伤身。";
        }
    }

    if( (shenGuan + shenSha) >= 3 ) {
        str = str + "或者胆小怕事，或者容易得病，或者容易怀才不遇，或者容易得罪人。";
    }

    if( sex.equals("男")) {
        if( (shenGuan + shenSha) > 1 ) {
            str = str + (key == true ? "多官煞，" : "") + "有机会吃财政饭，工作辛苦，压力大。可以有多个儿女。";
        }
        if( shenShang > 0 && (shenYin + shenXiao) == 0) {
            str = str + (key == true ? "有伤官，" : "") + "易有不好的官家事。";
        }
        if( (shenCaip + shenCaiz) > 1 ) {
            str = str + "多次婚姻或者多个女友的可能性大。";
        }
        if( (shenCaip + shenCaiz) == 0 ) {
            int guan = fnDzcgFindGuanCai(false);
            if( guan == 0 ) {
                str = str + "如果大运也无财，则不易成婚。";
            }
            else if( guan == 1) {
                str = str + (key == true ? "地支藏干有财，" : "" ) + "有比较弱的成婚机会。";
            }
            else {
                str = str + (key == true ? "地支藏干有多财，" : "") + "有多段感情的机会。";
            }
        }
    }
    else {
        if( (shenGuan + shenSha) > 1 ) {
            str = str + (key == true ? "多官，" : "") + "多次婚姻或者多个男友的可能性大。有机会吃财政饭。";
        }
        if( (shenGuan + shenSha) == 0 ) {
            int guan = fnDzcgFindGuanCai(true);
            if( guan == 0 ) {
                str = str + "如果大运也无官，则不易成婚。";
            }
            else if( guan == 1) {
                str = str + (key == true ? "地支藏干有官，" : "") + "有比较弱的成婚机会。";
            }
            else {
                str = str + (key == true ? "地支藏干有多官，" : "") + "有多段感情的机会。";
            }
        }
        if( shenShang > 0 && (shenYin + shenXiao) == 0) {
            str = str + (key == true ? "有伤官，" : "") + "婚姻不易和睦。";
        }
        if( (shenShang + shenShi) > 1 ) {
            str = str + (key == true ? "多食伤，" : "") + "易有多个儿女。";
        }
    
        for( int ii = 0 ; ii < bazi.dzcgDayList.length ; ii++ ) {
            if( bazi.dzcgDayList[ii].ss.equals("伤") ) {
                str = str + (key == true ? "婚宫藏干有伤官，" : "") + "易分居。";
                break;
            }
        }
    }

    return str;
}

public String fnSelfPayShenSha(String dayGan, String yearZhi, String monthZhi, String dayZhi, String hourZhi) {
    String str = "";

    if( fnComputeTianYi(bazi.dayGan, bazi.yearZhi) ) {
        str = str + "少年有贵人相帮。";
    }
    if( fnComputeTianYi(bazi.dayGan, bazi.monthZhi) ) {
        str = str + "青年有贵人相帮。";
    }
    if( fnComputeTianYi(bazi.dayGan, bazi.dayZhi) ) {
        str = str + "中年有贵人相帮。";
    }
    if( fnComputeTianYi(bazi.dayGan, bazi.hourZhi) ) {
        str = str + "晚年有贵人相帮。";
    }
    return str;
}

public List<String> fnSelfPayBigFate2() {
    //// 分析大运
    List<String> list = new ArrayList<>();
    String str = "　";
    list.add(str);
    str = "     大运分析     ";
    list.add(str);
    str = "----";
    list.add(str);

    DayunLiunian dln;
    for( int ii = 0 ; ii < bazi.bigyunList.length ; ii++ ) {
        if( ii > 0 ) {
            if( (bazi.bigyunList[ii].year + 9) >= predictLiuNianEnd ) {
                if( m_pay == false) {
                    break;
                }
            }
        }
        
        dln = bazi.bigyunList[ii];
        List<String> big = fnBaziBigFateAnalysis(bazi.sex, dln.year, dln.age, bazi.yearGan, bazi.yearZhi, bazi.monthGan, bazi.monthZhi, bazi.dayGan, bazi.dayZhi, bazi.hourGan, bazi.hourZhi, dln.tg, dln.dz);
        list.addAll(big);
 
        str = "　";
        list.add(str);
    }

    return list;
}

public List<String> fnSelfPayLiuNian2() {
    //// 分析流年
    List<String> list = new ArrayList<>();
    String str = "     流年分析     ";
    list.add(str);
    str = "----";
    list.add(str);

    DayunLiunian dln;
    String yearGan, yearZhi;

    if( predictLiuNianEnd < bazi.bigyunList[0].year) {
        if( m_pay == true ) {
            predictLiuNianEnd = bazi.bigyunList[0].year + 2;
        }
        else {
            predictLiuNianEnd = bazi.bigyunList[0].year;
        }
    }

    for( int ii = 0 ; ii < bazi.bigyunList.length ; ii++ ) {
        dln = bazi.bigyunList[ii];
        for( int jj = 0 ; jj < 10 ; jj++ ) {

            
            if( (bazi.bigyunList[ii].year + jj) < predictLiuNianBegin ) continue;
            if( (bazi.bigyunList[ii].year + jj) > predictLiuNianEnd ) break;

            yearGan = dln.liunian.substring(jj * 2, jj * 2 +1);
            yearZhi = dln.liunian.substring(jj * 2 + 1, jj * 2 + 2);

            List<String> big = fnBaziLiuNianAnalysis(bazi.sex, dln.year + jj, dln.age + jj, 
            bazi.yearGan, bazi.yearZhi, bazi.monthGan, bazi.monthZhi, bazi.dayGan, bazi.dayZhi, 
            bazi.hourGan, bazi.hourZhi, dln.tg, dln.dz, yearGan, yearZhi);

            list.addAll(big);
    
            str = "　";
            list.add(str);            
        }  
        if( ( bazi.bigyunList[ii].year + 10) > predictLiuNianEnd ) break;
    }

    return list;
}

public String fnShenChangeBig(String shenOld ) {   
    String str = "";
    switch (shenOld) {
        case "印":
        case "枭":
            str = "或者学业不顺，或者遇到技术困难，或者感到无助，或者长辈不顺。";
            break;
        case "比":
        case "劫":
            str = "或者感到孤单，或者有亲朋不顺。或者破财，或者事业压力变大。";
            break;
        case "食":
        case "伤":
            str = "或者身体变好，或者赚钱变少";
            if( bazi.sex.equals("女") ) {
                str += "，或者儿女不顺。";
            }

            
            break;
        case "财":
        case "才":
            str = "或者身体变好，或者破财，或者事业变难";
            if( bazi.sex.equals("男") ) {
                str += "，或者婚姻出现变化。";
            }
            break;
        case "官":
        case "煞":
            str = "或者身体变好，或者事业不顺，或者事业变动";
            if( bazi.sex.equals("男") ) {
                str += "，或者儿女不顺。";
            }
            else {
                str += "，或者婚姻出现变化。";
            }
            break;
    }

    return str;
}

public List<String> fnBaziAnalysis( String sex,
    String yearGan, String yearZhi, 
    String monthGan, String monthZhi, 
    String dayGan, String dayZhi, 
    String hourGan, String hourZhi) {

    boolean he = false;
    ArrayList<String> arrAnalysis = new ArrayList<String>();
    ArrayList<String> arrGan5he = new ArrayList<String>();
    String msg;

    String shenYearGan = "";
    String shenYearZhi = "";
    String shenMonthGan = "";
    String shenMonthZhi = "";
    String shenDayZhi = "";
    String shenHourGan = "";
    String shenHourZhi = "";

    String feYearGan = "";          /// 年干五行
    String feYearZhi = "";          /// 年支五行
    String  feMonthGan = "";          /// 月干五行
    String  feMonthZhi = "";          /// 月支五行
    String  feDayGan = "";          /// 日干五行
    String  feDayZhi = "";          /// 日支五行
    String  feHourGan = "";          /// 时干五行
    String  feHourZhi = "";          /// 时支五行

    String  feUse1 = "";
    String  feUse2 = "";

    String  heYearGan = yearGan;
    String  heYearZhi = yearZhi;
    String  heMonthGan = monthGan;
    String  heMonthZhi = monthZhi;
    String  heDayZhi = dayZhi;
    String  heHourGan = hourGan;
    String  heHourZhi = hourZhi;

    /// 合后的十神
    String heShenYearGan = "";
    String heShenYearZhi = "";
    String heShenMonthGan = "";
    String heShenMonthZhi = "";
    String heShenDayZhi = "";
    String heShenHourGan = "";
    String heShenHourZhi = "";

    Integer selfStrength = 0;   /// 日元强弱， 1 强，0 平，-1 弱
    Integer selfMoreLess = 0;   /// 五行旺衰， 0 平，1 旺， 2 旺
    Integer feUp, feDown, feUp2;       /// 五行生克个数， feup2是 月干，日支，时支的五行生克个数
    String  feMore1 = "";  /// 五行旺1
    String  feMore2 = "";  /// 五行旺2

    shenYearGan = fnComputeShishen(dayGan, yearGan);
    shenYearZhi = fnComputeShishen(dayGan, yearZhi);
    shenMonthGan = fnComputeShishen(dayGan, monthGan);
    shenMonthZhi = fnComputeShishen(dayGan, monthZhi);
    shenDayZhi = fnComputeShishen(dayGan, dayZhi);
    shenHourGan = fnComputeShishen(dayGan, hourGan);
    shenHourZhi = fnComputeShishen(dayGan, hourZhi);
    
    heShenYearGan = shenYearGan;
    heShenYearZhi = shenYearZhi;
    heShenMonthGan = shenMonthGan;
    heShenMonthZhi = shenMonthZhi;
    heShenDayZhi = shenDayZhi;
    heShenHourGan = shenHourGan;
    heShenHourZhi = shenHourZhi;

    feYearGan = fnGz2Wu2(yearGan);
    feYearZhi = fnGz2Wu2(yearZhi);
    feMonthGan = fnGz2Wu2(monthGan);
    feMonthZhi = fnGz2Wu2(monthZhi);
    feDayGan = fnGz2Wu2(dayGan);
    feDayZhi = fnGz2Wu2(dayZhi);
    feHourGan = fnGz2Wu2(hourGan);
    feHourZhi = fnGz2Wu2(hourZhi);


    msg = "　";
    arrAnalysis.add(msg);
    msg = "     命局分析     ";
    arrAnalysis.add(msg);
    msg = "----";
    arrAnalysis.add(msg);
    msg = "";


    msg = fnSelfDayGan(dayGan, yearZhi, monthZhi, dayZhi, hourZhi, sex);
    arrAnalysis.add(msg);
    msg = "";
    
    switch(feDayGan) {
        case "金":
            feUse1 = "土";
            feUse2 = "金";
            break;
        case "木":
            feUse1 = "水";
            feUse2 = "木";
            break;
        case "水":
            feUse1 = "金";
            feUse2 = "水";
            break;
        case "火":
            feUse1 = "木";
            feUse2 = "火";
            break;
        case "土":
            feUse1 = "火";
            feUse2 = "土";
            break;
    }

    he = false;
    //#region 地支三会局
    if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
        if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
            if( hourZhi.equals("辰") || dayZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) {
                if( feHourGan.equals("木") || feMonthGan.equals("木") || feYearGan.equals("木") ) {
                    if( dayZhi.equals("辰") ) {
                        feDayZhi = "木";
                        heDayZhi = "卯";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                    else if( monthZhi.equals("辰") ) {
                        feMonthZhi = "木";
                        heMonthZhi = "卯";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                    else if( hourZhi.equals("辰") ) {
                        feHourZhi = "木";
                        heHourZhi = "卯";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    }
                    else if( yearZhi.equals("辰") ) {
                        feYearZhi = "木";
                        heYearZhi = "卯";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    }
                    he = true;
                    if( m_bProfessional ) {
                        msg = "寅卯辰三会木局。";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
    }

    if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
        if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
            if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
                if( feHourGan.equals("火") || feMonthGan.equals("火") || feYearGan.equals("火") ) {
                    if( dayZhi.equals("未") ) {
                        feDayZhi = "火";
                        heDayZhi = "午";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                    else if( monthZhi.equals("未") ) {
                        feMonthZhi = "火";
                        heMonthZhi = "午";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                    else if( hourZhi.equals("未") ) {
                        feHourZhi = "火";
                        heHourZhi = "午";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    }
                    else if( yearZhi.equals("未") ) {
                        feYearZhi = "火";
                        heYearZhi = "午";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    }
                    he = true;
                    if( m_bProfessional ) {
                        msg = "巳午未三会火局。";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
    }

    if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
        if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                if( feHourGan.equals("金") || feMonthGan.equals("金") || feYearGan.equals("金") ) {
                    if( dayZhi.equals("戌") ) {
                        feDayZhi = "金";
                        heDayZhi = "酉";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                    else if( monthZhi.equals("戌") ) {
                        feMonthZhi = "金";
                        heMonthZhi = "酉";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                    else if( hourZhi.equals("戌") ) {
                        feHourZhi = "金";
                        heHourZhi = "酉";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    }
                    else if( yearZhi.equals("戌") ) {
                        feYearZhi = "金";
                        heYearZhi = "酉";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    }
                    he = true;
                    if( m_bProfessional ) {
                        msg = "申酉戌三会金局。";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
    }

    if( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) {
        if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
            if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
                if( feHourGan.equals("水") || feMonthGan.equals("水") || feYearGan.equals("水") ) {
                    if( dayZhi.equals("丑") ) {
                        feDayZhi = "水";
                        heDayZhi = "子";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                    else if( monthZhi.equals("丑") ) {
                        feMonthZhi = "水";
                        heMonthZhi = "子";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                    else if( hourZhi.equals("丑") ) {
                        feHourZhi = "水";
                        heHourZhi = "子";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    }
                    else if( yearZhi.equals("丑") ) {
                        feYearZhi = "水";
                        heYearZhi = "子";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    }
                    he = true;
                    if( m_bProfessional ) {
                        msg = "亥子丑三会水局。";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
    }

    //#endregion

    //#region 地支三合局
    if( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) {
        if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
            if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
                if( feHourGan.equals("木") || feMonthGan.equals("木") || feYearGan.equals("木") ) {
                
                    if( hourZhi.equals("亥") && dayZhi.equals("未") ) {
                        feHourZhi = "木";                    
                        heHourZhi = "寅";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        feDayZhi = "木";
                        heDayZhi = "卯";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                    else if( hourZhi.equals("亥") && monthZhi.equals("未") ) {
                        feHourZhi = "木";
                        heHourZhi = "寅";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        feMonthZhi = "木";
                        heMonthZhi = "卯";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                    else if( hourZhi.equals("亥") && yearZhi.equals("未") ) {
                        feHourZhi = "木";
                        heHourZhi = "寅";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        feYearZhi = "木";
                        heYearZhi = "卯";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    }
                    else if( dayZhi.equals("亥") && hourZhi.equals("未") ) {
                        feDayZhi = "木";
                        heDayZhi = "寅";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        feHourZhi = "木";
                        heHourZhi = "卯";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    }
                    else if( dayZhi.equals("亥") && monthZhi.equals("未") ) {
                        feDayZhi = "木";
                        heDayZhi = "寅";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        feMonthZhi = "木";
                        heMonthZhi = "卯";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                    else if( dayZhi.equals("亥") && yearZhi.equals("未") ) {
                        feDayZhi = "木";
                        heDayZhi = "寅";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        feYearZhi = "木";
                        heYearZhi = "卯";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    }
                    else if( monthZhi.equals("亥") && hourZhi.equals("未") ) {
                        feMonthZhi = "木";
                        heMonthZhi = "寅";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        feHourZhi = "木";
                        heHourZhi = "卯";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    }
                    else if( monthZhi.equals("亥") && dayZhi.equals("未") ) {
                        feMonthZhi = "木";
                        heMonthZhi = "寅";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        feDayZhi = "木";
                        heDayZhi = "卯";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                    else if( monthZhi.equals("亥") && yearZhi.equals("未") ) {
                        feMonthZhi = "木";
                        heMonthZhi = "寅";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        feYearZhi = "木";
                        heYearZhi = "卯";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    }
                    else if( yearZhi.equals("亥") && hourZhi.equals("未") ) {
                        feYearZhi = "木";
                        heYearZhi = "寅";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        feHourZhi = "木";
                        heHourZhi = "卯";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    }
                    else if( yearZhi.equals("亥") && dayZhi.equals("未") ) {
                        feYearZhi = "木";
                        heYearZhi = "寅";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        feDayZhi = "木";
                        heDayZhi = "卯";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                    else if( yearZhi.equals("亥") && monthZhi.equals("未") ) {
                        feYearZhi = "木";
                        heYearZhi = "寅";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        feMonthZhi = "木";
                        heMonthZhi = "卯";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                    he = true;
                    if( m_bProfessional ) {
                        msg = "亥卯未三合木局。";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
    }

    if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
        if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                if( feHourGan.equals("火") || feMonthGan.equals("火") || feYearGan.equals("火") ) {

                    if( hourZhi.equals("寅") && dayZhi.equals("戌") ) {
                        feHourZhi = "火";
                        heHourZhi = "巳";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        feDayZhi = "火";
                        heDayZhi = "午";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                    else if( hourZhi.equals("寅") && monthZhi.equals("戌") ) {
                        feHourZhi = "火";
                        heHourZhi = "巳";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        feMonthZhi = "火";
                        heMonthZhi = "午";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                    else if( hourZhi.equals("寅") && yearZhi.equals("戌") ) {
                        feHourZhi = "火";
                        heHourZhi = "巳";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        feYearZhi = "火";
                        heYearZhi = "午";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    }
                    else if( dayZhi.equals("寅") && hourZhi.equals("戌") ) {
                        feDayZhi = "火";
                        heDayZhi = "巳";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        feHourZhi = "火";
                        heHourZhi = "午";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    }
                    else if( dayZhi.equals("寅") && monthZhi.equals("戌") ) {
                        feDayZhi = "火";
                        heDayZhi = "巳";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        feMonthZhi = "火";
                        heMonthZhi = "午";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                    else if( dayZhi.equals("寅") && yearZhi.equals("戌") ) {
                        feDayZhi = "火";
                        heDayZhi = "巳";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        feYearZhi = "火";
                        heYearZhi = "午";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    }
                    else if( monthZhi.equals("寅") && hourZhi.equals("戌") ) {
                        feMonthZhi = "火";
                        heMonthZhi = "巳";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        feHourZhi = "火";
                        heHourZhi = "午";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    }
                    else if( monthZhi.equals("寅") && dayZhi.equals("戌") ) {
                        feMonthZhi = "火";
                        heMonthZhi = "巳";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        feDayZhi = "火";
                        heDayZhi = "午";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                    else if( monthZhi.equals("寅") && yearZhi.equals("戌") ) {
                        feMonthZhi = "火";
                        heMonthZhi = "巳";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        feYearZhi = "火";
                        heYearZhi = "午";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    }
                    else if( yearZhi.equals("寅") && hourZhi.equals("戌") ) {
                        feYearZhi = "火";
                        heYearZhi = "巳";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        feHourZhi = "火";
                        heHourZhi = "午";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    }
                    else if( yearZhi.equals("寅") && dayZhi.equals("戌") ) {
                        feYearZhi = "火";
                        heYearZhi = "巳";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        feDayZhi = "火";
                        heDayZhi = "午";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                    else if( yearZhi.equals("寅") && monthZhi.equals("戌") ) {
                        feYearZhi = "火";
                        heYearZhi = "巳";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        feMonthZhi = "火";
                        heMonthZhi = "午";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                    he = true;
                    if( m_bProfessional ) {
                        msg = "寅午戌三合火局。";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
    }

    if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
        if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
            if( hourZhi.equals("辰") || dayZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) {
                if( feHourGan.equals("水") || feMonthGan.equals("水") || feYearGan.equals("水") ) {

                    if( hourZhi.equals("申") && dayZhi.equals("辰") ) {
                        feHourZhi = "水";
                        heHourZhi = "亥";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        feDayZhi = "水";
                        heDayZhi = "子";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                    else if( hourZhi.equals("申") && monthZhi.equals("辰") ) {
                        feHourZhi = "水";
                        heHourZhi = "亥";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        feMonthZhi = "水";
                        heMonthZhi = "子";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                    else if( hourZhi.equals("申") && yearZhi.equals("辰") ) {
                        feHourZhi = "水";
                        heHourZhi = "亥";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        feYearZhi = "水";
                        heYearZhi = "子";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    }
                    else if( dayZhi.equals("申") && hourZhi.equals("辰") ) {
                        feDayZhi = "水";
                        heDayZhi = "亥";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        feHourZhi = "水";
                        heHourZhi = "子";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    }
                    else if( dayZhi.equals("申") && monthZhi.equals("辰") ) {
                        feDayZhi = "水";
                        heDayZhi = "亥";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        feMonthZhi = "水";
                        heMonthZhi = "子";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                    else if( dayZhi.equals("申") && yearZhi.equals("辰") ) {
                        feDayZhi = "水";
                        heDayZhi = "亥";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        feYearZhi = "水";
                        heYearZhi = "子";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    }
                    else if( monthZhi.equals("申") && hourZhi.equals("辰") ) {
                        feMonthZhi = "水";
                        heMonthZhi = "亥";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        feHourZhi = "水";
                        heHourZhi = "子";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    }
                    else if( monthZhi.equals("申") && dayZhi.equals("辰") ) {
                        feMonthZhi = "水";
                        heMonthZhi = "亥";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        feDayZhi = "水";
                        heDayZhi = "子";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                    else if( monthZhi.equals("申") && yearZhi.equals("辰") ) {
                        feMonthZhi = "水";
                        heMonthZhi = "亥";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        feYearZhi = "水";
                        heYearZhi = "子";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    }
                    else if( yearZhi.equals("申") && hourZhi.equals("辰") ) {
                        feYearZhi = "水";
                        heYearZhi = "亥";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        feHourZhi = "水";
                        heHourZhi = "子";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    }
                    else if( yearZhi.equals("申") && dayZhi.equals("辰") ) {
                        feYearZhi = "水";
                        heYearZhi = "亥";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        feDayZhi = "水";
                        heDayZhi = "子";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                    else if( yearZhi.equals("申") && monthZhi.equals("辰") ) {
                        feYearZhi = "水";
                        heYearZhi = "亥";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        feMonthZhi = "水";
                        heMonthZhi = "子";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                    he = true;
                    if( m_bProfessional ) {
                        msg = "申子辰三合水局。";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
    }

    if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
        if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
            if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
                if( feHourGan.equals("金") || feMonthGan.equals("金") || feYearGan.equals("金") ) {

                    if( hourZhi.equals("巳") && dayZhi.equals("丑") ) {
                        feHourZhi = "金";
                        heHourZhi = "申";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        feDayZhi = "金";
                        heDayZhi = "酉";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                    else if( hourZhi.equals("巳") && monthZhi.equals("丑") ) {
                        feHourZhi = "金";
                        heHourZhi = "申";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        feMonthZhi = "金";
                        heMonthZhi = "酉";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                    else if( hourZhi.equals("巳") && yearZhi.equals("丑") ) {
                        feHourZhi = "金";
                        heHourZhi = "申";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        feYearZhi = "金";
                        heYearZhi = "酉";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    }
                    else if( dayZhi.equals("巳") && hourZhi.equals("丑") ) {
                        feDayZhi = "金";
                        heDayZhi = "申";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        feHourZhi = "金";
                        heHourZhi = "酉";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    }
                    else if( dayZhi.equals("巳") && monthZhi.equals("丑") ) {
                        feDayZhi = "金";
                        heDayZhi = "申";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        feMonthZhi = "金";
                        heMonthZhi = "酉";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                    else if( dayZhi.equals("巳") && yearZhi.equals("丑") ) {
                        feDayZhi = "金";
                        heDayZhi = "申";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        feYearZhi = "金";
                        heYearZhi = "酉";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    }
                    else if( monthZhi.equals("巳") && hourZhi.equals("丑") ) {
                        feMonthZhi = "金";
                        heMonthZhi = "申";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        feHourZhi = "金";
                        heHourZhi = "酉";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    }
                    else if( monthZhi.equals("巳") && dayZhi.equals("丑") ) {
                        feMonthZhi = "金";
                        heMonthZhi = "申";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        feDayZhi = "金";
                        heDayZhi = "酉";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                    else if( monthZhi.equals("巳") && yearZhi.equals("丑") ) {
                        feMonthZhi = "金";
                        heMonthZhi = "申";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        feYearZhi = "金";
                        heYearZhi = "酉";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    }
                    else if( yearZhi.equals("巳") && hourZhi.equals("丑") ) {
                        feYearZhi = "金";
                        heYearZhi = "申";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        feHourZhi = "金";
                        heHourZhi = "酉";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    }
                    else if( yearZhi.equals("巳") && dayZhi.equals("丑") ) {
                        feYearZhi = "金";
                        heYearZhi = "申";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        feDayZhi = "金";
                        heDayZhi = "酉";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                    else if( yearZhi.equals("巳") && monthZhi.equals("丑") ) {
                        feYearZhi = "金";
                        heYearZhi = "申";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        feMonthZhi = "金";
                        heMonthZhi = "酉";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                    he = true;
                    if( m_bProfessional ) {
                        msg = "巳酉丑三合金局。";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
    }

    //#endregion

    //#region 地支六合
    if( he == false ) {
        Integer cnt1, cnt2;

        cnt1 = 0;
        cnt2 = 0;
        if( hourZhi.equals("子") ) {
            cnt1 = cnt1 + 1;
        }
        if( dayZhi.equals("子") ) {
            cnt1 = cnt1 + 1;
        }
        if( monthZhi.equals("子") ) {
            cnt1 = cnt1 + 1;
        }
        if( yearZhi.equals("子") ) {
            cnt1 = cnt1 + 1;
        }
        if( hourZhi.equals("丑") ) {
            cnt2 = cnt2 + 1;
        }
        if( dayZhi.equals("丑") ) {
            cnt2 = cnt2 + 1;
        }
        if( monthZhi.equals("丑") ) {
            cnt2 = cnt2 + 1;
        }
        if( yearZhi.equals("丑") ) {
            cnt2 = cnt2 + 1;
        }
        if( cnt1 == 2 && cnt2 == 2 ) {
            if( feHourGan.equals("土") || feMonthGan.equals("土") || feYearGan.equals("土") ) {            
                if( dayZhi.equals("子") ) {
                    feDayZhi = "土";
                    heDayZhi = "丑";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    if( hourZhi.equals("丑") ) {
                        if( monthZhi.equals("子") ) { /// 丑子子丑
                            feMonthZhi = "土";
                            heMonthZhi = "丑";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        }
                        else { ///// 子丑子丑
                            feYearZhi = "土";
                            heYearZhi = "丑";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        }
                    }
                    else { // 丑丑子子
                    }
                }
                else {
                    if( hourZhi.equals("子") ) { /// xx丑子
                        feHourZhi = "土";
                        heHourZhi = "丑";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        if( monthZhi.equals("子") ) { /// 丑子丑子
                            feMonthZhi = "土";
                            heMonthZhi = "丑";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        }
                        else { /// 子丑丑子
                            feYearZhi = "土";
                            heYearZhi = "丑";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        }
                    }
                    else  {  // 子子丑丑
                        feMonthZhi = "土";
                        heMonthZhi = "丑";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                }
                if( m_bProfessional ) {
                    msg = "子丑六合土。";
                    arrAnalysis.add(msg);
                }
            }
        }
        else if( hourZhi.equals("子") && feHourGan.equals("土") && 
        ( dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
            feHourZhi = "土";
            heHourZhi = "丑";
            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
            if( m_bProfessional ) {
                msg = "子丑六合土。";
                arrAnalysis.add(msg);
            }
        }
        else if( dayZhi.equals("子") && feDayGan.equals("土") && 
        ( hourZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
            feDayZhi = "土";
            heDayZhi = "丑";
            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
            if( m_bProfessional ) {
                msg = "子丑六合土。";
                arrAnalysis.add(msg);
            }
        }
        else if( monthZhi.equals("子") && feMonthGan.equals("土") && 
        ( hourZhi.equals("丑") || dayZhi.equals("丑") || yearZhi.equals("丑") ) ) {
            feMonthZhi = "土";
            heMonthZhi = "丑";
            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
            if( m_bProfessional ) {
                msg = "子丑六合土。";
                arrAnalysis.add(msg);
            }
        }
        else if( yearZhi.equals("子") && feYearGan.equals("土") && 
        ( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") ) ) {
            feYearZhi = "土";
            heYearZhi = "丑";
            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
            if( m_bProfessional ) {
                msg = "子丑六合土。";
                arrAnalysis.add(msg);
            }
        }

        cnt1 = 0;
        cnt2 = 0;
        if( hourZhi.equals("亥") ) {
            cnt1 = cnt1 + 1;
        }
        if( dayZhi.equals("亥") ) {
            cnt1 = cnt1 + 1;
        }
        if( monthZhi.equals("亥") ) {
            cnt1 = cnt1 + 1;
        }
        if( yearZhi.equals("亥") ) {
            cnt1 = cnt1 + 1;
        }
        if( hourZhi.equals("寅") ) {
            cnt2 = cnt2 + 1;
        }
        if( dayZhi.equals("寅") ) {
            cnt2 = cnt2 + 1;
        }
        if( monthZhi.equals("寅") ) {
            cnt2 = cnt2 + 1;
        }
        if( yearZhi.equals("寅") ) {
            cnt2 = cnt2 + 1;
        }
        if( cnt1 == 2 && cnt2 == 2) {
            if( feHourGan.equals("木") || feMonthGan.equals("木") || feYearGan.equals("木") ) {            
                if( dayZhi.equals("亥") ) {
                    feDayZhi = "木";
                    heDayZhi = "寅";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    if( hourZhi.equals("寅") ) {
                        if( monthZhi.equals("亥") ) { /// 寅亥亥寅
                            feMonthZhi = "木";
                            heMonthZhi = "寅";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        }
                        else { ///// 亥寅亥寅
                            feYearZhi = "木";
                            heYearZhi = "寅";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        }
                    }
                    else { // 寅寅亥亥
                    }
                }
                else {
                    if( hourZhi.equals("亥") ) { /// xx寅亥
                        feHourZhi = "木";
                        heHourZhi = "寅";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        if( monthZhi.equals("亥") ) { /// 寅亥寅亥
                            feMonthZhi = "木";
                            heMonthZhi = "寅";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        }
                        else { /// 亥寅寅亥
                            feYearZhi = "木";
                            heYearZhi = "寅";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        }
                    }
                    else  {  // 亥亥寅寅
                        feMonthZhi = "木";
                        heMonthZhi = "寅";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                }
                if( m_bProfessional ) {
                    msg = "亥寅六合木。";
                    arrAnalysis.add(msg);
                }
            }                        
        }
        else if( hourZhi.equals("亥") && feHourGan.equals("木") &&
        ( dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
            feHourZhi = "木";
            heHourZhi = "寅";
            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
            if( m_bProfessional ) {
                msg = "亥寅六合木。";
                arrAnalysis.add(msg);
            }
        }
        else if( dayZhi.equals("亥") && feDayGan.equals("木") && 
        ( hourZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
            feDayZhi = "木";
            heDayZhi = "寅";
            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
            if( m_bProfessional ) {
                msg = "亥寅六合木。";
                arrAnalysis.add(msg);
            }
        }
        else if( monthZhi.equals("亥") && feMonthGan.equals("木") && 
        ( hourZhi.equals("寅") || dayZhi.equals("寅") || yearZhi.equals("寅") ) ) {
            feMonthZhi = "木";
            heMonthZhi = "寅";
            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
            if( m_bProfessional ) {
                msg = "亥寅六合木。";
                arrAnalysis.add(msg);
            }
        }
        else if( yearZhi.equals("亥") && feYearGan.equals("木") && 
        ( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") ) ) {
            feYearZhi = "木";
            heYearZhi = "寅";
            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
            if( m_bProfessional ) {
                msg = "亥寅六合木。";
                arrAnalysis.add(msg);
            }
        }

        cnt1 = 0;
        cnt2 = 0;
        if( hourZhi.equals("卯") ) {
            cnt1 = cnt1 + 1;
        }
        if( dayZhi.equals("卯") ) {
            cnt1 = cnt1 + 1;
        }
        if( monthZhi.equals("卯") ) {
            cnt1 = cnt1 + 1;
        }
        if( yearZhi.equals("卯") ) {
            cnt1 = cnt1 + 1;
        }
        if( hourZhi.equals("戌") ) {
            cnt2 = cnt2 + 1;
        }
        if( dayZhi.equals("戌") ) {
            cnt2 = cnt2 + 1;
        }
        if( monthZhi.equals("戌") ) {
            cnt2 = cnt2 + 1;
        }
        if( yearZhi.equals("戌") ) {
            cnt2 = cnt2 + 1;
        }
        if( cnt1 == 2 && cnt2 == 2) {  /// 戌含戊，巳含戊
            if( feHourGan.equals("火") || feMonthGan.equals("火") || feYearGan.equals("火") ) {            
                if( dayZhi.equals("卯") ) {
                    if( hourZhi.equals("戌") ) {
                        feDayZhi = "火";
                        heDayZhi = "巳";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        feHourZhi = "火";
                        heHourZhi = "午";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        if( monthZhi.equals("卯") ) {
                            feMonthZhi = "火";
                            heMonthZhi = "巳";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            feYearZhi = "火";
                            heYearZhi = "午";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        }
                        else { 
                            feMonthZhi = "火";
                            heMonthZhi = "午";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            feYearZhi = "火";
                            heYearZhi = "巳";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        }
                    }
                    else { // 年月肯定是 卯卯
                        feDayZhi = "火";
                        heDayZhi = "巳";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        feMonthZhi = "火";
                        heMonthZhi = "午";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                }
                else {
                    if( hourZhi.equals("卯") ) {
                        feHourZhi = "火";
                        heHourZhi = "巳";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        feDayZhi = "火";
                        heDayZhi = "午";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        if( monthZhi.equals("卯") ) {
                            feMonthZhi = "火";
                            heMonthZhi = "巳";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            feYearZhi = "火";
                            heYearZhi = "午";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        }
                        else {
                            feMonthZhi = "火";
                            heMonthZhi = "午";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            feYearZhi = "火";
                            heYearZhi = "巳";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        }
                    }
                    else  {  // 年月肯定是 卯卯
                        feDayZhi = "火";
                        heDayZhi = "午";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        feMonthZhi = "火";
                        heMonthZhi = "巳";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                }
                if( m_bProfessional ) {
                    msg = "卯戌六合火。";
                    arrAnalysis.add(msg);
                }
            }
        }
        else if( hourZhi.equals("卯") && ( dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
            if( feHourGan.equals("火") ) {            

                feHourZhi = "火";
                heHourZhi = "巳";
                heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                if(  dayZhi.equals("戌") ) {
                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);    
                }
                else if( monthZhi.equals("戌") ) {
                    feMonthZhi = "火";
                    heMonthZhi = "午";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                }
                else if( yearZhi.equals("戌") ) {
                    feYearZhi = "火";
                    heYearZhi = "午";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                }
                if( m_bProfessional ) {
                    msg = "卯戌六合火。";
                    arrAnalysis.add(msg);
                }

            }
            else {
                if(  dayZhi.equals("戌") && feDayGan.equals("火") ) {
                    feHourZhi = "火";
                    heHourZhi = "巳";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);

                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);    

                    if( m_bProfessional ) {
                        msg = "卯戌六合火。";
                        arrAnalysis.add(msg);
                    }
                        
                }
                else if( monthZhi.equals("戌") && feMonthGan.equals("火") ) {
                    feHourZhi = "火";
                    heHourZhi = "巳";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
    
                    feMonthZhi = "火";
                    heMonthZhi = "午";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火。";
                        arrAnalysis.add(msg);
                    }
    
                }
                else if( yearZhi.equals("戌") && feYearGan.equals("火") ) {
                    feHourZhi = "火";
                    heHourZhi = "巳";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
    
                    feYearZhi = "火";
                    heYearZhi = "午";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火。";
                        arrAnalysis.add(msg);
                    }
    
                }
                
            }
        }
        else if( dayZhi.equals("卯") && ( hourZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
            
            if( feDayGan.equals("火")) {

                feDayZhi = "火";
                heDayZhi = "巳";
                heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                if(  hourZhi.equals("戌") ) {
                    feHourZhi = "火";
                    heHourZhi = "午";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);    
                }
                else if( monthZhi.equals("戌") ) {
                    feMonthZhi = "火";
                    heMonthZhi = "午";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                }
                else if( yearZhi.equals("戌") ) {
                    feYearZhi = "火";
                    heYearZhi = "午";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                }
                if( m_bProfessional ) {
                    msg = "卯戌六合火。";
                    arrAnalysis.add(msg);
                }

            }
            else {
                if(  hourZhi.equals("戌") && feHourGan.equals("火") ) {
                    feDayZhi = "火";
                    heDayZhi = "巳";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
    
                    feHourZhi = "火";
                    heHourZhi = "午";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);    

                    if( m_bProfessional ) {
                        msg = "卯戌六合火。";
                        arrAnalysis.add(msg);
                    }
                }
                else if( monthZhi.equals("戌") && feMonthGan.equals("火") ) {
                    feDayZhi = "火";
                    heDayZhi = "巳";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
    
                    feMonthZhi = "火";
                    heMonthZhi = "午";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火。";
                        arrAnalysis.add(msg);
                    }
    
                }
                else if( yearZhi.equals("戌") && feYearGan.equals("火") ) {
                    feDayZhi = "火";
                    heDayZhi = "巳";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
    
                    feYearZhi = "火";
                    heYearZhi = "午";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火。";
                        arrAnalysis.add(msg);
                    }

                }

            }
        }
        else if( monthZhi.equals("卯") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || yearZhi.equals("戌") ) ) {
            
            if( feMonthGan.equals("火")) {

                feMonthZhi = "火";
                heMonthZhi = "巳";
                heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                if( dayZhi.equals("戌") ) {
                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                }
                else if( yearZhi.equals("戌") ) {
                    feYearZhi = "火";
                    heYearZhi = "午";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                }
                else if(  hourZhi.equals("戌") ) {
                    feHourZhi = "火";
                    heHourZhi = "午";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);    
                }

                if( m_bProfessional ) {
                    msg = "卯戌六合火。";
                    arrAnalysis.add(msg);
                }
            }
            else {
                if( dayZhi.equals("戌") && feDayGan.equals("火") ) {
                    feMonthZhi = "火";
                    heMonthZhi = "巳";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
    
                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火。";
                        arrAnalysis.add(msg);
                    }
                }
                else if( yearZhi.equals("戌") && feYearGan.equals("火") ) {
                    feMonthZhi = "火";
                    heMonthZhi = "巳";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
    
                    feYearZhi = "火";
                    heYearZhi = "午";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火。";
                        arrAnalysis.add(msg);
                    }
                }
                else if(  hourZhi.equals("戌") && feHourGan.equals("火") ) {
                    feMonthZhi = "火";
                    heMonthZhi = "巳";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
    
                    feHourZhi = "火";
                    heHourZhi = "午";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);    

                    if( m_bProfessional ) {
                        msg = "卯戌六合火。";
                        arrAnalysis.add(msg);
                    }
                }

            }
        }
        else if( yearZhi.equals("卯") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") ) ) {
            
            if( feYearGan.equals("火")) {

                feYearZhi = "火";
                heYearZhi = "巳";
                heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                if( monthZhi.equals("戌") ) {
                    feMonthZhi = "火";
                    heMonthZhi = "午";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                }
                else if( dayZhi.equals("戌") ) {
                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                }
                else if(  hourZhi.equals("戌") ) {
                    feHourZhi = "火";
                    heHourZhi = "午";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);    
                }

                if( m_bProfessional ) {
                    msg = "卯戌六合火。";
                    arrAnalysis.add(msg);
                }
            }
            else {
                if( monthZhi.equals("戌") && feMonthGan.equals("火") ) {
                    feYearZhi = "火";
                    heYearZhi = "巳";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
    
                    feMonthZhi = "火";
                    heMonthZhi = "午";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火。";
                        arrAnalysis.add(msg);
                    }
                }
                else if( dayZhi.equals("戌") && feDayGan.equals("火") ) {
                    feYearZhi = "火";
                    heYearZhi = "巳";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
    
                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火。";
                        arrAnalysis.add(msg);
                    }
                }
                else if(  hourZhi.equals("戌") && feHourGan.equals("火") ) {
                    feYearZhi = "火";
                    heYearZhi = "巳";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
    
                    feHourZhi = "火";
                    heHourZhi = "午";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);    

                    if( m_bProfessional ) {
                        msg = "卯戌六合火。";
                        arrAnalysis.add(msg);
                    }
                }

            }
        }

        cnt1 = 0;
        cnt2 = 0;
        if( hourZhi.equals("辰") ) {
            cnt1 = cnt1 + 1;
        }
        if( dayZhi.equals("辰") ) {
            cnt1 = cnt1 + 1;
        }
        if( monthZhi.equals("辰") ) {
            cnt1 = cnt1 + 1;
        }
        if( yearZhi.equals("辰") ) {
            cnt1 = cnt1 + 1;
        }
        if( hourZhi.equals("酉") ) {
            cnt2 = cnt2 + 1;
        }
        if( dayZhi.equals("酉") ) {
            cnt2 = cnt2 + 1;
        }
        if( monthZhi.equals("酉") ) {
            cnt2 = cnt2 + 1;
        }
        if( yearZhi.equals("酉") ) {
            cnt2 = cnt2 + 1;
        }
        if( cnt1 == 2 && cnt2 == 2) {
            if( feHourGan.equals("金") || feMonthGan.equals("金") || feYearGan.equals("金") ) {            
                if( dayZhi.equals("辰") ) {
                    feDayZhi = "金";
                    heDayZhi = "酉";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    if( hourZhi.equals("酉") ) {
                        if( monthZhi.equals("辰") ) { /// 酉辰辰酉
                            feMonthZhi = "金";
                            heMonthZhi = "酉";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        }
                        else { ///// 辰酉辰酉
                            feYearZhi = "金";
                            heYearZhi = "酉";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        }
                    }
                    else { // 酉酉辰辰
                    }
                }
                else {
                    if( hourZhi.equals("辰") ) { /// xx酉辰
                        feHourZhi = "金";
                        heHourZhi = "酉";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        if( monthZhi.equals("辰") ) { /// 酉辰酉辰
                            feMonthZhi = "金";
                            heMonthZhi = "酉";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        }
                        else { /// 辰酉酉辰
                            feYearZhi = "金";
                            heYearZhi = "酉";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        }
                    }
                    else  {  // 辰辰酉酉
                        feMonthZhi = "金";
                        heMonthZhi = "酉";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                }

                if( m_bProfessional ) {
                    msg = "辰酉六合金。";
                    arrAnalysis.add(msg);
                }
            }                        
        }
        else if( hourZhi.equals("辰") && ( dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
            if( feHourGan.equals("金") ) {
                feHourZhi = "金";
                heHourZhi = "申";
                heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);

                if( m_bProfessional ) {
                    msg = "辰酉六合金。";
                    arrAnalysis.add(msg);
                }
            }
        }
        else if( dayZhi.equals("辰") && ( hourZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
            if( feDayGan.equals("金") ) {
                feDayZhi = "金";
                heDayZhi = "申";
                heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);

                if( m_bProfessional ) {
                    msg = "辰酉六合金。";
                    arrAnalysis.add(msg);
                }
            }
        }
        else if( monthZhi.equals("辰") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || yearZhi.equals("酉") ) ) {
            if( feMonthGan.equals("金") ) {
                feMonthZhi = "金";
                heMonthZhi = "申";
                heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);

                if( m_bProfessional ) {
                    msg = "辰酉六合金。";
                    arrAnalysis.add(msg);
                }
            }
        }
        else if( yearZhi.equals("辰") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") ) ) {
            if( feYearGan.equals("金") ) {
                feYearZhi = "金";
                heYearZhi = "申";
                heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);

                if( m_bProfessional ) {
                    msg = "辰酉六合金。";
                    arrAnalysis.add(msg);
                }
            }
        }

        cnt1 = 0;  
        cnt2 = 0;
        if( hourZhi.equals("巳") ) {
            cnt1 = cnt1 + 1;
        }
        if( dayZhi.equals("巳") ) {
            cnt1 = cnt1 + 1;
        }
        if( monthZhi.equals("巳") ) {
            cnt1 = cnt1 + 1;
        }
        if( yearZhi.equals("巳") ) {
            cnt1 = cnt1 + 1;
        }
        if( hourZhi.equals("申") ) {
            cnt2 = cnt2 + 1;
        }
        if( dayZhi.equals("申") ) {
            cnt2 = cnt2 + 1;
        }
        if( monthZhi.equals("申") ) {
            cnt2 = cnt2 + 1;
        }
        if( yearZhi.equals("申") ) {
            cnt2 = cnt2 + 1;
        }
        if( cnt1 == 2 && cnt2 == 2) {  /// 申含壬水，亥含人水
            if( feHourGan.equals("水") || feMonthGan.equals("水") || feYearGan.equals("水") ) {            

                if( dayZhi.equals("巳") ) {
                    if( hourZhi.equals("申") ) {
                        feHourZhi = "水";
                        heHourZhi = "亥";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
            
                        feDayZhi = "水";
                        heDayZhi = "子";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        if( monthZhi.equals("申") ) {
                            feMonthZhi = "水";
                            heMonthZhi = "亥";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            feYearZhi = "水";
                            heYearZhi = "子";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        }
                        else {
                            feMonthZhi = "水";
                            heMonthZhi = "子";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            feYearZhi = "水";
                            heYearZhi = "亥";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        }
            
                    }
                    else{
                        feMonthZhi = "水";
                        heMonthZhi = "亥";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
        
                        feDayZhi = "水";
                        heDayZhi = "子";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                }
                else {
                    if( hourZhi.equals("巳") ) {
                        feHourZhi = "水";
                        heHourZhi = "子";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        feDayZhi = "水";
                        heDayZhi = "亥";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        if( monthZhi.equals("申") ) {
                            feMonthZhi = "水";
                            heMonthZhi = "亥";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            feYearZhi = "水";
                            heYearZhi = "子";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        }
                        else {
                            feMonthZhi = "水";
                            heMonthZhi = "子";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            feYearZhi = "水";
                            heYearZhi = "亥";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        }
                    }
                    else {
                        feMonthZhi = "水";
                        heMonthZhi = "子";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        feDayZhi = "水";
                        heDayZhi = "亥";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    }
                }

                if( m_bProfessional ) {
                    msg = "巳申六合水。";
                    arrAnalysis.add(msg);
                }
            }
        }
        else if( hourZhi.equals("巳") && ( dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) ) {
            if( feHourGan.equals("水")) {

                feHourZhi = "水";
                heHourZhi = "子";
                heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                if( dayZhi.equals("申") ) {
                    feDayZhi = "水";
                    heDayZhi = "亥";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);    
                }
                else if( monthZhi.equals("申") ) {
                    feMonthZhi = "水";
                    heMonthZhi = "亥";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                }
                else if( yearZhi.equals("申") ) {
                    feYearZhi = "水";
                    heYearZhi = "亥";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                }

                if( m_bProfessional ) {
                    msg = "巳申六合水。";
                    arrAnalysis.add(msg);
                }
            }
            else {
                if( dayZhi.equals("申") && feDayGan.equals("水") ) {
                    feHourZhi = "水";
                    heHourZhi = "子";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
    
                    feDayZhi = "水";
                    heDayZhi = "亥";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);    

                    if( m_bProfessional ) {
                        msg = "巳申六合水。";
                        arrAnalysis.add(msg);
                    }
                }
                else if( monthZhi.equals("申") && feMonthGan.equals("水") ) {
                    feHourZhi = "水";
                    heHourZhi = "子";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
    
                    feMonthZhi = "水";
                    heMonthZhi = "亥";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);

                    if( m_bProfessional ) {
                        msg = "巳申六合水。";
                        arrAnalysis.add(msg);
                    }
                }
                else if( yearZhi.equals("申") && feYearGan.equals("水") ) {
                    feHourZhi = "水";
                    heHourZhi = "子";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
    
                    feYearZhi = "水";
                    heYearZhi = "亥";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);

                    if( m_bProfessional ) {
                        msg = "巳申六合水。";
                        arrAnalysis.add(msg);
                    }
                }

            }
        }
        else if( dayZhi.equals("巳") && ( hourZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) ) {
            
            if( feDayGan.equals("水")) {

                feDayZhi = "水";
                heDayZhi = "子";
                heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                if( hourZhi.equals("申") ) {
                    feHourZhi = "水";
                    heHourZhi = "亥";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);    
                }
                else if( monthZhi.equals("申") ) {
                    feMonthZhi = "水";
                    heMonthZhi = "亥";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                }
                else if( yearZhi.equals("申") ) {
                    feYearZhi = "水";
                    heYearZhi = "亥";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                }

                if( m_bProfessional ) {
                    msg = "巳申六合水。";
                    arrAnalysis.add(msg);
                }
            }
            else {
                if( hourZhi.equals("申") && feHourGan.equals("水") ) {
                    feDayZhi = "水";
                    heDayZhi = "子";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
    
                    feHourZhi = "水";
                    heHourZhi = "亥";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);    

                    if( m_bProfessional ) {
                        msg = "巳申六合水。";
                        arrAnalysis.add(msg);
                    }
                }
                else if( monthZhi.equals("申") && feMonthGan.equals("水") ) {
                    feDayZhi = "水";
                    heDayZhi = "子";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
    
                    feMonthZhi = "水";
                    heMonthZhi = "亥";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);

                    if( m_bProfessional ) {
                        msg = "巳申六合水。";
                        arrAnalysis.add(msg);
                    }
                }
                else if( yearZhi.equals("申") && feYearGan.equals("水") ) {
                    feDayZhi = "水";
                    heDayZhi = "子";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
    
                    feYearZhi = "水";
                    heYearZhi = "亥";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);

                    if( m_bProfessional ) {
                        msg = "巳申六合水。";
                        arrAnalysis.add(msg);
                    }
                }

            }
        }
        else if( monthZhi.equals("巳") && ( hourZhi.equals("申") || dayZhi.equals("申") || yearZhi.equals("申") ) ) {

            if( feMonthGan.equals("水")) {

                feMonthZhi = "水";
                heMonthZhi = "子";
                heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                if( dayZhi.equals("申") ) {
                    feDayZhi = "水";
                    heDayZhi = "亥";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                }
                else if( yearZhi.equals("申") ) {
                    feYearZhi = "水";
                    heYearZhi = "亥";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                }
                else if( hourZhi.equals("申") ) {
                    feHourZhi = "水";
                    heHourZhi = "亥";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);    
                }

                if( m_bProfessional ) {
                    msg = "巳申六合水。";
                    arrAnalysis.add(msg);
                }
            }
            else {
                if( dayZhi.equals("申") && feDayGan.equals("水") ) {
                    feMonthZhi = "水";
                    heMonthZhi = "子";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
    
                    feDayZhi = "水";
                    heDayZhi = "亥";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);

                    if( m_bProfessional ) {
                        msg = "巳申六合水。";
                        arrAnalysis.add(msg);
                    }
                }
                else if( yearZhi.equals("申") && feYearGan.equals("水") ) {
                    feMonthZhi = "水";
                    heMonthZhi = "子";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
    
                    feYearZhi = "水";
                    heYearZhi = "亥";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);

                    if( m_bProfessional ) {
                        msg = "巳申六合水。";
                        arrAnalysis.add(msg);
                    }
                }
                else if( hourZhi.equals("申") && feHourGan.equals("水") ) {
                    feMonthZhi = "水";
                    heMonthZhi = "子";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
    
                    feHourZhi = "水";
                    heHourZhi = "亥";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);    

                    if( m_bProfessional ) {
                        msg = "巳申六合水。";
                        arrAnalysis.add(msg);
                    }
                }

            }
        }
        else if( yearZhi.equals("巳") && ( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") ) ) {
            
            if( feYearGan.equals("水")) {

                feYearZhi = "水";
                heYearZhi = "子";
                heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                if( monthZhi.equals("申") ) {
                    feMonthZhi = "水";
                    heMonthZhi = "亥";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                }
                else if( dayZhi.equals("申") ) {
                    feDayZhi = "水";
                    heDayZhi = "亥";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                }
                else if( hourZhi.equals("申") ) {
                    feHourZhi = "水";
                    heHourZhi = "亥";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);    
                }

                if( m_bProfessional ) {
                    msg = "巳申六合水。";
                    arrAnalysis.add(msg);
                }
            }
            else {
                if( monthZhi.equals("申") && feMonthGan.equals("水") ) {
                    feYearZhi = "水";
                    heYearZhi = "子";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
    
                    feMonthZhi = "水";
                    heMonthZhi = "亥";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);

                    if( m_bProfessional ) {
                        msg = "巳申六合水。";
                        arrAnalysis.add(msg);
                    }
                }
                else if( dayZhi.equals("申") && feDayGan.equals("水") ) {
                    feYearZhi = "水";
                    heYearZhi = "子";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
    
                    feDayZhi = "水";
                    heDayZhi = "亥";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);

                    if( m_bProfessional ) {
                        msg = "巳申六合水。";
                        arrAnalysis.add(msg);
                    }
                }
                else if( hourZhi.equals("申") && feHourGan.equals("水") ) {
                    feYearZhi = "水";
                    heYearZhi = "子";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
    
                    feHourZhi = "水";
                    heHourZhi = "亥";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);    

                    if( m_bProfessional ) {
                        msg = "巳申六合水。";
                        arrAnalysis.add(msg);
                    }
                }

            }
        }
        
        cnt1 = 0;
        cnt2 = 0;
        if( hourZhi.equals("午") ) {
            cnt1 = cnt1 + 1;
        }
        if( dayZhi.equals("午") ) {
            cnt1 = cnt1 + 1;
        }
        if( monthZhi.equals("午") ) {
            cnt1 = cnt1 + 1;
        }
        if( yearZhi.equals("午") ) {
            cnt1 = cnt1 + 1;
        }
        if( hourZhi.equals("未") ) {
            cnt2 = cnt2 + 1;
        }
        if( dayZhi.equals("未") ) {
            cnt2 = cnt2 + 1;
        }
        if( monthZhi.equals("未") ) {
            cnt2 = cnt2 + 1;
        }
        if( yearZhi.equals("未") ) {
            cnt2 = cnt2 + 1;
        }
        if( cnt1 == 2 && cnt2 == 2) {
            if( feGanHuo > feGanTu ) {            
                if( dayZhi.equals("午") ) {
                    if( hourZhi.equals("未") ) { /// xx午未
                        feHourZhi = "火";
                        heHourZhi = "午";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        if( monthZhi.equals("午") ) { /// 未午午未
                            feYearZhi = "火";
                            heYearZhi = "午";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);        
                        }
                        else {  /// 午未午未
                            feMonthZhi = "火";
                            heMonthZhi = "午";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        }
                    }
                    else { /// 未未午午
                        feMonthZhi = "火";
                        heMonthZhi = "午";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                }
                else {
                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    if( hourZhi.equals("午") ) {  //// xx未午
                        if( monthZhi.equals("午") ) {  /// 未午未午
                            feYearZhi = "火";
                            heYearZhi = "午";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);        
                        }
                        else {
                            feMonthZhi = "火";
                            heMonthZhi = "午";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        }
                    }
                    else {  /// 午午未未
                    }
                }

                if( m_bProfessional ) {
                    msg = "午未六合火。";
                    arrAnalysis.add(msg);
                }
            }
            else if( feGanHuo < feGanTu ) {
                if( dayZhi.equals("午") ) {
                    feDayZhi = "土";
                    heDayZhi = "未";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    if( hourZhi.equals("未") ) { /// xx午未
                        if( monthZhi.equals("午") ) { /// 未午午未
                            feMonthZhi = "土";
                            heMonthZhi = "未";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        }
                        else {  /// 午未午未
                            feYearZhi = "土";
                            heYearZhi = "未";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);        
                        }
                    }
                    else { /// 未未午午
                    }
                }
                else {
                    if( hourZhi.equals("午") ) {  //// xx未午
                        feHourZhi = "土";
                        heHourZhi = "未";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);

                        if( monthZhi.equals("午") ) {  /// 未午未午
                            feMonthZhi = "土";
                            heMonthZhi = "未";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        }
                        else {
                            feYearZhi = "土";
                            heYearZhi = "未";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);        
                        }
                    }
                    else {  /// 午午未未
                        feMonthZhi = "土";
                        heMonthZhi = "未";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    }
                }

                if( m_bProfessional ) {
                    msg = "午未六合土。";
                    arrAnalysis.add(msg);
                }
            }
        }
        else if( hourZhi.equals("午") && ( dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) ) {
            if( feGanTu > feGanHuo ) {
                feHourZhi = "土";
                heHourZhi = "未";
                heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);

                if( m_bProfessional ) {
                    msg = "午未六合土。";
                    arrAnalysis.add(msg);
                }
            }
            else if( feGanHuo > feGanTu ) {
                if(dayZhi.equals("未") ) {
                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                }
                else if(monthZhi.equals("未") ) {
                    feMonthZhi = "火";
                    heMonthZhi = "午";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                }
                else if(yearZhi.equals("未") ) {
                    feYearZhi = "火";
                    heYearZhi = "午";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                }

                if( m_bProfessional ) {
                    msg = "午未六合火。";
                    arrAnalysis.add(msg);
                }                
            }
        }
        else if( dayZhi.equals("午") && ( hourZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) ) {
            if( feGanTu > feGanHuo ) {
                feDayZhi = "土";
                heDayZhi = "未";
                heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);    

                if( m_bProfessional ) {
                    msg = "午未六合土。";
                    arrAnalysis.add(msg);
                }
            }
            else if( feGanHuo > feGanTu ) {
                if(hourZhi.equals("未") ) {
                    feHourZhi = "火";
                    heHourZhi = "午";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                }
                else if(monthZhi.equals("未") ) {
                    feMonthZhi = "火";
                    heMonthZhi = "午";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                }
                else if(yearZhi.equals("未") ) {
                    feYearZhi = "火";
                    heYearZhi = "午";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                }

                if( m_bProfessional ) {
                    msg = "午未六合火。";
                    arrAnalysis.add(msg);
                }
            }
        }
        else if( monthZhi.equals("午") && ( hourZhi.equals("未") || dayZhi.equals("未") || yearZhi.equals("未") ) ) {
            
            if( feGanTu > feGanHuo ) {
                feMonthZhi = "土";
                heMonthZhi = "未";
                heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);

                if( m_bProfessional ) {
                    msg = "午未六合土。";
                    arrAnalysis.add(msg);
                }
            }
            else if( feGanHuo > feGanTu ) {
                if(hourZhi.equals("未") ) {
                    feHourZhi = "火";
                    heHourZhi = "午";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                }
                else if(dayZhi.equals("未") ) {
                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                }
                else if(yearZhi.equals("未") ) {
                    feYearZhi = "火";
                    heYearZhi = "午";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                }

                if( m_bProfessional ) {
                    msg = "午未六合火。";
                    arrAnalysis.add(msg);
                }
            }
        }
        else if( yearZhi.equals("午") && ( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") ) ) {
            if( feGanTu > feGanHuo ) {
                feYearZhi = "土";
                heYearZhi = "未";
                heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);

                if( m_bProfessional ) {
                    msg = "午未六合土。";
                    arrAnalysis.add(msg);
                }
            }
            else if( feGanHuo > feGanTu ) {
                if(hourZhi.equals("未") ) {
                    feHourZhi = "火";
                    heHourZhi = "午";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                }
                else if(dayZhi.equals("未") ) {
                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                }
                else if(monthZhi.equals("未") ) {
                    feMonthZhi = "火";
                    heMonthZhi = "午";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                }

                if( m_bProfessional ) {
                    msg = "午未六合火。";
                    arrAnalysis.add(msg);
                }
            }            
        }
    }

    //#endregion

    //#region 天干五合
    he = false;
    if( dayGan.equals("己") && hourGan.equals("甲")  ) {
        msg = "";
        if( m_bProfessional ) msg = "甲己合化土，";
        if( feHourZhi.equals("土")) {
            feHourGan = "土";
            heHourGan = "己";
            heShenHourGan = fnComputeShishen(dayGan, heHourGan);
            msg += "易安分守信。";    
            arrGan5he.add(msg);
        }
        else {
            if( m_bProfessional ) msg += "未成。";
        }
    }
    else  if( dayGan.equals("己") && monthGan.equals("甲")  ) {
        msg = "";
        if( m_bProfessional ) msg = "甲己合化土，";
        if( feMonthZhi.equals("土")) {
            feMonthGan = "土";
            heMonthGan = "己";
            heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
            he = true;    
            msg += "易安分守信。";    
            arrGan5he.add(msg);
        }
        else {
            if( m_bProfessional ) msg += "未成。";
        }
    }  /// 日元本身不能被合化。
    if(he == false) {
        if( yearGan.equals("甲") && monthGan.equals("己")  ) {
            msg = "";
            if( m_bProfessional ) msg = "甲己合化土，";
            if( feYearZhi.equals("土")) { 
                feYearGan = "土";
                heYearGan = "己";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg += "易安分守信。";    
                arrGan5he.add(msg);
            }
            else {
                if( m_bProfessional ) msg += "未成。";
            }
        }
        if( monthGan.equals("甲") && yearGan.equals("己")) {
            msg = "";
            if( m_bProfessional ) msg = "甲己合化土，";
            if( feMonthZhi.equals("土")) {
                feMonthGan = "土";
                heMonthGan = "己";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                he = true;
                msg += "或者安分守信。";    
                arrGan5he.add(msg);
            }
            else {
                if( m_bProfessional ) msg += "未成。";
            }
        }
    }

    he = false;
    if( dayGan.equals("庚") && hourGan.equals("乙") ) {
        msg = "";
        if( m_bProfessional ) msg = "乙庚合化金，";
        if( feHourZhi.equals("金")) {
            feHourGan = "金";
            heHourGan = "庚";
            heShenHourGan = fnComputeShishen(dayGan, heHourGan);
            msg += "或者有仁有义。";    
            arrGan5he.add(msg);
        }
        else {
            if( m_bProfessional ) msg += "未成。";
        }
    }
    else if( dayGan.equals("庚") && monthGan.equals("乙") ) {
        msg = "";
        if( m_bProfessional ) msg = "乙庚合化金，";
        if( feMonthZhi.equals("金")) {
            feMonthGan = "金";
            heMonthGan = "庚";
            heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
            he = true;
            msg += "或者有仁有义。";    
            arrGan5he.add(msg);
        }
        else {
            if( m_bProfessional ) msg += "未成。";
        }
    }
    if(he == false) {
        if( yearGan.equals("乙") && monthGan.equals("庚") ) {
            msg = "";
            if( m_bProfessional ) msg = "乙庚合化金，";
            if( feYearZhi.equals("金")) {
                feYearGan = "金";
                heYearGan = "庚";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg += "或者有仁有义。";    
                arrGan5he.add(msg);
            }
            else {
                if( m_bProfessional ) msg += "未成。";
            }
        }
        if( monthGan.equals("乙") && yearGan.equals("庚") ) {
            msg = "";
            if( m_bProfessional ) msg = "乙庚合化金，";
            if( feMonthZhi.equals("金")) {
                feMonthGan = "金";
                heMonthGan = "庚";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                he = true;
                msg += "或者有仁有义。";    
                arrGan5he.add(msg);
            }
            else {
                if( m_bProfessional ) msg += "未成。";
            }
        }
    }

    he = false;
    if( dayGan.equals("丙") && hourGan.equals("辛")) {
        msg = "";
        if( m_bProfessional ) msg = "丙辛合化水，";
        if( feHourZhi.equals("水") || feDayZhi.equals("水") ) {
            feHourGan = "水";
            heHourGan = "癸";
            heShenHourGan = fnComputeShishen(dayGan, heHourGan);
            msg += "或者聪明贵气。";    
            arrGan5he.add(msg);
        }
        else {
            if( m_bProfessional ) msg += "未成。";
        }
    }
    else if( dayGan.equals("辛") && hourGan.equals("丙") ) {
        msg = "";
        if( m_bProfessional ) msg = "丙辛合化水，";
        if( feHourZhi.equals("水") || feDayZhi.equals("水") ) {  
            feHourGan = "水";
            heHourGan = "壬";
            heShenHourGan = fnComputeShishen(dayGan, heHourGan);
            msg += "或者聪明贵气。";    
            arrGan5he.add(msg);
        }
        else {
            if( m_bProfessional ) msg += "未成。";
        }
    }
    else if( dayGan.equals("丙") && monthGan.equals("辛") ) {
        msg = "";
        if( m_bProfessional ) msg = "丙辛合化水，";
        if( feMonthZhi.equals("水") || feDayZhi.equals("水") ) {
            feMonthGan = "水";
            heMonthGan = "癸";
            heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
            he = true;
            msg += "或者聪明贵气。";    
            arrGan5he.add(msg);
        }
        else {
            if( m_bProfessional ) msg += "未成。";
        }
    }
    else if( dayGan.equals("辛") && monthGan.equals("丙") ) {
        msg = "";
        if( m_bProfessional ) msg = "丙辛合化水，";
        if( feMonthZhi.equals("水") || feDayZhi.equals("水") ) {
            feMonthGan = "水";
            heMonthGan = "壬";
            heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
            he = true;
            msg += "或者聪明贵气。";    
            arrGan5he.add(msg);
        }
        else {
            if( m_bProfessional ) msg += "未成。";
        }
    }
    if(he == false) {
        if( yearGan.equals("丙") && monthGan.equals("辛")) {
            msg = "";
            if( m_bProfessional ) msg = "丙辛合化水，";
            if( feYearZhi.equals("水") || feMonthZhi.equals("水") ) {
                feMonthGan = "水";
                heMonthGan = "癸";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                feYearGan = "水";
                heYearGan = "壬";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg += "或者聪明贵气。";    
                arrGan5he.add(msg);
            }
            else {
                if( m_bProfessional ) msg += "未成。";
            }
        }
        if( monthGan.equals("丙") && yearGan.equals("辛")) {
            msg = "";
            if( m_bProfessional ) msg = "丙辛合化水，";
            if( feYearZhi.equals("水") || feMonthZhi.equals("水") ) {
                feMonthGan = "水";
                heMonthGan = "壬";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                feYearGan = "水";
                heYearGan = "癸";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg += "或者聪明贵气。";    
                arrGan5he.add(msg);
            }
            else {
                if( m_bProfessional ) msg += "未成。";
            }
        }
    }

    he = false;  /// 丁化乙木，壬化甲木
    if( dayGan.equals("丁") && hourGan.equals("壬") ) {
        msg = "";
        if( m_bProfessional ) msg = "丁壬合化木，";
        if( feHourZhi.equals("木") || feDayZhi.equals("木") ) {
            feHourGan = "木";
            heHourGan = "甲";
            heShenHourGan = fnComputeShishen(dayGan, heHourGan);
            msg += "虽然积极努力，但后果不确定。";    
            arrGan5he.add(msg);
        }
        else {
            if( m_bProfessional ) msg += "未成。";
        }
    }
    else if( dayGan.equals("壬") && hourGan.equals("丁")) {
        msg = "";
        if( m_bProfessional ) msg = "丁壬合化木，";
        if( feHourZhi.equals("木") || feDayZhi.equals("木") ) {
            feHourGan = "木";
            heHourGan = "乙";
            heShenHourGan = fnComputeShishen(dayGan, heHourGan);
            msg += "虽然积极努力，但后果不确定。";    
            arrGan5he.add(msg);
        }
        else {
            if( m_bProfessional ) msg += "未成。";
        }
    }
    else if( dayGan.equals("丁") && monthGan.equals("壬") ) {
        msg = "";
        if( m_bProfessional ) msg = "丁壬合化木，";
        if( feMonthZhi.equals("木") || feDayZhi.equals("木") ) {
            feMonthGan = "木";
            heMonthGan = "甲";
            heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
            he = true;
            msg += "虽然积极努力，但后果不确定。";    
            arrGan5he.add(msg);
        }
        else {
            if( m_bProfessional ) msg += "未成。";
        }
    }
    else if( dayGan.equals("壬") && monthGan.equals("丁") ) {
        msg = "";
        if( m_bProfessional ) msg = "丁壬合化木，";
        if( feMonthZhi.equals("木") || feDayZhi.equals("木") ) {
            feMonthGan = "木";
            heMonthGan = "乙";
            heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
            he = true;
            msg += "虽然积极努力，但后果不确定。";    
            arrGan5he.add(msg);
        }
        else {
            if( m_bProfessional ) msg += "未成。";
        }
    }
    if(he == false) {
        if( yearGan.equals("丁") && monthGan.equals("壬") ) {
            msg = "";
            if( m_bProfessional ) msg = "丁壬合化木，";
            if( feYearZhi.equals("木") || feMonthZhi.equals("木") ) {
                feYearGan = "木";
                heYearGan = "乙";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                feMonthGan = "木";
                heMonthGan = "甲";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg += "虽然积极努力，但后果不确定。";    
                arrGan5he.add(msg);
            }
            else {
                if( m_bProfessional ) msg += "未成。";
            }
        }
        if( monthGan.equals("丁") && yearGan.equals("壬") ) {
            msg = "";
            if( m_bProfessional ) msg = "丁壬合化木，";
            if( feYearZhi.equals("木") || feMonthZhi.equals("木") ) {
                feYearGan = "木";
                heYearGan = "甲";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                feMonthGan = "木";
                heMonthGan = "乙";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg += "虽然积极努力，但后果不确定。";    
                arrGan5he.add(msg);
            }
            else {
                if( m_bProfessional ) msg += "未成。";
            }
        }
    }

    he = false;  /// 戊化丙火，癸化丁火
    if( dayGan.equals("戊") && hourGan.equals("癸") ) {
        msg = "";
        if( m_bProfessional ) msg = "戊癸合化火，";
        if( feHourZhi.equals("火") || feDayZhi.equals("火") ) {
            feHourGan = "火";
            heHourGan = "丁";
            heShenHourGan = fnComputeShishen(dayGan, heHourGan);
            msg += "或者俊秀薄情。";    
            arrGan5he.add(msg);
        }
        else {
            if( m_bProfessional ) msg += "未成。";
        }
    }
    else if( dayGan.equals("癸") && hourGan.equals("戊") ) {
        msg = "";
        if( m_bProfessional ) msg = "戊癸合化火，";
        if( feHourZhi.equals("火") || feDayZhi.equals("火") ) {
            feHourGan = "火";
            heHourGan = "丙";
            heShenHourGan = fnComputeShishen(dayGan, heHourGan);
            msg += "或者俊秀薄情。";    
            arrGan5he.add(msg);
        }
        else {
            if( m_bProfessional ) msg += "未成。";
        }
    }
    else if( dayGan.equals("戊") && monthGan.equals("癸")) {
        msg = "";
        if( m_bProfessional ) msg = "戊癸合化火，";
        if( feMonthZhi.equals("火") || feDayZhi.equals("火") ) {
            feMonthGan = "火";
            heMonthGan = "丁";
            heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
            he = true;
            msg += "或者俊秀薄情。";    
            arrGan5he.add(msg);
        }
        else {
            if( m_bProfessional ) msg += "未成。";
        }
    }
    else if( dayGan.equals("癸") && monthGan.equals("戊") ) {
        msg = "";
        if( m_bProfessional ) msg = "戊癸合化火，";
        if( feMonthZhi.equals("火") || feDayZhi.equals("火") ) {
            feMonthGan = "火";
            heMonthGan = "丙";
            heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
            he = true;
            msg += "或者俊秀薄情。";    
            arrGan5he.add(msg);
        }
        else {
            if( m_bProfessional ) msg += "未成。";
        }
    }
    if(he == false) {
        if( yearGan.equals("戊") && monthGan.equals("癸")) {
            msg = "";
            if( m_bProfessional ) msg = "戊癸合化火，";
            if( feYearZhi.equals("火") || feMonthZhi.equals("火") ) {
                feYearGan = "火";
                heYearGan = "丙";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                feMonthGan = "火";
                heMonthGan = "丁";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg += "或者俊秀薄情。";    
                arrGan5he.add(msg);
            }
            else {
                if( m_bProfessional ) msg += "未成。";
            }
        }
        if( monthGan.equals("戊") && yearGan.equals("癸")) {
            msg = "";
            if( m_bProfessional ) msg = "戊癸合化火，";
            if( feYearZhi.equals("火") || feMonthZhi.equals("火") ) {
                feYearGan = "火";
                heYearGan = "丁";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                feMonthGan = "火";
                heMonthGan = "丙";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                arrGan5he.add(msg);
                msg += "或者俊秀薄情。";    
            }
            else {
                if( m_bProfessional ) msg += "未成。";
            }
        }
    }

    //#endregion

    //#region 重新计算五行个数，和生克数量
    feJin = 0; feMu = 0; feShui = 0; feHuo = 0; feTu = 0; feUp = 0; feDown = 0; feUp2 = 0;
    feGanJin = 0; feGanMu = 0; feGanShui = 0; feGanHuo = 0; feGanTu = 0;
    if( feYearGan.equals("金") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( feYearGan.equals("木") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;

    }
    if( feYearGan.equals("水") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }
    if( feYearGan.equals("火") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( feYearGan.equals("土") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( feUse1.equals(feYearGan) || feUse2.equals(feYearGan) ) {
        feUp = feUp + 1;
    }
    else {
        feDown = feDown + 1;
    }

    if( feMonthGan.equals("金") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( feMonthGan.equals("木") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;
    }
    if( feMonthGan.equals("水") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }
    if( feMonthGan.equals("火") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( feMonthGan.equals("土") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( feUse1.equals(feMonthGan) || feUse2.equals(feMonthGan) ) {
        feUp = feUp + 1;
        feUp2 = feUp2 + 1;
    }
    else {
        feDown = feDown + 1;
    }
    
    if( feDayGan.equals("金") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( feDayGan.equals("木") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;
    }
    if( feDayGan.equals("水") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }
    if( feDayGan.equals("火") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( feDayGan.equals("土") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( feUse1.equals(feDayGan) || feUse2.equals(feDayGan) ) {
        feUp = feUp + 1;
    }
    else {
        feDown = feDown + 1;
    }    
    
    if( feHourGan.equals("金") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( feHourGan.equals("木") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;
    }
    if( feHourGan.equals("水") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }
    if( feHourGan.equals("火") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( feHourGan.equals("土") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( feUse1.equals(feHourGan) || feUse2.equals(feHourGan) ) {
        feUp = feUp + 1;
        feUp2 = feUp2 + 1;
    }
    else {
        feDown = feDown + 1;
    }

    if( feYearZhi.equals("金") ) {
        feJin = feJin + 1;
    }
    if( feYearZhi.equals("木") ) {
        feMu = feMu + 1;
    }
    if( feYearZhi.equals("水") ) {
        feShui = feShui + 1;
    }
    if( feYearZhi.equals("火") ) {
        feHuo = feHuo + 1;
    }
    if( feYearZhi.equals("土") ) {
        feTu = feTu + 1;
    }
    if( feUse1.equals(feYearZhi) || feUse2.equals(feYearZhi) ) {
        feUp = feUp + 1;
    }
    else {
        feDown = feDown + 1;
    }
    

    if( feMonthZhi.equals("金") ) {
        feJin = feJin + 1;
    }
    if( feMonthZhi.equals("木") ) {
        feMu = feMu + 1;
    }
    if( feMonthZhi.equals("水") ) {
        feShui = feShui + 1;
    }
    if( feMonthZhi.equals("火") ) {
        feHuo = feHuo + 1;
    }
    if( feMonthZhi.equals("土") ) {
        feTu = feTu + 1;
    }
    if( feUse1.equals(feMonthZhi) || feUse2.equals(feMonthZhi) ) {
        feUp = feUp + 1;
    }
    else {
        feDown = feDown + 1;
    }
    
    if( feDayZhi.equals("金") ) {
        feJin = feJin + 1;
    }
    if( feDayZhi.equals("木") ) {
        feMu = feMu + 1;
    }
    if( feDayZhi.equals("水") ) {
        feShui = feShui + 1;
    }
    if( feDayZhi.equals("火") ) {
        feHuo = feHuo + 1;
    }
    if( feDayZhi.equals("土") ) {
        feTu = feTu + 1;
    }
    if( feUse1.equals(feDayZhi) || feUse2.equals(feDayZhi) ) {
        feUp = feUp + 1;
        feUp2 = feUp2 + 1;
    }
    else {
        feDown = feDown + 1;
    }

    if( feHourZhi.equals("金") ) {
        feJin = feJin + 1;
    }
    if( feHourZhi.equals("木") ) {
        feMu = feMu + 1;
    }
    if( feHourZhi.equals("水") ) {
        feShui = feShui + 1;
    }
    if( feHourZhi.equals("火") ) {
        feHuo = feHuo + 1;
    }
    if( feHourZhi.equals("土") ) {
        feTu = feTu + 1;
    }
    if( feUse1.equals(feHourZhi) || feUse2.equals(feHourZhi) ) {
        feUp = feUp + 1;
    }
    else {
        feDown = feDown + 1;
    }

    //#endregion

    //#region 计算十神 
        shenGuan = 0;
        shenSha = 0;
        shenYin = 0;
        shenXiao = 0;
        shenBi = 0;
        shenJie = 0;
        shenCaiz = 0;
        shenCaip = 0;
        shenShi = 0;
        shenShang = 0;

        if( heShenHourGan.equals("比") ) {
                shenBi = shenBi + 1;
            }
        if( heShenHourGan.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenHourGan.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenHourGan.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenHourGan.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenHourGan.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenHourGan.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenHourGan.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenHourGan.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenHourGan.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenHourZhi.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenHourZhi.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenHourZhi.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenHourZhi.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenHourZhi.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenHourZhi.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenHourZhi.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenHourZhi.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenHourZhi.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenHourZhi.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenDayZhi.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenDayZhi.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenDayZhi.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenDayZhi.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenDayZhi.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenDayZhi.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenDayZhi.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenDayZhi.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenDayZhi.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenDayZhi.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenMonthGan.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenMonthGan.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenMonthGan.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenMonthGan.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenMonthGan.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenMonthGan.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenMonthGan.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenMonthGan.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenMonthGan.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenMonthGan.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenMonthZhi.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenMonthZhi.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenMonthZhi.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenMonthZhi.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenMonthZhi.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenMonthZhi.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenMonthZhi.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenMonthZhi.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenMonthZhi.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenMonthZhi.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenYearGan.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenYearGan.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenYearGan.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenYearGan.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenYearGan.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenYearGan.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenYearGan.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenYearGan.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenYearGan.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenYearGan.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenYearZhi.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenYearZhi.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenYearZhi.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenYearZhi.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenYearZhi.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenYearZhi.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenYearZhi.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenYearZhi.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenYearZhi.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenYearZhi.equals("才") ) {
            shenCaip = shenCaip + 1;
        }
    //#endregion

    /// 判断 日干强弱，身强可用比劫，身弱要用印枭，生克个数
    selfStrength = -1;
    if( feUp2 == 3) {
        selfStrength = 1;
    }
    else if( feUp2 == 2 && feUp == 4) {
        if( (feYearGan.equals(feUse1) || feYearGan.equals(feUse2)) ||
            (feYearZhi.equals(feUse1) || feYearZhi.equals(feUse2)) ) {
            selfStrength = 0;
        }
        else {
            selfStrength = 1;            
        }        
    }
    else if( feUp2 == 1 && feUp == 4) {
        if( (feYearGan.equals(feUse1) || feYearGan.equals(feUse2)) ||
            (feYearZhi.equals(feUse1) || feYearZhi.equals(feUse2)) ) {
            selfStrength = 0;
        }
        else {
            selfStrength = 1;            
        }        
    }
    else if( feUp > 4) {
        selfStrength = 1;        
    }

    //#region 五行旺衰 
    /// 判断是否有五行旺衰，有旺衰以旺衰为主，无旺衰以身强为主，判断喜用，忌用
    selfMoreLess = 0;
    if( feJin >= 3) {
        selfMoreLess = 1;
        feMore1 = "金";
    }
    if( feMu >= 3) {
        if( selfStrength == 1) {
            selfMoreLess = 2;
            feMore2 = "木";
        }
        else {
            selfMoreLess = 1;
            feMore1 = "木";
        }
    }
    if( feShui >= 3) {
        if( selfStrength == 1) {
            selfMoreLess = 2;
            feMore2 = "水";
        }
        else {
            selfMoreLess = 1;
            feMore1 = "水";
        }
    }
    if( feHuo >= 3) {
        if( selfStrength == 1) {
            selfMoreLess = 2;
            feMore2 = "火";
        }
        else {
            selfMoreLess = 1;
            feMore1 = "火";
        }
    }
    if( feTu >= 3) {
        if( selfStrength == 1) {
            selfMoreLess = 2;
            feMore2 = "土";
        }
        else {
            selfMoreLess = 1;
            feMore1 = "土";
        }
    }

    //// 分析自己的运势，发现不准。
    if( selfMoreLess == 2 ) {  /// 五行两个元素旺，需要调和，
        switch (feMore1) {
            case "金":
            {
                
                switch (feMore2) {
                    case "木":
                    {
                        switch (feDayGan) {
                            case "金":
                                msg = "八字五行金木旺，用水调和，能够获取更多财富。";
                                break;
                            case "木":
                                msg = "八字五行金木旺，用水调和，事业能够顺顺利利。";
                                break;
                            case "水":
                                msg = "八字五行金木旺，用水调和，事业能够顺顺利利。";
                                break;
                            case "火":
                                msg = "八字五行金木旺，用水调和，事业财运都有发展。";
                                break;

                            default:
                                break;
                        }
                        break;
                    }
                    default:
                        break;
                }
                break;
            }                
            case "木":
                break;
            case "水":
                break;
            case "火":
                break;
            case "土":
                break;        
            default:
                break;
        }
        msg = "";
    }
    else if( selfMoreLess == 1 ) { /// 五行一个元素旺，需要用该元素判断用神，忌神

    }
    else {  /// 五行无元素旺衰
    }
    //#endregion

    msg = fnComputeXiYong2( dayGan, selfStrength);
    if( !msg.equals(feUse1) ) {
        feUse2 = feUse1;
        feUse1 = msg;
    }
    if(selfStrength > 0) {  /// 日干强
        msg = "八字命强，喜用为：" + feUse1 + ", " + fnWuHelp(feUse1);
        arrAnalysis.add(msg);

        msg = "如懂风水，在工作和生活的环境，布置" + feUse1 + "局，增加运势。";
        arrAnalysis.add(msg);
    }
    else if(selfStrength == 0) {  /// 日干平
        msg = "八字命平，需要再根据每个大运（甚至流年）的生克，再判断喜忌，然后确定用神和忌神。";
        arrAnalysis.add(msg);
    }
    else {  /// 日干弱
        msg = "八字命弱，喜用为：" + feUse1 + ", " + fnWuHelp(feUse1);
        arrAnalysis.add(msg);

        msg = "如懂风水，在工作和生活的环境，布置" + feUse1 + "局，增加运势。";
        arrAnalysis.add(msg);
    }

    /// 保存命局强弱喜用，给大运流年使用
    m_selfStrength = selfStrength;
    m_feUse1 = feUse1;
    m_feUse2 = feUse2;
    
    msg = fnSelfDayZhiMonthGanHourGan2(sex, heShenDayZhi, heShenMonthGan, heShenHourGan, dayGan, dayZhi, hourGan, monthGan);    
    arrAnalysis.add(msg);

    /// 十神分析
    msg  = fnSelfPayShiShen2(false, sex);
    arrAnalysis.add(msg);

    if( sex.equals("男") ) {
        if( shenYearGan.equals("财") && shenYearZhi.equals("财") ) {
            msg = "有离婚复婚的可能。";
            arrAnalysis.add(msg);
        }
        else if( shenMonthGan.equals("财") && shenMonthZhi.equals("财") ) {
            msg = "有离婚复婚的可能。";
            arrAnalysis.add(msg);
        }
        else if( shenHourGan.equals("财") && shenHourZhi.equals("财") ) {
            msg = "有离婚复婚的可能。";
            arrAnalysis.add(msg);
        }
    }
    else {
        if( shenYearGan.equals("官") && shenYearZhi.equals("官") ) {
            msg = "有离婚复婚的可能。";
            arrAnalysis.add(msg);
        }
        else if( shenMonthGan.equals("官") && shenMonthZhi.equals("官") ) {
            msg = "有离婚复婚的可能。";
            arrAnalysis.add(msg);
        }
        else if( shenHourGan.equals("官") && shenHourZhi.equals("官") ) {
            msg = "有离婚复婚的可能。";
            arrAnalysis.add(msg);
        }
    }

    /// 合掉的神煞分析
    arrAnalysis.addAll(arrGan5he);

    //#region 天干四冲
    msg = "";
    if( ( hourGan.equals("庚") || dayGan.equals("庚") || 
    monthGan.equals("庚") || yearGan.equals("庚") )  && 
    ( hourGan.equals("甲") || dayGan.equals("甲") || 
    monthGan.equals("甲") || yearGan.equals("甲") ) ) {
        msg = "甲庚相冲，";
        if( feMu <= feJin ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "甲"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "庚"));
        }
        arrAnalysis.add(msg);
    }
    else if( ( hourGan.equals("甲") || dayGan.equals("甲") || 
    monthGan.equals("甲") || yearGan.equals("甲") )  && 
    ( hourGan.equals("庚") || dayGan.equals("庚") || 
    monthGan.equals("庚") || yearGan.equals("庚") ) ) {
        msg = "甲庚相冲，";
        if( feMu <= feJin ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "甲"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "庚"));
        }
        arrAnalysis.add(msg);
    }

    if( ( hourGan.equals("乙") || dayGan.equals("乙") || 
    monthGan.equals("乙") || yearGan.equals("乙") )  && 
    ( hourGan.equals("辛") || dayGan.equals("辛") || 
    monthGan.equals("辛") || yearGan.equals("辛") ) ) {
        msg = "乙辛相冲，";
        if( feMu <= feJin ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "乙"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "辛"));
        }
        arrAnalysis.add(msg);
    }
    else if( ( hourGan.equals("辛") || dayGan.equals("辛") || 
    monthGan.equals("辛") || yearGan.equals("辛") )  && 
    ( hourGan.equals("乙") || dayGan.equals("乙") || 
    monthGan.equals("乙") || yearGan.equals("乙") ) ) {
        msg = "乙辛相冲，";
        if( feMu <= feJin ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "乙"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "辛"));
        }
        arrAnalysis.add(msg);
    }

    if( ( hourGan.equals("丙") || dayGan.equals("丙") || 
    monthGan.equals("丙") || yearGan.equals("丙") ) && 
    ( hourGan.equals("壬") || dayGan.equals("壬") || 
    monthGan.equals("壬") || yearGan.equals("壬") ) ) {
        msg = "丙壬相冲，";
        if( feHuo <= feShui ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "丙"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "壬"));
        }
        arrAnalysis.add(msg);
    }
    else if( ( hourGan.equals("壬") || dayGan.equals("壬") || 
    monthGan.equals("壬") || yearGan.equals("壬") ) && 
    ( hourGan.equals("丙") || dayGan.equals("丙") || 
    monthGan.equals("丙") || yearGan.equals("丙") ) ) {
        msg = "丙壬相冲，";
        if( feHuo <= feShui ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "丙"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "壬"));
        }
        arrAnalysis.add(msg);
    } 

    if( ( hourGan.equals("丁") || dayGan.equals("丁") || 
    monthGan.equals("丁") || yearGan.equals("丁") ) && 
    ( hourGan.equals("癸") || dayGan.equals("癸") || 
    monthGan.equals("癸") || yearGan.equals("癸") ) ) {
        msg = "丁癸相冲，";
        if( feHuo <= feShui ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "丁"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "癸"));
        }
        arrAnalysis.add(msg);
    }
    else if( ( hourGan.equals("癸") || dayGan.equals("癸") || 
    monthGan.equals("癸") || yearGan.equals("癸") ) && 
    ( hourGan.equals("丁") || dayGan.equals("丁") || 
    monthGan.equals("丁") || yearGan.equals("丁") ) ) {
        msg = "丁癸相冲，";
        if( feHuo <= feShui ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "丁"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "癸"));
        }
        arrAnalysis.add(msg);
    }
    //#endregion

    /// 地支相冲，相害，分析
    //#region 地支六冲
    msg = "";
    if( hourZhi.equals("子") && ( dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "子午相冲，";
        msg += "易不安，居住地会变迁。";
    }
    else if( dayZhi.equals("子") && ( hourZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "子午相冲，";
        msg += "易不安，居住地会变迁。";
    }
    else if( monthZhi.equals("子") && ( hourZhi.equals("午") || dayZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "子午相冲，";
        msg += "易不安，居住地会变迁。";
    }
    else if( yearZhi.equals("子") && ( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "子午相冲，";
        msg += "易不安，居住地会变迁。";
    }

    if( hourZhi.equals("丑") && ( dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "丑未相冲，";
        msg += "事多阻。工作多变。";
    }
    else if( dayZhi.equals("丑") && ( hourZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "丑未相冲，";
        msg += "事多阻。工作多变。";
    }
    else if( monthZhi.equals("丑") && ( hourZhi.equals("未") || dayZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "丑未相冲，";
        msg += "事多阻。工作多变。";
    }
    else if( yearZhi.equals("丑") && ( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "丑未相冲，";
        msg += "事多阻。工作多变。";
    }

    if( hourZhi.equals("寅") && ( dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "寅申相冲，";
        msg += "多情或者管闲事。居住地和工作都多变。";
    }
    else if( dayZhi.equals("寅") && ( hourZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "寅申相冲，";
        msg += "多情或者管闲事。居住地和工作都多变。";
    }
    else if( monthZhi.equals("寅") && ( hourZhi.equals("申") || dayZhi.equals("申") || yearZhi.equals("申") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "寅申相冲，";
        msg += "多情或者管闲事。居住地和工作都多变。";
    }
    else if( yearZhi.equals("寅") && ( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "寅申相冲，";
        msg += "多情或者管闲事。居住地和工作都多变。";
    }

    if( hourZhi.equals("卯") && ( dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "卯酉相冲，";
        msg += "多劳碌，易情色纠纷。居住地会变迁。";
    }
    else if( dayZhi.equals("卯") && ( hourZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "卯酉相冲，";
        msg += "多劳碌，易情色纠纷。居住地会变迁。";
    }
    else if( monthZhi.equals("卯") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "卯酉相冲，";
        msg += "多劳碌，易情色纠纷。居住地会变迁。";
    }
    else if( yearZhi.equals("卯") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "卯酉相冲，";
        msg += "多劳碌，易情色纠纷。居住地会变迁。";
    }

    if( hourZhi.equals("辰") && ( dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "辰戌相冲，";
        msg += "克亲人，帮他人。工作多变。";
    }
    else if( dayZhi.equals("辰") && ( hourZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "辰戌相冲，";
        msg += "克亲人，帮他人。工作多变。";
    }
    else if( monthZhi.equals("辰") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || yearZhi.equals("戌") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "辰戌相冲，";
        msg += "克亲人，帮他人。工作多变。";
    }
    else if( yearZhi.equals("辰") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "辰戌相冲，";
        msg += "克亲人，帮他人。工作多变。";
    }

    if( hourZhi.equals("巳") && ( dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "巳亥相冲，";
        msg += "易帮他人。居住地和工作都多变。";
    }
    else if( dayZhi.equals("巳") && ( hourZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "巳亥相冲，";
        msg += "易帮他人。居住地和工作都多变。";
    }
    else if( monthZhi.equals("巳") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "巳亥相冲，";
        msg += "易帮他人。居住地和工作都多变。";
    }
    else if( yearZhi.equals("巳") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "巳亥相冲，";
        msg += "易帮他人。居住地和工作都多变。";
    }
    if( msg.isEmpty() == false ) {
        arrAnalysis.add(msg);
    }
    //#endregion

    //#region 地址六害 
    msg = "";
    if( hourZhi.equals("子") && ( dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "子未相害，";
        msg += "无助于子孙。";
    }
    else if( dayZhi.equals("子") && ( hourZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "子未相害，";
        msg += "无助于子孙。";
    }
    else if( monthZhi.equals("子") && ( hourZhi.equals("未") || dayZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "子未相害，";
        msg += "无助于子孙。";
    }
    else if( yearZhi.equals("子") && ( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "子未相害，";
        msg += "无助于子孙。";
    }

    if( hourZhi.equals("丑") && ( dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "丑午相害，";
        msg += "易怒，无耐心，大运逢弱易有伤残。";
    }
    else if( dayZhi.equals("丑") && ( hourZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "丑午相害，";
        msg += "易怒，无耐心，大运逢弱易有伤残。";
    }
    else if( monthZhi.equals("丑") && ( hourZhi.equals("午") || dayZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "丑午相害，";
        msg += "易怒，无耐心，大运逢弱易有伤残。";
    }
    else if( yearZhi.equals("丑") && ( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "丑午相害，";
        msg += "易怒，无耐心，大运逢弱易有伤残。";
    }        

    if( hourZhi.equals("寅") && ( dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "寅巳相害，";
        msg += "多疾病。";
    }
    else if( dayZhi.equals("寅") && ( hourZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "寅巳相害，";
        msg += "多疾病。";
    }
    else if( monthZhi.equals("寅") && ( hourZhi.equals("巳") || dayZhi.equals("巳") || yearZhi.equals("巳") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "寅巳相害，";
        msg += "多疾病。";
    }
    else if( yearZhi.equals("寅") && ( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "寅巳相害，";
        msg += "多疾病。";
    }

    if( hourZhi.equals("卯") && ( dayZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "卯辰相害，";
        msg += "易怒，无耐心，大运逢弱易有伤残。";
    }
    else if( dayZhi.equals("卯") && ( hourZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "卯辰相害，";
        msg += "易怒，无耐心，大运逢弱易有伤残。";
    }
    else if( monthZhi.equals("卯") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || yearZhi.equals("辰") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "卯辰相害，";
        msg += "易怒，无耐心，大运逢弱易有伤残。";
    }
    else if( yearZhi.equals("卯") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || monthZhi.equals("辰") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "卯辰相害，";
        msg += "易怒，无耐心，大运逢弱易有伤残。";
    }

    if( hourZhi.equals("申") && ( dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "申亥相害，";
        msg += "易是非，易犯小人。";
    }
    else if( dayZhi.equals("申") && ( hourZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "申亥相害，";
        msg += "易是非，易犯小人。";
    }
    else if( monthZhi.equals("申") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "申亥相害，";
        msg += "易是非，易犯小人。";
    }
    else if( yearZhi.equals("申") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "申亥相害，";
        msg += "易是非，易犯小人。";
    }

    if( yearZhi.equals("酉") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "酉戌相害，";
        msg += "易遭亲朋相害。";
    }
    else if( hourZhi.equals("酉") && ( yearZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "酉戌相害，";
        msg += "易遭亲朋相害。";
    }
    else if( monthZhi.equals("酉") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || yearZhi.equals("戌") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "酉戌相害，";
        msg += "易遭亲朋相害。";
    }
    else if( dayZhi.equals("酉") && ( hourZhi.equals("戌") || yearZhi.equals("戌") || monthZhi.equals("戌") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "酉戌相害，";
        msg += "易遭亲朋相害。";
    } 
    if( msg.isEmpty() == false ) {
        arrAnalysis.add(msg);
    }
    //#endregion

    //#region 地支相刑 
    msg = "";
    if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
        if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
            if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
                msg = "";
                if( m_bProfessional ) msg = "寅巳申三刑，";
                msg += "易官司或是非，女不易怀孕或易流产。";
            }
        }
    }
    
    if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
        if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                msg = "";
                if( m_bProfessional ) msg = "未丑戌三刑，";
                msg += "易挫折，女易孤单。";
            }
        }
    }

    if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
        if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
            msg = "";
            if( m_bProfessional ) msg = "子卯二刑，";
            msg += "与上级(辈)或者下级(辈)不和。";
        }
    }

    if( hourZhi.equals("辰") && ( dayZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "辰辰自刑，";
        msg += "有始无终，常陷困境。";
    }
    else if(dayZhi.equals("辰") && ( monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "辰辰自刑，";
        msg += "有始无终，常陷困境。";

    }
    else if( monthZhi.equals("辰") && yearZhi.equals("辰") ) {
        msg = "";
        if( m_bProfessional ) msg = "辰辰自刑，";
        msg += "有始无终，常陷困境。";

    }

    if( hourZhi.equals("午") && ( dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "午午自刑，";
        msg += "有始无终，常陷困境。";
    }
    else if( dayZhi.equals("午") && ( monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "午午自刑，";
        msg += "有始无终，常陷困境。";
    }
    else if( monthZhi.equals("午") && yearZhi.equals("午") ) {
        msg = "";
        if( m_bProfessional ) msg = "午午自刑，";
        msg += "有始无终，常陷困境。";
    }

    if( hourZhi.equals("酉") && ( dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "酉酉自刑，";
        msg += "有始无终，常陷困境。";
    }
    else if( dayZhi.equals("酉") && ( monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "酉酉自刑，";
        msg += "有始无终，常陷困境。";
    }
    else if( monthZhi.equals("酉") && yearZhi.equals("酉") ) {
        msg = "";
        if( m_bProfessional ) msg = "酉酉自刑，";
        msg += "有始无终，常陷困境。";
    }

    if( hourZhi.equals("亥") && ( dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "亥亥自刑，";
        msg += "有始无终，常陷困境。";
    }
    else if( dayZhi.equals("亥") && ( monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "";
        if( m_bProfessional ) msg = "亥亥自刑，";
        msg += "有始无终，常陷困境。";
    }
    else if( monthZhi.equals("亥") && yearZhi.equals("亥") ) {
        msg = "";
        if( m_bProfessional ) msg = "亥亥自刑，";
        msg += "有始无终，常陷困境。";
    }

    if( msg.isEmpty() == false ) {
        arrAnalysis.add(msg);
    }
    //#endregion

    /// 神煞分析，天乙贵人
    msg = fnSelfPayShenSha(dayGan, yearZhi, monthZhi, dayZhi, hourZhi);
    arrAnalysis.add(msg);

    return arrAnalysis;
}

public List<String> fnBaziBigFateAnalysis(
    String sex, Integer startYear, Integer age,
    String yearGan, String yearZhi, 
    String monthGan, String monthZhi, 
    String dayGan, String dayZhi, 
    String hourGan, String hourZhi,
    String bigGan, String bigZhi) {
    
    ArrayList<String> arrAnalysis = new ArrayList<String>();
    ArrayList<String> arrHeChong = new ArrayList<String>();
    String msg;

    boolean he = false;

    String shenYearGan = "";
    String shenYearZhi = "";
    String shenMonthGan = "";
    String shenMonthZhi = "";
    String shenDayZhi = "";
    String shenHourGan = "";
    String shenHourZhi = "";
    String shenBigGan = "";
    String shenBigZhi = "";

    String feYearGan = "";          /// 年干五行
    String feYearZhi = "";          /// 年支五行
    String feMonthGan = "";          /// 月干五行
    String feMonthZhi = "";          /// 月支五行
    String feDayGan = "";          /// 日干五行
    String feDayZhi = "";          /// 日支五行
    String feHourGan = "";          /// 时干五行
    String feHourZhi = "";          /// 时支五行
    String feBigGan = "";          /// 大运干五行
    String feBigZhi = "";          /// 大运支五行

    String  feUse1 = m_feUse1;
    String  feUse2 = m_feUse2;

    String  heYearGan = yearGan;
    String  heYearZhi = yearZhi;
    String  heMonthGan = monthGan;
    String  heMonthZhi = monthZhi;
    String  heDayZhi = dayZhi;
    String  heHourGan = hourGan;
    String  heHourZhi = hourZhi;
    String  heBigGan = bigGan;
    String  heBigZhi = bigZhi;

    /// 合后的十神
    String heShenYearGan = "";
    String heShenYearZhi = "";
    String heShenMonthGan = "";
    String heShenMonthZhi = "";
    String heShenDayZhi = "";
    String heShenHourGan = "";
    String heShenHourZhi = "";
    String heShenBigGan = "";
    String heShenBigZhi = "";

    Integer feUp, feDown, feUp2;       /// 五行生克个数, feup2是紧挨日干的生克个数

    shenYearGan = fnComputeShishen(dayGan, yearGan);
    shenYearZhi = fnComputeShishen(dayGan, yearZhi);
    shenMonthGan = fnComputeShishen(dayGan, monthGan);
    shenMonthZhi = fnComputeShishen(dayGan, monthZhi);
    shenDayZhi = fnComputeShishen(dayGan, dayZhi);
    shenHourGan = fnComputeShishen(dayGan, hourGan);
    shenHourZhi = fnComputeShishen(dayGan, hourZhi);
    shenBigGan = fnComputeShishen(dayGan, bigGan);
    shenBigZhi = fnComputeShishen(dayGan, bigZhi);
    
    heShenYearGan = shenYearGan;
    heShenYearZhi = shenYearZhi;
    heShenMonthGan = shenMonthGan;
    heShenMonthZhi = shenMonthZhi;
    heShenDayZhi = shenDayZhi;
    heShenHourGan = shenHourGan;
    heShenHourZhi = shenHourZhi;
    heShenBigGan = shenBigGan;
    heShenBigZhi = shenBigZhi;

    feYearGan = fnGz2Wu2(yearGan);
    feYearZhi = fnGz2Wu2(yearZhi);
    feMonthGan = fnGz2Wu2(monthGan);
    feMonthZhi = fnGz2Wu2(monthZhi);
    feDayGan = fnGz2Wu2(dayGan);
    feDayZhi = fnGz2Wu2(dayZhi);
    feHourGan = fnGz2Wu2(hourGan);
    feHourZhi = fnGz2Wu2(hourZhi);

    feBigGan = fnGz2Wu2(bigGan);
    feBigZhi = fnGz2Wu2(bigZhi);

    msg = startYear + "年 " + (age < 10 ? "0" + age: age.toString()) + "岁开始 " + bigGan + bigZhi + " 大运：" + fnSelfPayBigFateWangShuai(dayGan, bigZhi) +"。";
    arrAnalysis.add(msg);
    msg = "大运：行 " + shenBigGan + shenBigZhi + " 运。";
    arrAnalysis.add(msg);

    /// 大运地支合 
    //#region 地支三会局
    he = false; msg = "";
    if( bigZhi.equals("寅")) {
        if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
            if( hourZhi.equals("辰") || dayZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) {
                if( feBigGan.equals("木") || feHourGan.equals("木") || feDayGan.equals("木") || feMonthGan.equals("木") || feYearGan.equals("木") ) {
                    if( m_bProfessional ) {
                        msg = "寅卯辰三会木局.";
                        arrAnalysis.add(msg);
                    }
                    if( dayZhi.equals("辰") ) {
                        feDayZhi = "木";
                        heDayZhi = "卯";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);  
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("辰") ) {
                        feMonthZhi = "木";
                        heMonthZhi = "卯";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);  
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("辰") ) {
                        feHourZhi = "木";
                        heHourZhi = "卯";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("辰") ) {
                        feYearZhi = "木";
                        heYearZhi = "卯";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;
                }
            }
        }
    }
    else if( bigZhi.equals("卯")) {
        if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
            if( hourZhi.equals("辰") || dayZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) {
                if( feBigGan.equals("木") || feHourGan.equals("木") || feDayGan.equals("木") || feMonthGan.equals("木") || feYearGan.equals("木") ) {
                    if( m_bProfessional ) {
                        msg = "寅卯辰三会木局.";
                        arrAnalysis.add(msg);
                    } 
                    if( dayZhi.equals("辰") ) {
                        feDayZhi = "木";
                        heDayZhi = "卯";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("辰") ) {
                        feMonthZhi = "木";
                        heMonthZhi = "卯";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("辰") ) {
                        feHourZhi = "木";
                        heHourZhi = "卯";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("辰") ) {
                        feYearZhi = "木";
                        heYearZhi = "卯";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;
                }
            }
        }
    }
    else if( bigZhi.equals("辰")) {
        if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
            if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
                if( feBigGan.equals("木") || feHourGan.equals("木") || feDayGan.equals("木") || 
                feMonthGan.equals("木") || feYearGan.equals("木") ) {
                    feBigZhi = "木";
                    heBigZhi = "卯";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                    he = true;

                    if( m_bProfessional ) {
                        msg = "寅卯辰三会木局.";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
    }

    if( bigZhi.equals("巳")) {
        if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
            if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
                if( feBigGan.equals("火") || feHourGan.equals("火") || feDayGan.equals("火") || 
                feMonthGan.equals("火") || feYearGan.equals("火") ) {
                    if( m_bProfessional ) {
                        msg = "巳午未三会火局.";
                        arrAnalysis.add(msg);
                    }
                    if( dayZhi.equals("未") ) {
                        feDayZhi = "火";
                        heDayZhi = "午";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("未") ) {
                        feMonthZhi = "火";
                        heMonthZhi = "午";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("未") ) {
                        feHourZhi = "火";
                        heHourZhi = "午";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("未") ) {
                        feYearZhi = "火";
                        heYearZhi = "午";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;
                }
            }
        }
    }
    else if( bigZhi.equals("午")) {
        if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
            if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
                if( feBigGan.equals("火") || feHourGan.equals("火") || feDayGan.equals("火") || 
                feMonthGan.equals("火") || feYearGan.equals("火") ) {
                    if( m_bProfessional ) {
                        msg = "巳午未三会火局.";
                        arrAnalysis.add(msg);
                    } 
                    if( dayZhi.equals("未") ) {
                        feDayZhi = "火";
                        heDayZhi = "午";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("未") ) {
                        feMonthZhi = "火";
                        heMonthZhi = "午";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("未") ) {
                        feHourZhi = "火";
                        heHourZhi = "午";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("未") ) {
                        feYearZhi = "火";
                        heYearZhi = "午";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;
                }
            }
        }
    }
    else if( bigZhi.equals("未")) {
        if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
            if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
                if( feBigGan.equals("火") || feHourGan.equals("火") || feDayGan.equals("火") || 
                feMonthGan.equals("火") || feYearGan.equals("火") ) {
                    feBigZhi = "火";
                    heBigZhi = "午";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                    he = true;

                    if( m_bProfessional ) {
                        msg = "巳午未三会火局.";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
    }

    if( bigZhi.equals("申")) {
        if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                if( feBigGan.equals("金") || feHourGan.equals("金") || feDayGan.equals("金") || 
                feMonthGan.equals("金") || feYearGan.equals("金") ) {
                    if( m_bProfessional ) {
                        msg = "申酉戌三会金局.";
                        arrAnalysis.add(msg);
                    }
                    if( dayZhi.equals("戌") ) {
                        feDayZhi = "金";
                        heDayZhi = "酉";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("戌") ) {
                        feMonthZhi = "金";
                        heMonthZhi = "酉";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("戌") ) {
                        feHourZhi = "金";
                        heHourZhi = "酉";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("戌") ) {
                        feYearZhi = "金";
                        heYearZhi = "酉";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;
                }
            }
        }
    }
    else if( bigZhi.equals("酉")) {
        if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                if( feBigGan.equals("金") || feHourGan.equals("金") || feDayGan.equals("金") || 
                feMonthGan.equals("金") || feYearGan.equals("金") ) {
                    if( m_bProfessional ) {
                        msg = "申酉戌三会金局.";
                        arrAnalysis.add(msg);
                    }
                    if( dayZhi.equals("戌") ) {
                        feDayZhi = "金";
                        heDayZhi = "酉";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("戌") ) {
                        feMonthZhi = "金";
                        heMonthZhi = "酉";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("戌") ) {
                        feHourZhi = "金";
                        heHourZhi = "酉";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("戌") ) {
                        feYearZhi = "金";
                        heYearZhi = "酉";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;
                }
            }
        }
    }
    else if( bigZhi.equals("戌")) {
        if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
            if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
                if( feBigGan.equals("金") || feHourGan.equals("金") || feDayGan.equals("金") || 
                feMonthGan.equals("金") || feYearGan.equals("金") ) {
                
                    feBigZhi = "金";
                    heBigZhi = "酉"; 
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                    he = true;

                    if( m_bProfessional ) {
                        msg = "申酉戌三会金局.";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
    }

    if( bigZhi.equals("亥")) {
        if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
            if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
                if( feBigGan.equals("水") || feHourGan.equals("水") || feDayGan.equals("水") || 
                feMonthGan.equals("水") || feYearGan.equals("水") ) {
                    if( m_bProfessional ) {
                        msg = "亥子丑三会水局.";
                        arrAnalysis.add(msg);
                    }
                    if( dayZhi.equals("丑") ) {
                        feDayZhi = "水";
                        heDayZhi = "子";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("丑") ) {
                        feMonthZhi = "水";
                        heMonthZhi = "子";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("丑") ) {
                        feHourZhi = "水";
                        heHourZhi = "子";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("丑") ) {
                        feYearZhi = "水";
                        heYearZhi = "子";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;
                }
            }
        }
    }
    else if( bigZhi.equals("子")) {
        if( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) {
            if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
                if( feBigGan.equals("水") || feHourGan.equals("水") || feDayGan.equals("水") || 
                feMonthGan.equals("水") || feYearGan.equals("水") ) {
                    if( m_bProfessional ) {
                        msg = "亥子丑三会水局.";
                        arrAnalysis.add(msg);
                    }
                    if( dayZhi.equals("丑") ) {
                        feDayZhi = "水";
                        heDayZhi = "子";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("丑") ) {
                        feMonthZhi = "水";
                        heMonthZhi = "子";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("丑") ) {
                        feHourZhi = "水";
                        heHourZhi = "子";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("丑") ) {
                        feYearZhi = "水";
                        heYearZhi = "子";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;
                }
            }
        }
    }
    else if( bigZhi.equals("丑")) {
        if( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) {
            if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
                if( feBigGan.equals("水") || feHourGan.equals("水") || feDayGan.equals("水") || 
                feMonthGan.equals("水") || feYearGan.equals("水") ) {

                    feBigZhi = "水";
                    heBigZhi = "子";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                    he = true;

                    if( m_bProfessional ) {
                        msg = "亥子丑三会水局.";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
    }

    //#endregion

    //#region 地支三合局
    if( he == false ) {
        msg = "";
        if( bigZhi.equals("亥")) {
            if( feBigGan.equals("木") || feHourGan.equals("木") || feDayGan.equals("木") || 
            feMonthGan.equals("木") || feYearGan.equals("木") ) {
                if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
                    if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
                        if( m_bProfessional ) {
                            msg = "亥卯未三合木局.";
                            arrAnalysis.add(msg);
                        }
                        feBigZhi = "木";
                        heBigZhi = "寅";
                        heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);                   
                        if( dayZhi.equals("未") ) {
                            feDayZhi = "木";
                            heDayZhi = "卯";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("未") ) {
                            feMonthZhi = "木";
                            heMonthZhi = "卯";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        else if( hourZhi.equals("未") ) {
                            feHourZhi = "木";
                            heHourZhi = "卯";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("未") ) {
                            feYearZhi = "木";
                            heYearZhi = "卯";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        he = true;
                    }
                }
            }
        }
        else if( bigZhi.equals("卯")) {
            if( feBigGan.equals("木") || feHourGan.equals("木") || feDayGan.equals("木") || 
            feMonthGan.equals("木") || feYearGan.equals("木") ) {
                if( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) {
                    if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
                        if( m_bProfessional ) {
                            msg = "亥卯未三合木局.";
                            arrAnalysis.add(msg);
                        } 
                        if( hourZhi.equals("亥") && dayZhi.equals("未") ) {
                            feHourZhi = "木";                    
                            heHourZhi = "寅";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);

                            feDayZhi = "木";
                            heDayZhi = "卯";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( hourZhi.equals("亥") && monthZhi.equals("未") ) {
                            feHourZhi = "木";
                            heHourZhi = "寅";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);

                            feMonthZhi = "木";
                            heMonthZhi = "卯";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        else if( hourZhi.equals("亥") && yearZhi.equals("未") ) {
                            feHourZhi = "木";
                            heHourZhi = "寅";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);

                            feYearZhi = "木";
                            heYearZhi = "卯";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        else if( dayZhi.equals("亥") && hourZhi.equals("未") ) {
                            feDayZhi = "木";
                            heDayZhi = "寅";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);

                            feHourZhi = "木";
                            heHourZhi = "卯";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( dayZhi.equals("亥") && monthZhi.equals("未") ) {
                            feDayZhi = "木";
                            heDayZhi = "寅";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);

                            feMonthZhi = "木";
                            heMonthZhi = "卯";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        else if( dayZhi.equals("亥") && yearZhi.equals("未") ) {
                            feDayZhi = "木";
                            heDayZhi = "寅";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);

                            feYearZhi = "木";
                            heYearZhi = "卯";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("亥") && hourZhi.equals("未") ) {
                            feMonthZhi = "木";
                            heMonthZhi = "寅";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);

                            feHourZhi = "木";
                            heHourZhi = "卯";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("亥") && dayZhi.equals("未") ) {
                            feMonthZhi = "木";
                            heMonthZhi = "寅";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);

                            feDayZhi = "木";
                            heDayZhi = "卯";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("亥") && yearZhi.equals("未") ) {
                            feMonthZhi = "木";
                            heMonthZhi = "寅";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);

                            feYearZhi = "木";
                            heYearZhi = "卯";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("亥") && hourZhi.equals("未") ) {
                            feYearZhi = "木";
                            heYearZhi = "寅";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);

                            feHourZhi = "木";
                            heHourZhi = "卯";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("亥") && dayZhi.equals("未") ) {
                            feYearZhi = "木";
                            heYearZhi = "寅";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);

                            feDayZhi = "木";
                            heDayZhi = "卯";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("亥") && monthZhi.equals("未") ) {
                            feYearZhi = "木";
                            heYearZhi = "寅";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);

                            feMonthZhi = "木";
                            heMonthZhi = "卯";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        he = true;
                    }
                }
            }
        }
        else if( bigZhi.equals("未")) {
            if( feBigGan.equals("木") || feHourGan.equals("木") || feDayGan.equals("木") || 
            feMonthGan.equals("木") || feYearGan.equals("木") ) {
                if( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) {
                    if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
                        if( m_bProfessional ) {
                            msg = "亥卯未三合木局.";
                            arrAnalysis.add(msg);
                        }   
                        
                        feBigZhi = "木";
                        heBigZhi = "卯";
                        heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                        
                        if( dayZhi.equals("亥") ) {
                            feDayZhi = "木";
                            heDayZhi = "寅";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("亥") ) {
                            feMonthZhi = "木";
                            heMonthZhi = "寅";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        else if( hourZhi.equals("亥") ) {
                            feHourZhi = "木";
                            heHourZhi = "寅";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("亥") ) {
                            feYearZhi = "木";
                            heYearZhi = "寅";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        he = true;
                    }
                }
            }
        }

        if( bigZhi.equals("寅")) {
            if( feBigGan.equals("火") || feHourGan.equals("火") || feDayGan.equals("火") || 
            feMonthGan.equals("火") || feYearGan.equals("火") ) {
                if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
                    if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                        if( m_bProfessional ) {
                            msg = "寅午戌三合火局.";
                            arrAnalysis.add(msg);
                        } 
                        
                        feBigZhi = "火";
                        heBigZhi = "巳";
                        heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                        if( dayZhi.equals("戌") ) {
                            feDayZhi = "火";
                            heDayZhi = "午";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("戌") ) {
                            feMonthZhi = "火";
                            heMonthZhi = "午";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        else if( hourZhi.equals("戌") ) {
                            feHourZhi = "火";
                            heHourZhi = "午";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("戌") ) {
                            feYearZhi = "火";
                            heYearZhi = "午";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        he = true;                    
                    }
                }
            }
        }
        else if( bigZhi.equals("午")) {
            if( feBigGan.equals("火") || feHourGan.equals("火") || feDayGan.equals("火") || 
            feMonthGan.equals("火") || feYearGan.equals("火") ) {
                if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
                    if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                        if( hourZhi.equals("寅") && dayZhi.equals("戌") ) {
                            if( m_bProfessional ) {
                                msg = "寅午戌三合火局.";
                                arrAnalysis.add(msg);
                            } 
                            
                            feHourZhi = "火";
                            heHourZhi = "巳";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);

                            feDayZhi = "火";
                            heDayZhi = "午";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( hourZhi.equals("寅") && monthZhi.equals("戌") ) {
                            feHourZhi = "火";
                            heHourZhi = "巳";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);

                            feMonthZhi = "火";
                            heMonthZhi = "午";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        else if( hourZhi.equals("寅") && yearZhi.equals("戌") ) {
                            feHourZhi = "火";
                            heHourZhi = "巳";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);

                            feYearZhi = "火";
                            heYearZhi = "午";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        else if( dayZhi.equals("寅") && hourZhi.equals("戌") ) {
                            feDayZhi = "火";
                            heDayZhi = "巳";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);

                            feHourZhi = "火";
                            heHourZhi = "午";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( dayZhi.equals("寅") && monthZhi.equals("戌") ) {
                            feDayZhi = "火";
                            heDayZhi = "巳";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);

                            feMonthZhi = "火";
                            heMonthZhi = "午";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        else if( dayZhi.equals("寅") && yearZhi.equals("戌") ) {
                            feDayZhi = "火";
                            heDayZhi = "巳";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);

                            feYearZhi = "火";
                            heYearZhi = "午";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("寅") && hourZhi.equals("戌") ) {
                            feMonthZhi = "火";
                            heMonthZhi = "巳";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);

                            feHourZhi = "火";
                            heHourZhi = "午";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("寅") && dayZhi.equals("戌") ) {
                            feMonthZhi = "火";
                            heMonthZhi = "巳";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);

                            feDayZhi = "火";
                            heDayZhi = "午";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("寅") && yearZhi.equals("戌") ) {
                            feMonthZhi = "火";
                            heMonthZhi = "巳";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);

                            feYearZhi = "火";
                            heYearZhi = "午";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("寅") && hourZhi.equals("戌") ) {
                            feYearZhi = "火";
                            heYearZhi = "巳";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);

                            feHourZhi = "火";
                            heHourZhi = "午";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("寅") && dayZhi.equals("戌") ) {
                            feYearZhi = "火";
                            heYearZhi = "巳";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);

                            feDayZhi = "火";
                            heDayZhi = "午";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("寅") && monthZhi.equals("戌") ) {
                            feYearZhi = "火";
                            heYearZhi = "巳";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);

                            feMonthZhi = "火";
                            heMonthZhi = "午";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        he = true;
                    }
                }
            }
        }
        else if( bigZhi.equals("戌")) {
            if( feBigGan.equals("火") || feHourGan.equals("火") || feDayGan.equals("火") || 
            feMonthGan.equals("火") || feYearGan.equals("火") ) {
                if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
                    if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
                        if( m_bProfessional ) {
                            msg = "寅午戌三合火局.";
                            arrAnalysis.add(msg);
                        }  
                        
                        feBigZhi = "火";
                        heBigZhi = "午";
                        heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                        if( dayZhi.equals("寅") ) {
                            feDayZhi = "火";
                            heDayZhi = "巳";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("寅") ) {
                            feMonthZhi = "火";
                            heMonthZhi = "巳";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        else if( hourZhi.equals("寅") ) {
                            feHourZhi = "火";
                            heHourZhi = "巳";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("寅") ) {
                            feYearZhi = "火";
                            heYearZhi = "巳";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        he = true;                    
                    }
                }
            }
        }

        if( bigZhi.equals("申")) {
            if( feBigGan.equals("水") || feHourGan.equals("水") || feDayGan.equals("水") || 
            feMonthGan.equals("水") || feYearGan.equals("水") ) {
                if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
                    if( hourZhi.equals("辰") || dayZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) {
                        if( m_bProfessional ) {
                            msg = "申子辰三合水局.";
                            arrAnalysis.add(msg);
                        } 
                        
                        feBigZhi = "水";
                        heBigZhi = "亥";
                        heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);

                        if( dayZhi.equals("辰") ) {
                            feDayZhi = "水";
                            heDayZhi = "子";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("辰") ) {
                            feMonthZhi = "水";
                            heMonthZhi = "子";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        else if( hourZhi.equals("辰") ) {
                            feHourZhi = "水";
                            heHourZhi = "子";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("辰") ) {
                            feYearZhi = "水";
                            heYearZhi = "子";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        he = true;
                    }
                }
            }
        }
        else if( bigZhi.equals("子")) {
            if( feBigGan.equals("水") || feHourGan.equals("水") || feDayGan.equals("水") || 
            feMonthGan.equals("水") || feYearGan.equals("水") ) {
                if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
                    if( hourZhi.equals("辰") || dayZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) {
                        if( hourZhi.equals("申") && dayZhi.equals("辰") ) {
                            if( m_bProfessional ) {
                                msg = "申子辰三合水局.";
                                arrAnalysis.add(msg);
                            } 
                            
                            feHourZhi = "水";
                            heHourZhi = "亥";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);

                            feDayZhi = "水";
                            heDayZhi = "子";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( hourZhi.equals("申") && monthZhi.equals("辰") ) {
                            feHourZhi = "水";
                            heHourZhi = "亥";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                            feMonthZhi = "水";
                            heMonthZhi = "子";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        else if( hourZhi.equals("申") && yearZhi.equals("辰") ) {
                            feHourZhi = "水";
                            heHourZhi = "亥";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);

                            feYearZhi = "水";
                            heYearZhi = "子";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        else if( dayZhi.equals("申") && hourZhi.equals("辰") ) {
                            feDayZhi = "水";
                            heDayZhi = "亥";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);

                            feHourZhi = "水";
                            heHourZhi = "子";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( dayZhi.equals("申") && monthZhi.equals("辰") ) {
                            feDayZhi = "水";
                            heDayZhi = "亥";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);

                            feMonthZhi = "水";
                            heMonthZhi = "子";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        else if( dayZhi.equals("申") && yearZhi.equals("辰") ) {
                            feDayZhi = "水";
                            heDayZhi = "亥";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);

                            feYearZhi = "水";
                            heYearZhi = "子";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("申") && hourZhi.equals("辰") ) {
                            feMonthZhi = "水";
                            heMonthZhi = "亥";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);

                            feHourZhi = "水";
                            heHourZhi = "子";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("申") && dayZhi.equals("辰") ) {
                            feMonthZhi = "水";
                            heMonthZhi = "亥";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);

                            feDayZhi = "水";
                            heDayZhi = "子";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("申") && yearZhi.equals("辰") ) {
                            feMonthZhi = "水";
                            heMonthZhi = "亥";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);

                            feYearZhi = "水";
                            heYearZhi = "子";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("申") && hourZhi.equals("辰") ) {
                            feYearZhi = "水";
                            heYearZhi = "亥";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);

                            feHourZhi = "水";
                            heHourZhi = "子";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("申") && dayZhi.equals("辰") ) {
                            feYearZhi = "水";
                            heYearZhi = "亥";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);

                            feDayZhi = "水";
                            heDayZhi = "子";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("申") && monthZhi.equals("辰") ) {
                            feYearZhi = "水";
                            heYearZhi = "亥";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);

                            feMonthZhi = "水";
                            heMonthZhi = "子";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        he = true;
                    }
                }
            }
        }
        else if( bigZhi.equals("辰")) {
            if( feBigGan.equals("水") || feHourGan.equals("水") || feDayGan.equals("水") || 
            feMonthGan.equals("水") || feYearGan.equals("水") ) {
                if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
                    if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
                        if( m_bProfessional ) {
                            msg = "申子辰三合水局.";
                            arrAnalysis.add(msg);
                        } 
                        
                        feBigZhi = "水";
                        heBigZhi = "子";
                        heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);

                        if( dayZhi.equals("申") ) {
                            feDayZhi = "水";
                            heDayZhi = "亥";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("申") ) {
                            feMonthZhi = "水";
                            heMonthZhi = "亥";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        else if( hourZhi.equals("申") ) {
                            feHourZhi = "水";
                            heHourZhi = "亥";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("申") ) {
                            feYearZhi = "水";
                            heYearZhi = "亥";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        he = true;
                    }
                }
            }
        }

        if( bigZhi.equals("巳")) {
            if( feBigGan.equals("金") || feHourGan.equals("金") || feDayGan.equals("金") || 
            feMonthGan.equals("金") || feYearGan.equals("金") ) {
                if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
                    if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
                        if( m_bProfessional ) {
                            msg = "巳酉丑三合金局.";
                            arrAnalysis.add(msg);
                        } 
                        
                        feBigZhi = "金";
                        heBigZhi = "申";
                        heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                        if( dayZhi.equals("丑") ) {
                            feDayZhi = "金";
                            heDayZhi = "酉";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("丑") ) {
                            feMonthZhi = "金";
                            heMonthZhi = "酉";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        else if( hourZhi.equals("丑") ) {
                            feHourZhi = "金";
                            heHourZhi = "酉";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("丑") ) {
                            feYearZhi = "金";
                            heYearZhi = "酉";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        he = true;
                    }
                }
            }
        }
        else if( bigZhi.equals("酉")) {
            if( feBigGan.equals("金") || feHourGan.equals("金") || feDayGan.equals("金") || 
            feMonthGan.equals("金") || feYearGan.equals("金") ) {
                if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
                    if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
                        if( m_bProfessional ) {
                            msg = "巳酉丑三合金局.";
                            arrAnalysis.add(msg);
                        }
                        
                        if( hourZhi.equals("巳") && dayZhi.equals("丑") ) {
                            feHourZhi = "金";
                            heHourZhi = "申";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);

                            feDayZhi = "金";
                            heDayZhi = "酉";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( hourZhi.equals("巳") && monthZhi.equals("丑") ) {
                            feHourZhi = "金";
                            heHourZhi = "申";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);

                            feMonthZhi = "金";
                            heMonthZhi = "酉";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        else if( hourZhi.equals("巳") && yearZhi.equals("丑") ) {
                            feHourZhi = "金";
                            heHourZhi = "申";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);

                            feYearZhi = "金";
                            heYearZhi = "酉";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        else if( dayZhi.equals("巳") && hourZhi.equals("丑") ) {
                            feDayZhi = "金";
                            heDayZhi = "申";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);

                            feHourZhi = "金";
                            heHourZhi = "酉";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( dayZhi.equals("巳") && monthZhi.equals("丑") ) {
                            feDayZhi = "金";
                            heDayZhi = "申";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);

                            feMonthZhi = "金";
                            heMonthZhi = "酉";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        else if( dayZhi.equals("巳") && yearZhi.equals("丑") ) {
                            feDayZhi = "金";
                            heDayZhi = "申";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);

                            feYearZhi = "金";
                            heYearZhi = "酉";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("巳") && hourZhi.equals("丑") ) {
                            feMonthZhi = "金";
                            heMonthZhi = "申";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);

                            feHourZhi = "金";
                            heHourZhi = "酉";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("巳") && dayZhi.equals("丑") ) {
                            feMonthZhi = "金";
                            heMonthZhi = "申";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);

                            feDayZhi = "金";
                            heDayZhi = "酉";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("巳") && yearZhi.equals("丑") ) {
                            feMonthZhi = "金";
                            heMonthZhi = "申";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);

                            feYearZhi = "金";
                            heYearZhi = "酉";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("巳") && hourZhi.equals("丑") ) {
                            feYearZhi = "金";
                            heYearZhi = "申";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);

                            feHourZhi = "金";
                            heHourZhi = "酉";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("巳") && dayZhi.equals("丑") ) {
                            feYearZhi = "金";
                            heYearZhi = "申";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);

                            feDayZhi = "金";
                            heDayZhi = "酉";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("巳") && monthZhi.equals("丑") ) {
                            feYearZhi = "金";
                            heYearZhi = "申";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);

                            feMonthZhi = "金";
                            heMonthZhi = "酉";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        he = true;
                    }
                }
            }
        }
        else if( bigZhi.equals("丑")) {
            if( feBigGan.equals("金") || feHourGan.equals("金") || feDayGan.equals("金") || 
            feMonthGan.equals("金") || feYearGan.equals("金") ) {
                if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
                    if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
                        if( m_bProfessional ) {
                            msg = "巳酉丑三合金局.";
                            arrAnalysis.add(msg);
                        } 
                        
                        feBigZhi = "金";
                        heBigZhi = "酉";
                        heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                        if( dayZhi.equals("丑") ) {
                            feDayZhi = "金";
                            heDayZhi = "申";
                            heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                            msg = fnShenChangeBig(shenDayZhi);
                            arrHeChong.add(msg);
                        }
                        else if( monthZhi.equals("巳") ) {
                            feMonthZhi = "金";
                            heMonthZhi = "申";
                            heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                            msg = fnShenChangeBig(shenMonthZhi);
                            arrHeChong.add(msg);
                        }
                        else if( hourZhi.equals("巳") ) {
                            feHourZhi = "金";
                            heHourZhi = "申";
                            heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                            msg = fnShenChangeBig(shenHourZhi);
                            arrHeChong.add(msg);
                        }
                        else if( yearZhi.equals("巳") ) {
                            feYearZhi = "金";
                            heYearZhi = "申";
                            heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                            msg = fnShenChangeBig(shenYearZhi);
                            arrHeChong.add(msg);
                        }
                        he = true;
                    }
                }
            }
        }

    }
    //#endregion

    //#region 地支六合
    if( he == false ) {
        msg = "";
        if( bigZhi.equals("子") && feBigGan.equals("土") &&
        ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
        monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
            feBigZhi = "土";
            heBigZhi = "丑";
            heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);

            if( m_bProfessional ) {
                msg = "子丑六合土.";
                arrAnalysis.add(msg);
            }
        }
        if( bigZhi.equals("丑") && ( hourZhi.equals("子") || dayZhi.equals("子") || 
            monthZhi.equals("子") || yearZhi.equals("子") ) ) {
            if( dayZhi.equals("子") && feDayGan.equals("土") ) {
                feDayZhi = "土";
                heDayZhi = "丑";
                heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                msg = fnShenChangeBig(shenDayZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "子丑六合土.";
                    arrAnalysis.add(msg);
                }
            }
            else if( monthZhi.equals("子") && feMonthGan.equals("土") ) {
                feMonthZhi = "土";
                heMonthZhi = "丑";
                heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                msg = fnShenChangeBig(shenMonthZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "子丑六合土.";
                    arrAnalysis.add(msg);
                }
            }
            else if( hourZhi.equals("子") && feHourGan.equals("土") ) {
                feHourZhi = "土";
                heHourZhi = "丑";
                heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                msg = fnShenChangeBig(shenHourZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "子丑六合土.";
                    arrAnalysis.add(msg);
                }
            }
            else if( yearZhi.equals("子") && feYearGan.equals("土") ) {
                feYearZhi = "土";
                heYearZhi = "丑";
                heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                msg = fnShenChangeBig(shenYearZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "子丑六合土.";
                    arrAnalysis.add(msg);
                }
            }
        }

        if( bigZhi.equals("寅") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || 
            monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
            if( dayZhi.equals("亥") && feDayGan.equals("木") ) {
                feDayZhi = "木";
                heDayZhi = "寅";
                heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                msg = fnShenChangeBig(shenDayZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "寅亥六合木.";
                    arrAnalysis.add(msg);
                }
            }
            else if( monthZhi.equals("亥") && feMonthGan.equals("木") ) {
                feMonthZhi = "木";
                heMonthZhi = "寅";
                heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                msg = fnShenChangeBig(shenMonthZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "寅亥六合木.";
                    arrAnalysis.add(msg);
                }
            }
            else if( hourZhi.equals("亥") && feHourGan.equals("木") ) {
                feHourZhi = "木";
                heHourZhi = "寅";
                heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                msg = fnShenChangeBig(shenHourZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "寅亥六合木.";
                    arrAnalysis.add(msg);
                }
            }
            else if( yearZhi.equals("亥") && feYearGan.equals("木") ) {
                feYearZhi = "木";
                heYearZhi = "寅";
                heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                msg = fnShenChangeBig(shenYearZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "寅亥六合木.";
                    arrAnalysis.add(msg);
                }
            }
        }
        if( bigZhi.equals("亥") && feBigGan.equals("木") &&
        ( hourZhi.equals("寅") || dayZhi.equals("寅") || 
        monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
            feBigZhi = "木";
            heBigZhi = "寅";
            heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);

            if( m_bProfessional ) {
                msg = "寅亥六合木.";
                arrAnalysis.add(msg);
            }
        }

        if( bigZhi.equals("卯") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
            monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
            
            if( feBigGan.equals("火")) {
                feBigZhi = "火";
                heBigZhi = "巳";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                
                if( dayZhi.equals("戌") ) {
                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("戌") ) {
                    feMonthZhi = "火";
                    heMonthZhi = "午";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("戌") ) {
                    feHourZhi = "火";
                    heHourZhi = "午";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);
                }
                else if( yearZhi.equals("戌") ) {
                    feYearZhi = "火";
                    heYearZhi = "午";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }

                if( m_bProfessional ) {
                    msg = "卯戌六合火.";
                    arrAnalysis.add(msg);
                }
            }
            else {
                
                if( dayZhi.equals("戌") && feDayGan.equals("火") ) {
                    feBigZhi = "火";
                    heBigZhi = "巳";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
    
                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火.";
                        arrAnalysis.add(msg);
                    }
                }
                else if( monthZhi.equals("戌") && feMonthGan.equals("火") ) {
                    feBigZhi = "火";
                    heBigZhi = "巳";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
    
                    feMonthZhi = "火";
                    heMonthZhi = "午";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火.";
                        arrAnalysis.add(msg);
                    }
                }
                else if( hourZhi.equals("戌") && feHourGan.equals("火") ) {
                    feBigZhi = "火";
                    heBigZhi = "巳";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
    
                    feHourZhi = "火";
                    heHourZhi = "午";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火.";
                        arrAnalysis.add(msg);
                    }
                }
                else if( yearZhi.equals("戌") && feYearGan.equals("火") ) {
                    feBigZhi = "火";
                    heBigZhi = "巳";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
    
                    feYearZhi = "火";
                    heYearZhi = "午";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火.";
                        arrAnalysis.add(msg);
                    }
                }

            }
        }
        if( bigZhi.equals("戌") && ( hourZhi.equals("卯") || dayZhi.equals("卯") || 
            monthZhi.equals("卯") || yearZhi.equals("卯") ) ) {
            if( feBigGan.equals("火")) {
                feBigZhi = "火";
                heBigZhi = "午";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                
                if( dayZhi.equals("卯") ) {
                    feDayZhi = "火";
                    heDayZhi = "巳";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("卯") ) {
                    feMonthZhi = "火";
                    heMonthZhi = "巳";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("卯") ) {
                    feHourZhi = "火";
                    heHourZhi = "巳";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);
                }
                else if( yearZhi.equals("卯") ) {
                    feYearZhi = "火";
                    heYearZhi = "巳";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }

                if( m_bProfessional ) {
                    msg = "卯戌六合火.";
                    arrAnalysis.add(msg);
                }
            }
            else {
                
                if( dayZhi.equals("卯") && feDayGan.equals("火") ) {
                    feBigZhi = "火";
                    heBigZhi = "午";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
    
                    feDayZhi = "火";
                    heDayZhi = "巳";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火.";
                        arrAnalysis.add(msg);
                    }
                }
                else if( monthZhi.equals("卯") && feMonthGan.equals("火") ) {
                    feBigZhi = "火";
                    heBigZhi = "午";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
    
                    feMonthZhi = "火";
                    heMonthZhi = "巳";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火.";
                        arrAnalysis.add(msg);
                    }
                }
                else if( hourZhi.equals("卯") && feHourGan.equals("火") ) {
                    feBigZhi = "火";
                    heBigZhi = "午";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
    
                    feHourZhi = "火";
                    heHourZhi = "巳";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火.";
                        arrAnalysis.add(msg);
                    }
                }
                else if( yearZhi.equals("卯") && feYearGan.equals("火") ) {
                    feBigZhi = "火";
                    heBigZhi = "午";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
    
                    feYearZhi = "火";
                    heYearZhi = "巳";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火.";
                        arrAnalysis.add(msg);
                    }
                }

            }
        }

        if( bigZhi.equals("辰") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || 
            monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
            if( feBigGan.equals("金")) {
                feBigZhi = "金";
                heBigZhi = "申";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);    

                if( m_bProfessional ) {
                    msg = "辰酉六合金.";
                    arrAnalysis.add(msg);
                }
            }
        }
        if( bigZhi.equals("酉") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || 
            monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
            
            if( dayZhi.equals("辰") && feDayGan.equals("金") ) {
                feDayZhi = "金";
                heDayZhi = "申";
                heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                msg = fnShenChangeBig(shenDayZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "辰酉六合金.";
                    arrAnalysis.add(msg);
                }
            }
            else if( monthZhi.equals("辰") && feMonthGan.equals("金") ) {
                feMonthZhi = "金";
                heMonthZhi = "申";
                heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                msg = fnShenChangeBig(shenMonthZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "辰酉六合金.";
                    arrAnalysis.add(msg);
                }
            }
            else if( hourZhi.equals("辰") && feHourGan.equals("金") ) {
                feHourZhi = "金";
                heHourZhi = "申";
                heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                msg = fnShenChangeBig(shenHourZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "辰酉六合金.";
                    arrAnalysis.add(msg);
                }
            }
            else if( yearZhi.equals("辰") && feYearGan.equals("金") ) {
                feYearZhi = "金";
                heYearZhi = "申";
                heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                msg = fnShenChangeBig(shenYearZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "辰酉六合金.";
                    arrAnalysis.add(msg);
                }
            }
        }

        if( bigZhi.equals("巳") && ( hourZhi.equals("申") || dayZhi.equals("申") || 
            monthZhi.equals("申") || yearZhi.equals("申") ) ) {
            if( feBigGan.equals("水")) {
                feBigZhi = "水";
                heBigZhi = "子";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                if( dayZhi.equals("申") ) {
                    feDayZhi = "水";
                    heDayZhi = "亥";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("申") ) {
                    feMonthZhi = "水";
                    heMonthZhi = "亥";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("申") ) {
                    feHourZhi = "水";
                    heHourZhi = "亥";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg); 
                }
                else if( yearZhi.equals("申") ) {
                    feYearZhi = "水";
                    heYearZhi = "亥";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }

                if( m_bProfessional ) {
                    msg = "巳申六合水.";
                    arrAnalysis.add(msg);
                }
            }
            else {
                if( dayZhi.equals("申") && feDayGan.equals("水") ) {
                    feBigZhi = "水";
                    heBigZhi = "子";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
    
                    feDayZhi = "水";
                    heDayZhi = "亥";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "巳申六合水.";
                        arrAnalysis.add(msg);
                    }
                }
                else if( monthZhi.equals("申") && feMonthGan.equals("水") ) {
                    feBigZhi = "水";
                    heBigZhi = "子";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
    
                    feMonthZhi = "水";
                    heMonthZhi = "亥";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "巳申六合水.";
                        arrAnalysis.add(msg);
                    }
                }
                else if( hourZhi.equals("申") && feHourGan.equals("水") ) {
                    feBigZhi = "水";
                    heBigZhi = "子";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
    
                    feHourZhi = "水";
                    heHourZhi = "亥";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg); 

                    if( m_bProfessional ) {
                        msg = "巳申六合水.";
                        arrAnalysis.add(msg);
                    }
                }
                else if( yearZhi.equals("申") && feYearGan.equals("水") ) {
                    feBigZhi = "水";
                    heBigZhi = "子";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
    
                    feYearZhi = "水";
                    heYearZhi = "亥";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "巳申六合水.";
                        arrAnalysis.add(msg);
                    }
                }

            }
        }
        if( bigZhi.equals("申") && ( hourZhi.equals("巳") || dayZhi.equals("巳") || 
        monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
            if( feBigGan.equals("水")) {
                feBigZhi = "水";
                heBigZhi = "亥";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                if( dayZhi.equals("巳") ) {
                    feDayZhi = "水";
                    heDayZhi = "子";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("巳") ) {
                    feMonthZhi = "水";
                    heMonthZhi = "子";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("巳") ) {
                    feHourZhi = "水";
                    heHourZhi = "子";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg); 
                }
                else if( yearZhi.equals("巳") ) {
                    feYearZhi = "水";
                    heYearZhi = "子";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }

                if( m_bProfessional ) {
                    msg = "申巳六合水.";
                    arrAnalysis.add(msg);
                }
            }
            else {
                if( dayZhi.equals("巳") && feDayGan.equals("水") ) {
                    feBigZhi = "水";
                    heBigZhi = "亥";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
    
                    feDayZhi = "水";
                    heDayZhi = "子";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "申巳六合水.";
                        arrAnalysis.add(msg);
                    }
                }
                else if( monthZhi.equals("巳") && feMonthGan.equals("水") ) {
                    feBigZhi = "水";
                    heBigZhi = "亥";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
    
                    feMonthZhi = "水";
                    heMonthZhi = "子";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "申巳六合水.";
                        arrAnalysis.add(msg);
                    }
                }
                else if( hourZhi.equals("巳") && feHourGan.equals("水") ) {
                    feBigZhi = "水";
                    heBigZhi = "亥";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
    
                    feHourZhi = "水";
                    heHourZhi = "子";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg); 

                    if( m_bProfessional ) {
                        msg = "申巳六合水.";
                        arrAnalysis.add(msg);
                    }
                }
                else if( yearZhi.equals("巳") && feYearGan.equals("水") ) {
                    feBigZhi = "水";
                    heBigZhi = "亥";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
    
                    feYearZhi = "水";
                    heYearZhi = "子";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "申巳六合水.";
                        arrAnalysis.add(msg);
                    }
                }
            }             
        }

        
        if( bigZhi.equals("午") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
            monthZhi.equals("未") || yearZhi.equals("未") ) ) {
            if( feGanTu > feGanHuo ) {
                feBigZhi = "土";
                heBigZhi = "未";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);   

                if( m_bProfessional ) {
                    msg = "午未六合土.";
                    arrAnalysis.add(msg);
                }
            }
            else if( feGanHuo > feGanTu ) {
                if(  hourZhi.equals("未") ) {
                    feHourZhi = "火";
                    heHourZhi = "午";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);
                }
                else if( dayZhi.equals("未") ) {
                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("未") ) {
                    feMonthZhi = "火";
                    heMonthZhi = "午";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( yearZhi.equals("未") ) {
                    feYearZhi = "火";
                    heYearZhi = "午";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }

                if( m_bProfessional ) {
                    msg = "午未六合火.";
                    arrAnalysis.add(msg);
                }
            }
        }
        if( bigZhi.equals("未") && ( hourZhi.equals("午") || dayZhi.equals("午") || 
        monthZhi.equals("午") || yearZhi.equals("午") ) ) {
            if( feGanTu > feGanHuo ) {
           
                if( dayZhi.equals("午") ) {
                        feDayZhi = "土";
                        heDayZhi = "未";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                }
                else if( monthZhi.equals("午") ) {
                    feMonthZhi = "土";
                    heMonthZhi = "未";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("午") ) {
                    feHourZhi = "土";
                    heHourZhi = "未";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);
                }
                else if( yearZhi.equals("午") ) {
                    feYearZhi = "土";
                    heYearZhi = "未";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }

                if( m_bProfessional ) {
                    msg = "午未六合土.";
                    arrAnalysis.add(msg);
                }
            }
            else if( feGanHuo > feGanTu ) {
                feBigZhi = "火";
                heBigZhi = "午";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);

                if( m_bProfessional ) {
                    msg = "午未六合火.";
                    arrAnalysis.add(msg);
                }
            }
        }
    }
    //#endregion

    //#region 天干五合
    msg = "";
    if( bigGan.equals("甲") && ( hourGan.equals("己") ||  
        monthGan.equals("己") || yearGan.equals("己") ) ) {
        if( feBigZhi.equals("土") ) {
            feBigGan = "土";
            heBigGan = "己";
            heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            msg = "甲己合化土，易安分守信。";
            arrAnalysis.add(msg);
        }
    }
    if( bigGan.equals("己") && ( hourGan.equals("甲") ||  
        monthGan.equals("甲") || yearGan.equals("甲") ) ) {

        if( feMonthZhi.equals("土") && monthGan.equals("甲")) {
            feMonthGan = "土";
            heMonthGan = "己";
            heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
            msg = "甲己合化土，易安分守信。";    
            arrAnalysis.add(msg);
            msg = fnShenChangeBig(shenMonthGan);
            arrAnalysis.add(msg);
    }
        else if( feHourZhi.equals("土") && hourGan.equals("甲")) {
            feHourGan = "土";
            heHourGan = "己";
            heShenHourGan = fnComputeShishen(dayGan, heHourGan);
            msg = "甲己合化土，易安分守信。";    
            arrAnalysis.add(msg);
            msg = fnShenChangeBig(shenHourGan);
            arrAnalysis.add(msg);
        }
        else if( feYearZhi.equals("土") && yearGan.equals("甲")) {
            feYearGan = "土";
            heYearGan = "己";
            heShenYearGan = fnComputeShishen(dayGan, heYearGan);
            msg = "甲己合化土，易安分守信。";    
            arrAnalysis.add(msg);
            msg = fnShenChangeBig(shenYearGan);
            arrAnalysis.add(msg);
        }    
    }

    if( bigGan.equals("乙") && ( hourGan.equals("庚") || 
        monthGan.equals("庚") || yearGan.equals("庚") ) ) {
        if( feBigZhi.equals("土") ) {
            feBigGan = "金";
            heBigGan = "庚";
            heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            msg = "乙庚合化金，易有仁有义。";
            arrAnalysis.add(msg);
        }
    }
    if( bigGan.equals("庚") && ( hourGan.equals("乙") || 
        monthGan.equals("乙") || yearGan.equals("乙") ) ) {
        if( feMonthZhi.equals("金") && monthGan.equals("乙")) {
            feMonthGan = "金";
            heMonthGan = "庚";
            heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
            msg = "乙庚合化金，易有仁有义。";
            arrAnalysis.add(msg);
            msg = fnShenChangeBig(shenMonthGan);
            arrAnalysis.add(msg);
        }
        else if( feHourZhi.equals("金") && hourGan.equals("乙")) {
            feHourGan = "金";
            heHourGan = "庚";
            heShenHourGan = fnComputeShishen(dayGan, heHourGan);
            msg = "乙庚合化金，易有仁有义。";
            arrAnalysis.add(msg);
            msg = fnShenChangeBig(shenHourGan);
            arrAnalysis.add(msg);
        }
        else if( feYearZhi.equals("金") && yearGan.equals("乙")) {
            feYearGan = "金";
            heYearGan = "庚";
            heShenYearGan = fnComputeShishen(dayGan, heYearGan);
            msg = "乙庚合化金，易有仁有义。";
            arrAnalysis.add(msg);
            msg = fnShenChangeBig(shenYearGan);
            arrAnalysis.add(msg);
        }
    } 

    if( bigGan.equals("丙") && ( hourGan.equals("辛") ||  
        monthGan.equals("辛") || yearGan.equals("辛") ) ) {
        if( feBigZhi.equals("水") ) {
            feBigGan = "水";
            heBigGan = "壬";
            heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            if( monthGan.equals("辛")) {
                feMonthGan = "水";
                heMonthGan = "癸";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrAnalysis.add(msg);
            }
            else if( hourGan.equals("辛")) {
                feHourGan = "水";
                heHourGan = "癸";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrAnalysis.add(msg);
            }
            else if( yearGan.equals("辛")) {
                feYearGan = "水";
                heYearGan = "癸";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrAnalysis.add(msg);
            }
        }
        else {
            if( feMonthZhi.equals("水") && monthGan.equals("辛")) {
                feBigGan = "水";
                heBigGan = "壬";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feMonthGan = "水";
                heMonthGan = "癸";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrAnalysis.add(msg);
            }
            else if( feHourZhi.equals("水") && hourGan.equals("辛")) {
                feBigGan = "水";
                heBigGan = "壬";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feHourGan = "水";
                heHourGan = "癸";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrAnalysis.add(msg);
            }
            else if( feYearZhi.equals("水") && yearGan.equals("辛")) {
                feBigGan = "水";
                heBigGan = "壬";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feYearGan = "水";
                heYearGan = "癸";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrAnalysis.add(msg);
            }
        }
    }
    if( bigGan.equals("辛") && ( hourGan.equals("丙") ||  
        monthGan.equals("丙") || yearGan.equals("丙") ) ) {
        if( feBigZhi.equals("水") ) {
            feBigGan = "水";
            heBigGan = "癸";
            heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            if( monthGan.equals("丙")) {
                feMonthGan = "水";
                heMonthGan = "壬";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrAnalysis.add(msg);
            }
            else if( hourGan.equals("丙")) {
                feHourGan = "水";
                heHourGan = "壬";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrAnalysis.add(msg);
            }
            else if( yearGan.equals("丙")) {
                feYearGan = "水";
                heYearGan = "壬";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrAnalysis.add(msg);
            }
        }
        else {
            if( feMonthZhi.equals("水") && monthGan.equals("丙")) {
                feBigGan = "水";
                heBigGan = "癸";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feMonthGan = "水";
                heMonthGan = "壬";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrAnalysis.add(msg);
            }
            else if( feHourZhi.equals("水") && hourGan.equals("丙")) {
                feBigGan = "水";
                heBigGan = "癸";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feHourGan = "水";
                heHourGan = "壬";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrAnalysis.add(msg);
            }
            else if( feYearZhi.equals("水") && yearGan.equals("丙")) {
                feBigGan = "水";
                heBigGan = "壬";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feYearGan = "水";
                heYearGan = "壬";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrAnalysis.add(msg);
            }
        }                
    }

    if( bigGan.equals("丁") && ( hourGan.equals("壬") || 
        monthGan.equals("壬") || yearGan.equals("壬") ) ) {
        if( feBigZhi.equals("木") ) {
            feBigGan = "木";
            heBigGan = "乙";
            heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            if( monthGan.equals("壬")) {
                feMonthGan = "木";
                heMonthGan = "甲";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrAnalysis.add(msg);
            }
            else if( hourGan.equals("壬")) {
                feHourGan = "木";
                heHourGan = "甲";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrAnalysis.add(msg);
            }
            else if( yearGan.equals("壬")) {
                feYearGan = "木";
                heYearGan = "甲";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrAnalysis.add(msg);
            }
        }
        else {
            if( feMonthZhi.equals("木") && monthGan.equals("壬")) {
                feBigGan = "木";
                heBigGan = "乙";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feMonthGan = "木";
                heMonthGan = "甲";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrAnalysis.add(msg);
            }
            else if( feHourZhi.equals("木") && hourGan.equals("壬")) {
                feBigGan = "木";
                heBigGan = "乙";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feHourGan = "木";
                heHourGan = "甲";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrAnalysis.add(msg);
            }
            else if( feYearZhi.equals("木") && yearGan.equals("壬")) {
                feBigGan = "木";
                heBigGan = "乙";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feYearGan = "木";
                heYearGan = "甲";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrAnalysis.add(msg);
            }
        }
    }
    if( bigGan.equals("壬") && ( hourGan.equals("丁") ||  
        monthGan.equals("丁") || yearGan.equals("丁") ) ) {
        if( feBigZhi.equals("木") ) {
            feBigGan = "木";
            heBigGan = "甲";
            heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            if( monthGan.equals("丁")) {
                feMonthGan = "木";
                heMonthGan = "乙";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrAnalysis.add(msg);
            }
            else if( hourGan.equals("丁")) {
                feHourGan = "木";
                heHourGan = "乙";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrAnalysis.add(msg);
            }
            else if( yearGan.equals("丁")) {
                feYearGan = "木";
                heYearGan = "乙";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrAnalysis.add(msg);
            }
        }
        else {
            if( feMonthZhi.equals("木") && monthGan.equals("丁")) {
                feBigGan = "木";
                heBigGan = "甲";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feMonthGan = "木";
                heMonthGan = "乙";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrAnalysis.add(msg);
            }
            else if( feHourZhi.equals("木") && hourGan.equals("丁")) {
                feBigGan = "木";
                heBigGan = "甲";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feHourGan = "木";
                heHourGan = "乙";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrAnalysis.add(msg);
            }
            else if( feYearZhi.equals("木") && yearGan.equals("丁")) {
                feBigGan = "木";
                heBigGan = "甲";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feYearGan = "木";
                heYearGan = "乙";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrAnalysis.add(msg);
            }
        }
    }

    if( bigGan.equals("戊") && ( hourGan.equals("癸") ||  
        monthGan.equals("癸") || yearGan.equals("癸") ) ) {
        if( feBigZhi.equals("火") ) {
            feBigGan = "火";
            heBigGan = "丙";
            heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            if( monthGan.equals("癸")) {
                feMonthGan = "火";
                heMonthGan = "丁";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrAnalysis.add(msg);
            }
            else if( hourGan.equals("癸")) {
                feHourGan = "火";
                heHourGan = "丁";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrAnalysis.add(msg);
            }
            else if( yearGan.equals("癸")) {
                feYearGan = "火";
                heYearGan = "丁";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrAnalysis.add(msg);
            }
        }
        else {
            if( feMonthZhi.equals("火") && monthGan.equals("癸")) {
                feBigGan = "火";
                heBigGan = "丙";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feMonthGan = "火";
                heMonthGan = "丁";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrAnalysis.add(msg);
            }
            else if( feHourZhi.equals("火") && hourGan.equals("癸")) {
                feBigGan = "火";
                heBigGan = "丙";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feHourGan = "火";
                heHourGan = "丁";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrAnalysis.add(msg);
            }
            else if( feYearZhi.equals("火") && yearGan.equals("癸")) {
                feBigGan = "火";
                heBigGan = "丙";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feYearGan = "火";
                heYearGan = "丁";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrAnalysis.add(msg);
            }
        }
    }
    if( bigGan.equals("癸") && ( hourGan.equals("戊") ||  
        monthGan.equals("戊") || yearGan.equals("戊") ) ) {
        if( feBigZhi.equals("火") ) {
            feBigGan = "火";
            heBigGan = "丁";
            heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            if( monthGan.equals("戊")) {
                feMonthGan = "火";
                heMonthGan = "丙";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrAnalysis.add(msg);
            }
            else if( hourGan.equals("戊")) {
                feHourGan = "火";
                heHourGan = "丙";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrAnalysis.add(msg);
            }
            else if( yearGan.equals("戊")) {
                feYearGan = "火";
                heYearGan = "丙";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrAnalysis.add(msg);
            }
        }
        else {
            if( feMonthZhi.equals("火") && monthGan.equals("戊")) {
                feBigGan = "火";
                heBigGan = "丁";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feMonthGan = "火";
                heMonthGan = "丙";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrAnalysis.add(msg);
            }
            else if( feHourZhi.equals("火") && hourGan.equals("戊")) {
                feBigGan = "火";
                heBigGan = "丁";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feHourGan = "火";
                heHourGan = "丙";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrAnalysis.add(msg);
            }
            else if( feYearZhi.equals("火") && yearGan.equals("戊")) {
                feBigGan = "火";
                heBigGan = "丁";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                feYearGan = "火";
                heYearGan = "丙";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrAnalysis.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrAnalysis.add(msg);
            }
        }
    
    }

    //#endregion

    //#region 重新计算五行个数，和生克数量
    feJin = 0; feMu = 0; feShui = 0; feHuo = 0; feTu = 0; feUp = 0; feDown = 0; feUp2 = 0;
    feGanJin = 0; feGanMu = 0; feGanShui = 0; feGanHuo = 0; feGanTu = 0;
    
    if( feYearGan.equals("金") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( feYearGan.equals("木") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;

    }
    if( feYearGan.equals("水") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }
    if( feYearGan.equals("火") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( feYearGan.equals("土") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( feUse1.equals(feYearGan) || feUse2.equals(feYearGan) ) {
        feUp = feUp + 1;
    }
    else {
        feDown = feDown + 1;
    }

    if( feMonthGan.equals("金") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( feMonthGan.equals("木") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;
    }
    if( feMonthGan.equals("水") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }
    if( feMonthGan.equals("火") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( feMonthGan.equals("土") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( feUse1.equals(feMonthGan) || feUse2.equals(feMonthGan) ) {
        feUp = feUp + 1;
        feUp2 = feUp2 + 1;
    }
    else {
        feDown = feDown + 1;
    }
    
    if( feDayGan.equals("金") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( feDayGan.equals("木") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;
    }
    if( feDayGan.equals("水") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }
    if( feDayGan.equals("火") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( feDayGan.equals("土") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( feUse1.equals(feDayGan) || feUse2.equals(feDayGan) ) {
        feUp = feUp + 1;
    }
    else {
        feDown = feDown + 1;
    }    
    
    if( feHourGan.equals("金") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( feHourGan.equals("木") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;
    }
    if( feHourGan.equals("水") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }
    if( feHourGan.equals("火") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( feHourGan.equals("土") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( feUse1.equals(feHourGan) || feUse2.equals(feHourGan) ) {
        feUp = feUp + 1;
        feUp2 = feUp2 + 1;
    }
    else {
        feDown = feDown + 1;
    }

    if( feBigGan.equals("金") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( feBigGan.equals("木") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;
    }
    if( feBigGan.equals("水") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }
    if( feBigGan.equals("火") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( feBigGan.equals("土") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( feUse1.equals(feBigGan) || feUse2.equals(feBigGan) ) {
        feUp = feUp + 1;
        feUp2 = feUp2 + 1;
    }
    else {
        feDown = feDown + 1;
    }

    if( feYearZhi.equals("金") ) {
        feJin = feJin + 1;
    }
    if( feYearZhi.equals("木") ) {
        feMu = feMu + 1;
    }
    if( feYearZhi.equals("水") ) {
        feShui = feShui + 1;
    }
    if( feYearZhi.equals("火") ) {
        feHuo = feHuo + 1;
    }
    if( feYearZhi.equals("土") ) {
        feTu = feTu + 1;
    }
    if( feUse1.equals(feYearZhi) || feUse2.equals(feYearZhi) ) {
        feUp = feUp + 1;
    }
    else {
        feDown = feDown + 1;
    }
    

    if( feMonthZhi.equals("金") ) {
        feJin = feJin + 1;
    }
    if( feMonthZhi.equals("木") ) {
        feMu = feMu + 1;
    }
    if( feMonthZhi.equals("水") ) {
        feShui = feShui + 1;
    }
    if( feMonthZhi.equals("火") ) {
        feHuo = feHuo + 1;
    }
    if( feMonthZhi.equals("土") ) {
        feTu = feTu + 1;
    }
    if( feUse1.equals(feMonthZhi) || feUse2.equals(feMonthZhi) ) {
        feUp = feUp + 1;
    }
    else {
        feDown = feDown + 1;
    }
    
    if( feDayZhi.equals("金") ) {
        feJin = feJin + 1;
    }
    if( feDayZhi.equals("木") ) {
        feMu = feMu + 1;
    }
    if( feDayZhi.equals("水") ) {
        feShui = feShui + 1;
    }
    if( feDayZhi.equals("火") ) {
        feHuo = feHuo + 1;
    }
    if( feDayZhi.equals("土") ) {
        feTu = feTu + 1;
    }
    if( feUse1.equals(feDayZhi) || feUse2.equals(feDayZhi) ) {
        feUp = feUp + 1;
        feUp2 = feUp2 + 1;
    }
    else {
        feDown = feDown + 1;
    }

    if( feHourZhi.equals("金") ) {
        feJin = feJin + 1;
    }
    if( feHourZhi.equals("木") ) {
        feMu = feMu + 1;
    }
    if( feHourZhi.equals("水") ) {
        feShui = feShui + 1;
    }
    if( feHourZhi.equals("火") ) {
        feHuo = feHuo + 1;
    }
    if( feHourZhi.equals("土") ) {
        feTu = feTu + 1;
    }
    if( feUse1.equals(feHourZhi) || feUse2.equals(feHourZhi) ) {
        feUp = feUp + 1;
    }
    else {
        feDown = feDown + 1;
    }

    if( feBigZhi.equals("金") ) {
        feJin = feJin + 1;
    }
    if( feBigZhi.equals("木") ) {
        feMu = feMu + 1;
    }
    if( feBigZhi.equals("水") ) {
        feShui = feShui + 1;
    }
    if( feBigZhi.equals("火") ) {
        feHuo = feHuo + 1;
    }
    if( feBigZhi.equals("土") ) {
        feTu = feTu + 1;
    }
    if( feUse1.equals(feBigZhi) || feUse2.equals(feBigZhi) ) {
        feUp = feUp + 1;
    }
    else {
        feDown = feDown + 1;
    }

    //#endregion

    //#region 计算十神 
        shenGuan = 0;
        shenSha = 0;
        shenYin = 0;
        shenXiao = 0;
        shenBi = 0;
        shenJie = 0;
        shenCaiz = 0;
        shenCaip = 0;
        shenShi = 0;
        shenShang = 0;

        if( heShenHourGan.equals("比") ) {
                shenBi = shenBi + 1;
            }
        if( heShenHourGan.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenHourGan.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenHourGan.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenHourGan.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenHourGan.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenHourGan.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenHourGan.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenHourGan.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenHourGan.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenHourZhi.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenHourZhi.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenHourZhi.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenHourZhi.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenHourZhi.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenHourZhi.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenHourZhi.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenHourZhi.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenHourZhi.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenHourZhi.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenDayZhi.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenDayZhi.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenDayZhi.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenDayZhi.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenDayZhi.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenDayZhi.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenDayZhi.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenDayZhi.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenDayZhi.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenDayZhi.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenMonthGan.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenMonthGan.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenMonthGan.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenMonthGan.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenMonthGan.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenMonthGan.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenMonthGan.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenMonthGan.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenMonthGan.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenMonthGan.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenMonthZhi.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenMonthZhi.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenMonthZhi.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenMonthZhi.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenMonthZhi.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenMonthZhi.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenMonthZhi.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenMonthZhi.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenMonthZhi.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenMonthZhi.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenYearGan.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenYearGan.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenYearGan.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenYearGan.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenYearGan.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenYearGan.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenYearGan.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenYearGan.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenYearGan.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenYearGan.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenYearZhi.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenYearZhi.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenYearZhi.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenYearZhi.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenYearZhi.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenYearZhi.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenYearZhi.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenYearZhi.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenYearZhi.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenYearZhi.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenBigGan.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenBigGan.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenBigGan.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenBigGan.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenBigGan.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenBigGan.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenBigGan.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenBigGan.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenBigGan.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenBigGan.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenBigZhi.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenBigZhi.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenBigZhi.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenBigZhi.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenBigZhi.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenBigZhi.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenBigZhi.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenBigZhi.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenBigZhi.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenBigZhi.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

    //#endregion

    //#region 天干四冲
    msg = "";
    if( bigGan.equals("庚") && ( hourGan.equals("甲") || dayGan.equals("甲") || 
    monthGan.equals("甲") || yearGan.equals("甲") ) ) {
        msg = "甲庚相冲，";
        if( feMu <= feJin ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "甲"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "庚"));
        }
        arrHeChong.add(msg);
    }
    if( bigGan.equals("甲") && ( hourGan.equals("庚") || dayGan.equals("庚") || 
    monthGan.equals("庚") || yearGan.equals("庚") ) ) {
        msg = "甲庚相冲，";
        if( feMu <= feJin ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "甲"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "庚"));
        }
        arrHeChong.add(msg);
    }

    if( bigGan.equals("乙") && ( hourGan.equals("辛") || dayGan.equals("辛") || 
    monthGan.equals("辛") || yearGan.equals("辛") ) ) {
        msg = "乙辛相冲，";
        if( feMu <= feJin ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "乙"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "辛"));
        }
        arrHeChong.add(msg);
    }
    if( bigGan.equals("辛") && ( hourGan.equals("乙") || dayGan.equals("乙") || 
    monthGan.equals("乙") || yearGan.equals("乙") ) ) {
        msg = "乙辛相冲，";
        if( feMu <= feJin ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "乙"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "辛"));
        }
        arrHeChong.add(msg);
    }

    if( bigGan.equals("丙") && ( hourGan.equals("壬") || dayGan.equals("壬") || 
    monthGan.equals("壬") || yearGan.equals("壬") ) ) {
        msg = "丙壬相冲，";
        if( feHuo <= feShui ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "丙"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "壬"));
        }
        arrHeChong.add(msg);
    }
    if( bigGan.equals("壬") && ( hourGan.equals("丙") || dayGan.equals("丙") || 
    monthGan.equals("丙") || yearGan.equals("丙") ) ) {
        msg = "丙壬相冲，";
        if( feHuo <= feShui ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "丙"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "壬"));
        }
        arrHeChong.add(msg);
    } 

    if( bigGan.equals("丁") && ( hourGan.equals("癸") || dayGan.equals("癸") || 
    monthGan.equals("癸") || yearGan.equals("癸") ) ) {
        msg = "丁癸相冲，";
        if( feHuo <= feShui ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "丁"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "癸"));
        }
        arrHeChong.add(msg);
    }
    if( bigGan.equals("癸") && ( hourGan.equals("丁") || dayGan.equals("丁") || 
    monthGan.equals("丁") || yearGan.equals("丁") ) ) {
        msg = "丁癸相冲，";
        if( feHuo <= feShui ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "丁"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "癸"));
        }
        arrHeChong.add(msg);
    }
    //#endregion

    /// 地支刑冲害 
    //#region 地支六冲
    if( bigZhi.equals("子") && ( hourZhi.equals("午") || dayZhi.equals("午") || 
    monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "子午相冲，易不安。";
        arrHeChong.add(msg);
        if( dayZhi.equals("午") ) {
            msg = "子午冲婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);    
        }
    }
    if( bigZhi.equals("午") && ( hourZhi.equals("子") || dayZhi.equals("子") || 
    monthZhi.equals("子") || yearZhi.equals("子") ) ) {
        msg = "子午相冲，易不安。";
        arrHeChong.add(msg);
        if( dayZhi.equals("子") ) {
            msg = "子午冲婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);    
        }
    }

    if( bigZhi.equals("丑") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
            monthZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "丑未相冲，事多阻。";
        arrHeChong.add(msg);
        if( dayZhi.equals("未") ) {
            msg = "丑未冲婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);    
        }
    }
    if( bigZhi.equals("未") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
    monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
        msg = "丑未相冲，事多阻。";
        arrHeChong.add(msg);
        if( dayZhi.equals("丑") ) {
            msg = "丑未冲婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);    
        }
    }

    if( bigZhi.equals("寅") && ( hourZhi.equals("申") || dayZhi.equals("申") || 
            monthZhi.equals("申") || yearZhi.equals("申") ) ) {
        msg = "寅申相冲，多情或者管闲事。";
        arrHeChong.add(msg);
        if( dayZhi.equals("申") ) {
            msg = "寅申冲婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);    
        }
    }
    if( bigZhi.equals("申") && ( hourZhi.equals("寅") || dayZhi.equals("寅") || 
    monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
        msg = "寅申相冲，多情或者管闲事。";
        arrHeChong.add(msg);
        if( dayZhi.equals("寅") ) {
            msg = "寅申冲婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);    
        }
    }

    if( bigZhi.equals("卯") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || 
            monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "卯酉相冲，多劳碌，易情色纠纷。";
        arrHeChong.add(msg);
        if( dayZhi.equals("酉") ) {
            msg = "卯酉冲婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);    
        }
    }
    if( bigZhi.equals("酉") && ( hourZhi.equals("卯") || dayZhi.equals("卯") || 
    monthZhi.equals("卯") || yearZhi.equals("卯") ) ) {
        msg = "卯酉相冲，多劳碌，易情色纠纷。";
        arrHeChong.add(msg);
        if( dayZhi.equals("卯") ) {
            msg = "卯酉冲婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);    
        }
    }

    if( bigZhi.equals("辰") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
            monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
        msg = "辰戌相冲，克亲人，帮他人。";
        arrHeChong.add(msg);
        if( dayZhi.equals("戌") ) {
            msg = "辰戌冲婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);    
        }
    }
    if( bigZhi.equals("戌") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || 
    monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
        msg = "辰戌相冲，克亲人，帮他人。";
        arrHeChong.add(msg);
        if( dayZhi.equals("辰") ) {
            msg = "辰戌冲婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);    
        }
    }

    if( bigZhi.equals("巳") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || 
            monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "巳亥相冲，易帮他人。";
        arrHeChong.add(msg);
        if( dayZhi.equals("亥") ) {
            msg = "巳亥冲婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);    
        }
    }
    if( bigZhi.equals("亥") && ( hourZhi.equals("巳") || dayZhi.equals("巳") || 
    monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
        msg = "巳亥相冲，易帮他人。";
        arrHeChong.add(msg);
        if( dayZhi.equals("巳") ) {
            msg = "巳亥冲婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);    
        }
    }

    //#endregion

    //#region 地址六害 
    if( bigZhi.equals("子") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
            monthZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "子未相害，无助于子孙。";
        arrHeChong.add(msg);
        if( dayZhi.equals("未") ) {
            msg = "子未害婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }
    if( bigZhi.equals("未") && ( hourZhi.equals("子") || dayZhi.equals("子") || 
    monthZhi.equals("子") || yearZhi.equals("子") ) ) {
        msg = "子未相害，无助于子孙。";
        arrHeChong.add(msg);
        if( dayZhi.equals("子") ) {
            msg = "子未害婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }

    if( bigZhi.equals("丑") && ( hourZhi.equals("午") || dayZhi.equals("午") || 
            monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "丑午相害，易怒，无耐心，大运逢弱易有伤残。";
        arrHeChong.add(msg);
        if( dayZhi.equals("午") ) {
            msg = "丑午害婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }
    if( bigZhi.equals("午") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
    monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
        msg = "丑午相害，易怒，无耐心，大运逢弱易有伤残。";
        arrHeChong.add(msg);
        if( dayZhi.equals("丑") ) {
            msg = "丑午害婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }

    if( bigZhi.equals("寅") && ( hourZhi.equals("巳") || dayZhi.equals("巳") || 
            monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
        msg = "寅巳相害，多疾病。";
        arrHeChong.add(msg);
        if( dayZhi.equals("巳") ) {
            msg = "寅巳害婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }
    if( bigZhi.equals("巳") && ( hourZhi.equals("寅") || dayZhi.equals("寅") || 
    monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
        msg = "寅巳相害，多疾病。";
        arrHeChong.add(msg);
        if( dayZhi.equals("寅") ) {
            msg = "寅巳害婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }

    if( bigZhi.equals("卯") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || 
            monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
        msg = "卯辰相害，易怒，无耐心，大运逢弱易有伤残。";
        arrHeChong.add(msg);
        if( dayZhi.equals("辰") ) {
            msg = "卯辰害婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }
    if( bigZhi.equals("辰") && ( hourZhi.equals("卯") || dayZhi.equals("卯") || 
    monthZhi.equals("卯") || yearZhi.equals("卯") ) ) {
        msg = "卯辰相害，易怒，无耐心，大运逢弱易有伤残。";
        arrHeChong.add(msg);
        if( dayZhi.equals("卯") ) {
            msg = "卯辰害婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }

    if( bigZhi.equals("申") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || 
    monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "申亥相害";
        arrHeChong.add(msg);
        if( dayZhi.equals("亥") ) {
            msg = "申亥害婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }
    if( bigZhi.equals("亥") && ( hourZhi.equals("申") || dayZhi.equals("申") || 
        monthZhi.equals("申") || yearZhi.equals("申") ) ) {
            msg = "申亥相害";
            arrHeChong.add(msg);
        if( dayZhi.equals("申") ) {
            msg = "申亥害婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }

    if( bigZhi.equals("酉") && ( yearZhi.equals("戌") || hourZhi.equals("戌") || 
            dayZhi.equals("戌") || monthZhi.equals("戌") ) ) {
        msg = "酉戌相害";
        arrHeChong.add(msg);
        if( dayZhi.equals("戌") ) {
            msg = "酉戌害婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }
    if( bigZhi.equals("戌") && ( yearZhi.equals("酉") || hourZhi.equals("酉") || 
    dayZhi.equals("酉") || monthZhi.equals("酉") ) ) {
        msg = "酉戌相害";
        arrHeChong.add(msg);
        if( dayZhi.equals("酉") ) {
            msg = "酉戌害婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }
    
    //#endregion

    //#region 地支相刑 
    if( bigZhi.equals("寅")) {
        if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
            if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
                msg = "寅巳申三刑，易官司或是非，女不易怀孕或易流产。";
                arrHeChong.add(msg);
                if( dayZhi.equals("巳") || dayZhi.equals("申") ) {
                    msg = "寅巳申刑婚宫，影响婚姻，或者口角或两地分居等。";
                    arrHeChong.add(msg);
                }
            }
        }
    }
    else if( bigZhi.equals("巳")) {
        if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
            if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
                msg = "寅巳申三刑，易官司或是非，女不易怀孕或易流产。";
                arrHeChong.add(msg);
                if( dayZhi.equals("寅") || dayZhi.equals("申") ) {
                    msg = "寅巳申刑婚宫，影响婚姻，或者口角或两地分居等。";
                    arrHeChong.add(msg);
                }
            }
        }
    }
    else if( bigZhi.equals("申")) {
        if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
            if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
                msg = "寅巳申三刑，易官司或是非，女不易怀孕或易流产。";
                arrHeChong.add(msg);
                if( dayZhi.equals("寅") || dayZhi.equals("巳") ) {
                    msg = "寅巳申刑婚宫，影响婚姻，或者口角或两地分居等。";
                    arrHeChong.add(msg);
                }
            }
        }
    }

    if(bigZhi.equals("未")) {
        if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                msg = "未丑戌三刑，易挫折，女易孤单。";
                arrHeChong.add(msg);
                if( dayZhi.equals("丑") || dayZhi.equals("戌") ) {
                    msg = "未丑戌刑婚宫，影响婚姻，或者口角或两地分居等。";
                    arrHeChong.add(msg);
                }
            }
        }
    }
    else if( bigZhi.equals("丑")) {
        if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                msg = "未丑戌三刑，易挫折，女易孤单。";
                arrHeChong.add(msg);
                if( dayZhi.equals("未") || dayZhi.equals("戌") ) {
                    msg = "未丑戌刑婚宫，影响婚姻，或者口角或两地分居等。";
                    arrHeChong.add(msg);
                }
            }
        }
    }
    else if( bigZhi.equals("戌")) {
        if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
            if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
                msg = "未丑戌三刑，易挫折，女易孤单。";
                arrHeChong.add(msg);
                if( dayZhi.equals("未") || dayZhi.equals("丑") ) {
                    msg = "未丑戌刑婚宫，影响婚姻，或者口角或两地分居等。";
                    arrHeChong.add(msg);
                }
            }
        }
    }

    if( bigZhi.equals("卯") && (hourZhi.equals("子") || dayZhi.equals("子") || 
            monthZhi.equals("子") || yearZhi.equals("子") ) ) {
        msg = "子卯二刑，与上级(辈)或者下级(辈)不和。";
        arrHeChong.add(msg);
        if( dayZhi.equals("子") ) {
            msg = "子卯刑婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }
    else if( bigZhi.equals("子") && (hourZhi.equals("卯") || dayZhi.equals("卯") || 
            monthZhi.equals("卯") || yearZhi.equals("卯") ) ) {
        msg = "子卯二刑，与上级(辈)或者下级(辈)不和。";
        arrHeChong.add(msg);
        if( dayZhi.equals("卯") ) {
            msg = "子卯刑婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }

    if( bigZhi.equals("辰") && (hourZhi.equals("辰") || dayZhi.equals("辰") || 
            monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
        msg = "辰辰自刑，有始无终，常陷困境。";
        arrHeChong.add(msg);
        if( dayZhi.equals("辰") ) {
            msg = "辰辰刑婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }

    if( bigZhi.equals("午") && (hourZhi.equals("午") || dayZhi.equals("午") || 
            monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "午午自刑，有始无终，常陷困境。";
        arrHeChong.add(msg);
        if( dayZhi.equals("午") ) {
            msg = "午午刑婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }

    if( bigZhi.equals("酉") && ( hourZhi.equals("酉")  || dayZhi.equals("酉") || 
            monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "酉酉自刑，有始无终，常陷困境。";
        arrHeChong.add(msg);
        if( dayZhi.equals("酉") ) {
            msg = "酉酉刑婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }
    if( bigZhi.equals("亥") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || 
            monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "亥亥自刑，有始无终，常陷困境。";
        arrHeChong.add(msg);
        if( dayZhi.equals("亥") ) {
            msg = "亥亥刑婚宫，影响婚姻，或者口角或两地分居等。";
            arrHeChong.add(msg);
        }
    }

    //#endregion

    /// 分析合冲之后的十神，
    //#region 大运变更 
    if( !shenBigGan.equals(heShenBigGan) ) {
        msg = "大运天干由 " + shenBigGan + " 变成 " + heShenBigGan + "。";
        arrAnalysis.add(msg);
    }
    if( !shenBigZhi.equals(heShenBigZhi) ) {
        msg = "大运地支由 " + shenBigZhi + " 变成 " + heShenBigZhi + "。";
        arrAnalysis.add(msg);
    }

    msg = "大运为 " + heShenBigGan + heShenBigZhi + " 运。";
    //#endregion

    /// 男合财，女合官，合婚宫
    //#region 命局官财被合 
    /// 合婚宫
    if( age >= 18 ) {
        arrAnalysis.addAll(arrHeChong);

        if( !shenDayZhi.equals(heShenDayZhi) ) {
            msg = "婚宫有变动，" + shenDayZhi + "变成" + heShenDayZhi + "，婚姻状态可能会有变化。";
            arrAnalysis.add(msg);
        }
        /// 男合财，女合官
        if( sex.equals("男") ) {
            if( !shenYearGan.equals(heShenYearGan) && (shenYearGan.equals("财") || shenYearGan.equals("才")) ) {
                msg = "命局财被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenYearZhi.equals(heShenYearZhi) && (shenYearZhi.equals("财") || shenYearZhi.equals("才")) ) {
                msg = "命局财被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenMonthGan.equals(heShenMonthGan) && (shenMonthGan.equals("财") || shenMonthGan.equals("才")) ) {
                msg = "命局财被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenMonthZhi.equals(heShenMonthZhi) && (shenMonthZhi.equals("财") || shenMonthZhi.equals("才")) ) {
                msg = "命局财被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenDayZhi.equals(heShenDayZhi) && (shenDayZhi.equals("财") || shenDayZhi.equals("才")) ) {
                msg = "命局财被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenHourGan.equals(heShenHourGan) && (shenHourGan.equals("财") || shenHourGan.equals("才")) ) {
                msg = "命局财被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenHourZhi.equals(heShenHourZhi) && (shenHourZhi.equals("财") || shenHourZhi.equals("才")) ) {
                msg = "命局财被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
        }
        else {
            if( !shenYearGan.equals(heShenYearGan) && (shenYearGan.equals("官") || shenYearGan.equals("煞")) ) {
                msg = "命局官被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenYearZhi.equals(heShenYearZhi) && (shenYearZhi.equals("官") || shenYearZhi.equals("煞")) ) {
                msg = "命局官被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenMonthGan.equals(heShenMonthGan) && (shenMonthGan.equals("官") || shenMonthGan.equals("煞")) ) {
                msg = "命局官被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenMonthZhi.equals(heShenMonthZhi) && (shenMonthZhi.equals("官") || shenMonthZhi.equals("煞")) ) {
                msg = "命局官被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenDayZhi.equals(heShenDayZhi) && (shenDayZhi.equals("官") || shenDayZhi.equals("煞")) ) {
                msg = "命局官被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenHourGan.equals(heShenHourGan) && (shenHourGan.equals("官") || shenHourGan.equals("煞")) ) {
                msg = "命局官被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenHourZhi.equals(heShenHourZhi) && (shenHourZhi.equals("官") || shenHourZhi.equals("煞")) ) {
                msg = "命局官被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
        }
    } 
    //#endregion

    //#region 大运十神分析
    msg = "";
    if( age < 18 ) { /// 20岁前的大运
        if( heShenBigGan.equals("官") || heShenBigGan.equals("煞")) {
            if( heShenBigZhi.equals("官") || heShenBigZhi.equals("煞")) { //官官
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "学习稍微好一些，虽然调皮但是讨人喜欢。";
                }
                else { /// 身弱
                    if( (shenYin + shenXiao) > 0 ) {
                        msg = msg + "很努力，学习稍微好一些，爱惹事情。";
                    }
                    else {
                        msg = msg + "很努力，学习一般，爱惹事情。";
                    }
                }
                if( m_selfStrength == 0 ) {
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
            else if( heShenBigZhi.equals("印") || heShenBigZhi.equals("枭")) {  // 官印
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，懂事，讨人喜欢。";
                    }
                    else {
                        msg = msg + "学习好，董事，讨人喜欢。";
                    }
                }
                else { /// 身弱
                    if( (shenGuan + shenSha) > 3) {
                        msg = msg + "比较努力，学习好，爱惹事情。";
                    }
                    else {
                        msg = msg + "比较努力，学习好，比较调皮。";
                    }
                }
                if( m_selfStrength == 0 ) {
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
            else if( heShenBigZhi.equals("比") || heShenBigZhi.equals("劫")) { // 官比
                if( (shenYin + shenXiao) >= 3 ) {
                    msg = msg + "学习不好，";
                }
                else {
                    msg = msg + "学习好，";
                }
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "比较懂事，比较要强。";
                }
                else { /// 身弱
                    msg = msg + "爱惹事，比较任性。";
                }
                if( m_selfStrength == 0 ) {
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
            else if( heShenBigZhi.equals("食") || heShenBigZhi.equals("伤")) { // 官食
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "比较懂事，有才艺，表现好。";
                }
                else { /// 身弱
                    msg = msg + "比较调皮，易有病。";
                }
                if( m_selfStrength == 0 ) {
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
            else if( heShenBigZhi.equals("财") || heShenBigZhi.equals("才")) { // 官财
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "比较懂事，讨人喜欢，不爱学习。";
                }
                else { /// 身弱
                    msg = msg + "爱惹事。不爱学习。易有病。";
                }
                if( m_selfStrength == 0 ) {
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
        }
        else if( heShenBigGan.equals("印") || heShenBigGan.equals("枭")) {
            if( heShenBigZhi.equals("官") || heShenBigZhi.equals("煞")) { // 印官
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，懂事，讨人喜欢。";
                    }
                    else {
                        msg = msg + "学习好，董事，讨人喜欢。";
                    }
                }
                else { /// 身弱
                    if( (shenGuan + shenSha) > 3) {
                        msg = msg + "比较努力，学习好，爱惹事情。";
                    }
                    else {
                        msg = msg + "比较努力，学习好，比较调皮。";
                    }
                }
                if( m_selfStrength == 0 ) {
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
            else if( heShenBigZhi.equals("印") || heShenBigZhi.equals("枭")) { // 印印
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，胆小，不吃苦。";
                    }
                    else {
                        msg = msg + "学习好，比较要强。";
                    }
                }
                else { /// 身弱
                    msg = msg + "学习好，有个性。";
                }
                if( m_selfStrength == 0 ) {
                    String strUse = "";
                    switch (feDayGan) {
                        case "金": strUse = "木"; break;
                        case "木": strUse = "土"; break;
                        case "水": strUse = "火"; break;
                        case "火": strUse = "金"; break;
                        case "土": strUse = "水"; break;
                        default: break;
                    }
                    arrAnalysis.add("本大运喜用为" + strUse + ", " + fnWuHelp(strUse));
                }
            }
            else if( heShenBigZhi.equals("比") || heShenBigZhi.equals("劫")) { // 印比
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，胆小，不吃苦，比较调皮。";
                    }
                    else {
                        msg = msg + "学习好，比较调皮。";
                    }
                }
                else { /// 身弱
                    msg = msg + "学习好，比较要强。";
                }
                if( m_selfStrength == 0 ) {
                    String strUse = "";
                    switch (feDayGan) {
                        case "金": strUse = "木"; break;
                        case "木": strUse = "土"; break;
                        case "水": strUse = "火"; break;
                        case "火": strUse = "金"; break;
                        case "土": strUse = "水"; break;
                        default: break;
                    }
                    arrAnalysis.add("本大运喜用为" + strUse + ", " + fnWuHelp(strUse));
                }
            }
            else if( heShenBigZhi.equals("食") || heShenBigZhi.equals("伤")) {  // 印食
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，胆小，不吃苦，比较调皮。";
                    }
                    else {
                        msg = msg + "学习好，表现好。";
                    }
                }
                else { /// 身弱
                    msg = msg + "学习好，有些任性。";
                }
                if( m_selfStrength == 0 ) {
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
            else if( heShenBigZhi.equals("财") || heShenBigZhi.equals("才")) { // 印财
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "虽然学习有波动，不会太差。";
                }
                else { /// 身弱
                    msg = msg + "虽然学习有波动，最后不太好。";
                }
                if( m_selfStrength == 0 ) {
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
        }
        else if( heShenBigGan.equals("比") || heShenBigGan.equals("劫")) {
            if( heShenBigZhi.equals("官") || heShenBigZhi.equals("煞")) { // 比官
                if( (shenYin + shenXiao) >= 3 ) {
                    msg = msg + "学习不好，";
                }
                else {
                    msg = msg + "学习好，";
                }
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "比较懂事，比较要强。";
                }
                else { /// 身弱
                    msg = msg + "爱惹事，比较任性。";
                }
                if( m_selfStrength == 0 ) {
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
            else if( heShenBigZhi.equals("印") || heShenBigZhi.equals("枭")) { // 比印
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，胆小，不吃苦，比较调皮。";
                    }
                    else {
                        msg = msg + "学习好，比较调皮。";
                    }
                }
                else { /// 身弱
                    msg = msg + "学习好，比较要强。";
                }
                if( m_selfStrength == 0 ) {
                    String strUse = "";
                    switch (feDayGan) {
                        case "金": strUse = "木"; break;
                        case "木": strUse = "土"; break;
                        case "水": strUse = "火"; break;
                        case "火": strUse = "金"; break;
                        case "土": strUse = "水"; break;
                        default: break;
                    }
                    arrAnalysis.add("本大运喜用为" + strUse + ", " + fnWuHelp(strUse));
                }
            }
            else if( heShenBigZhi.equals("比") || heShenBigZhi.equals("劫")) { // 比比
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "学习一般，比较任性。";
                }
                else { /// 身弱
                    msg = msg + "学习一般，比较要强。";
                }
                if( m_selfStrength == 0 ) {
                    String strUse = "";
                    switch (feDayGan) {
                        case "金": strUse = "木"; break;
                        case "木": strUse = "土"; break;
                        case "水": strUse = "火"; break;
                        case "火": strUse = "金"; break;
                        case "土": strUse = "水"; break;
                        default: break;
                    }
                    arrAnalysis.add("本大运喜用为" + strUse + ", " + fnWuHelp(strUse));
                }
            }
            else if( heShenBigZhi.equals("食") || heShenBigZhi.equals("伤")) { // 比食
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，胆小，不吃苦，比较调皮。";
                    }
                    else {
                        msg = msg + "学习一般，比较要强，表现好。";
                    }
                }
                else { /// 身弱
                    msg = msg + "学习一般，比较要强，有些任性。";
                }
                if( m_selfStrength == 0 ) {
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
            else if( heShenBigZhi.equals("财") || heShenBigZhi.equals("才")) { // 比财
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "不爱学习，比较任性。";
                }
                else { /// 身弱
                    msg = msg + "不爱学习，比较要强。";
                }
                if( m_selfStrength == 0 ) {
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
        }
        else if( heShenBigGan.equals("食") || heShenBigGan.equals("伤")) {
            if( heShenBigZhi.equals("官") || heShenBigZhi.equals("煞")) { // 食官
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "比较懂事，有才艺，表现好。";
                }
                else { /// 身弱
                    msg = msg + "比较调皮，易有病。";
                }
                if( m_selfStrength == 0 ) {
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
            else if( heShenBigZhi.equals("印") || heShenBigZhi.equals("枭")) { // 食印
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，胆小，不吃苦，比较调皮。";
                    }
                    else {
                        msg = msg + "学习好，表现好。";
                    }
                }
                else { /// 身弱
                    msg = msg + "学习好，有些任性。";
                }
                if( m_selfStrength == 0 ) {
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
            else if( heShenBigZhi.equals("比") || heShenBigZhi.equals("劫")) { // 食比
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，胆小，不吃苦，比较调皮。";
                    }
                    else {
                        msg = msg + "学习一般，比较要强，表现好。";
                    }
                }
                else { /// 身弱
                    msg = msg + "学习一般，比较要强，有些任性。";
                }
                if( m_selfStrength == 0 ) {
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
            else if( heShenBigZhi.equals("食") || heShenBigZhi.equals("伤")) { // 食食
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "学习一般，有才艺，表现好。";
                }
                else { /// 身弱
                    msg = msg + "学习一般，有些任性，易有病。";
                }
                if( m_selfStrength == 0 ) {  /// 用比劫做喜用
                    arrAnalysis.add("本大运喜用为" + feDayGan + ", " + fnWuHelp(feDayGan));
                }
            }
            else if( heShenBigZhi.equals("财") || heShenBigZhi.equals("才")) { // 食财
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "不爱学习，有才艺，表现好。";
                }
                else { /// 身弱
                    msg = msg + "不爱学习，有些任性，易有病。";
                }
                if( m_selfStrength == 0 ) {  /// 用比劫做喜用
                    arrAnalysis.add("本大运喜用为" + feDayGan + ", " + fnWuHelp(feDayGan));
                }
            }
        }
        else if( heShenBigGan.equals("财") || heShenBigGan.equals("才")) {
            if( heShenBigZhi.equals("官") || heShenBigZhi.equals("煞")) { // 财官
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "比较懂事，讨人喜欢，不爱学习。";
                }
                else { /// 身弱
                    msg = msg + "爱惹事。不爱学习。易有病。";
                }
                if( m_selfStrength == 0 ) {
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
            else if( heShenBigZhi.equals("印") || heShenBigZhi.equals("枭")) { // 财印
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "虽然学习有波动，不会太差。";
                }
                else { /// 身弱
                    msg = msg + "虽然学习有波动，最后不太好。";
                }
                if( m_selfStrength == 0 ) {
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
            else if( heShenBigZhi.equals("比") || heShenBigZhi.equals("劫")) { // 财比
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "不爱学习，比较任性。";
                }
                else { /// 身弱
                    msg = msg + "不爱学习，比较要强。";
                }
                if( m_selfStrength == 0 ) {
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
            else if( heShenBigZhi.equals("食") || heShenBigZhi.equals("伤")) { // 财食
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "不爱学习，有才艺，表现好。";
                }
                else { /// 身弱
                    msg = msg + "不爱学习，有些任性，易有病。";
                }
                if( m_selfStrength == 0 ) {  /// 用比劫做喜用
                    arrAnalysis.add("本大运喜用为" + feDayGan + ", " + fnWuHelp(feDayGan));
                }
            }
            else if( heShenBigZhi.equals("财") || heShenBigZhi.equals("才")) { // 财财
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "不爱学习。有压力。";
                }
                else { /// 身弱
                    msg = msg + "不爱学习，有压力，易有病。";
                }
                if( m_selfStrength == 0 ) {  /// 用比劫做喜用
                    arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
                }
            }
        }
        arrAnalysis.add(msg);
        return arrAnalysis;
    }

    if( heShenBigGan.equals("官") || heShenBigGan.equals("煞")) {
        if( heShenBigZhi.equals("官") || heShenBigZhi.equals("煞")) { // 官官
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 大运相对较好，事业有发展。";
                if( (shenBi + shenJie ) >= 2 ) {
                    msg = msg + "有同事或者朋友帮忙解决事业问题。";
                }
                if( (shenYin + shenXiao ) >= 2 ) {
                    msg = msg + "有长辈或者贵人帮忙解决事业问题。";
                }
            }
            else { /// 身弱
                if( m_selfStrength == 1 ) { /// 命局身强
                    msg = msg + "大运相对较好，事业有发展。";
                }
                else {
                    msg = msg + "大运相对不好，即使有仕途，但工作压力变大，或者会有官司缠身。";
                }
                if( shenShang > 0 && (shenYin + shenXiao) == 0 ) {
                    msg = msg + "有伤官，" + "有官司缠身的概率较大。";
                }
            }
            if( !heShenBigGan.equals(heShenBigZhi) ) {
                msg = msg + "官杀混杂，" + "事业易有波折。";
            }

            if( sex.equals("女")) {
                if( (shenGuan + shenSha) <= 2 ) {
                    msg = msg + "女生走官运，" + "可能会有婚姻变动。";                 
                }
                else {
                    msg = msg + "有异性缘，或者婚姻有变动。";
                    if( feDown > feUp ) {
                        msg = msg + "易有情色纠纷。";
                    }
                }
            }

            if( m_selfStrength == 0 ) {
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
        else if( heShenBigZhi.equals("印") || heShenBigZhi.equals("枭")) { // 官印
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenYin + shenXiao) > 3) {
                    msg = msg + " 大运相对一般，事业有发展，对财运不好，感到无助。";
                }
                else {
                    msg = msg + " 大运相对较好，事业有发展，有贵人相助。在学业，技术等方面可有提高。对财运不好。";
                }

            }
            else { /// 身弱
                msg = msg + " 大运相对一般，事业有发展。学业，技术等方面可有提高。对财运不好。";
            }
            if( sex.equals("女")) {
                if( (shenGuan + shenSha) <= 1 ) {
                    msg = msg + "女生走官运，可能会有婚姻变动。";
                }
                else {
                    msg = msg + "有异性缘，或者婚姻有变动。";
                }
            }
            if( m_selfStrength == 0 ) {
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
        else if( heShenBigZhi.equals("比") || heShenBigZhi.equals("劫")) { // 官比
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 大运相对较好，事业发展较好，有同事或者朋友相助。";
            }
            else { /// 身弱
                msg = msg + " 大运相对一般，事业有发展。财运可能会变好一些。";
            }
            if( sex.equals("女")) {
                if( (shenGuan + shenSha) <= 1 ) {
                    msg = msg + "女生走官运，可能会有婚姻变动。";
                }
                else {
                    msg = msg + "有异性缘，或者婚姻有变动。";
                }
            }
            if( m_selfStrength == 0 ) {
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
        else if( heShenBigZhi.equals("食") || heShenBigZhi.equals("伤")) { // 官食
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenYin + shenXiao) > 0) {
                    if( (shenCaip + shenCaiz) > 0 ) {
                        msg = msg + "有印克制食伤，"+ "大运相对较好，财运官运都有发展和变化。";
                    }
                    else {
                        msg = msg + " 有印克制食伤，" + "大运相对还行，事业有发展和变化。";
                    }
                }
                else {
                    msg = msg + " 无印克制，" + "大运相对一般，事业有波动，但是往好的方向发展。";
                }
            }
            else { /// 身弱
                if( zpSheng >= zpKe ) {
                    msg = msg + " 大运相对较好，事业有波动，但是往好的方向发展。";
                }
                else {
                    msg = msg + " 大运相对不好，事业波动下行，还有可能官司缠身。易得伤病。";
                }
            }
            if( sex.equals("女")) {
                if( (shenGuan + shenSha) <= 1 ) {
                    msg = msg + "女生走官运，可能会有异性缘，但不易成婚。";
                }
                else {
                    msg = msg + "有异性缘，也容易伤及家庭。";
                }
            }
            if( m_selfStrength == 0 ) {
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
        else if( heShenBigZhi.equals("财") || heShenBigZhi.equals("才")) { // 官财
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 大运相对较好，财运官运都有发展。";
            }
            else { /// 身弱
                if( zpSheng >= zpKe ) {
                    msg = msg+ " 大运相对较好，财运官运都有发展。";
                }
                else {
                    msg = msg + " 大运相对不好，事业有波动，财运有波动，或者往好的方向发展则很辛苦，或者往不好方向发展。天克地冲易得伤病。";
                }
            }
            if( sex.equals("女")) {
                if( (shenGuan + shenSha) <= 1 ) {
                    msg = msg + "女生走官运，可能会有婚姻变动。";
                }
                else {
                    msg = msg + "有异性缘，或者婚姻有变动。";
                }
            }
            if( sex.equals("男")) {
                if( (shenCaip + shenCaiz) <= 1 ) {
                    msg = msg + "可能会有婚姻变动。";
                }
                else {
                    msg = msg + "有异性缘，或者婚姻有变动。";
                }
            }
            if( m_selfStrength == 0 ) {
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
    }
    else if( heShenBigGan.equals("印") || heShenBigGan.equals("枭")) {
        if( heShenBigZhi.equals("官") || heShenBigZhi.equals("煞")) { // 印官
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenYin + shenXiao) > 3 ) {
                    msg = msg + " 大运相对一般，事业有发展，对财运不好。感到无助，可能会名誉受损。";
                }
                else {
                    msg = msg + " 大运相对较好，事业有发展，有贵人相助。在学业，技术等方面可有提高。对财运不好。";
                }
            }
            else { /// 身弱
                if( (shenGuan + shenSha) > 3) {
                    msg = msg + " 大运相对一般，事业不顺。学业，技术等方面可有提高。";
                }
                else {
                    msg = msg + " 大运相对一般，事业不顺，财运稍好。学业，技术等方面可有提高。";
                }
            }
            if( sex.equals("女")) {
                if( (shenGuan + shenSha) <= 1 ) {
                    msg = msg + "女生走官运，可能会有婚姻。";
                }
                else {
                    msg = msg + "有异性缘，或者婚姻有变动。";
                }
            }
            if( m_selfStrength == 0 ) {
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
        else if( heShenBigZhi.equals("印") || heShenBigZhi.equals("枭")) { // 印印
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenYin + shenXiao) > 3 ) {
                    msg = msg + " 大运相对不好，对财运不好。感到无助，可能会名誉受损。";
                }
                else {
                    msg = msg + "大运相对不好，财运官运都不顺利。在学业，技术等方面可有提高。";
                }
            }
            else { /// 身弱
                msg = msg + " 大运相对较好，学业，技术等方面可有提高。有人相帮，各个方面都会顺利。财运不佳。";
            }
            if( m_selfStrength == 0 ) {
                String strUse = "";
                switch (feDayGan) {
                    case "金": strUse = "木"; break;
                    case "木": strUse = "土"; break;
                    case "水": strUse = "火"; break;
                    case "火": strUse = "金"; break;
                    case "土": strUse = "水"; break;
                    default: break;
                }
                arrAnalysis.add("本大运喜用为" + strUse + ", " + fnWuHelp(strUse));
            }
        }
        else if( heShenBigZhi.equals("比") || heShenBigZhi.equals("劫")) { // 印比
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenYin + shenXiao) > 3 ) {
                    msg = msg + " 大运相对不好，对财运不好，被亲朋所累，感到无助。可能会名誉受损。";
                }
                else {
                    msg = msg + "大运相对不好，对财运不好，被亲朋所累。";
                }
            }
            else { /// 身弱
                msg = msg + " 大运相对较好，学业，技术等方面可有提高。有人相帮，有同事朋友相助，各个方面都会顺利。";
            }
            if( m_selfStrength == 0 ) {
                String strUse = "";
                switch (feDayGan) {
                    case "金": strUse = "木"; break;
                    case "木": strUse = "土"; break;
                    case "水": strUse = "火"; break;
                    case "火": strUse = "金"; break;
                    case "土": strUse = "水"; break;
                    default: break;
                }
                arrAnalysis.add("本大运喜用为" + strUse + ", " + fnWuHelp(strUse));
            }
        }
        else if( heShenBigZhi.equals("食") || heShenBigZhi.equals("伤")) { // 印食
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenCaip + shenCaiz) > 0 ) {
                    msg = msg + " 大运相对较好，财运有发展机会，事业有波动。";
                }
                else {
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + " 大运相对一般，财运和事业有波动，感到无助。可能会名誉受损。";
                    }
                    else {
                        msg = msg + " 大运相对一般，事业和财运会有波动，相对向好的方向发展。";
                    }
                }
            }
            else { /// 身弱
                msg = msg + " 大运相对一般，学业，技术等方面可有提高。财运会有发展的机会，事业有波动。";
            }
            if( sex.equals("女")) {
                if( (shenGuan + shenSha) > 0 ) {
                    msg = msg + "对家庭或婚姻有不好的影响。";
                }
            }
            if( m_selfStrength == 0 ) {
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
        else if( heShenBigZhi.equals("财") || heShenBigZhi.equals("才")) { // 印财
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenShi + shenShang) > 0 ) {
                    msg = msg + " 大运相对较好，财运较好。";
                }
                else {
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + " 大运相对一般，感到无助，可能会名誉受损。财运会有波动，相对向好的方向发展。";
                    }
                    else {
                        msg = msg + " 大运相对一般，财运和事业会有波动，相对向好的方向发展。";
                    }
                }
            }
            else { /// 身弱
                msg = msg + " 大运相对一般，学业，技术等方面可有提高。或者财运或者事业会有波动。";
            }
            if( sex.equals("男")) {
                if( (shenCaip + shenCaiz) <= 1 ) {
                    msg = msg + "可能会有婚姻变动。";
                }
                else {
                    msg = msg + "有异性缘，或者婚姻有变动。";
                }
            }
            if( m_selfStrength == 0 ) {
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
    }
    else if( heShenBigGan.equals("比") || heShenBigGan.equals("劫")) {
        if( heShenBigZhi.equals("官") || heShenBigZhi.equals("煞")) { // 比官
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 大运相对较好，事业发展较好，有同事或者朋友相助。";
            }
            else { /// 身弱
                msg = msg + " 大运相对一般，事业有发展。财运可能会变好一些。";
            }
            if( sex.equals("女")) {
                if( (shenGuan + shenSha) <= 1 ) {
                    msg = msg + "女生走官运，可能会有婚姻变动。";
                }
                else {
                    msg = msg + "有异性缘，或者婚姻有变动。";
                }
            }
            if( m_selfStrength == 0 ) {
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
        else if( heShenBigZhi.equals("印") || heShenBigZhi.equals("枭")) { // 比印
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenYin + shenXiao) > 3 ) {
                    msg = msg + " 大运相对不好，对财运不好，被亲朋所累，感到无助。可能会名誉受损。";
                }
                else {
                    msg = msg + "大运相对不好，对财运不好，被亲朋所累。";
                }
            }
            else { /// 身弱
                msg = msg + " 大运相对较好，学业，技术等方面可有提高。有人相帮，有同事朋友相助，各个方面都会顺利。";
            }
            if( m_selfStrength == 0 ) {
                String strUse = "";
                switch (feDayGan) {
                    case "金": strUse = "木"; break;
                    case "木": strUse = "土"; break;
                    case "水": strUse = "火"; break;
                    case "火": strUse = "金"; break;
                    case "土": strUse = "水"; break;
                    default: break;
                }
                arrAnalysis.add("本大运喜用为" + strUse + ", " + fnWuHelp(strUse));
            }
        }
        else if( heShenBigZhi.equals("比") || heShenBigZhi.equals("劫")) { // 比比
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 大运相对不好，对财运和事业不好，被亲朋所累。";
            }
            else { /// 身弱
                msg = msg + " 大运相对一般，有同事朋友相助，事业相对顺利。财运相对变好一些。";
            }
            if( m_selfStrength == 0 ) {
                String strUse = "";
                switch (feDayGan) {
                    case "金": strUse = "木"; break;
                    case "木": strUse = "土"; break;
                    case "水": strUse = "火"; break;
                    case "火": strUse = "金"; break;
                    case "土": strUse = "水"; break;
                    default: break;
                }
                arrAnalysis.add("本大运喜用为" + strUse + ", " + fnWuHelp(strUse));
            }
        }
        else if( heShenBigZhi.equals("食") || heShenBigZhi.equals("伤")) { // 比食
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenCaip + shenCaiz) > 0) {
                    msg = msg + " 大运相对一般，有财运，易被亲朋所累，事业有波动。";
                }
                else {
                    msg = msg + " 大运相对一般，被亲朋所累，事业往不利的方向有点儿波动。";
                }
            }
            else { /// 身弱
                msg = msg + " 大运相对不好，虽然有亲友相帮，事业有波动相对向不利方向发展。";
            }
            if( sex.equals("女")) {
                if( (shenGuan + shenSha) > 0 ) {
                    msg = msg + "对家庭或婚姻有不好的影响。";
                }
            }
            if( m_selfStrength == 0 ) {
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
        else if( heShenBigZhi.equals("财") || heShenBigZhi.equals("才")) { // 比财
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 大运相对较好，会有财运，小心亲朋夺财，事业有波动。";
            }
            else { /// 身弱
                msg = msg + " 大运相对一般，会有点儿财运，但要小心努力获取。";
            }
            if( sex.equals("男")) {
                if( (shenCaip + shenCaiz) <= 1 ) {
                    msg = msg + "可能会有婚姻变动。";
                }
                else {
                    msg = msg + "有异性缘，或者婚姻有变动。";
                }
            }
            if( m_selfStrength == 0 ) {
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
    }
    else if( heShenBigGan.equals("食") || heShenBigGan.equals("伤")) {
        if( heShenBigZhi.equals("官") || heShenBigZhi.equals("煞")) { // 食官 
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenYin + shenXiao) > 0) {
                    if( (shenCaip + shenCaiz) > 0 ) {
                        msg = msg + "有印克制食伤，"+ "大运相对较好，财运官运都有发展和变化。";
                    }
                    else {
                        msg = msg + " 有印克制食伤，" + "大运相对还行，事业有发展和变化。";
                    }
                }
                else {
                    msg = msg + " 无印克制，" + "大运相对一般，事业有波动，但是往好的方向发展。";
                }
            }
            else { /// 身弱
                if( zpSheng >= zpKe ) {
                    msg = msg + " 大运相对较好，事业有波动，但是往好的方向发展。";
                }
                else {
                    msg = msg + " 大运相对不好，事业波动下行，还有可能官司缠身。易得伤病。";
                }
            }
            if( sex.equals("女")) {
                if( (shenGuan + shenSha) <= 1 ) {
                    msg = msg + "女生走官运，可能会有异性缘，但不易成婚。";
                }
                else {
                    msg = msg + "有异性缘，也容易伤及家庭。";
                }
            }
            if( m_selfStrength == 0 ) {
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
        else if( heShenBigZhi.equals("印") || heShenBigZhi.equals("枭")) { // 食印
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenCaip + shenCaiz) > 0 ) {
                    msg = msg + " 大运相对较好，财运有发展机会，事业有波动。";
                }
                else {
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + " 大运相对一般，财运和事业有波动，感到无助。可能会名誉受损。";
                    }
                    else {
                        msg = msg + " 大运相对一般，事业和财运会有波动，相对向好的方向发展。";
                    }
                }
            }
            else { /// 身弱
                msg = msg + " 大运相对一般，学业，技术等方面可有提高。财运会有发展的机会，事业有波动。";
            }
            if( sex.equals("女")) {
                if( (shenGuan + shenSha) > 0 ) {
                    msg = msg + "对家庭或婚姻有不好的影响。";
                }
            }
            if( m_selfStrength == 0 ) {
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
        else if( heShenBigZhi.equals("比") || heShenBigZhi.equals("劫")) { // 食比
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenCaip + shenCaiz) > 0) {
                    msg = msg + " 大运相对一般，有财运，易被亲朋所累，事业有波动。";
                }
                else {
                    msg = msg + " 大运相对一般，被亲朋所累，事业往不利的方向有点儿波动。";
                }
            }
            else { /// 身弱
                msg = msg + " 大运相对不好，虽然有亲友相帮，事业有波动相对向不利方向发展。";
            }
            if( sex.equals("女")) {
                if( (shenGuan + shenSha) > 0 ) {
                    msg = msg + "对家庭或婚姻有不好的影响。";
                }
            }
            if( m_selfStrength == 0 ) {
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
        else if( heShenBigZhi.equals("食") || heShenBigZhi.equals("伤")) { // 食食
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenCaip + shenCaiz) > 0) {
                    msg = msg + " 大运相对一般，有财运，事业有波动。";
                }
                else {
                    msg = msg + " 大运相对不好，事业有波动。易得小伤小病。";
                }
            }
            else { /// 身弱
                msg = msg + " 大运相对不好，对事业不好。易破财，易得伤病。";
            }
            if( sex.equals("女")) {
                if( (shenGuan + shenSha) > 0 ) {
                    msg = msg + "对家庭或婚姻有不好的影响。";
                }
            }
            if( m_selfStrength == 0 ) {  /// 用比劫做喜用
                arrAnalysis.add("本大运喜用为" + feDayGan + ", " + fnWuHelp(feDayGan));
            }
        }
        else if( heShenBigZhi.equals("财") || heShenBigZhi.equals("才")) { // 食财
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 大运相对较好，有财运。事业有发展。";
            }
            else { /// 身弱
                msg = msg + " 大运相对不好，对事业不好。易破财，易得伤病。";
            }
            if( sex.equals("女")) {
                if( (shenGuan + shenSha) > 0 ) {
                    msg = msg + "对家庭或婚姻有不好的影响。";
                }
            }
            if( sex.equals("男")) {
                if( (shenCaip + shenCaiz) <= 1 ) {
                    msg = msg + "可能会有婚姻。";
                }
                else {
                    msg = msg + "有异性缘，或者婚姻有变动。";
                }
            }
            if( m_selfStrength == 0 ) {  /// 用比劫做喜用
                arrAnalysis.add("本大运喜用为" + feDayGan + ", " + fnWuHelp(feDayGan));
            }
        }
    }
    else if( heShenBigGan.equals("财") || heShenBigGan.equals("才")) {
        if( heShenBigZhi.equals("官") || heShenBigZhi.equals("煞")) { // 财官 
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 大运相对较好，财运官运都有发展。";
            }
            else { /// 身弱
                if( zpSheng >= zpKe ) {
                    msg = msg+ " 大运相对较好，财运官运都有发展。";
                }
                else {
                    msg = msg + " 大运相对不好，事业有波动，财运有波动，或者往好的方向发展则很辛苦，或者往不好方向发展。天冲地克易得伤病。";
                }
            }
            if( sex.equals("女")) {
                if( (shenGuan + shenSha) <= 1 ) {
                    msg = msg + "女生走官运，可能会有婚姻变动。";
                }
                else {
                    msg = msg + "有异性缘，或者婚姻有变动。";
                }
            }
            if( sex.equals("男")) {
                if( (shenCaip + shenCaiz) <= 1 ) {
                    msg = msg + "可能会有婚姻变动。";
                }
                else {
                    msg = msg + "有异性缘，或者婚姻有变动。";
                }
            }
            if( m_selfStrength == 0 ) {
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
        else if( heShenBigZhi.equals("印") || heShenBigZhi.equals("枭")) { // 财印 
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenShi + shenShang) > 0 ) {
                    msg = msg + " 大运相对较好，财运较好。";
                }
                else {
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + " 大运相对一般，感到无助，可能会名誉受损。财运会有波动，相对向好的方向发展。";
                    }
                    else {
                        msg = msg + " 大运相对一般，财运和事业会有波动，相对向好的方向发展。";
                    }
                }
            }
            else { /// 身弱
                msg = msg + " 大运相对一般，学业，技术等方面可有提高。或者财运或者事业会有波动。";
            }
            if( sex.equals("男")) {
                if( (shenCaip + shenCaiz) <= 1 ) {
                    msg = msg + "可能会有婚姻变动。";
                }
                else {
                    msg = msg + "有异性缘，或者婚姻有变动。";
                }
            }
            if( m_selfStrength == 0 ) {
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
        else if( heShenBigZhi.equals("比") || heShenBigZhi.equals("劫")) { // 财比 
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 大运相对较好，会有财运，小心亲朋夺财，事业有波动。";
            }
            else { /// 身弱
                msg = msg + " 大运相对一般，会有点儿财运，但要小心努力获取。";
            }
            if( sex.equals("男")) {
                if( (shenCaip + shenCaiz) <= 1 ) {
                    msg = msg + "可能会有婚姻变动。";
                }
                else {
                    msg = msg + "有异性缘，或者婚姻有变动。";
                }
            }
            if( m_selfStrength == 0 ) {
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
        else if( heShenBigZhi.equals("食") || heShenBigZhi.equals("伤")) { // 财食
            if( feUp >= feDown || m_selfStrength > 0 ) {  /// 身强
                msg = msg + " 大运相对较好，有财运。事业有发展。";
            }
            else { /// 身弱
                msg = msg + " 大运相对不好，对事业不好。易破财，易得伤病。";
            }
            if( sex.equals("女")) {
                if( (shenGuan + shenSha) > 0 ) {
                    msg = msg + "对家庭或婚姻有不好的影响。";
                }
            }
            if( sex.equals("男")) {
                if( (shenCaip + shenCaiz) <= 1 ) {
                    msg = msg + "可能会有婚姻变动。";
                }
                else {
                    msg = msg + "有异性缘，或者婚姻有变动。";
                }
            }
            if( m_selfStrength == 0 ) {  /// 用比劫做喜用
                arrAnalysis.add("本大运喜用为" + feDayGan + ", " + fnWuHelp(feDayGan));
            }
        }
        else if( heShenBigZhi.equals("财") || heShenBigZhi.equals("才")) { // 财财
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 大运相对较好，有财运，事业有发展。";
            }
            else { /// 身弱
                msg = msg + " 大运相对不好，对事业不好。易破财。";
            }
            if( sex.equals("男")) {
                if( (shenCaip + shenCaiz) <= 2 ) {
                    msg = msg + "可能会有婚姻变动。";
                }
                else {
                    msg = msg + "有异性缘，或者婚姻有变动。";
                }
            }
            if( m_selfStrength == 0 ) {  /// 用比劫做喜用
                arrAnalysis.add("本大运喜用为" + feUse1 + ", " + fnWuHelp(feUse1));
            }
        }
    }

    arrAnalysis.add(msg);
    //#endregion

    /// 神煞，天乙贵人，驿马
    if( fnComputeTianYi(dayGan, heBigZhi) ) {
        msg = "大运有贵人相帮。";
        arrAnalysis.add(msg);
    }
    if( fnComputeYiMa(dayZhi, heBigZhi) ) {
        msg = "有驿马：事业有变动，或者生活有变迁，或者长期出差在外。";
        arrAnalysis.add(msg);
    }
    else if( fnComputeYiMa(yearZhi, heBigZhi) ) {
        msg = "有驿马：事业有变动，或者生活有变迁，或者长期出差在外。";
        arrAnalysis.add(msg);
    }

    return arrAnalysis;
}

public List<String> fnBaziLiuNianAnalysis(
    String sex, Integer startYear, Integer age,
    String yearGan, String yearZhi, 
    String monthGan, String monthZhi, 
    String dayGan, String dayZhi, 
    String hourGan, String hourZhi,
    String bigGan, String bigZhi,
    String liuGan, String liuZhi) {
        
    ArrayList<String> arrAnalysis = new ArrayList<String>();
    ArrayList<String> arrHeChong = new ArrayList<String>();

    String msg;

    boolean he = false;

    String shenYearGan = "";
    String shenYearZhi = "";
    String shenMonthGan = "";
    String shenMonthZhi = "";
    String shenDayZhi = "";
    String shenHourGan = "";
    String shenHourZhi = "";
    String shenBigGan = "";
    String shenBigZhi = "";
    String shenLiuGan = "";
    String shenLiuZhi = "";

    String feYearGan = "";          /// 年干五行
    String feYearZhi = "";          /// 年支五行
    String feMonthGan = "";          /// 月干五行
    String feMonthZhi = "";          /// 月支五行
    String feDayGan = "";          /// 日干五行
    String feDayZhi = "";          /// 日支五行
    String feHourGan = "";          /// 时干五行
    String feHourZhi = "";          /// 时支五行
    String feBigGan = "";          /// 大运干五行
    String feBigZhi = "";          /// 大运支五行
    String feLiuGan = "";          /// 流年干五行
    String feLiuZhi = "";          /// 流年支五行

    String  feUse1 = m_feUse1;
    String  feUse2 = m_feUse2;

    String  heYearGan = yearGan;
    String  heYearZhi = yearZhi;
    String  heMonthGan = monthGan;
    String  heMonthZhi = monthZhi;
    String  heDayZhi = dayZhi;
    String  heHourGan = hourGan;
    String  heHourZhi = hourZhi;
    String  heBigGan = bigGan;
    String  heBigZhi = bigZhi;
    String  heLiuGan = liuGan;
    String  heLiuZhi = liuZhi;

    /// 合后的十神
    String heShenYearGan = "";
    String heShenYearZhi = "";
    String heShenMonthGan = "";
    String heShenMonthZhi = "";
    String heShenDayZhi = "";
    String heShenHourGan = "";
    String heShenHourZhi = "";
    String heShenBigGan = "";
    String heShenBigZhi = "";
    String heShenLiuGan = "";
    String heShenLiuZhi = "";

    Integer feUp, feDown, feUp2;       /// 五行生克个数, feup2是紧挨日干的生克个数

    shenYearGan = fnComputeShishen(dayGan, yearGan);
    shenYearZhi = fnComputeShishen(dayGan, yearZhi);
    shenMonthGan = fnComputeShishen(dayGan, monthGan);
    shenMonthZhi = fnComputeShishen(dayGan, monthZhi);
    shenDayZhi = fnComputeShishen(dayGan, dayZhi);
    shenHourGan = fnComputeShishen(dayGan, hourGan);
    shenHourZhi = fnComputeShishen(dayGan, hourZhi);
    shenBigGan = fnComputeShishen(dayGan, bigGan);
    shenBigZhi = fnComputeShishen(dayGan, bigZhi);
    shenLiuGan = fnComputeShishen(dayGan, liuGan);
    shenLiuZhi = fnComputeShishen(dayGan, liuZhi);
    
    heShenYearGan = shenYearGan;
    heShenYearZhi = shenYearZhi;
    heShenMonthGan = shenMonthGan;
    heShenMonthZhi = shenMonthZhi;
    heShenDayZhi = shenDayZhi;
    heShenHourGan = shenHourGan;
    heShenHourZhi = shenHourZhi;
    heShenBigGan = shenBigGan;
    heShenBigZhi = shenBigZhi;
    heShenLiuGan = shenLiuGan;
    heShenLiuZhi = shenLiuZhi;

    feYearGan = fnGz2Wu2(yearGan);
    feYearZhi = fnGz2Wu2(yearZhi);
    feMonthGan = fnGz2Wu2(monthGan);
    feMonthZhi = fnGz2Wu2(monthZhi);
    feDayGan = fnGz2Wu2(dayGan);
    feDayZhi = fnGz2Wu2(dayZhi);
    feHourGan = fnGz2Wu2(hourGan);
    feHourZhi = fnGz2Wu2(hourZhi);

    feBigGan = fnGz2Wu2(bigGan);
    feBigZhi = fnGz2Wu2(bigZhi);
    feLiuGan = fnGz2Wu2(liuGan);
    feLiuZhi = fnGz2Wu2(liuZhi);

    msg = startYear + "年 " + (age < 10 ? "0" + age: age.toString()) + "岁 " + liuGan + liuZhi + " 流年，行 " + 
    shenLiuGan + shenLiuZhi + " 运。";
    arrAnalysis.add(msg);

    /// 大运地支合 
    //#region 地支三会局
    he = false;
    if( liuZhi.equals("寅") ) {
        if( feLiuGan.equals("木") || feBigGan.equals("木") || 
        feHourGan.equals("木") || feDayGan.equals("木") || 
        feMonthGan.equals("木") || feYearGan.equals("木") ) {

            if( bigZhi.equals("卯") && (hourZhi.equals("辰") || dayZhi.equals("辰") || 
            monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
                if( dayZhi.equals("辰") ) {
                    feDayZhi = "木";
                    heDayZhi = "卯";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);  
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("辰") ) {
                    feMonthZhi = "木";
                    heMonthZhi = "卯";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);  
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("辰") ) {
                    feHourZhi = "木";
                    heHourZhi = "卯";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);
                }
                else if( yearZhi.equals("辰") ) {
                    feYearZhi = "木";
                    heYearZhi = "卯";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }
                he = true;
                if( m_bProfessional ) {
                    msg = "寅卯辰三会木局";
                    arrAnalysis.add(msg);
                }
                }
            else if( bigZhi.equals("辰") && (hourZhi.equals("卯") || dayZhi.equals("卯") ||
            monthZhi.equals("卯") || yearZhi.equals("卯") ) ) {
                feBigZhi = "木";
                heBigZhi = "卯";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                he = true;
                if( m_bProfessional ) {
                    msg = "寅卯辰三会木局";
                    arrAnalysis.add(msg);
                }
                }

        }
    }
    else if( liuZhi.equals("卯")) {
        if( feLiuGan.equals("木") || feBigGan.equals("木") || 
        feHourGan.equals("木") || feDayGan.equals("木") || 
        feMonthGan.equals("木") || feYearGan.equals("木") ) {
            
            if( bigZhi.equals("寅") && (hourZhi.equals("辰") || dayZhi.equals("辰") || 
            monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
                if( dayZhi.equals("辰") ) {
                    feDayZhi = "木";
                    heDayZhi = "卯";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("辰") ) {
                    feMonthZhi = "木";
                    heMonthZhi = "卯";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("辰") ) {
                    feHourZhi = "木";
                    heHourZhi = "卯";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);
                }
                else if( yearZhi.equals("辰") ) {
                    feYearZhi = "木";
                    heYearZhi = "卯";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }
                he = true;            
                if( m_bProfessional ) {
                    msg = "寅卯辰三会木局";
                    arrAnalysis.add(msg);
                }
                }
            else if( bigZhi.equals("辰") && (hourZhi.equals("寅") || dayZhi.equals("寅") ||
            monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
                feBigZhi = "木";
                heBigZhi = "卯";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                he = true;
                if( m_bProfessional ) {
                    msg = "寅卯辰三会木局";
                    arrAnalysis.add(msg);
                }
            }

        }
    }
    else if( liuZhi.equals("辰")) {
        if( feLiuGan.equals("木") || feBigGan.equals("木") || 
        feHourGan.equals("木") || feDayGan.equals("木") || 
        feMonthGan.equals("木") || feYearGan.equals("木") ) {
            
            if( bigZhi.equals("寅") && ( hourZhi.equals("卯") || dayZhi.equals("卯") || 
            monthZhi.equals("卯") || yearZhi.equals("卯") ) ) {
                feLiuZhi = "木";
                heLiuZhi = "卯";
                heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
                he = true;            
                if( m_bProfessional ) {
                    msg = "寅卯辰三会木局";
                    arrAnalysis.add(msg);
                }
                }
            else if( bigZhi.equals("卯") && ( hourZhi.equals("寅") || dayZhi.equals("寅") ||
            monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
                feLiuZhi = "木";
                heLiuZhi = "卯";
                heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
                he = true;            
                if( m_bProfessional ) {
                    msg = "寅卯辰三会木局";
                    arrAnalysis.add(msg);
                }
            }

        }
    }

    if( liuZhi.equals("巳")) {
        if( feLiuGan.equals("火") || feBigGan.equals("火") ||
        feHourGan.equals("火") || feDayGan.equals("火") ||
        feMonthGan.equals("火") || feYearGan.equals("火") ) {

            if( bigZhi.equals("午") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
            monthZhi.equals("未") || yearZhi.equals("未") ) ) {
                if( dayZhi.equals("未") ) {
                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("未") ) {
                    feMonthZhi = "火";
                    heMonthZhi = "午";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("未") ) {
                    feHourZhi = "火";
                    heHourZhi = "午";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);
                }
                else if( yearZhi.equals("未") ) {
                    feYearZhi = "火";
                    heYearZhi = "午";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }
                he = true;
                if( m_bProfessional ) {
                    msg = "巳午未三会火局";
                    arrAnalysis.add(msg);
                }
            }
            else if( bigZhi.equals("未") && ( hourZhi.equals("午") || dayZhi.equals("午") ||
            monthZhi.equals("午") || yearZhi.equals("午") ) ) {
                feBigZhi = "火";
                heBigZhi = "午";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                he = true;
                if( m_bProfessional ) {
                    msg = "巳午未三会火局";
                    arrAnalysis.add(msg);
                }
    
            }

        }
    }    
    else if( liuZhi.equals("午")) {
        if( feLiuGan.equals("火") || feBigGan.equals("火") ||
        feHourGan.equals("火") || feDayGan.equals("火") ||
        feMonthGan.equals("火") || feYearGan.equals("火") ) {

            if( bigZhi.equals("巳") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
            monthZhi.equals("未") || yearZhi.equals("未") ) ) {
                if( dayZhi.equals("未") ) {
                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("未") ) {
                    feMonthZhi = "火";
                    heMonthZhi = "午";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("未") ) {
                    feHourZhi = "火";
                    heHourZhi = "午";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);
                }
                else if( yearZhi.equals("未") ) {
                    feYearZhi = "火";
                    heYearZhi = "午";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }
                he = true; 
                if( m_bProfessional ) {
                    msg = "巳午未三会火局";
                    arrAnalysis.add(msg);
                }                
                
            }
            else if( bigZhi.equals("未") && ( hourZhi.equals("巳") || dayZhi.equals("巳") ||
            monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
                feBigZhi = "火";
                heBigZhi = "午";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                he = true;
                if( m_bProfessional ) {
                    msg = "巳午未三会火局";
                    arrAnalysis.add(msg);
                }
        
            }

        }
    }
    else if( liuZhi.equals("未")) {
        if( feLiuGan.equals("火") || feBigGan.equals("火") ||
        feHourGan.equals("火") || feDayGan.equals("火") ||
        feMonthGan.equals("火") || feYearGan.equals("火") ) {

            if( bigZhi.equals("巳") && ( hourZhi.equals("午") || dayZhi.equals("午") || 
            monthZhi.equals("午") || yearZhi.equals("午") ) ) {
                feLiuZhi = "火";
                heLiuZhi = "午";
                heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
                he = true;
                if( m_bProfessional ) {
                    msg = "巳午未三会火局";
                    arrAnalysis.add(msg);
                }
                    
            }
            else if( bigZhi.equals("午") && ( hourZhi.equals("巳") || dayZhi.equals("巳") ||
            monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
                feLiuZhi = "火";
                heLiuZhi = "午";
                heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
                he = true;
                if( m_bProfessional ) {
                    msg = "巳午未三会火局";
                    arrAnalysis.add(msg);
                }
    
            }
        }
    }

    if( liuZhi.equals("申")) {
        if( feLiuGan.equals("金") || feBigGan.equals("金") ||
        feHourGan.equals("金") || feDayGan.equals("金") ||
        feMonthGan.equals("金") || feYearGan.equals("金") ) {

            if( bigZhi.equals("酉") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
            monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
                if( dayZhi.equals("戌") ) {
                    feDayZhi = "金";
                    heDayZhi = "酉";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("戌") ) {
                    feMonthZhi = "金";
                    heMonthZhi = "酉";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("戌") ) {
                    feHourZhi = "金";
                    heHourZhi = "酉";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);
                }
                else if( yearZhi.equals("戌") ) {
                    feYearZhi = "金";
                    heYearZhi = "酉";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }
                he = true;            
                if( m_bProfessional ) {
                    msg = "申酉戌三会金局";
                    arrAnalysis.add(msg);
                }

            }
            else if( bigZhi.equals("戌") && ( hourZhi.equals("酉") || dayZhi.equals("酉") ||
            monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
                feBigZhi = "金";
                heBigZhi = "酉";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                he = true;
                if( m_bProfessional ) {
                    msg = "申酉戌三会金局";
                    arrAnalysis.add(msg);
                }

            }
        }
    }
    else if( liuZhi.equals("酉")) {
        if( feLiuGan.equals("金") || feBigGan.equals("金") ||
        feHourGan.equals("金") || feDayGan.equals("金") ||
        feMonthGan.equals("金") || feYearGan.equals("金") ) {

            if( bigZhi.equals("申") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
            monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
                if( dayZhi.equals("戌") ) {
                    feDayZhi = "金";
                    heDayZhi = "酉";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("戌") ) {
                    feMonthZhi = "金";
                    heMonthZhi = "酉";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("戌") ) {
                    feHourZhi = "金";
                    heHourZhi = "酉";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);
                }
                else if( yearZhi.equals("戌") ) {
                    feYearZhi = "金";
                    heYearZhi = "酉";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }
                he = true;
                if( m_bProfessional ) {
                    msg = "申酉戌三会金局";
                    arrAnalysis.add(msg);
                }

            }
            else if( bigZhi.equals("戌") && ( hourZhi.equals("申") || dayZhi.equals("申") ||
            monthZhi.equals("申") || yearZhi.equals("申") ) ) {
                feBigZhi = "金";
                heBigZhi = "酉";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                he = true;
                if( m_bProfessional ) {
                    msg = "申酉戌三会金局";
                    arrAnalysis.add(msg);
                }                
            }
        }
    }
    else if( liuZhi.equals("戌")) {
        if( feLiuGan.equals("金") || feBigGan.equals("金") ||
        feHourGan.equals("金") || feDayGan.equals("金") ||
        feMonthGan.equals("金") || feYearGan.equals("金") ) {

            if( bigZhi.equals("申") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || 
            monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
                feLiuZhi = "金";
                heLiuZhi = "酉"; 
                heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
                he = true;

                if( m_bProfessional ) {
                    msg = "申酉戌三会金局";
                    arrAnalysis.add(msg);
                }
            }
            else if( bigZhi.equals("酉") && ( hourZhi.equals("申") || dayZhi.equals("申") ||
            monthZhi.equals("申") || yearZhi.equals("申") ) ) {
                feLiuZhi = "金";
                heLiuZhi = "酉"; 
                heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
                he = true;

                if( m_bProfessional ) {
                    msg = "申酉戌三会金局";
                    arrAnalysis.add(msg);
                }
            }
        }
    }

    if( liuZhi.equals("亥")) {
        if( feLiuGan.equals("水") || feBigGan.equals("水") ||
        feHourGan.equals("水") || feDayGan.equals("水") ||
        feMonthGan.equals("水") || feYearGan.equals("水") ) {

            if( bigZhi.equals("子") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
            monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
                if( dayZhi.equals("丑") ) {
                    feDayZhi = "水";
                    heDayZhi = "子";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("丑") ) {
                    feMonthZhi = "水";
                    heMonthZhi = "子";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("丑") ) {
                    feHourZhi = "水";
                    heHourZhi = "子";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);
                }
                else if( yearZhi.equals("丑") ) {
                    feYearZhi = "水";
                    heYearZhi = "子";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }
                he = true;

                if( m_bProfessional ) {
                    msg = "亥子丑三会水局";
                    arrAnalysis.add(msg);
                }                
            }
            else if( bigZhi.equals("丑") && ( hourZhi.equals("子") || dayZhi.equals("子") ||
            monthZhi.equals("子") || yearZhi.equals("子") ) ) {
                feBigZhi = "水";
                heBigZhi = "子";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                he = true;

                if( m_bProfessional ) {
                    msg = "亥子丑三会水局";
                    arrAnalysis.add(msg);
                }                
            }
        }
    }
    else if( liuZhi.equals("子")) {
        if( feLiuGan.equals("水") || feBigGan.equals("水") ||
        feHourGan.equals("水") || feDayGan.equals("水") ||
        feMonthGan.equals("水") || feYearGan.equals("水") ) {

            if( bigZhi.equals("亥") || ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
            monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
                if( dayZhi.equals("丑") ) {
                    feDayZhi = "水";
                    heDayZhi = "子";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("丑") ) {
                    feMonthZhi = "水";
                    heMonthZhi = "子";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("丑") ) {
                    feHourZhi = "水";
                    heHourZhi = "子";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);
                }
                else if( yearZhi.equals("丑") ) {
                    feYearZhi = "水";
                    heYearZhi = "子";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }
                he = true;

                if( m_bProfessional ) {
                    msg = "亥子丑三会水局";
                    arrAnalysis.add(msg);
                }
            }
            else if( bigZhi.equals("丑") && ( hourZhi.equals("亥") || dayZhi.equals("亥") ||
            monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
                feBigZhi = "水";
                heBigZhi = "子";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                he = true;

                if( m_bProfessional ) {
                    msg = "亥子丑三会水局";
                    arrAnalysis.add(msg);
                }
            }        
        }
    }
    else if( liuZhi.equals("丑")) {
        if( feLiuGan.equals("水") || feBigGan.equals("水") ||
        feHourGan.equals("水") || feDayGan.equals("水") ||
        feMonthGan.equals("水") || feYearGan.equals("水") ) {

            if( bigZhi.equals("亥") && ( hourZhi.equals("子") || dayZhi.equals("子") || 
            monthZhi.equals("子") || yearZhi.equals("子") ) ) {
                feLiuZhi = "水";
                heLiuZhi = "子";
                heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
                he = true;

                if( m_bProfessional ) {
                    msg = "亥子丑三会水局";
                    arrAnalysis.add(msg);
                }
            }
            else if( bigZhi.equals("子") && ( hourZhi.equals("亥") || dayZhi.equals("亥") ||
            monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
                feLiuZhi = "水";
                heLiuZhi = "子";
                heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
                he = true;

                if( m_bProfessional ) {
                    msg = "亥子丑三会水局";
                    arrAnalysis.add(msg);
                }
            }
        }
    }

    //#endregion

    //#region 地支三合局
    if( he == false ) {

        if( liuZhi.equals("亥")) {
            if( feLiuGan.equals("木") || feBigGan.equals("木") || 
            feHourGan.equals("木") || feDayGan.equals("木") || 
            feMonthGan.equals("木") || feYearGan.equals("木") ) {
                if( bigZhi.equals("卯") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
                monthZhi.equals("未") || yearZhi.equals("未") ) ) {
                    feLiuZhi = "木";
                    heLiuZhi = "寅";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);                   
                    if( dayZhi.equals("未") ) {
                        feDayZhi = "木";
                        heDayZhi = "卯";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("未") ) {
                        feMonthZhi = "木";
                        heMonthZhi = "卯";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("未") ) {
                        feHourZhi = "木";
                        heHourZhi = "卯";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("未") ) {
                        feYearZhi = "木";
                        heYearZhi = "卯";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;     
                    
                    if( m_bProfessional ) {
                        msg = "亥卯未三会木局";
                        arrAnalysis.add(msg);
                    }
                }
                else if( bigZhi.equals("未") && ( hourZhi.equals("卯") || dayZhi.equals("卯") ||
                monthZhi.equals("卯") || yearZhi.equals("卯") ) ) {
                    feLiuZhi = "木";
                    heLiuZhi = "寅";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);                   

                    feBigZhi = "木";
                    heBigZhi = "卯";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                    he = true;

                    if( m_bProfessional ) {
                        msg = "亥卯未三会木局";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
        else if( liuZhi.equals("卯")) {
            if( feLiuGan.equals("木") || feBigGan.equals("木") || 
            feHourGan.equals("木") || feDayGan.equals("木") || 
            feMonthGan.equals("木") || feYearGan.equals("木") ) {
                if( bigZhi.equals("亥") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
                monthZhi.equals("未") || yearZhi.equals("未") ) ) {
                    feBigZhi = "木";
                    heBigZhi = "寅";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                    if( dayZhi.equals("未") ) {
                        feDayZhi = "木";
                        heDayZhi = "卯";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("未") ) {
                        feMonthZhi = "木";
                        heMonthZhi = "卯";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("未") ) {
                        feHourZhi = "木";
                        heHourZhi = "卯";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("未") ) {
                        feYearZhi = "木";
                        heYearZhi = "卯";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;       
                    
                    if( m_bProfessional ) {
                        msg = "亥卯未三会木局";
                        arrAnalysis.add(msg);
                    }
                }
                else if( bigZhi.equals("未") && ( hourZhi.equals("亥") || dayZhi.equals("亥") ||
                monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
                    feBigZhi = "木";
                    heBigZhi = "卯";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                    if( dayZhi.equals("亥") ) {
                        feDayZhi = "木";
                        heDayZhi = "寅";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("亥") ) {
                        feMonthZhi = "木";
                        heMonthZhi = "寅";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("亥") ) {
                        feHourZhi = "木";
                        heHourZhi = "寅";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("亥") ) {
                        feYearZhi = "木";
                        heYearZhi = "寅";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;

                    if( m_bProfessional ) {
                        msg = "亥卯未三会木局";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
        else if( liuZhi.equals("未")) {
            if( feLiuGan.equals("木") || feBigGan.equals("木") || 
            feHourGan.equals("木") || feDayGan.equals("木") || 
            feMonthGan.equals("木") || feYearGan.equals("木") ) {
                if( bigZhi.equals("亥") && ( hourZhi.equals("卯") || dayZhi.equals("卯") || 
                monthZhi.equals("卯") || yearZhi.equals("卯") ) ) {
                    feLiuZhi = "木";
                    heLiuZhi = "卯";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                    feBigZhi = "木";
                    heBigZhi = "寅";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                    he = true;

                    if( m_bProfessional ) {
                        msg = "亥卯未三会木局";
                        arrAnalysis.add(msg);
                    }
                }
                else if( bigZhi.equals("卯") && ( hourZhi.equals("亥") || dayZhi.equals("亥") ||
                monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
                    feLiuZhi = "木";
                    heLiuZhi = "卯";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                    if( hourZhi.equals("亥") ) {
                        feHourZhi = "木";
                        heHourZhi = "寅";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( dayZhi.equals("亥") ) {
                        feDayZhi = "木";
                        heDayZhi = "寅";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("亥") ) {
                        feMonthZhi = "木";
                        heMonthZhi = "寅";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("亥") ) {
                        feYearZhi = "木";
                        heYearZhi = "寅";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;

                    if( m_bProfessional ) {
                        msg = "亥卯未三会木局";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }

        if( liuZhi.equals("寅")) {
            if( feLiuGan.equals("火") || feBigGan.equals("火") ||
            feHourGan.equals("火") || feDayGan.equals("火") ||
            feMonthGan.equals("火") || feYearGan.equals("火") ) {
    
                if( bigZhi.equals("午") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
                monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
                    feLiuZhi = "火";
                    heLiuZhi = "巳";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
                    if( dayZhi.equals("戌") ) {
                        feDayZhi = "火";
                        heDayZhi = "午";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("戌") ) {
                        feMonthZhi = "火";
                        heMonthZhi = "午";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("戌") ) {
                        feHourZhi = "火";
                        heHourZhi = "午";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("戌") ) {
                        feYearZhi = "火";
                        heYearZhi = "午";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;  
                    
                    if( m_bProfessional ) {
                        msg = "寅午戌三会火局";
                        arrAnalysis.add(msg);
                    }
                }
                else if( bigZhi.equals("戌") && ( hourZhi.equals("午") || dayZhi.equals("午") ||
                monthZhi.equals("午") || yearZhi.equals("午") ) ) {
                    feLiuZhi = "火";
                    heLiuZhi = "巳";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                    feBigZhi = "火";
                    heBigZhi = "午";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                    he = true;

                    if( m_bProfessional ) {
                        msg = "寅午戌三会火局";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
        else if( liuZhi.equals("午")) {
            if( feLiuGan.equals("火") || feBigGan.equals("火") ||
            feHourGan.equals("火") || feDayGan.equals("火") ||
            feMonthGan.equals("火") || feYearGan.equals("火") ) {
    
                if( bigZhi.equals("寅") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
                monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
                    feBigZhi = "火";
                    heBigZhi = "巳";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);

                    if( dayZhi.equals("戌") ) {
                        feDayZhi = "火";
                        heDayZhi = "午";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("戌") ) {
                        feMonthZhi = "火";
                        heMonthZhi = "午";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if(hourZhi.equals("戌") ) {
                        feHourZhi = "火";
                        heHourZhi = "午";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("戌") ) {
                        feYearZhi = "火";
                        heYearZhi = "午";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;     
                    
                    if( m_bProfessional ) {
                        msg = "寅午戌三会火局";
                        arrAnalysis.add(msg);
                    }
                }
                else if( bigZhi.equals("戌") && ( hourZhi.equals("寅") || dayZhi.equals("寅") ||
                monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
                    feBigZhi = "火";
                    heBigZhi = "午";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                    if( hourZhi.equals("寅") ) {
                        feHourZhi = "火";
                        heHourZhi = "巳";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( dayZhi.equals("寅") ) {
                        feDayZhi = "火";
                        heDayZhi = "巳";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("寅") ) {
                        feMonthZhi = "火";
                        heMonthZhi = "巳";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("寅") ) {
                        feYearZhi = "火";
                        heYearZhi = "巳";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;

                    if( m_bProfessional ) {
                        msg = "寅午戌三会火局";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
        else if( liuZhi.equals("戌")) {
            if( feLiuGan.equals("火") || feBigGan.equals("火") ||
            feHourGan.equals("火") || feDayGan.equals("火") ||
            feMonthGan.equals("火") || feYearGan.equals("火") ) {
    
                if( bigZhi.equals("寅") && ( hourZhi.equals("午") || dayZhi.equals("午") || 
                monthZhi.equals("午") || yearZhi.equals("午") ) ) {
                    feLiuZhi = "火";
                    heLiuZhi = "午";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                    feBigZhi = "火";
                    heBigZhi = "巳";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                    he = true;    
                    
                    if( m_bProfessional ) {
                        msg = "寅午戌三会火局";
                        arrAnalysis.add(msg);
                    }
                }
                else if( bigZhi.equals("午") && ( hourZhi.equals("寅") || dayZhi.equals("寅") ||
                monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
                    feLiuZhi = "火";
                    heLiuZhi = "午";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                    if( hourZhi.equals("寅") ) {
                        feHourZhi = "火";
                        heHourZhi = "巳";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( dayZhi.equals("寅") ) {
                        feDayZhi = "火";
                        heDayZhi = "巳";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("寅") ) {
                        feMonthZhi = "火";
                        heMonthZhi = "巳";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("寅") ) {
                        feYearZhi = "火";
                        heYearZhi = "巳";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;

                    if( m_bProfessional ) {
                        msg = "寅午戌三会火局";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }

        if( liuZhi.equals("申")) {        
            if( feLiuGan.equals("水") || feBigGan.equals("水") ||
            feHourGan.equals("水") || feDayGan.equals("水") ||
            feMonthGan.equals("水") || feYearGan.equals("水") ) {

                if( bigZhi.equals("子") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || 
                monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
                    feLiuZhi = "水";
                    heLiuZhi = "亥";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                    if( dayZhi.equals("辰") ) {
                        feDayZhi = "水";
                        heDayZhi = "子";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("辰") ) {
                        feMonthZhi = "水";
                        heMonthZhi = "子";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("辰") ) {
                        feHourZhi = "水";
                        heHourZhi = "子";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("辰") ) {
                        feYearZhi = "水";
                        heYearZhi = "子";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true; 
                    
                    if( m_bProfessional ) {
                        msg = "申子辰三会水局";
                        arrAnalysis.add(msg);
                    }
                }
                else if( bigZhi.equals("辰") && ( hourZhi.equals("子") || dayZhi.equals("子") ||
                monthZhi.equals("子") || yearZhi.equals("子") ) ) {
                    feLiuZhi = "水";
                    heLiuZhi = "亥";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                    feBigZhi = "水";
                    heBigZhi = "子";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                    he = true;

                    if( m_bProfessional ) {
                        msg = "申子辰三会水局";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
        else if( liuZhi.equals("子")) {
            if( feLiuGan.equals("水") || feBigGan.equals("水") ||
            feHourGan.equals("水") || feDayGan.equals("水") ||
            feMonthGan.equals("水") || feYearGan.equals("水") ) {

                if( bigZhi.equals("申") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || 
                monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
                    feBigZhi = "水";
                    heBigZhi = "亥";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);

                    if( dayZhi.equals("辰") ) {
                        feDayZhi = "水";
                        heDayZhi = "子";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("辰") ) {
                        feMonthZhi = "水";
                        heMonthZhi = "子";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("辰") ) {
                        feHourZhi = "水";
                        heHourZhi = "子";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("辰") ) {
                        feYearZhi = "水";
                        heYearZhi = "子";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;  
                    
                    if( m_bProfessional ) {
                        msg = "申子辰三会水局";
                        arrAnalysis.add(msg);
                    }
                }
                else if( bigZhi.equals("辰") && ( hourZhi.equals("申") || dayZhi.equals("申") ||
                monthZhi.equals("申") || yearZhi.equals("申") ) ) {
                    feBigZhi = "水";
                    heBigZhi = "子";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);

                    if( hourZhi.equals("申") ) {
                        feHourZhi = "水";
                        heHourZhi = "亥";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( dayZhi.equals("申") ) {
                        feDayZhi = "水";
                        heDayZhi = "亥";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("申") ) {
                        feMonthZhi = "水";
                        heMonthZhi = "亥";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("申") ) {
                        feYearZhi = "水";
                        heYearZhi = "亥";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;

                    if( m_bProfessional ) {
                        msg = "申子辰三会水局";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
        else if( liuZhi.equals("辰")) {
            if( feLiuGan.equals("水") || feBigGan.equals("水") ||
            feHourGan.equals("水") || feDayGan.equals("水") ||
            feMonthGan.equals("水") || feYearGan.equals("水") ) {

                if( bigZhi.equals("申") && ( hourZhi.equals("子") || dayZhi.equals("子") || 
                monthZhi.equals("子") || yearZhi.equals("子") ) ) {
                    feLiuZhi = "水";
                    heLiuZhi = "子";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                    feBigZhi = "水";
                    heBigZhi = "亥";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                    he = true;
                    
                    if( m_bProfessional ) {
                        msg = "申子辰三会水局";
                        arrAnalysis.add(msg);
                    }
                }
                else if( bigZhi.equals("子") && ( hourZhi.equals("申") || dayZhi.equals("申") ||
                monthZhi.equals("申") || yearZhi.equals("申") ) ) {
                    feLiuZhi = "水";
                    heLiuZhi = "子";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                    if( hourZhi.equals("申") ) {
                        feHourZhi = "水";
                        heHourZhi = "亥";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( dayZhi.equals("申") ) {
                        feDayZhi = "水";
                        heDayZhi = "亥";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("申") ) {
                        feMonthZhi = "水";
                        heMonthZhi = "亥";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("申") ) {
                        feYearZhi = "水";
                        heYearZhi = "亥";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;

                    if( m_bProfessional ) {
                        msg = "申子辰三会水局";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }

        if( liuZhi.equals("巳")) {
            if( feLiuGan.equals("金") || feBigGan.equals("金") ||
            feHourGan.equals("金") || feDayGan.equals("金") ||
            feMonthGan.equals("金") || feYearGan.equals("金") ) {
    
                if( bigZhi.equals("酉") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
                monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
                    feLiuZhi = "金";
                    heLiuZhi = "申";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
                    
                    if( dayZhi.equals("丑") ) {
                        feDayZhi = "金";
                        heDayZhi = "酉";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("丑") ) {
                        feMonthZhi = "金";
                        heMonthZhi = "酉";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("丑") ) {
                        feHourZhi = "金";
                        heHourZhi = "酉";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("丑") ) {
                        feYearZhi = "金";
                        heYearZhi = "酉";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;
                    
                    if( m_bProfessional ) {
                        msg = "巳酉丑三会金局";
                        arrAnalysis.add(msg);
                    }
                }
                else if( bigZhi.equals("丑") && ( hourZhi.equals("酉") || dayZhi.equals("酉") ||
                monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
                    feLiuZhi = "金";
                    heLiuZhi = "申";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                    feBigZhi = "金";
                    heBigZhi = "酉";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                    he = true;

                    if( m_bProfessional ) {
                        msg = "巳酉丑三会金局";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
        else if( liuZhi.equals("酉")) {
            if( feLiuGan.equals("金") || feBigGan.equals("金") ||
            feHourGan.equals("金") || feDayGan.equals("金") ||
            feMonthGan.equals("金") || feYearGan.equals("金") ) {
    
                if( bigZhi.equals("巳") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
                monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
                    feBigZhi = "金";
                    heBigZhi = "申";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);

                    if( dayZhi.equals("丑") ) {
                        feDayZhi = "金";
                        heDayZhi = "酉";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("丑") ) {
                        feMonthZhi = "金";
                        heMonthZhi = "酉";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("丑") ) {
                        feHourZhi = "金";
                        heHourZhi = "酉";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("丑") ) {
                        feYearZhi = "金";
                        heYearZhi = "酉";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;
                    
                    if( m_bProfessional ) {
                        msg = "巳酉丑三会金局";
                        arrAnalysis.add(msg);
                    }
                }
                else if( bigZhi.equals("丑") && ( hourZhi.equals("巳") || dayZhi.equals("巳") ||
                monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
                    feBigZhi = "金";
                    heBigZhi = "酉";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);

                    if( dayZhi.equals("巳") ) {
                        feDayZhi = "金";
                        heDayZhi = "申";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("巳") ) {
                        feMonthZhi = "金";
                        heMonthZhi = "申";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("巳") ) {
                        feHourZhi = "金";
                        heHourZhi = "申";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("巳") ) {
                        feYearZhi = "金";
                        heYearZhi = "申";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;

                    if( m_bProfessional ) {
                        msg = "巳酉丑三会金局";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
        else if( liuZhi.equals("丑")) {
            if( feLiuGan.equals("金") || feBigGan.equals("金") ||
            feHourGan.equals("金") || feDayGan.equals("金") ||
            feMonthGan.equals("金") || feYearGan.equals("金") ) {
    
                if( bigZhi.equals("巳") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || 
                monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
                    feLiuZhi = "金";
                    heLiuZhi = "酉";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                    feBigZhi = "金";
                    heBigZhi = "申";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                    he = true;

                    if( m_bProfessional ) {
                        msg = "巳酉丑三会金局";
                        arrAnalysis.add(msg);
                    }
                }
                else if( bigZhi.equals("酉") && ( hourZhi.equals("巳") || dayZhi.equals("巳") ||
                monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
                    feLiuZhi = "金";
                    heLiuZhi = "酉";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                    if( dayZhi.equals("巳") ) {
                        feDayZhi = "金";
                        heDayZhi = "申";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                    }
                    else if( monthZhi.equals("巳") ) {
                        feMonthZhi = "金";
                        heMonthZhi = "申";
                        heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                        msg = fnShenChangeBig(shenMonthZhi);
                        arrHeChong.add(msg);
                    }
                    else if( hourZhi.equals("巳") ) {
                        feHourZhi = "金";
                        heHourZhi = "申";
                        heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                        msg = fnShenChangeBig(shenHourZhi);
                        arrHeChong.add(msg);
                    }
                    else if( yearZhi.equals("巳") ) {
                        feYearZhi = "金";
                        heYearZhi = "申";
                        heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                        msg = fnShenChangeBig(shenYearZhi);
                        arrHeChong.add(msg);
                    }
                    he = true;

                    if( m_bProfessional ) {
                        msg = "巳酉丑三会金局";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
    }
    //#endregion

    //#region 地支六合
    if( he == false ) { 

        if( liuZhi.equals("子") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
        monthZhi.equals("丑") || yearZhi.equals("丑") || bigZhi.equals("丑") ) ) {
            if( feLiuGan.equals("土")) {
                feLiuZhi = "土";
                heLiuZhi = "丑";
                heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                if( m_bProfessional ) {
                    msg = "子丑六合土";
                    arrAnalysis.add(msg);
                }
            }
        }
        if( liuZhi.equals("丑") && ( hourZhi.equals("子") || dayZhi.equals("子") || 
        monthZhi.equals("子") || yearZhi.equals("子") || bigZhi.equals("子") ) ) {
            if( bigZhi.equals("子") && feBigGan.equals("土")) {
                feBigZhi = "土";
                heBigZhi = "丑";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);

                if( m_bProfessional ) {
                    msg = "子丑六合土";
                    arrAnalysis.add(msg);
                }
            }
            else if( dayZhi.equals("子") && feDayGan.equals("土")) {
                feDayZhi = "土";
                heDayZhi = "丑";
                heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                msg = fnShenChangeBig(shenDayZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "子丑六合土";
                    arrAnalysis.add(msg);
                }
            }
            else if( monthZhi.equals("子") && feMonthGan.equals("土")) {
                feMonthZhi = "土";
                heMonthZhi = "丑";
                heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                msg = fnShenChangeBig(shenMonthZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "子丑六合土";
                    arrAnalysis.add(msg);
                }
            }
            else if( hourZhi.equals("子") && feHourGan.equals("土")) {
                feHourZhi = "土";
                heHourZhi = "丑";
                heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                msg = fnShenChangeBig(shenHourZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "子丑六合土";
                    arrAnalysis.add(msg);
                }
            }
            else if( yearZhi.equals("子") && feYearGan.equals("土")) {
                feYearZhi = "土";
                heYearZhi = "丑";
                heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                msg = fnShenChangeBig(shenYearZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "子丑六合土";
                    arrAnalysis.add(msg);
                }
            }
        }

        if( liuZhi.equals("寅") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || 
        monthZhi.equals("亥") || yearZhi.equals("亥") || bigZhi.equals("亥") ) ) {
            if(bigZhi.equals("亥") && feBigGan.equals("土") ) {
                feBigZhi = "木";
                heBigZhi = "亥";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);

                if( m_bProfessional ) {
                    msg = "寅亥六合木";
                    arrAnalysis.add(msg);
                }
            }
            else if( dayZhi.equals("亥") && feDayGan.equals("土") ) {
                feDayZhi = "木";
                heDayZhi = "寅";
                heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                msg = fnShenChangeBig(shenDayZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "寅亥六合木";
                    arrAnalysis.add(msg);
                }
            }
            else if( monthZhi.equals("亥") && feMonthGan.equals("土") ) {
                feMonthZhi = "木";
                heMonthZhi = "寅";
                heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                msg = fnShenChangeBig(shenMonthZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "寅亥六合木";
                    arrAnalysis.add(msg);
                }
            }
            else if( hourZhi.equals("亥") && feHourGan.equals("土") ) {
                feHourZhi = "木";
                heHourZhi = "寅";
                heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                msg = fnShenChangeBig(shenHourZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "寅亥六合木";
                    arrAnalysis.add(msg);
                }
            }
            else if( yearZhi.equals("亥") && feYearGan.equals("土") ) {
                feYearZhi = "木";
                heYearZhi = "寅";
                heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                msg = fnShenChangeBig(shenYearZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "寅亥六合木";
                    arrAnalysis.add(msg);
                }
            }
        }
        if( liuZhi.equals("亥") && ( hourZhi.equals("寅") || dayZhi.equals("寅") || 
        monthZhi.equals("寅") || yearZhi.equals("寅") || bigZhi.equals("寅") ) ) {
            if( feLiuGan.equals("土") ) {
                feLiuZhi = "木";
                heLiuZhi = "寅";
                heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                if( m_bProfessional ) {
                    msg = "寅亥六合木";
                    arrAnalysis.add(msg);
                }
            }
        }

        if( liuZhi.equals("卯") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
        monthZhi.equals("戌") || yearZhi.equals("戌") || bigZhi.equals("戌") ) ) {
            if( feLiuGan.equals("火")) {

                feLiuZhi = "火";
                heLiuZhi = "巳";
                heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
                
                if( bigZhi.equals("戌")) {
                    feBigZhi = "火";
                    heBigZhi = "午";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                }
                else if( dayZhi.equals("戌") ) {
                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("戌") ) {
                    feMonthZhi = "火";
                    heMonthZhi = "午";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("戌") ) {
                    feHourZhi = "火";
                    heHourZhi = "午";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);
                }
                else if( yearZhi.equals("戌") ) {
                    feYearZhi = "火";
                    heYearZhi = "午";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }

                if( m_bProfessional ) {
                    msg = "卯戌六合火";
                    arrAnalysis.add(msg);
                }
            }
            else {
                if( bigZhi.equals("戌") && feBigGan.equals("火") ) {
                    feLiuZhi = "火";
                    heLiuZhi = "巳";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
                    
                    feBigZhi = "火";
                    heBigZhi = "午";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火";
                        arrAnalysis.add(msg);
                    }
                }
                else if( dayZhi.equals("戌") && feDayGan.equals("火") ) {
                    feLiuZhi = "火";
                    heLiuZhi = "巳";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
                    
                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火";
                        arrAnalysis.add(msg);
                    }
                }
                else if( monthZhi.equals("戌") && feMonthGan.equals("火") ) {
                    feLiuZhi = "火";
                    heLiuZhi = "巳";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
                    
                    feMonthZhi = "火";
                    heMonthZhi = "午";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火";
                        arrAnalysis.add(msg);
                    }
                }
                else if( hourZhi.equals("戌") && feHourGan.equals("火") ) {
                    feLiuZhi = "火";
                    heLiuZhi = "巳";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
                    
                    feHourZhi = "火";
                    heHourZhi = "午";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火";
                        arrAnalysis.add(msg);
                    }
                }
                else if( yearZhi.equals("戌") && feYearGan.equals("火") ) {
                    feLiuZhi = "火";
                    heLiuZhi = "巳";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
                    
                    feYearZhi = "火";
                    heYearZhi = "午";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火";
                        arrAnalysis.add(msg);
                    }
                }

            }
        }
        if( liuZhi.equals("戌") && ( hourZhi.equals("卯") || dayZhi.equals("卯") || 
        monthZhi.equals("卯") || yearZhi.equals("卯") || bigZhi.equals("卯") ) ) {
            if( feLiuGan.equals("火")) {
                feLiuZhi = "火";
                heLiuZhi = "午";
                heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
                
                if( bigZhi.equals("卯")) {
                    feBigZhi = "火";
                    heBigZhi = "巳";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                }
                else if( dayZhi.equals("卯") ) {
                    feDayZhi = "火";
                    heDayZhi = "巳";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("卯") ) {
                    feMonthZhi = "火";
                    heMonthZhi = "巳";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("卯") ) {
                    feHourZhi = "火";
                    heHourZhi = "巳";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);
                }
                else if( yearZhi.equals("卯") ) {
                    feYearZhi = "火";
                    heYearZhi = "巳";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }

                if( m_bProfessional ) {
                    msg = "卯戌六合火";
                    arrAnalysis.add(msg);
                }
            }
            else {
                
                if( bigZhi.equals("卯") && feBigGan.equals("火") ) {
                    feLiuZhi = "火";
                    heLiuZhi = "午";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
    
                    feBigZhi = "火";
                    heBigZhi = "巳";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火";
                        arrAnalysis.add(msg);
                    }
                }
                else if( dayZhi.equals("卯") && feDayGan.equals("火") ) {
                    feLiuZhi = "火";
                    heLiuZhi = "午";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
    
                    feDayZhi = "火";
                    heDayZhi = "巳";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火";
                        arrAnalysis.add(msg);
                    }
                }
                else if( monthZhi.equals("卯") && feMonthGan.equals("火") ) {
                    feLiuZhi = "火";
                    heLiuZhi = "午";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
    
                    feMonthZhi = "火";
                    heMonthZhi = "巳";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火";
                        arrAnalysis.add(msg);
                    }
                }
                else if( hourZhi.equals("卯") && feHourGan.equals("火") ) {
                    feLiuZhi = "火";
                    heLiuZhi = "午";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
    
                    feHourZhi = "火";
                    heHourZhi = "巳";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火";
                        arrAnalysis.add(msg);
                    }
                }
                else if( yearZhi.equals("卯") && feYearGan.equals("火") ) {
                    feLiuZhi = "火";
                    heLiuZhi = "午";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
    
                    feYearZhi = "火";
                    heYearZhi = "巳";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "卯戌六合火";
                        arrAnalysis.add(msg);
                    }
                }

            }
        }

        if( liuZhi.equals("辰") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || 
        monthZhi.equals("酉") || yearZhi.equals("酉") || bigZhi.equals("酉") ) ) {
            if( feLiuGan.equals("金")) {
                feLiuZhi = "金";
                heLiuZhi = "申";
                heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);    

                if( m_bProfessional ) {
                    msg = "辰酉六合金";
                    arrAnalysis.add(msg);
                }
            }
        }
        if( liuZhi.equals("酉") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || 
        monthZhi.equals("辰") || yearZhi.equals("辰") || bigZhi.equals("辰") ) ) {
            
            if(bigZhi.equals("辰") && feBigGan.equals("金") ) {
                feBigZhi = "金";
                heBigZhi = "申";
                heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);

                if( m_bProfessional ) {
                    msg = "辰酉六合金";
                    arrAnalysis.add(msg);
                }
                }
            else if( dayZhi.equals("辰") && feDayGan.equals("金") ) {
                feDayZhi = "金";
                heDayZhi = "申";
                heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                msg = fnShenChangeBig(shenDayZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "辰酉六合金";
                    arrAnalysis.add(msg);
                }
                }
            else if( monthZhi.equals("辰") && feMonthGan.equals("金") ) {
                feMonthZhi = "金";
                heMonthZhi = "申";
                heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                msg = fnShenChangeBig(shenMonthZhi);
                arrHeChong.add(msg);

                if( m_bProfessional ) {
                    msg = "辰酉六合金";
                    arrAnalysis.add(msg);
                }
            }
            else if( hourZhi.equals("辰") && feHourGan.equals("金") ) {
                feHourZhi = "金";
                heHourZhi = "申";
                heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                msg = fnShenChangeBig(shenHourZhi);
                arrHeChong.add(msg);
                if( m_bProfessional ) {
                    msg = "辰酉六合金";
                    arrAnalysis.add(msg);
                }
    
            }
            else if( yearZhi.equals("辰") && feYearGan.equals("金") ) {
                feYearZhi = "金";
                heYearZhi = "申";
                heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                msg = fnShenChangeBig(shenYearZhi);
                arrHeChong.add(msg);
                if( m_bProfessional ) {
                    msg = "辰酉六合金";
                    arrAnalysis.add(msg);
                }
    
            }

        }

        if( liuZhi.equals("巳") && ( hourZhi.equals("申") || dayZhi.equals("申") || 
        monthZhi.equals("申") || yearZhi.equals("申") || bigZhi.equals("申") ) ) {
            if( feLiuGan.equals("水")) {
                feLiuZhi = "水";
                heLiuZhi = "子";
                heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                if( bigZhi.equals("申")) {
                    feBigZhi = "水";
                    heBigZhi = "亥";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                }
                else if( dayZhi.equals("申") ) {
                    feDayZhi = "水";
                    heDayZhi = "亥";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("申") ) {
                    feMonthZhi = "水";
                    heMonthZhi = "亥";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("申") ) {
                    feHourZhi = "水";
                    heHourZhi = "亥";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg); 
                }
                else if( yearZhi.equals("申") ) {
                    feYearZhi = "水";
                    heYearZhi = "亥";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }

                if( m_bProfessional ) {
                    msg = "巳申六合水";
                    arrAnalysis.add(msg);
                }
    
            }
            else {
                if( bigZhi.equals("申") && feBigGan.equals("水") ) {
                    feLiuZhi = "水";
                    heLiuZhi = "子";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
        
                    feBigZhi = "水";
                    heBigZhi = "亥";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);

                    if( m_bProfessional ) {
                        msg = "巳申六合水";
                        arrAnalysis.add(msg);
                    }
                }
                else if( dayZhi.equals("申") && feDayGan.equals("水") ) {
                    feLiuZhi = "水";
                    heLiuZhi = "子";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                    feDayZhi = "水";
                    heDayZhi = "亥";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "巳申六合水";
                        arrAnalysis.add(msg);
                    }

                }
                else if( monthZhi.equals("申") && feMonthGan.equals("水") ) {
                    feLiuZhi = "水";
                    heLiuZhi = "子";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                    feMonthZhi = "水";
                    heMonthZhi = "亥";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "巳申六合水";
                        arrAnalysis.add(msg);
                    }
                }
                else if( hourZhi.equals("申") && feHourGan.equals("水") ) {
                    feLiuZhi = "水";
                    heLiuZhi = "子";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                    feHourZhi = "水";
                    heHourZhi = "亥";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg); 

                    if( m_bProfessional ) {
                        msg = "巳申六合水";
                        arrAnalysis.add(msg);
                    }
                }
                else if( yearZhi.equals("申") && feYearGan.equals("水") ) {
                    feLiuZhi = "水";
                    heLiuZhi = "子";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                    feYearZhi = "水";
                    heYearZhi = "亥";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "巳申六合水";
                        arrAnalysis.add(msg);
                    }
                }

            }
        }
        if( liuZhi.equals("申") && ( hourZhi.equals("巳") || dayZhi.equals("巳") || 
        monthZhi.equals("巳") || yearZhi.equals("巳") || bigZhi.equals("巳") ) ) {
            if( feLiuGan.equals("木")) {
                feLiuZhi = "水";
                heLiuZhi = "亥";
                heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                if( bigZhi.equals("巳")) {
                    feBigZhi = "水";
                    heBigZhi = "子";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                }
                else if( dayZhi.equals("巳") ) {
                    feDayZhi = "水";
                    heDayZhi = "子";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("巳") ) {
                    feMonthZhi = "水";
                    heMonthZhi = "子";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("巳") ) {
                    feHourZhi = "水";
                    heHourZhi = "子";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg); 
                }
                else if( yearZhi.equals("巳") ) {
                    feYearZhi = "水";
                    heYearZhi = "子";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }

                if( m_bProfessional ) {
                    msg = "申巳六合木";
                    arrAnalysis.add(msg);
                }
            }
            else {

                if( bigZhi.equals("巳") && feBigGan.equals("木") ) {
                    feLiuZhi = "水";
                    heLiuZhi = "亥";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
    
                    feBigZhi = "水";
                    heBigZhi = "子";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);

                    if( m_bProfessional ) {
                        msg = "申巳六合木";
                        arrAnalysis.add(msg);
                    }
                }
                else if( dayZhi.equals("巳") && feDayGan.equals("木") ) {
                    feLiuZhi = "水";
                    heLiuZhi = "亥";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
    
                    feDayZhi = "水";
                    heDayZhi = "子";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "申巳六合木";
                        arrAnalysis.add(msg);
                    }
                }
                else if( monthZhi.equals("巳") && feMonthGan.equals("木") ) {
                    feLiuZhi = "水";
                    heLiuZhi = "亥";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
    
                    feMonthZhi = "水";
                    heMonthZhi = "子";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "申巳六合木";
                        arrAnalysis.add(msg);
                    }
                }
                else if( hourZhi.equals("巳") && feHourGan.equals("木") ) {
                    feLiuZhi = "水";
                    heLiuZhi = "亥";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
    
                    feHourZhi = "水";
                    heHourZhi = "子";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg); 

                    if( m_bProfessional ) {
                        msg = "申巳六合木";
                        arrAnalysis.add(msg);
                    }
                }
                else if( yearZhi.equals("巳") && feYearGan.equals("木") ) {
                    feLiuZhi = "水";
                    heLiuZhi = "亥";
                    heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);
    
                    feYearZhi = "水";
                    heYearZhi = "子";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);

                    if( m_bProfessional ) {
                        msg = "申巳六合木";
                        arrAnalysis.add(msg);
                    }
                }
            }
        }
        
        if( liuZhi.equals("午") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
        monthZhi.equals("未") || yearZhi.equals("未") || bigZhi.equals("未") ) ) {
            if( feGanTu> feGanJin ) {
                feLiuZhi = "土";
                heLiuZhi = "未";
                heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                if( m_bProfessional ) {
                    msg = "午未六合土";
                    arrAnalysis.add(msg);
                }
            }
            else if( feGanTu < feGanJin ) {
                if( hourZhi.equals("未")) {
                    feHourZhi = "火";
                    heHourZhi = "午";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);
                }
                else if( dayZhi.equals("未")) {
                    feDayZhi = "火";
                    heDayZhi = "午";
                    heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                    msg = fnShenChangeBig(shenDayZhi);
                    arrHeChong.add(msg);
                }
                else if( monthZhi.equals("未")) {
                    feMonthZhi = "火";
                    heMonthZhi = "午";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( yearZhi.equals("未")) {
                    feYearZhi = "火";
                    heYearZhi = "午";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }
                else if( bigZhi.equals("未")) {
                    feBigZhi = "火";
                    heBigZhi = "午";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                }

                if( m_bProfessional ) {
                    msg = "午未六合火";
                    arrAnalysis.add(msg);
                }
            }
        }
        if( liuZhi.equals("未") && ( hourZhi.equals("午") || dayZhi.equals("午") || 
        monthZhi.equals("午") || yearZhi.equals("午") || bigZhi.equals("午") ) ) {
            if( feGanTu > feGanHuo ) {

                if( bigZhi.equals("午")) {
                    feBigZhi = "土";
                    heBigZhi = "未";
                    heShenBigZhi = fnComputeShishen(dayGan, heBigZhi);
                }
                else if( dayZhi.equals("午") ) {
                        feDayZhi = "土";
                        heDayZhi = "未";
                        heShenDayZhi = fnComputeShishen(dayGan, heDayZhi);
                        msg = fnShenChangeBig(shenDayZhi);
                        arrHeChong.add(msg);
                }
                else if( monthZhi.equals("午") ) {
                    feMonthZhi = "土";
                    heMonthZhi = "未";
                    heShenMonthZhi = fnComputeShishen(dayGan, heMonthZhi);
                    msg = fnShenChangeBig(shenMonthZhi);
                    arrHeChong.add(msg);
                }
                else if( hourZhi.equals("午") ) {
                    feHourZhi = "土";
                    heHourZhi = "未";
                    heShenHourZhi = fnComputeShishen(dayGan, heHourZhi);
                    msg = fnShenChangeBig(shenHourZhi);
                    arrHeChong.add(msg);
                }
                else if( yearZhi.equals("午") ) {
                    feYearZhi = "土";
                    heYearZhi = "未";
                    heShenYearZhi = fnComputeShishen(dayGan, heYearZhi);
                    msg = fnShenChangeBig(shenYearZhi);
                    arrHeChong.add(msg);
                }

                if( m_bProfessional ) {
                    msg = "午未六合土";
                    arrAnalysis.add(msg);
                }
            }
            else if( feGanTu < feGanHuo ) {
                feLiuZhi = "火";
                heLiuZhi = "午";
                heShenLiuZhi = fnComputeShishen(dayGan, heLiuZhi);

                if( m_bProfessional ) {
                    msg = "午未六合火";
                    arrAnalysis.add(msg);
                }
            }
        }
    } 

    //#endregion

    //#region 天干五合
    if( liuGan.equals("甲") && ( hourGan.equals("己") ||  
    monthGan.equals("己") || yearGan.equals("己") || bigGan.equals("己") ) ) {
        if( feLiuZhi.equals("土") ) {
            feLiuGan = "土";
            heLiuGan = "己";
            heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);
            msg = "甲己合化土，易安分守信。";
            arrHeChong.add(msg);
        }
    }
    if( liuGan.equals("己") && ( hourGan.equals("甲") ||  
    monthGan.equals("甲") || yearGan.equals("甲") || bigGan.equals("甲") ) ) {

        if( feBigZhi.equals("土") && bigGan.equals("甲")) {
            feBigGan = "土";
            heBigGan = "己";
            heShenBigGan = fnComputeShishen(dayGan, heBigGan);
        }
        else if( feMonthZhi.equals("土") && monthGan.equals("甲")) {
            feMonthGan = "土";
            heMonthGan = "己";
            heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
            msg = "甲己合化土，易安分守信。";    
            arrHeChong.add(msg);
            msg = fnShenChangeBig(shenMonthGan);
            arrHeChong.add(msg);
    }
        else if( feHourZhi.equals("土") && hourGan.equals("甲")) {
            feHourGan = "土";
            heHourGan = "己";
            heShenHourGan = fnComputeShishen(dayGan, heHourGan);
            msg = "甲己合化土，易安分守信。";    
            arrHeChong.add(msg);
            msg = fnShenChangeBig(shenHourGan);
            arrHeChong.add(msg);
        }
        else if( feYearZhi.equals("土") && yearGan.equals("甲")) {
            feYearGan = "土";
            heYearGan = "己";
            heShenYearGan = fnComputeShishen(dayGan, heYearGan);
            msg = "甲己合化土，易安分守信。";    
            arrHeChong.add(msg);
            msg = fnShenChangeBig(shenYearGan);
            arrHeChong.add(msg);
        }    
    }

    if( liuGan.equals("乙") && ( hourGan.equals("庚") || 
    monthGan.equals("庚") || yearGan.equals("庚") || bigGan.equals("庚") ) ) {
        if( feLiuZhi.equals("土") ) {
            feLiuGan = "金";
            heLiuGan = "庚";
            heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);
            msg = "乙庚合化金，易有仁有义。";
            arrHeChong.add(msg);
        }
    }
    if( liuGan.equals("庚") && ( hourGan.equals("乙") || 
    monthGan.equals("乙") || yearGan.equals("乙") || bigGan.equals("乙") ) ) {

        if( feBigZhi.equals("金") && bigGan.equals("乙") ) {
            feBigGan = "金";
            heBigGan = "庚";
            heShenBigGan = fnComputeShishen(dayGan, heBigGan);
        }
        else if( feMonthZhi.equals("金") && monthGan.equals("乙")) {
            feMonthGan = "金";
            heMonthGan = "庚";
            heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
            msg = "乙庚合化金，易有仁有义。";
            arrHeChong.add(msg);
            msg = fnShenChangeBig(shenMonthGan);
            arrHeChong.add(msg);
        }
        else if( feHourZhi.equals("金") && hourGan.equals("乙")) {
            feHourGan = "金";
            heHourGan = "庚";
            heShenHourGan = fnComputeShishen(dayGan, heHourGan);
            msg = "乙庚合化金，易有仁有义。";
            arrHeChong.add(msg);
            msg = fnShenChangeBig(shenHourGan);
            arrHeChong.add(msg);
        }
        else if( feYearZhi.equals("金") && yearGan.equals("乙")) {
            feYearGan = "金";
            heYearGan = "庚";
            heShenYearGan = fnComputeShishen(dayGan, heYearGan);
            msg = "乙庚合化金，易有仁有义。";
            arrHeChong.add(msg);
            msg = fnShenChangeBig(shenYearGan);
            arrHeChong.add(msg);
        }
    } 

    if( liuGan.equals("丙") && ( hourGan.equals("辛") ||  
    monthGan.equals("辛") || yearGan.equals("辛") || bigGan.equals("辛") ) ) {
        if( feLiuZhi.equals("水") ) {
            feLiuGan = "水";
            heLiuGan = "壬";
            heShenBigGan = fnComputeShishen(dayGan, heBigGan);

            if( bigGan.equals("辛")) {
                feBigGan = "水";
                heBigGan = "癸";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            }
            else if( monthGan.equals("辛")) {
                feMonthGan = "水";
                heMonthGan = "癸";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrHeChong.add(msg);
            }
            else if( hourGan.equals("辛")) {
                feHourGan = "水";
                heHourGan = "癸";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrHeChong.add(msg);
            }
            else if( yearGan.equals("辛")) {
                feYearGan = "水";
                heYearGan = "癸";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrHeChong.add(msg);
            }
        }
        else {
            if( feBigZhi.equals("水") && bigGan.equals("辛")) {
                feLiuGan = "水";
                heLiuGan = "壬";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);

                feBigGan = "水";
                heBigGan = "癸";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrHeChong.add(msg);
            }
            else if( feMonthZhi.equals("水") && monthGan.equals("辛")) {
                feLiuGan = "水";
                heLiuGan = "壬";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);

                feMonthGan = "水";
                heMonthGan = "癸";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrHeChong.add(msg);
            }
            else if( feHourZhi.equals("水") && hourGan.equals("辛")) {
                feLiuGan = "水";
                heLiuGan = "壬";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);

                feHourGan = "水";
                heHourGan = "癸";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrHeChong.add(msg);
            }
            else if( feYearZhi.equals("水") && yearGan.equals("辛")) {
                feLiuGan = "水";
                heLiuGan = "壬";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);

                feYearGan = "水";
                heYearGan = "癸";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrHeChong.add(msg);
            }
        }
    }
    if( liuGan.equals("辛") && ( hourGan.equals("丙") ||  
    monthGan.equals("丙") || yearGan.equals("丙") || bigGan.equals("丙") ) ) {
        if( feLiuZhi.equals("水") ) {
            feLiuGan = "水";
            heLiuGan = "癸";
            heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);
            if( bigGan.equals("丙")) {
                feBigGan = "水";
                heBigGan = "壬";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            }
            else if( monthGan.equals("丙")) {
                feMonthGan = "水";
                heMonthGan = "壬";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrHeChong.add(msg);
            }
            else if( hourGan.equals("丙")) {
                feHourGan = "水";
                heHourGan = "壬";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrHeChong.add(msg);
            }
            else if( yearGan.equals("丙")) {
                feYearGan = "水";
                heYearGan = "壬";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrHeChong.add(msg);
            }
        }
        else {
            if( feBigZhi.equals("水") && bigGan.equals("丙")) {
                feLiuGan = "水";
                heLiuGan = "癸";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feBigGan = "水";
                heBigGan = "壬";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            }
            else if( feMonthZhi.equals("水") && monthGan.equals("丙")) {
                feLiuGan = "水";
                heLiuGan = "癸";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feMonthGan = "水";
                heMonthGan = "壬";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrHeChong.add(msg);
            }
            else if( feHourZhi.equals("水") && hourGan.equals("丙")) {
                feLiuGan = "水";
                heLiuGan = "癸";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feHourGan = "水";
                heHourGan = "壬";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrHeChong.add(msg);
            }
            else if( feYearZhi.equals("水") && yearGan.equals("丙")) {
                feLiuGan = "水";
                heLiuGan = "癸";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feYearGan = "水";
                heYearGan = "壬";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "丙辛合化水，易聪明贵气。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrHeChong.add(msg);
            }
        }                
    }

    if( liuGan.equals("丁") && ( hourGan.equals("壬") || 
    monthGan.equals("壬") || yearGan.equals("壬") || bigGan.equals("壬") ) ) {
        if( feLiuZhi.equals("木") ) {
            feLiuGan = "木";
            heLiuGan = "乙";
            heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

            if( bigGan.equals("壬")) {
                feBigGan = "木";
                heBigGan = "甲";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            }
            else if( monthGan.equals("壬")) {
                feMonthGan = "木";
                heMonthGan = "甲";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrHeChong.add(msg);
            }
            else if( hourGan.equals("壬")) {
                feHourGan = "木";
                heHourGan = "甲";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrHeChong.add(msg);
            }
            else if( yearGan.equals("壬")) {
                feYearGan = "木";
                heYearGan = "甲";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrHeChong.add(msg);
            }
        }
        else {
            if( feBigZhi.equals("木") && bigGan.equals("壬")) {
                feLiuGan = "木";
                heLiuGan = "乙";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feBigGan = "木";
                heBigGan = "甲";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            }
            else if( feMonthZhi.equals("木") && monthGan.equals("壬")) {
                feLiuGan = "木";
                heLiuGan = "乙";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feMonthGan = "木";
                heMonthGan = "甲";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrHeChong.add(msg);
            }
            else if( feHourZhi.equals("木") && hourGan.equals("壬")) {
                feLiuGan = "木";
                heLiuGan = "乙";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feHourGan = "木";
                heHourGan = "甲";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrHeChong.add(msg);
            }
            else if( feYearZhi.equals("木") && yearGan.equals("壬")) {
                feLiuGan = "木";
                heLiuGan = "乙";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feYearGan = "木";
                heYearGan = "甲";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrHeChong.add(msg);
            }
        }
    }
    if( liuGan.equals("壬") && ( hourGan.equals("丁") ||  
    monthGan.equals("丁") || yearGan.equals("丁") || bigGan.equals("丁") ) ) {
        if( feLiuZhi.equals("木") ) {
            feLiuGan = "木";
            heLiuGan = "甲";
            heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

            if( bigGan.equals("丁")) {
                feBigGan = "木";
                heBigGan = "乙";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            }
            else if( monthGan.equals("丁")) {
                feMonthGan = "木";
                heMonthGan = "乙";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrHeChong.add(msg);
            }
            else if( hourGan.equals("丁")) {
                feHourGan = "木";
                heHourGan = "乙";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrHeChong.add(msg);
            }
            else if( yearGan.equals("丁")) {
                feYearGan = "木";
                heYearGan = "乙";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrHeChong.add(msg);
            }
        }
        else {
            if( feBigZhi.equals("木") && bigGan.equals("丁") ) {
                feLiuGan = "木";
                heLiuGan = "甲";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feBigGan = "木";
                heBigGan = "乙";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            }
            else if( feMonthZhi.equals("木") && monthGan.equals("丁")) {
                feLiuGan = "木";
                heLiuGan = "甲";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feMonthGan = "木";
                heMonthGan = "乙";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrHeChong.add(msg);
            }
            else if( feHourZhi.equals("木") && hourGan.equals("丁")) {
                feLiuGan = "木";
                heLiuGan = "甲";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feHourGan = "木";
                heHourGan = "乙";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrHeChong.add(msg);
            }
            else if( feYearZhi.equals("木") && yearGan.equals("丁")) {
                feLiuGan = "木";
                heLiuGan = "甲";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feYearGan = "木";
                heYearGan = "乙";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "丁壬合化木，虽然积极努力，但后果不确定。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrHeChong.add(msg);
            }
        }
    }

    if( liuGan.equals("戊") && ( hourGan.equals("癸") ||  
    monthGan.equals("癸") || yearGan.equals("癸") || bigGan.equals("癸") ) ) {
        if( feLiuZhi.equals("火") ) {
            feLiuGan = "火";
            heLiuGan = "丙";
            heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

            if( bigGan.equals("癸")) {
                feBigGan = "火";
                heBigGan = "丁";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            }
            else if( monthGan.equals("癸")) {
                feMonthGan = "火";
                heMonthGan = "丁";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrHeChong.add(msg);
            }
            else if( hourGan.equals("癸")) {
                feHourGan = "火";
                heHourGan = "丁";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrHeChong.add(msg);
            }
            else if( yearGan.equals("癸")) {
                feYearGan = "火";
                heYearGan = "丁";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrHeChong.add(msg);
            }
        }
        else {
            if( feBigZhi.equals("火") && bigGan.equals("癸") ) {
                feLiuGan = "火";
                heLiuGan = "丙";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feBigGan = "火";
                heBigGan = "丁";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            }
            else if( feMonthZhi.equals("火") && monthGan.equals("癸")) {
                feLiuGan = "火";
                heLiuGan = "丙";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feMonthGan = "火";
                heMonthGan = "丁";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrHeChong.add(msg);
            }
            else if( feHourZhi.equals("火") && hourGan.equals("癸")) {
                feLiuGan = "火";
                heLiuGan = "丙";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feHourGan = "火";
                heHourGan = "丁";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrHeChong.add(msg);
            }
            else if( feYearZhi.equals("火") && yearGan.equals("癸")) {
                feLiuGan = "火";
                heLiuGan = "丙";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feYearGan = "火";
                heYearGan = "丁";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrHeChong.add(msg);
            }
        }
    }
    if( liuGan.equals("癸") && ( hourGan.equals("戊") ||  
    monthGan.equals("戊") || yearGan.equals("戊") || bigGan.equals("戊") ) ) {
        if( feLiuZhi.equals("火") ) {
            feLiuGan = "火";
            heLiuGan = "丁";
            heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

            if( bigGan.equals("戊")) {
                feBigGan = "火";
                heBigGan = "丙";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            }
            else if( monthGan.equals("戊")) {
                feMonthGan = "火";
                heMonthGan = "丙";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrHeChong.add(msg);
            }
            else if( hourGan.equals("戊")) {
                feHourGan = "火";
                heHourGan = "丙";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrHeChong.add(msg);
            }
            else if( yearGan.equals("戊")) {
                feYearGan = "火";
                heYearGan = "丙";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrHeChong.add(msg);
            }
        }
        else {
            if( feBigZhi.equals("火") && bigGan.equals("戊") ) {
                feLiuGan = "火";
                heLiuGan = "丁";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feBigGan = "火";
                heBigGan = "丙";
                heShenBigGan = fnComputeShishen(dayGan, heBigGan);
            }
            else if( feMonthZhi.equals("火") && monthGan.equals("戊")) {
                feLiuGan = "火";
                heLiuGan = "丁";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feMonthGan = "火";
                heMonthGan = "丙";
                heShenMonthGan = fnComputeShishen(dayGan, heMonthGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenMonthGan);
                arrHeChong.add(msg);
            }
            else if( feHourZhi.equals("火") && hourGan.equals("戊")) {
                feLiuGan = "火";
                heLiuGan = "丁";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feHourGan = "火";
                heHourGan = "丙";
                heShenHourGan = fnComputeShishen(dayGan, heHourGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenHourGan);
                arrHeChong.add(msg);
            }
            else if( feYearZhi.equals("火") && yearGan.equals("戊")) {
                feLiuGan = "火";
                heLiuGan = "丁";
                heShenLiuGan = fnComputeShishen(dayGan, heLiuGan);

                feYearGan = "火";
                heYearGan = "丙";
                heShenYearGan = fnComputeShishen(dayGan, heYearGan);
                msg = "戊癸合化火，易俊秀薄情。";
                arrHeChong.add(msg);
                msg = fnShenChangeBig(shenYearGan);
                arrHeChong.add(msg);
            }
        }
    
    }

    //#endregion

    //#region 重新计算五行个数，和生克数量
    feJin = 0; feMu = 0; feShui = 0; feHuo = 0; feTu = 0; feUp = 0; feDown = 0; feUp2 = 0;
    feGanJin = 0; feGanMu = 0; feGanShui = 0; feGanHuo = 0; feGanTu = 0;
    
    if( feYearGan.equals("金") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( feYearGan.equals("木") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;

    }
    if( feYearGan.equals("水") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }
    if( feYearGan.equals("火") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( feYearGan.equals("土") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( feUse1.equals(feYearGan) || feUse2.equals(feYearGan) ) {
        feUp = feUp + 1;
    }
    else {
        feDown = feDown + 1;
    }

    if( feMonthGan.equals("金") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( feMonthGan.equals("木") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;
    }
    if( feMonthGan.equals("水") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }
    if( feMonthGan.equals("火") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( feMonthGan.equals("土") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( feUse1.equals(feMonthGan) || feUse2.equals(feMonthGan) ) {
        feUp = feUp + 1;
        feUp2 = feUp2 + 1;
    }
    else {
        feDown = feDown + 1;
    }
    
    if( feDayGan.equals("金") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( feDayGan.equals("木") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;
    }
    if( feDayGan.equals("水") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }
    if( feDayGan.equals("火") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( feDayGan.equals("土") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( feUse1.equals(feDayGan) || feUse2.equals(feDayGan) ) {
        feUp = feUp + 1;
    }
    else {
        feDown = feDown + 1;
    }    
    
    if( feHourGan.equals("金") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( feHourGan.equals("木") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;
    }
    if( feHourGan.equals("水") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }
    if( feHourGan.equals("火") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( feHourGan.equals("土") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( feUse1.equals(feHourGan) || feUse2.equals(feHourGan) ) {
        feUp = feUp + 1;
        feUp2 = feUp2 + 1;
    }
    else {
        feDown = feDown + 1;
    }

    if( feBigGan.equals("金") ) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( feBigGan.equals("木") ) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;
    }
    if( feBigGan.equals("水") ) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }
    if( feBigGan.equals("火") ) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( feBigGan.equals("土") ) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( feUse1.equals(feBigGan) || feUse2.equals(feBigGan) ) {
        feUp = feUp + 1;
        feUp2 = feUp2 + 1;
    }
    else {
        feDown = feDown + 1;
    }

    if( feLiuGan.equals("金")) {
        feJin = feJin + 1;
        feGanJin = feGanJin + 1;
    }
    if( feLiuGan.equals("木")) {
        feMu = feMu + 1;
        feGanMu = feGanMu + 1;
    }
    if( feLiuGan.equals("水")) {
        feShui = feShui + 1;
        feGanShui = feGanShui + 1;
    }
    if( feLiuGan.equals("火")) {
        feHuo = feHuo + 1;
        feGanHuo = feGanHuo + 1;
    }
    if( feLiuGan.equals("土")) {
        feTu = feTu + 1;
        feGanTu = feGanTu + 1;
    }
    if( feUse1.equals(feLiuGan) || feUse2.equals(feLiuGan) ) {
        feUp = feUp + 1;
        feUp2 = feUp2 + 1;
    }
    else {
        feDown = feDown + 1;
    }

    if( feYearZhi.equals("金") ) {
        feJin = feJin + 1;
    }
    if( feYearZhi.equals("木") ) {
        feMu = feMu + 1;
    }
    if( feYearZhi.equals("水") ) {
        feShui = feShui + 1;
    }
    if( feYearZhi.equals("火") ) {
        feHuo = feHuo + 1;
    }
    if( feYearZhi.equals("土") ) {
        feTu = feTu + 1;
    }
    if( feUse1.equals(feYearZhi) || feUse2.equals(feYearZhi) ) {
        feUp = feUp + 1;
    }
    else {
        feDown = feDown + 1;
    }
    

    if( feMonthZhi.equals("金") ) {
        feJin = feJin + 1;
    }
    if( feMonthZhi.equals("木") ) {
        feMu = feMu + 1;
    }
    if( feMonthZhi.equals("水") ) {
        feShui = feShui + 1;
    }
    if( feMonthZhi.equals("火") ) {
        feHuo = feHuo + 1;
    }
    if( feMonthZhi.equals("土") ) {
        feTu = feTu + 1;
    }
    if( feUse1.equals(feMonthZhi) || feUse2.equals(feMonthZhi) ) {
        feUp = feUp + 1;
    }
    else {
        feDown = feDown + 1;
    }
    
    if( feDayZhi.equals("金") ) {
        feJin = feJin + 1;
    }
    if( feDayZhi.equals("木") ) {
        feMu = feMu + 1;
    }
    if( feDayZhi.equals("水") ) {
        feShui = feShui + 1;
    }
    if( feDayZhi.equals("火") ) {
        feHuo = feHuo + 1;
    }
    if( feDayZhi.equals("土") ) {
        feTu = feTu + 1;
    }
    if( feUse1.equals(feDayZhi) || feUse2.equals(feDayZhi) ) {
        feUp = feUp + 1;
        feUp2 = feUp2 + 1;
    }
    else {
        feDown = feDown + 1;
    }

    if( feHourZhi.equals("金") ) {
        feJin = feJin + 1;
    }
    if( feHourZhi.equals("木") ) {
        feMu = feMu + 1;
    }
    if( feHourZhi.equals("水") ) {
        feShui = feShui + 1;
    }
    if( feHourZhi.equals("火") ) {
        feHuo = feHuo + 1;
    }
    if( feHourZhi.equals("土") ) {
        feTu = feTu + 1;
    }
    if( feUse1.equals(feHourZhi) || feUse2.equals(feHourZhi) ) {
        feUp = feUp + 1;
    }
    else {
        feDown = feDown + 1;
    }

    if( feBigZhi.equals("金") ) {
        feJin = feJin + 1;
    }
    if( feBigZhi.equals("木") ) {
        feMu = feMu + 1;
    }
    if( feBigZhi.equals("水") ) {
        feShui = feShui + 1;
    }
    if( feBigZhi.equals("火") ) {
        feHuo = feHuo + 1;
    }
    if( feBigZhi.equals("土") ) {
        feTu = feTu + 1;
    }
    if( feUse1.equals(feBigZhi) || feUse2.equals(feBigZhi) ) {
        feUp = feUp + 1;
    }
    else {
        feDown = feDown + 1;
    }

    if( feLiuZhi.equals("金") ) {
        feJin = feJin + 1;
    }
    if( feLiuZhi.equals("木") ) {
        feMu = feMu + 1;
    }
    if( feLiuZhi.equals("水") ) {
        feShui = feShui + 1;
    }
    if( feLiuZhi.equals("火") ) {
        feHuo = feHuo + 1;
    }
    if( feLiuZhi.equals("土") ) {
        feTu = feTu + 1;
    }

    //#endregion

    //#region 计算十神 
        shenGuan = 0;
        shenSha = 0;
        shenYin = 0;
        shenXiao = 0;
        shenBi = 0;
        shenJie = 0;
        shenCaiz = 0;
        shenCaip = 0;
        shenShi = 0;
        shenShang = 0;

        if( heShenHourGan.equals("比") ) {
                shenBi = shenBi + 1;
            }
        if( heShenHourGan.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenHourGan.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenHourGan.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenHourGan.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenHourGan.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenHourGan.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenHourGan.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenHourGan.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenHourGan.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenHourZhi.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenHourZhi.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenHourZhi.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenHourZhi.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenHourZhi.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenHourZhi.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenHourZhi.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenHourZhi.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenHourZhi.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenHourZhi.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenDayZhi.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenDayZhi.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenDayZhi.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenDayZhi.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenDayZhi.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenDayZhi.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenDayZhi.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenDayZhi.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenDayZhi.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenDayZhi.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenMonthGan.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenMonthGan.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenMonthGan.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenMonthGan.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenMonthGan.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenMonthGan.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenMonthGan.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenMonthGan.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenMonthGan.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenMonthGan.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenMonthZhi.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenMonthZhi.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenMonthZhi.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenMonthZhi.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenMonthZhi.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenMonthZhi.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenMonthZhi.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenMonthZhi.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenMonthZhi.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenMonthZhi.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenYearGan.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenYearGan.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenYearGan.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenYearGan.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenYearGan.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenYearGan.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenYearGan.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenYearGan.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenYearGan.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenYearGan.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenYearZhi.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenYearZhi.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenYearZhi.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenYearZhi.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenYearZhi.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenYearZhi.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenYearZhi.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenYearZhi.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenYearZhi.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenYearZhi.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenBigGan.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenBigGan.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenBigGan.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenBigGan.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenBigGan.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenBigGan.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenBigGan.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenBigGan.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenBigGan.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenBigGan.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenBigZhi.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenBigZhi.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenBigZhi.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenBigZhi.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenBigZhi.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenBigZhi.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenBigZhi.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenBigZhi.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenBigZhi.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenBigZhi.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenLiuGan.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenLiuGan.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenLiuGan.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenLiuGan.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenLiuGan.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenLiuGan.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenLiuGan.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenLiuGan.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenLiuGan.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenLiuGan.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

        if( heShenLiuZhi.equals("比") ) {
            shenBi = shenBi + 1;
        }
        if( heShenLiuZhi.equals("劫") ) {
            shenJie = shenJie + 1;
        }
        if( heShenLiuZhi.equals("官") ) {
            shenGuan = shenGuan + 1;
        }
        if( heShenLiuZhi.equals("煞") ) {
            shenSha = shenSha + 1;
        }
        if( heShenLiuZhi.equals("印") ) {
            shenYin = shenYin + 1;
        }
        if( heShenLiuZhi.equals("枭") ) {
            shenXiao = shenXiao + 1;
        }
        if( heShenLiuZhi.equals("食") ) {
            shenShi = shenShi + 1;
        }
        if( heShenLiuZhi.equals("伤") ) {
            shenShang = shenShang + 1;
        }
        if( heShenLiuZhi.equals("财") ) {
            shenCaiz = shenCaiz + 1;
        }
        if( heShenLiuZhi.equals("才") ) {
            shenCaip = shenCaip + 1;
        }

    //#endregion

    //#region 天干四冲
    if( liuGan.equals("庚") && ( hourGan.equals("甲") || dayGan.equals("甲") || 
    monthGan.equals("甲") || yearGan.equals("甲") || bigGan.equals("甲") ) ) {
        msg = "甲庚相冲，";
        if( feMu <= feJin ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "甲"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "庚"));
        }
        arrHeChong.add(msg);
    }
    if( liuGan.equals("甲") && ( hourGan.equals("庚") || dayGan.equals("庚") || 
    monthGan.equals("庚") || yearGan.equals("庚") || bigGan.equals("庚") ) ) {
        msg = "甲庚相冲，";
        if( feMu <= feJin ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "甲"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "庚"));
        }
        arrHeChong.add(msg);
    }

    if( liuGan.equals("乙") && ( hourGan.equals("辛") || dayGan.equals("辛") || 
    monthGan.equals("辛") || yearGan.equals("辛") || bigGan.equals("辛") ) ) {
        msg = "乙辛相冲，";
        if( feMu <= feJin ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "乙"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "辛"));
        }
        arrHeChong.add(msg);
    }
    if( liuGan.equals("辛") && ( hourGan.equals("乙") || dayGan.equals("乙") || 
    monthGan.equals("乙") || yearGan.equals("乙") || bigGan.equals("乙") ) ) {
        msg = "乙辛相冲，";
        if( feMu <= feJin ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "乙"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "辛"));
        }
        arrHeChong.add(msg);
    }

    if( liuGan.equals("丙") && ( hourGan.equals("壬") || dayGan.equals("壬") || 
    monthGan.equals("壬") || yearGan.equals("壬") || bigGan.equals("壬") ) ) {
        msg = "丙壬相冲，";
        if( feHuo <= feShui ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "丙"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "壬"));
        }
        arrHeChong.add(msg);
    }
    if( liuGan.equals("壬") && ( hourGan.equals("丙") || dayGan.equals("丙") || 
    monthGan.equals("丙") || yearGan.equals("丙") || bigGan.equals("丙") ) ) {
        msg = "丙壬相冲，";
        if( feHuo <= feShui ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "丙"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "壬"));
        }
        arrHeChong.add(msg);
    } 

    if( liuGan.equals("丁") && ( hourGan.equals("癸") || dayGan.equals("癸") || 
    monthGan.equals("癸") || yearGan.equals("癸") || bigGan.equals("癸") ) ) {
        msg = "丁癸相冲，";
        if( feHuo <= feShui ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "丁"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "癸"));
        }
        arrHeChong.add(msg);
    }
    if( liuGan.equals("癸") && ( hourGan.equals("丁") || dayGan.equals("丁") || 
    monthGan.equals("丁") || yearGan.equals("丁") || bigGan.equals("丁") ) ) {
        msg = "丁癸相冲，";
        if( feHuo <= feShui ) {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "丁"));
        }
        else {
            msg += fnShenChangeBig(fnComputeShishen(dayGan, "癸"));
        }
        arrHeChong.add(msg);
    }
    //#endregion

    /// 地支刑冲害 
    //#region 地支六冲
    if( liuZhi.equals("子") && ( hourZhi.equals("午") || dayZhi.equals("午") || 
    monthZhi.equals("午") || yearZhi.equals("午") || bigZhi.equals("午") ) ) {
        msg = "子午相冲，易不安。";
        if( dayZhi.equals("午") ) {
            msg += "冲婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }
    if( liuZhi.equals("午") && ( hourZhi.equals("子") || dayZhi.equals("子") || 
    monthZhi.equals("子") || yearZhi.equals("子") || bigZhi.equals("子") ) ) {
        msg = "子午相冲，易不安。";
        if( dayZhi.equals("子") ) {
            msg += "冲婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }

    if( liuZhi.equals("丑") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
    monthZhi.equals("未") || yearZhi.equals("未") || bigZhi.equals("未") ) ) {
        msg = "丑未相冲，事多阻。";
        if( dayZhi.equals("未") ) {
            msg += "冲婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }
    if( liuZhi.equals("未") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
    monthZhi.equals("丑") || yearZhi.equals("丑") || bigZhi.equals("丑") ) ) {
        msg = "丑未相冲，事多阻。";
        if( dayZhi.equals("丑") ) {
            msg += "冲婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }

    if( liuZhi.equals("寅") && ( hourZhi.equals("申") || dayZhi.equals("申") || 
    monthZhi.equals("申") || yearZhi.equals("申") || bigZhi.equals("申") ) ) {
        msg = "寅申相冲，多情或者管闲事。";
        if( dayZhi.equals("申") ) {
            msg += "冲婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }
    if( liuZhi.equals("申") && ( hourZhi.equals("寅") || dayZhi.equals("寅") || 
    monthZhi.equals("寅") || yearZhi.equals("寅") || bigZhi.equals("寅") ) ) {
        msg = "寅申相冲，多情或者管闲事。";
        if( dayZhi.equals("寅") ) {
            msg += "冲婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }

    if( liuZhi.equals("卯") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || 
            monthZhi.equals("酉") || yearZhi.equals("酉") || bigZhi.equals("酉") ) ) {
        msg = "卯酉相冲，多劳碌，易情色纠纷。";
        if( dayZhi.equals("酉") ) {
            msg += "冲婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }
    if( liuZhi.equals("酉") && ( hourZhi.equals("卯") || dayZhi.equals("卯") || 
    monthZhi.equals("卯") || yearZhi.equals("卯") || bigZhi.equals("卯") ) ) {
        msg = "卯酉相冲，多劳碌，易情色纠纷。";
        if( dayZhi.equals("卯") ) {
            msg += "冲婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }

    if( liuZhi.equals("辰") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
    monthZhi.equals("戌") || yearZhi.equals("戌") || bigZhi.equals("戌") ) ) {
        msg = "辰戌相冲，克亲人，帮他人。";
        if( dayZhi.equals("戌") ) {
            msg += "冲婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }
    if( liuZhi.equals("戌") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || 
    monthZhi.equals("辰") || yearZhi.equals("辰") || bigZhi.equals("辰") ) ) {
        msg = "辰戌相冲，克亲人，帮他人。";
        if( dayZhi.equals("辰") ) {
            msg += "冲婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }

    if( liuZhi.equals("巳") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || 
    monthZhi.equals("亥") || yearZhi.equals("亥") || bigZhi.equals("亥") ) ) {
        msg = "巳亥相冲，易帮他人。";
        if( dayZhi.equals("亥") ) {
            msg += "冲婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }
    if( liuZhi.equals("亥") && ( hourZhi.equals("巳") || dayZhi.equals("巳") || 
    monthZhi.equals("巳") || yearZhi.equals("巳") || bigZhi.equals("巳") ) ) {
        msg = "巳亥相冲，易帮他人。";
        if( dayZhi.equals("巳") ) {
            msg += "冲婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }

    //#endregion

    //#region 地址六害 
    if( liuZhi.equals("子") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
    monthZhi.equals("未") || yearZhi.equals("未") || bigZhi.equals("未") ) ) {
        msg = "子未相害，无助于子孙。";
        if( dayZhi.equals("未") ) {
            msg += "害婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }
    if( liuZhi.equals("未") && ( hourZhi.equals("子") || dayZhi.equals("子") || 
    monthZhi.equals("子") || yearZhi.equals("子") || bigZhi.equals("子") ) ) {
        msg = "子未相害，无助于子孙。";
        if( dayZhi.equals("子") ) {
            msg += "害婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }

    if( liuZhi.equals("丑") && ( hourZhi.equals("午") || dayZhi.equals("午") || 
    monthZhi.equals("午") || yearZhi.equals("午") || bigZhi.equals("午") ) ) {
        msg = "丑午相害，易怒，无耐心，大运逢弱易有伤残。";
        if( dayZhi.equals("午") ) {
            msg += "害婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }
    if( liuZhi.equals("午") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
    monthZhi.equals("丑") || yearZhi.equals("丑") || bigZhi.equals("丑") ) ) {
        msg = "丑午相害，易怒，无耐心，大运逢弱易有伤残。";
        if( dayZhi.equals("丑") ) {
            msg += "害婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }

    if( liuZhi.equals("寅") && ( hourZhi.equals("巳") || dayZhi.equals("巳") || 
    monthZhi.equals("巳") || yearZhi.equals("巳") || bigZhi.equals("巳") ) ) {
        msg = "寅巳相害，多疾病。";
        if( dayZhi.equals("巳") ) {
            msg += "害婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }
    if( liuZhi.equals("巳") && ( hourZhi.equals("寅") || dayZhi.equals("寅") || 
    monthZhi.equals("寅") || yearZhi.equals("寅") || bigZhi.equals("寅") ) ) {
        msg = "寅巳相害，多疾病。";
        if( dayZhi.equals("寅") ) {
            msg += "害婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }

    if( liuZhi.equals("卯") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || 
    monthZhi.equals("辰") || yearZhi.equals("辰") || bigZhi.equals("辰") ) ) {
        msg = "卯辰相害，易怒，无耐心，大运逢弱易有伤残。";
        if( dayZhi.equals("辰") ) {
            msg += "害婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }
    if( liuZhi.equals("辰") && ( hourZhi.equals("卯") || dayZhi.equals("卯") || 
    monthZhi.equals("卯") || yearZhi.equals("卯") || bigZhi.equals("卯") ) ) {
        msg = "卯辰相害，易怒，无耐心，大运逢弱易有伤残。";
        if( dayZhi.equals("卯") ) {
            msg += "害婚宫，影响婚姻，或者口角或两地分居等。";
        }
        arrHeChong.add(msg);
    }

    if( liuZhi.equals("申") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || 
    monthZhi.equals("亥") || yearZhi.equals("亥") || bigZhi.equals("亥") ) ) {
        msg = "申亥相害，";
        if( dayZhi.equals("亥") ) {
            msg += "害婚宫，影响婚姻，或者口角或两地分居等。";
        }
        msg += fnShenChangeBig(fnComputeShishen(dayGan, "亥"));
        arrHeChong.add(msg);
    }
    if( liuZhi.equals("亥") && ( hourZhi.equals("申") || dayZhi.equals("申") || 
    monthZhi.equals("申") || yearZhi.equals("申") || bigZhi.equals("申") ) ) {
        msg = "申亥相害，";
        if( dayZhi.equals("申") ) {
            msg += "害婚宫，影响婚姻，或者口角或两地分居等。";
        }
        msg += fnShenChangeBig(fnComputeShishen(dayGan, "申"));
        arrHeChong.add(msg);
    }

    if( liuZhi.equals("酉") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
    monthZhi.equals("戌") || yearZhi.equals("戌") || bigZhi.equals("戌") ) ) {
        msg = "酉戌相害，";
        if( dayZhi.equals("戌") ) {
            msg += "害婚宫，影响婚姻，或者口角或两地分居等。";
        }
        msg += fnShenChangeBig(fnComputeShishen(dayGan, "戌"));
        arrHeChong.add(msg);
    }
    if( liuZhi.equals("戌") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || 
    monthZhi.equals("酉") || yearZhi.equals("酉") || bigZhi.equals("酉") ) ) {
        msg = "酉戌相害，";
        if( dayZhi.equals("酉") ) {
            msg += "害婚宫，影响婚姻，或者口角或两地分居等。";
        }
        msg += fnShenChangeBig(fnComputeShishen(dayGan, "酉"));
        arrHeChong.add(msg);
    }
    
    //#endregion

    //#region 地支相刑 
    if( liuZhi.equals("寅")) {
        if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || 
        yearZhi.equals("巳") || bigZhi.equals("巳") ) {
            if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || 
            yearZhi.equals("申") || bigZhi.equals("申") ) {
                msg = "寅巳申三刑，易官司或是非，女不易怀孕或易流产。";
                if( dayZhi.equals("巳") || dayZhi.equals("申") ) {
                    msg += "刑婚宫，影响婚姻，或者口角或两地分居等。";
                }
                msg += fnShenChangeBig(fnComputeShishen(dayGan, "巳"));
                msg += fnShenChangeBig(fnComputeShishen(dayGan, "申"));

                arrHeChong.add(msg);
            }
        }
    }
    else if( liuZhi.equals("巳")) {
        if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || 
        yearZhi.equals("申") || bigZhi.equals("申") ) {
            if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || 
            yearZhi.equals("寅") || bigZhi.equals("寅")) {
                msg = "寅巳申三刑，易官司或是非，女不易怀孕或易流产。";
                if( dayZhi.equals("寅") || dayZhi.equals("申") ) {
                    msg += "刑婚宫，影响婚姻，或者口角或两地分居等。";
                }
                msg += fnShenChangeBig(fnComputeShishen(dayGan, "申"));
                msg += fnShenChangeBig(fnComputeShishen(dayGan, "寅"));

                arrHeChong.add(msg);
            }
        }
    }
    else if( liuZhi.equals("申")) {
        if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || 
        yearZhi.equals("寅") || bigZhi.equals("寅") ) {
            if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || 
            yearZhi.equals("巳") || bigZhi.equals("巳") ) {
                msg = "寅巳申三刑，易官司或是非，女不易怀孕或易流产。";
                if( dayZhi.equals("寅") || dayZhi.equals("巳") ) {
                    msg += "刑婚宫，影响婚姻，或者口角或两地分居等。";
                }
                msg += fnShenChangeBig(fnComputeShishen(dayGan, "寅"));
                msg += fnShenChangeBig(fnComputeShishen(dayGan, "巳"));

                arrHeChong.add(msg);
            }
        }
    }

    if(liuZhi.equals("未")) {
        if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || 
        yearZhi.equals("丑") || bigZhi.equals("丑") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || 
            yearZhi.equals("戌") || bigZhi.equals("戌") ) {
                msg = "未丑戌三刑，易挫折，女易孤单。";
                if( dayZhi.equals("丑") || dayZhi.equals("戌") ) {
                    msg += "刑婚宫，影响婚姻，或者口角或两地分居等。";
                }
                msg += fnShenChangeBig(fnComputeShishen(dayGan, "丑"));  
                ///msg += fnShenChangeBig(fnComputeShishen(dayGan, "戌"));  /// 戌丑处理一个就行了，五行一样。

                arrHeChong.add(msg);
            }
        }
    }
    else if( liuZhi.equals("丑")) {
        if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || 
        yearZhi.equals("未") || bigZhi.equals("未") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || 
            yearZhi.equals("戌") || bigZhi.equals("戌") ) {
                msg = "未丑戌三刑，易挫折，女易孤单。";
                if( dayZhi.equals("未") || dayZhi.equals("戌") ) {
                    msg += "刑婚宫，影响婚姻，或者口角或两地分居等。";
                }
                msg += fnShenChangeBig(fnComputeShishen(dayGan, "未"));
                msg += fnShenChangeBig(fnComputeShishen(dayGan, "戌"));

                arrHeChong.add(msg);
            }
        }
    }
    else if( liuZhi.equals("戌")) {
        if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || 
        yearZhi.equals("未") || bigZhi.equals("未") ) {
            if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || 
            yearZhi.equals("丑") || bigZhi.equals("丑") ) {
                msg = "未丑戌三刑，易挫折，女易孤单。";
                if( dayZhi.equals("未") || dayZhi.equals("丑") ) {
                    msg += "刑婚宫，影响婚姻，或者口角或两地分居等。";
                }
                msg += fnShenChangeBig(fnComputeShishen(dayGan, "未"));
                msg += fnShenChangeBig(fnComputeShishen(dayGan, "丑"));

                arrHeChong.add(msg);
            }
        }
    }

    if( liuZhi.equals("卯") && (hourZhi.equals("子") || dayZhi.equals("子") || 
    monthZhi.equals("子") || yearZhi.equals("子") || bigZhi.equals("子") ) ) {
        msg = "子卯二刑，与上级(辈)或者下级(辈)不和。";
        if( dayZhi.equals("子") ) {
            msg += "刑婚宫，影响婚姻，或者口角或两地分居等。";
        }
        msg += fnShenChangeBig(fnComputeShishen(dayGan, "子"));
        arrHeChong.add(msg);
    }
    else if( liuZhi.equals("子") && (hourZhi.equals("卯") || dayZhi.equals("卯") || 
    monthZhi.equals("卯") || yearZhi.equals("卯") || bigZhi.equals("卯") ) ) {
        msg = "子卯二刑，与上级(辈)或者下级(辈)不和。";
        if( dayZhi.equals("卯") ) {
            msg += "刑婚宫，影响婚姻，或者口角或两地分居等。";
        }
        msg += fnShenChangeBig(fnComputeShishen(dayGan, "卯"));
        arrHeChong.add(msg);
    }

    if( liuZhi.equals("辰") && (hourZhi.equals("辰") || dayZhi.equals("辰") || 
    monthZhi.equals("辰") || yearZhi.equals("辰") || bigZhi.equals("辰") ) ) {
        msg = "辰辰自刑，有始无终，常陷困境。";
        if( dayZhi.equals("辰") ) {
            msg += "刑婚宫，影响婚姻，或者口角或两地分居等。";
        }
        msg += fnShenChangeBig(fnComputeShishen(dayGan, "辰"));
        arrHeChong.add(msg);
    }

    if( liuZhi.equals("午") && (hourZhi.equals("午") || dayZhi.equals("午") || 
    monthZhi.equals("午") || yearZhi.equals("午") || bigZhi.equals("午") ) ) {
        msg = "午午自刑，有始无终，常陷困境。";
        if( dayZhi.equals("午") ) {
            msg += "刑婚宫，影响婚姻，或者口角或两地分居等。";
        }
        msg += fnShenChangeBig(fnComputeShishen(dayGan, "午"));
        arrHeChong.add(msg);
    }

    if( liuZhi.equals("酉") && ( hourZhi.equals("酉")  || dayZhi.equals("酉") || 
    monthZhi.equals("酉") || yearZhi.equals("酉") || bigZhi.equals("酉") ) ) {
        msg = "酉酉自刑，有始无终，常陷困境。";
        if( dayZhi.equals("酉") ) {
            msg += "刑婚宫，影响婚姻，或者口角或两地分居等。";
        }
        msg += fnShenChangeBig(fnComputeShishen(dayGan, "酉"));
        arrHeChong.add(msg);
    }
    if( liuZhi.equals("亥") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || 
    monthZhi.equals("亥") || yearZhi.equals("亥") || bigZhi.equals("亥")) ) {
        msg = "亥亥自刑，有始无终，常陷困境。";
        if( dayZhi.equals("亥") ) {
            msg += "刑婚宫，影响婚姻，或者口角或两地分居等。";
        }
        msg += fnShenChangeBig(fnComputeShishen(dayGan, "亥"));
        arrHeChong.add(msg);
    }

    //#endregion

    /// 分析合冲之后的十神，
    //#region 流年变更 
    if( !shenLiuGan.equals(heShenLiuGan) ) {
        msg = "流年天干由 " + shenLiuGan + " 变成 " + heShenLiuGan + "。";
        arrAnalysis.add(msg);
    }
    if( !shenLiuZhi.equals(heShenLiuZhi) ) {
        msg = "流年地支由 " + shenLiuZhi + " 变成 " + heShenLiuZhi + "。";
        arrAnalysis.add(msg);
    }

    msg = "流年为 " + heShenLiuGan + heShenLiuZhi + " 运。";
    //#endregion

    /// 男合财，女合官，合婚宫
    //#region 命局官财被合 
    if( age >= 18 ) {

        arrAnalysis.addAll(arrHeChong);

        /// 合婚宫
        if( !shenDayZhi.equals(heShenDayZhi) ) {
            msg = "婚宫有变动，" + shenDayZhi + "变成" + heShenDayZhi + "，婚姻状态可能会有变化。";
            arrAnalysis.add(msg);
        }
        /// 男合财，女合官
        if( sex.equals("男") ) {
            if( !shenYearGan.equals(heShenYearGan) && (shenYearGan.equals("财") || shenYearGan.equals("才")) ) {
                msg = "命局财被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenYearZhi.equals(heShenYearZhi) && (shenYearZhi.equals("财") || shenYearZhi.equals("才")) ) {
                msg = "命局财被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenMonthGan.equals(heShenMonthGan) && (shenMonthGan.equals("财") || shenMonthGan.equals("才")) ) {
                msg = "命局财被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenMonthZhi.equals(heShenMonthZhi) && (shenMonthZhi.equals("财") || shenMonthZhi.equals("才")) ) {
                msg = "命局财被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenDayZhi.equals(heShenDayZhi) && (shenDayZhi.equals("财") || shenDayZhi.equals("才")) ) {
                msg = "命局财被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenHourGan.equals(heShenHourGan) && (shenHourGan.equals("财") || shenHourGan.equals("才")) ) {
                msg = "命局财被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenHourZhi.equals(heShenHourZhi) && (shenHourZhi.equals("财") || shenHourZhi.equals("才")) ) {
                msg = "命局财被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
        }
        else {
            if( !shenYearGan.equals(heShenYearGan) && (shenYearGan.equals("官") || shenYearGan.equals("煞")) ) {
                msg = "命局官被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenYearZhi.equals(heShenYearZhi) && (shenYearZhi.equals("官") || shenYearZhi.equals("煞")) ) {
                msg = "命局官被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenMonthGan.equals(heShenMonthGan) && (shenMonthGan.equals("官") || shenMonthGan.equals("煞")) ) {
                msg = "命局官被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenMonthZhi.equals(heShenMonthZhi) && (shenMonthZhi.equals("官") || shenMonthZhi.equals("煞")) ) {
                msg = "命局官被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenDayZhi.equals(heShenDayZhi) && (shenDayZhi.equals("官") || shenDayZhi.equals("煞")) ) {
                msg = "命局官被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenHourGan.equals(heShenHourGan) && (shenHourGan.equals("官") || shenHourGan.equals("煞")) ) {
                msg = "命局官被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
            else if( !shenHourZhi.equals(heShenHourZhi) && (shenHourZhi.equals("官") || shenHourZhi.equals("煞")) ) {
                msg = "命局官被合，可能婚姻会有变化。";
                arrAnalysis.add(msg);
            }
        }

    }

    //#endregion

    //#region 大运十神分析
    msg = "";
    if( age < 18 ) { /// 20岁前的大运
        if( heShenLiuGan.equals("官") || heShenLiuGan.equals("煞")) {
            if( heShenLiuZhi.equals("官") || heShenLiuZhi.equals("煞")) { //官官
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "学习稍微好一些，虽然调皮但是讨人喜欢。";
                }
                else { /// 身弱
                    if( (shenYin + shenXiao) > 0 ) {
                        msg = msg + "很努力，学习稍微好一些，爱惹事情。";
                    }
                    else {
                        msg = msg + "很努力，学习一般，爱惹事情。";
                    }
                }
            }
            else if( heShenLiuZhi.equals("印") || heShenLiuZhi.equals("枭")) {  // 官印
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，懂事，讨人喜欢。";
                    }
                    else {
                        msg = msg + "学习好，董事，讨人喜欢。";
                    }
                }
                else { /// 身弱
                    if( (shenGuan + shenSha) > 3) {
                        msg = msg + "比较努力，学习好，爱惹事情。";
                    }
                    else {
                        msg = msg + "比较努力，学习好，比较调皮。";
                    }
                }
            }
            else if( heShenLiuZhi.equals("比") || heShenLiuZhi.equals("劫")) { // 官比
                if( (shenYin + shenXiao) >= 3 ) {
                    msg = msg + "学习不好，";
                }
                else {
                    msg = msg + "学习好，";
                }
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "比较懂事，比较要强。";
                }
                else { /// 身弱
                    msg = msg + "爱惹事，比较任性。";
                }
            }
            else if( heShenLiuZhi.equals("食") || heShenLiuZhi.equals("伤")) { // 官食
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "比较懂事，有才艺，表现好。";
                }
                else { /// 身弱
                    msg = msg + "比较调皮，易有病。";
                }
            }
            else if( heShenLiuZhi.equals("财") || heShenLiuZhi.equals("才")) { // 官财
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "比较懂事，讨人喜欢，不爱学习。";
                }
                else { /// 身弱
                    msg = msg + "爱惹事。不爱学习。易有病。";
                }
            }
        }
        else if( heShenLiuGan.equals("印") || heShenLiuGan.equals("枭")) {
            if( heShenLiuZhi.equals("官") || heShenLiuZhi.equals("煞")) { // 印官
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，懂事，讨人喜欢。";
                    }
                    else {
                        msg = msg + "学习好，董事，讨人喜欢。";
                    }
                }
                else { /// 身弱
                    if( (shenGuan + shenSha) > 3) {
                        msg = msg + "比较努力，学习好，爱惹事情。";
                    }
                    else {
                        msg = msg + "比较努力，学习好，比较调皮。";
                    }
                }
            }
            else if( heShenLiuZhi.equals("印") || heShenLiuZhi.equals("枭")) { // 印印
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，胆小，不吃苦。";
                    }
                    else {
                        msg = msg + "学习好，比较要强。";
                    }
                }
                else { /// 身弱
                    msg = msg + "学习好，有个性。";
                }
            }
            else if( heShenLiuZhi.equals("比") || heShenLiuZhi.equals("劫")) { // 印比
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，胆小，不吃苦，比较调皮。";
                    }
                    else {
                        msg = msg + "学习好，比较调皮。";
                    }
                }
                else { /// 身弱
                    msg = msg + "学习好，比较要强。";
                }
            }
            else if( heShenLiuZhi.equals("食") || heShenLiuZhi.equals("伤")) {  // 印食
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，胆小，不吃苦，比较调皮。";
                    }
                    else {
                        msg = msg + "学习好，表现好。";
                    }
                }
                else { /// 身弱
                    msg = msg + "学习好，有些任性。";
                }
            }
            else if( heShenLiuZhi.equals("财") || heShenLiuZhi.equals("才")) { // 印财
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "虽然学习有波动，不会太差。";
                }
                else { /// 身弱
                    msg = msg + "虽然学习有波动，最后不太好。";
                }
            }
        }
        else if( heShenLiuGan.equals("比") || heShenLiuGan.equals("劫")) {
            if( heShenLiuZhi.equals("官") || heShenLiuZhi.equals("煞")) { // 比官
                if( (shenYin + shenXiao) >= 3 ) {
                    msg = msg + "学习不好，";
                }
                else {
                    msg = msg + "学习好，";
                }
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "比较懂事，比较要强。";
                }
                else { /// 身弱
                    msg = msg + "爱惹事，比较任性。";
                }
            }
            else if( heShenLiuZhi.equals("印") || heShenLiuZhi.equals("枭")) { // 比印
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，胆小，不吃苦，比较调皮。";
                    }
                    else {
                        msg = msg + "学习好，比较调皮。";
                    }
                }
                else { /// 身弱
                    msg = msg + "学习好，比较要强。";
                }
            }
            else if( heShenLiuZhi.equals("比") || heShenLiuZhi.equals("劫")) { // 比比
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "学习一般，比较任性。";
                }
                else { /// 身弱
                    msg = msg + "学习一般，比较要强。";
                }
            }
            else if( heShenLiuZhi.equals("食") || heShenLiuZhi.equals("伤")) { // 比食
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，胆小，不吃苦，比较调皮。";
                    }
                    else {
                        msg = msg + "学习一般，比较要强，表现好。";
                    }
                }
                else { /// 身弱
                    msg = msg + "学习一般，比较要强，有些任性。";
                }
            }
            else if( heShenLiuZhi.equals("财") || heShenLiuZhi.equals("才")) { // 比财
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "不爱学习，比较任性。";
                }
                else { /// 身弱
                    msg = msg + "不爱学习，比较要强。";
                }
            }
        }
        else if( heShenLiuGan.equals("食") || heShenLiuGan.equals("伤")) {
            if( heShenLiuZhi.equals("官") || heShenLiuZhi.equals("煞")) { // 食官
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "比较懂事，有才艺，表现好。";
                }
                else { /// 身弱
                    msg = msg + "比较调皮，易有病。";
                }
            }
            else if( heShenLiuZhi.equals("印") || heShenLiuZhi.equals("枭")) { // 食印
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，胆小，不吃苦，比较调皮。";
                    }
                    else {
                        msg = msg + "学习好，表现好。";
                    }
                }
                else { /// 身弱
                    msg = msg + "学习好，有些任性。";
                }
            }
            else if( heShenLiuZhi.equals("比") || heShenLiuZhi.equals("劫")) { // 食比
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + "学习不好，胆小，不吃苦，比较调皮。";
                    }
                    else {
                        msg = msg + "学习一般，比较要强，表现好。";
                    }
                }
                else { /// 身弱
                    msg = msg + "学习一般，比较要强，有些任性。";
                }
            }
            else if( heShenLiuZhi.equals("食") || heShenLiuZhi.equals("伤")) { // 食食
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "学习一般，有才艺，表现好。";
                }
                else { /// 身弱
                    msg = msg + "学习一般，有些任性，易有病。";
                }
            }
            else if( heShenLiuZhi.equals("财") || heShenLiuZhi.equals("才")) { // 食财
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "不爱学习，有才艺，表现好。";
                }
                else { /// 身弱
                    msg = msg + "不爱学习，有些任性，易有病。";
                }
            }
        }
        else if( heShenLiuGan.equals("财") || heShenLiuGan.equals("才")) {
            if( heShenLiuZhi.equals("官") || heShenLiuZhi.equals("煞")) { // 财官
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "比较懂事，讨人喜欢，不爱学习。";
                }
                else { /// 身弱
                    msg = msg + "爱惹事。不爱学习。易有病。";
                }
            }
            else if( heShenLiuZhi.equals("印") || heShenLiuZhi.equals("枭")) { // 财印
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "虽然学习有波动，不会太差。";
                }
                else { /// 身弱
                    msg = msg + "虽然学习有波动，最后不太好。";
                }
            }
            else if( heShenLiuZhi.equals("比") || heShenLiuZhi.equals("劫")) { // 财比
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "不爱学习，比较任性。";
                }
                else { /// 身弱
                    msg = msg + "不爱学习，比较要强。";
                }
            }
            else if( heShenLiuZhi.equals("食") || heShenLiuZhi.equals("伤")) { // 财食
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "不爱学习，有才艺，表现好。";
                }
                else { /// 身弱
                    msg = msg + "不爱学习，有些任性，易有病。";
                }
            }
            else if( heShenLiuZhi.equals("财") || heShenLiuZhi.equals("才")) { // 财财
                if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                    msg = msg + "不爱学习。有压力。";
                }
                else { /// 身弱
                    msg = msg + "不爱学习，有压力，易有病。";
                }
            }
        }
        arrAnalysis.add(msg);
        return arrAnalysis;
    }

    if( heShenLiuGan.equals("官") || heShenLiuGan.equals("煞")) {
        if( heShenLiuZhi.equals("官") || heShenLiuZhi.equals("煞")) { // 官官
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 本年相对较好，事业有发展。";
                if( (shenBi + shenJie ) >= 3 ) {
                    msg = msg + "有同事或者朋友帮忙解决事业问题。";
                }
                if( (shenYin + shenXiao ) >= 3 ) {
                    msg = msg + "有长辈或者贵人帮忙解决事业问题。";
                }
            }
            else { /// 身弱
                if( m_selfStrength == 1 ) { /// 命局身强
                    msg = msg + "本年相对较好，事业有发展。";
                }
                else {
                    msg = msg + "本年相对不好，即使有仕途，但工作压力变大，或者会有官司缠身。";
                }
                if( shenShang > 0 && (shenYin + shenXiao) == 0 ) {
                    msg = msg + "有伤官，" + "有官司缠身的概率较大。";
                }
            }
            if( !heShenBigGan.equals(heShenLiuZhi) ) {
                msg = msg + "官杀混杂，" + "事业易有波折。";
            }

            if( sex.equals("女")) {
                msg = msg + "有异性缘。";
                if( feDown > feUp ) {
                    msg = msg + "易有情色纠纷。";
                }
            }
        }
        else if( heShenLiuZhi.equals("印") || heShenLiuZhi.equals("枭")) { // 官印
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenYin + shenXiao) > 3) {
                    msg = msg + " 本年相对一般，事业有发展，对财运不好，感到无助。";
                }
                else {
                    msg = msg + " 本年相对较好，事业有发展，有贵人相助。在学业，技术等方面可有提高。对财运不好。";
                }

            }
            else { /// 身弱
                msg = msg + " 本年相对一般，事业有发展。学业，技术等方面可有提高。对财运不好。";
            }
            if( sex.equals("女")) {
                msg = msg + "有异性缘。";
            }
        }
        else if( heShenLiuZhi.equals("比") || heShenLiuZhi.equals("劫")) { // 官比
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 本年相对较好，事业发展较好，有同事或者朋友相助。";
            }
            else { /// 身弱
                msg = msg + " 本年相对一般，事业有发展。财运可能会变好一些。";
            }
            if( sex.equals("女")) {
                msg = msg + "有异性缘。";
            }
        }
        else if( heShenLiuZhi.equals("食") || heShenLiuZhi.equals("伤")) { // 官食
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenYin + shenXiao) > 0) {
                    if( (shenCaip + shenCaiz) > 0 ) {
                        msg = msg + "有印克制食伤，"+ "本年相对较好，财运官运都有发展和变化。";
                    }
                    else {
                        msg = msg + " 有印克制食伤，" + "本年相对还行，事业有发展和变化。";
                    }
                }
                else {
                    msg = msg + " 无印克制，" + "本年相对一般，事业有波动，但是往好的方向发展。";
                }
            }
            else { /// 身弱
                if( zpSheng >= zpKe ) {
                    msg = msg + " 本年相对较好，事业有波动，但是往好的方向发展。";
                }
                else {
                    msg = msg + " 本年相对不好，事业波动下行，还有可能官司缠身。易得伤病。";
                }
            }
            if( sex.equals("女")) {
                msg = msg + "有异性缘，也容易伤及家庭。";
            }
        }
        else if( heShenLiuZhi.equals("财") || heShenLiuZhi.equals("才")) { // 官财
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 本年相对较好，财运官运都有发展。";
            }
            else { /// 身弱
                if( zpSheng >= zpKe ) {
                    msg = msg+ " 本年相对较好，财运官运都有发展。";
                }
                else {
                    msg = msg + " 本年相对不好，事业有波动，财运有波动，或者往好的方向发展则很辛苦，或者往不好方向发展。天克地冲易得伤病。";
                }
            }
            msg = msg + "有异性缘，或者婚姻有变动。";
        }
    }
    else if( heShenLiuGan.equals("印") || heShenLiuGan.equals("枭")) {
        if( heShenLiuZhi.equals("官") || heShenLiuZhi.equals("煞")) { // 印官
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenYin + shenXiao) > 3 ) {
                    msg = msg + " 本年相对一般，事业有发展，对财运不好。感到无助，可能会名誉受损。";
                }
                else {
                    msg = msg + " 本年相对较好，事业有发展，有贵人相助。在学业，技术等方面可有提高。对财运不好。";
                }
            }
            else { /// 身弱
                if( (shenGuan + shenSha) > 3) {
                    msg = msg + " 本年相对一般，事业不顺。学业，技术等方面可有提高。";
                }
                else {
                    msg = msg + " 本年相对一般，事业不顺，财运稍好。学业，技术等方面可有提高。";
                }
            }
            if(  sex.equals("女")) {
                msg = msg + "有异性缘。";
            }
        }
        else if( heShenLiuZhi.equals("印") || heShenLiuZhi.equals("枭")) { // 印印
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenYin + shenXiao) > 3 ) {
                    msg = msg + " 本年相对不好，对财运不好。感到无助，可能会名誉受损。";
                }
                else {
                    msg = msg + "本年相对不好，财运官运都不顺利。在学业，技术等方面可有提高。";
                }
            }
            else { /// 身弱
                msg = msg + " 本年相对较好，学业，技术等方面可有提高。有人相帮，各个方面都会顺利。财运不佳。";
            }
        }
        else if( heShenLiuZhi.equals("比") || heShenLiuZhi.equals("劫")) { // 印比
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenYin + shenXiao) > 3 ) {
                    msg = msg + " 本年相对不好，对财运不好，被亲朋所累，感到无助。可能会名誉受损。";
                }
                else {
                    msg = msg + "本年相对不好，对财运不好，被亲朋所累。";
                }
            }
            else { /// 身弱
                msg = msg + " 本年相对较好，学业，技术等方面可有提高。有人相帮，有同事朋友相助，各个方面都会顺利。";
            }
        }
        else if( heShenLiuZhi.equals("食") || heShenLiuZhi.equals("伤")) { // 印食
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenCaip + shenCaiz) > 0 ) {
                    msg = msg + " 本年相对较好，财运有发展机会，事业有波动。";
                }
                else {
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + " 本年相对一般，财运和事业有波动，感到无助。可能会名誉受损。";
                    }
                    else {
                        msg = msg + " 本年相对一般，事业和财运会有波动，相对向好的方向发展。";
                    }
                }
            }
            else { /// 身弱
                msg = msg + " 本年相对一般，学业，技术等方面可有提高。财运会有发展的机会，事业有波动。";
            }
            if(  sex.equals("女")) {
                if( (shenGuan + shenSha) > 0 ) {
                    msg = msg + "对家庭或婚姻有不好的影响。";
                }
            }
        }
        else if( heShenLiuZhi.equals("财") || heShenLiuZhi.equals("才")) { // 印财
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenShi + shenShang) > 0 ) {
                    msg = msg + " 本年相对较好，财运较好。";
                }
                else {
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + " 本年相对一般，感到无助，可能会名誉受损。财运会有波动，相对向好的方向发展。";
                    }
                    else {
                        msg = msg + " 本年相对一般，财运和事业会有波动，相对向好的方向发展。";
                    }
                }
            }
            else { /// 身弱
                msg = msg + " 本年相对一般，学业，技术等方面可有提高。或者财运或者事业会有波动。";
            }
            if(  sex.equals("男")) {
                msg = msg + "有异性缘。";
            }
        }
    }
    else if( heShenLiuGan.equals("比") || heShenLiuGan.equals("劫")) {
        if( heShenLiuZhi.equals("官") || heShenLiuZhi.equals("煞")) { // 比官
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 本年相对较好，事业发展较好，有同事或者朋友相助。";
            }
            else { /// 身弱
                msg = msg + " 本年相对一般，事业有发展。财运可能会变好一些。";
            }
            if(  sex.equals("女")) {
                if( (shenGuan + shenSha) <= 1 ) {
                    msg = msg + "女生走官运，可能会有婚姻变动。";
                }
                else {
                    msg = msg + "有异性缘，或者婚姻有变动。";
                }
            }
        }
        else if( heShenLiuZhi.equals("印") || heShenLiuZhi.equals("枭")) { // 比印
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenYin + shenXiao) > 3 ) {
                    msg = msg + " 本年相对不好，对财运不好，被亲朋所累，感到无助。可能会名誉受损。";
                }
                else {
                    msg = msg + "本年相对不好，对财运不好，被亲朋所累。";
                }
            }
            else { /// 身弱
                msg = msg + " 本年相对较好，学业，技术等方面可有提高。有人相帮，有同事朋友相助，各个方面都会顺利。";
            }
        }
        else if( heShenLiuZhi.equals("比") || heShenLiuZhi.equals("劫")) { // 比比
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 本年相对不好，对财运和事业不好，被亲朋所累。";
            }
            else { /// 身弱
                msg = msg + " 本年相对一般，有同事朋友相助，事业相对顺利。财运相对变好一些。";
            }
        }
        else if( heShenLiuZhi.equals("食") || heShenLiuZhi.equals("伤")) { // 比食
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenCaip + shenCaiz) > 0) {
                    msg = msg + " 本年相对一般，有财运，易被亲朋所累，事业有波动。";
                }
                else {
                    msg = msg + " 本年相对一般，被亲朋所累，事业往不利的方向有点儿波动。";
                }
            }
            else { /// 身弱
                msg = msg + " 本年相对不好，虽然有亲友相帮，事业有波动相对向不利方向发展。";
            }
            if(  sex.equals("女")) {
                if( (shenGuan + shenSha) > 0 ) {
                    msg = msg + "对家庭或婚姻有不好的影响。";
                }
            }
        }
        else if( heShenLiuZhi.equals("财") || heShenLiuZhi.equals("才")) { // 比财
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 本年相对较好，会有财运，小心亲朋夺财，事业有波动。";
            }
            else { /// 身弱
                msg = msg + " 本年相对一般，会有点儿财运，但要小心努力获取。";
            }
            if(  sex.equals("男")) {
                msg = msg + "有异性缘。";
            }
        }
    }
    else if( heShenLiuGan.equals("食") || heShenLiuGan.equals("伤")) {
        if( heShenLiuZhi.equals("官") || heShenLiuZhi.equals("煞")) { // 食官 
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenYin + shenXiao) > 0) {
                    if( (shenCaip + shenCaiz) > 0 ) {
                        msg = msg + "有印克制食伤，"+ "本年相对较好，财运官运都有发展和变化。";
                    }
                    else {
                        msg = msg + " 有印克制食伤，" + "本年相对还行，事业有发展和变化。";
                    }
                }
                else {
                    msg = msg + " 无印克制，" + "本年相对一般，事业有波动，但是往好的方向发展。";
                }
            }
            else { /// 身弱
                if( zpSheng >= zpKe ) {
                    msg = msg + " 本年相对较好，事业有波动，但是往好的方向发展。";
                }
                else {
                    msg = msg + " 本年相对不好，事业波动下行，还有可能官司缠身。易得伤病。";
                }
            }
            if(  sex.equals("女")) {
                msg = msg + "有异性缘，也容易伤及家庭。";
            }
        }
        else if( heShenLiuZhi.equals("印") || heShenLiuZhi.equals("枭")) { // 食印
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenCaip + shenCaiz) > 0 ) {
                    msg = msg + " 本年相对较好，财运有发展机会，事业有波动。";
                }
                else {
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + " 本年相对一般，财运和事业有波动，感到无助。可能会名誉受损。";
                    }
                    else {
                        msg = msg + " 本年相对一般，事业和财运会有波动，相对向好的方向发展。";
                    }
                }
            }
            else { /// 身弱
                msg = msg + " 本年相对一般，学业，技术等方面可有提高。财运会有发展的机会，事业有波动。";
            }
            if(  sex.equals("女")) {
                if( (shenGuan + shenSha) > 0 ) {
                    msg = msg + "对家庭或婚姻有不好的影响。";
                }
            }
        }
        else if( heShenLiuZhi.equals("比") || heShenLiuZhi.equals("劫")) { // 食比
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenCaip + shenCaiz) > 0) {
                    msg = msg + " 本年相对一般，有财运，易被亲朋所累，事业有波动。";
                }
                else {
                    msg = msg + " 本年相对一般，被亲朋所累，事业往不利的方向有点儿波动。";
                }
            }
            else { /// 身弱
                msg = msg + " 本年相对不好，虽然有亲友相帮，事业有波动相对向不利方向发展。";
            }
            if(  sex.equals("女")) {
                if( (shenGuan + shenSha) > 0 ) {
                    msg = msg + "对家庭或婚姻有不好的影响。";
                }
            }
        }
        else if( heShenLiuZhi.equals("食") || heShenLiuZhi.equals("伤")) { // 食食
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenCaip + shenCaiz) > 0) {
                    msg = msg + " 本年相对一般，有财运，事业有波动。";
                }
                else {
                    msg = msg + " 本年相对不好，事业有波动。易得小伤小病。";
                }
            }
            else { /// 身弱
                msg = msg + " 本年相对不好，对事业不好。易破财，易得伤病。";
            }
            if(  sex.equals("女")) {
                if( (shenGuan + shenSha) > 0 ) {
                    msg = msg + "对家庭或婚姻有不好的影响。";
                }
            }
        }
        else if( heShenLiuZhi.equals("财") || heShenLiuZhi.equals("才")) { // 食财
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 本年相对较好，有财运。事业有发展。";
            }
            else { /// 身弱
                msg = msg + " 本年相对不好，对事业不好。易破财，易得伤病。";
            }
            if(  sex.equals("女")) {
                if( (shenGuan + shenSha) > 0 ) {
                    msg = msg + "对家庭或婚姻有不好的影响。";
                }
            }
            if(  sex.equals("男")) {
                msg = msg + "有异性缘，或者婚姻有变动。";
            }
        }
    }
    else if( heShenLiuGan.equals("财") || heShenLiuGan.equals("才")) {
        if( heShenLiuZhi.equals("官") || heShenLiuZhi.equals("煞")) { // 财官 
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 本年相对较好，财运官运都有发展。";
            }
            else { /// 身弱
                if( zpSheng >= zpKe ) {
                    msg = msg+ " 本年相对较好，财运官运都有发展。";
                }
                else {
                    msg = msg + " 本年相对不好，事业有波动，财运有波动，或者往好的方向发展则很辛苦，或者往不好方向发展。天克地冲易得伤病。";
                }
            }
            msg = msg + "有异性缘。";
        }
        else if( heShenLiuZhi.equals("印") || heShenLiuZhi.equals("枭")) { // 财印 
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                if( (shenShi + shenShang) > 0 ) {
                    msg = msg + " 本年相对较好，财运较好。";
                }
                else {
                    if( (shenYin + shenXiao) > 3 ) {
                        msg = msg + " 本年相对一般，感到无助，可能会名誉受损。财运会有波动，相对向好的方向发展。";
                    }
                    else {
                        msg = msg + " 本年相对一般，财运和事业会有波动，相对向好的方向发展。";
                    }
                }
            }
            else { /// 身弱
                msg = msg + " 本年相对一般，学业，技术等方面可有提高。或者财运或者事业会有波动。";
            }
            if(  sex.equals("男")) {
                msg = msg + "有异性缘。";
            }
        }
        else if( heShenLiuZhi.equals("比") || heShenLiuZhi.equals("劫")) { // 财比 
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 本年相对较好，会有财运，小心亲朋夺财，事业有波动。";
            }
            else { /// 身弱
                msg = msg + " 本年相对一般，会有点儿财运，但要小心努力获取。";
            }
            if(  sex.equals("男")) {
                msg = msg + "有异性缘，或者婚姻有变动。";
            }
        }
        else if( heShenLiuZhi.equals("食") || heShenLiuZhi.equals("伤")) { // 财食
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 本年相对较好，有财运。事业有发展。";
            }
            else { /// 身弱
                msg = msg + " 本年相对不好，对事业不好。易破财，易得伤病。";
            }
            if(  sex.equals("女")) {
                if( (shenGuan + shenSha) > 0 ) {
                    msg = msg + "对家庭或婚姻有不好的影响。";
                }
            }
            if(  sex.equals("男")) {
                msg = msg + "有异性缘。";
            }
        }
        else if( heShenLiuZhi.equals("财") || heShenLiuZhi.equals("才")) { // 财财
            if( feUp >= feDown || m_selfStrength > 0  ) {  /// 身强
                msg = msg + " 本年相对较好，有财运，事业有发展。";
            }
            else { /// 身弱
                msg = msg + " 本年相对不好，对事业不好。易破财。";
            }
            if(  sex.equals("男")) {
                msg = msg + "有异性缘。";
            }
        }
    }

    arrAnalysis.add(msg);
    //#endregion

    /// 神煞，天乙贵人，驿马
    if( fnComputeTianYi(dayGan, heLiuZhi) ) {
        msg = "本年有贵人相帮。";
        arrAnalysis.add(msg);
    }
    if( fnComputeYiMa(dayZhi, heLiuZhi) ) {
        msg = "有驿马：事业有变动，或者生活有变迁，或者长期出差在外。";
        arrAnalysis.add(msg);
    }
    else if( fnComputeYiMa(yearZhi, heLiuZhi) ) {
        msg = "有驿马：事业有变动，或者生活有变迁，或者长期出差在外。";
        arrAnalysis.add(msg);
    }

    return arrAnalysis;
}

public List<String> fnBaziDayFateAnalysis(
    String yearGan, String yearZhi, 
    String monthGan, String monthZhi, 
    String dayGan, String dayZhi, 
    String hourGan, String hourZhi,
    String bigGan, String bigZhi,
    String liuGan, String liuZhi,
    String curMonthGan, String curMonthZhi,
    String curDayGan, String curDayZhi) {
    

    ArrayList<String> arrAnalysis = new ArrayList<String>();
    //String msg;



    return arrAnalysis;
}

public static List<String> fnBaziHeChongAll(
    String yearGan, String yearZhi, 
    String monthGan, String monthZhi, 
    String dayGan, String dayZhi, 
    String hourGan, String hourZhi,
    String bigGan, String bigZhi,
    String liuGan, String liuZhi ) {
    
    ArrayList<String> arrAnalysis = new ArrayList<String>();
    String msg;

    //#region 本命命局 
    msg = "--- 本命刑冲合害 ---";
    arrAnalysis.add(msg);

    //#region 地支三会局
    if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
        if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
            if( hourZhi.equals("辰") || dayZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) {
                msg = "寅卯辰三会木局。";
                arrAnalysis.add(msg);
            }
        }
    }
    if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
        if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
            if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
                msg = "巳午未三会火局。";
                arrAnalysis.add(msg);
            }
        }
    }
    if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
        if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                msg = "申酉戌三会金局。";
                arrAnalysis.add(msg);
            }
        }
    }
    if( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) {
        if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
            if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
                msg = "亥子丑三会水局。";
                arrAnalysis.add(msg);
            }
        }
    }

    //#endregion

    //#region 地支三合局
    if( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) {
        if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
            if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
                msg = "亥卯未三合木局。";
                arrAnalysis.add(msg);
            }
        }
    }
    if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
        if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                msg = "寅午戌三合火局。";
                arrAnalysis.add(msg);
            }
        }
    }
    if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
        if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
            if( hourZhi.equals("辰") || dayZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) {
                msg = "申子辰三合水局。";
                arrAnalysis.add(msg);
            }
        }
    }
    if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
        if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
            if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
                msg = "巳酉丑三合金局。";
                arrAnalysis.add(msg);
            }
        }
    }

    //#endregion

    //#region 地支六合
    
    if( hourZhi.equals("子") && ( dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
        msg = "子丑六合土局。";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("子") && ( hourZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
        msg = "子丑六合土局。";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("子") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || yearZhi.equals("丑") ) ) {
        msg = "子丑六合土局。";
        arrAnalysis.add(msg);
    }
    else if( yearZhi.equals("子") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") ) ) {
        msg = "子丑六合土局。";
        arrAnalysis.add(msg);
    }

    if( hourZhi.equals("亥") && ( dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
        msg = "亥寅六合木局。";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("亥") && ( hourZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
        msg = "亥寅六合木局。";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("亥") && ( hourZhi.equals("寅") || dayZhi.equals("寅") || yearZhi.equals("寅") ) ) {
        msg = "亥寅六合木局。";
        arrAnalysis.add(msg);
    }
    else if( yearZhi.equals("亥") && ( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") ) ) {
        msg = "亥寅六合木局。";
        arrAnalysis.add(msg);
    }

    if( hourZhi.equals("卯") && ( dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
        msg = "卯戌六合火局。";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("卯") && ( hourZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
        msg = "卯戌六合火局。";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("卯") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || yearZhi.equals("戌") ) ) {
        msg = "卯戌六合火局。";
        arrAnalysis.add(msg);
    }
    else if( yearZhi.equals("卯") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") ) ) {
        msg = "卯戌六合火局。";
        arrAnalysis.add(msg);
    }

    if( hourZhi.equals("辰") && ( dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "辰酉六合金局。";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("辰") && ( hourZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "辰酉六合金局。";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("辰") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "辰酉六合金局。";
        arrAnalysis.add(msg);
    }
    else if( yearZhi.equals("辰") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") ) ) {
        msg = "辰酉六合金局。";
        arrAnalysis.add(msg);
    }

    if( hourZhi.equals("巳") && ( dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) ) {
        msg = "巳申六合水局。";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("巳") && ( hourZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) ) {
        msg = "巳申六合水局。";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("巳") && ( hourZhi.equals("申") || dayZhi.equals("申") || yearZhi.equals("申") ) ) {
        msg = "巳申六合水局。";
        arrAnalysis.add(msg);
    }
    else if( yearZhi.equals("巳") && ( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") ) ) {
        msg = "巳申六合水局。";
        arrAnalysis.add(msg);
    }
        
    if( hourZhi.equals("午") && ( dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "午未六合土局。";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("午") && ( hourZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "午未六合土局。";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("午") && ( hourZhi.equals("未") || dayZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "午未六合土局。";
        arrAnalysis.add(msg);
    }
    else if( yearZhi.equals("午") && ( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") ) ) {
        msg = "午未六合土局。";
        arrAnalysis.add(msg);
    }    

    //#endregion

    //#region 地支六冲
    if( hourZhi.equals("子") && ( dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "子午相冲";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("子") && ( hourZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "子午相冲";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("子") && ( hourZhi.equals("午") || dayZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "子午相冲";
        arrAnalysis.add(msg);
    }
    else if( yearZhi.equals("子") && ( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") ) ) {
        msg = "子午相冲";
        arrAnalysis.add(msg);
    }

    if( hourZhi.equals("丑") && ( dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "丑未相冲";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("丑") && ( hourZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "丑未相冲";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("丑") && ( hourZhi.equals("未") || dayZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "丑未相冲";
        arrAnalysis.add(msg);
    }
    else if( yearZhi.equals("丑") && ( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") ) ) {
        msg = "丑未相冲";
        arrAnalysis.add(msg);
    }

    if( hourZhi.equals("寅") && ( dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) ) {
        msg = "寅申相冲";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("寅") && ( hourZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) ) {
        msg = "寅申相冲";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("寅") && ( hourZhi.equals("申") || dayZhi.equals("申") || yearZhi.equals("申") ) ) {
        msg = "寅申相冲";
        arrAnalysis.add(msg);
    }
    else if( yearZhi.equals("寅") && ( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") ) ) {
        msg = "寅申相冲";
        arrAnalysis.add(msg);
    }

    if( hourZhi.equals("卯") && ( dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "卯酉相冲";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("卯") && ( hourZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "卯酉相冲";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("卯") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "卯酉相冲";
        arrAnalysis.add(msg);
    }
    else if( yearZhi.equals("卯") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") ) ) {
        msg = "卯酉相冲";
        arrAnalysis.add(msg);
    }

    if( hourZhi.equals("辰") && ( dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
        msg = "辰戌相冲";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("辰") && ( hourZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
        msg = "辰戌相冲";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("辰") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || yearZhi.equals("戌") ) ) {
        msg = "辰戌相冲";
        arrAnalysis.add(msg);
    }
    else if( yearZhi.equals("辰") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") ) ) {
        msg = "辰戌相冲";
        arrAnalysis.add(msg);
    }

    if( hourZhi.equals("巳") && ( dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "巳亥相冲";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("巳") && ( hourZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "巳亥相冲";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("巳") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "巳亥相冲";
        arrAnalysis.add(msg);
    }
    else if( yearZhi.equals("巳") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") ) ) {
        msg = "巳亥相冲";
        arrAnalysis.add(msg);
    }
    //#endregion

    //#region 地址六害 
    if( hourZhi.equals("子") && ( dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "子未相害";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("子") && ( hourZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "子未相害";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("子") && ( hourZhi.equals("未") || dayZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "子未相害";
        arrAnalysis.add(msg);
    }
    else if( yearZhi.equals("子") && ( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") ) ) {
        msg = "子未相害";
        arrAnalysis.add(msg);
    }

    if( hourZhi.equals("丑") && ( dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "丑午相害";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("丑") && ( hourZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "丑午相害";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("丑") && ( hourZhi.equals("午") || dayZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "丑午相害";
        arrAnalysis.add(msg);
    }
    else if( yearZhi.equals("丑") && ( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") ) ) {
        msg = "丑午相害";
        arrAnalysis.add(msg);
    }        

    if( hourZhi.equals("寅") && ( dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
        msg = "寅巳相害";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("寅") && ( hourZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
        msg = "寅巳相害";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("寅") && ( hourZhi.equals("巳") || dayZhi.equals("巳") || yearZhi.equals("巳") ) ) {
        msg = "寅巳相害";
        arrAnalysis.add(msg);
    }
    else if( yearZhi.equals("寅") && ( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") ) ) {
        msg = "寅巳相害";
        arrAnalysis.add(msg);
    }

    if( hourZhi.equals("卯") && ( dayZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
        msg = "卯辰相害";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("卯") && ( hourZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
        msg = "卯辰相害";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("卯") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || yearZhi.equals("辰") ) ) {
        msg = "卯辰相害";
        arrAnalysis.add(msg);
    }
    else if( yearZhi.equals("卯") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || monthZhi.equals("辰") ) ) {
        msg = "卯辰相害";
        arrAnalysis.add(msg);
    }

    if( hourZhi.equals("申") && ( dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "申亥相害";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("申") && ( hourZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "申亥相害";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("申") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "申亥相害";
        arrAnalysis.add(msg);
    }
    else if( yearZhi.equals("申") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") ) ) {
        msg = "申亥相害";
        arrAnalysis.add(msg);
    }

    if( yearZhi.equals("酉") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") ) ) {
        msg = "酉戌相害";
        arrAnalysis.add(msg);
    }
    else if( hourZhi.equals("酉") && ( yearZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") ) ) {
        msg = "酉戌相害";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("酉") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || yearZhi.equals("戌") ) ) {
        msg = "酉戌相害";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("酉") && ( hourZhi.equals("戌") || yearZhi.equals("戌") || monthZhi.equals("戌") ) ) {
        msg = "酉戌相害";
        arrAnalysis.add(msg);
    } 
    //#endregion

    //#region 地支相刑 
    if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
        if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
            if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
                msg = "寅巳申三刑";
                arrAnalysis.add(msg);
            }
        }
    }
    
    if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
        if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                msg = "未丑戌三刑";
                arrAnalysis.add(msg);
            }
        }
    }

    if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
        if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
            msg = "子卯二刑";
            arrAnalysis.add(msg);
        }
    }

    if( hourZhi.equals("辰") && ( dayZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
        msg = "辰辰自刑";
        arrAnalysis.add(msg);
    }
    else if(dayZhi.equals("辰") && ( monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
        msg = "辰辰自刑";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("辰") && yearZhi.equals("辰") ) {
        msg = "辰辰自刑";
        arrAnalysis.add(msg);
    }

    if( hourZhi.equals("午") && ( dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "午午自刑";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("午") && ( monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "午午自刑";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("午") && yearZhi.equals("午") ) {
        msg = "午午自刑";
        arrAnalysis.add(msg);
    }

    if( hourZhi.equals("酉") && ( dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "酉酉自刑";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("酉") && ( monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "酉酉自刑";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("酉") && yearZhi.equals("酉") ) {
        msg = "酉酉自刑";
        arrAnalysis.add(msg);
    }

    if( hourZhi.equals("亥") && ( dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "亥亥自刑";
        arrAnalysis.add(msg);
    }
    else if( dayZhi.equals("亥") && ( monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "亥亥自刑";
        arrAnalysis.add(msg);
    }
    else if( monthZhi.equals("亥") && yearZhi.equals("亥") ) {
        msg = "亥亥自刑";
        arrAnalysis.add(msg);
    }
    //#endregion


    //#region 天干五合
    if( dayGan.equals("己") && hourGan.equals("甲")  ) {
        msg = "甲己合化土。";
        arrAnalysis.add(msg);
    }
    else if( dayGan.equals("己") && monthGan.equals("甲")  ) {
        msg = "甲己合化土。";
        arrAnalysis.add(msg);
    }  
    if( yearGan.equals("甲") && monthGan.equals("己")  ) {
        msg = "甲己合化土。";
        arrAnalysis.add(msg);
    }
    if( monthGan.equals("甲") && yearGan.equals("己")) {
        msg = "甲己合化土。";
        arrAnalysis.add(msg);
    }

    if( dayGan.equals("庚") && hourGan.equals("乙") ) {
        msg = "乙庚合化金。";
        arrAnalysis.add(msg);
    }
    else if( dayGan.equals("庚") && monthGan.equals("乙") ) {
        msg = "乙庚合化金。";
        arrAnalysis.add(msg);
    }
    if( yearGan.equals("乙") && monthGan.equals("庚") ) {
        msg = "乙庚合化金。";
        arrAnalysis.add(msg);
    }
    if( monthGan.equals("乙") && yearGan.equals("庚") ) {
        msg = "乙庚合化金。";
        arrAnalysis.add(msg);
    }

    if( dayGan.equals("丙") && hourGan.equals("辛")) {
        msg = "丙辛合化水。";
        arrAnalysis.add(msg);
    }
    else if( dayGan.equals("辛") && hourGan.equals("丙") ) {
        msg = "丙辛合化水。";
        arrAnalysis.add(msg);
    }
    else if( dayGan.equals("丙") && monthGan.equals("辛") ) {
        msg = "丙辛合化水。";
        arrAnalysis.add(msg);
    }
    else if( dayGan.equals("辛") && monthGan.equals("丙") ) {
        msg = "丙辛合化水。";
        arrAnalysis.add(msg);
    }
    if( yearGan.equals("丙") && monthGan.equals("辛")) {
        msg = "丙辛合化水。";
        arrAnalysis.add(msg);
    }
    if( monthGan.equals("丙") && yearGan.equals("辛")) {
        msg = "丙辛合化水。";
        arrAnalysis.add(msg);
    }

    if( dayGan.equals("丁") && hourGan.equals("壬") ) {
        msg = "丁壬合化木。";
        arrAnalysis.add(msg);
    }
    else if( dayGan.equals("壬") && hourGan.equals("丁")) {
        msg = "丁壬合化木。";
        arrAnalysis.add(msg);
    }
    else if( dayGan.equals("丁") && monthGan.equals("壬") ) {
        msg = "丁壬合化木。";
        arrAnalysis.add(msg);
    }
    else if( dayGan.equals("壬") && monthGan.equals("丁") ) {
        msg = "丁壬合化木。";
        arrAnalysis.add(msg);
    }
    if( yearGan.equals("丁") && monthGan.equals("壬") ) {
        msg = "丁壬合化木。";
        arrAnalysis.add(msg);
    }
    if( monthGan.equals("丁") && yearGan.equals("壬") ) {
        msg = "丁壬合化木。";
        arrAnalysis.add(msg);
    }

    if( dayGan.equals("戊") && hourGan.equals("癸") ) {
        msg = "戊癸合化火。";
        arrAnalysis.add(msg);
    }
    else if( dayGan.equals("癸") && hourGan.equals("戊") ) {
        msg = "戊癸合化火。";
        arrAnalysis.add(msg);
    }
    else if( dayGan.equals("戊") && monthGan.equals("癸")) {
        msg = "戊癸合化火。";
        arrAnalysis.add(msg);
    }
    else if( dayGan.equals("癸") && monthGan.equals("戊") ) {
        msg = "戊癸合化火。";
        arrAnalysis.add(msg);
    }
    if( yearGan.equals("戊") && monthGan.equals("癸")) {
        msg = "戊癸合化火";
        arrAnalysis.add(msg);
    }
    if( monthGan.equals("戊") && yearGan.equals("癸")) {
        msg = "戊癸合化火。";
        arrAnalysis.add(msg);
    }

    //#endregion

    //#region 天干四冲
    if( hourGan.equals("甲") && ( dayGan.equals("庚") || monthGan.equals("庚") || yearGan.equals("庚") ) ) {
        msg = "甲庚相冲。";
        arrAnalysis.add(msg);
    }
    else if( dayGan.equals("甲") && ( hourGan.equals("庚") || monthGan.equals("庚") || yearGan.equals("庚") ) ) {
        msg = "甲庚相冲。";
        arrAnalysis.add(msg);
    }
    else if( monthGan.equals("甲") && ( hourGan.equals("庚") || dayGan.equals("庚") || yearGan.equals("庚") ) ) {
        msg = "甲庚相冲。";
        arrAnalysis.add(msg);
    }
    else if( yearGan.equals("甲") && ( hourGan.equals("庚") || dayGan.equals("庚") || monthGan.equals("庚") ) ) {
        msg = "甲庚相冲。";
        arrAnalysis.add(msg);
    }

    if( hourGan.equals("乙") && ( dayGan.equals("辛") || monthGan.equals("辛") || yearGan.equals("辛") ) ) {
        msg = "乙辛相冲。";
        arrAnalysis.add(msg);
    }
    else if( dayGan.equals("乙") && ( hourGan.equals("辛") || monthGan.equals("辛") || yearGan.equals("辛") ) ) {
        msg = "乙辛相冲。";
        arrAnalysis.add(msg);
    }
    else if( monthGan.equals("乙") && ( hourGan.equals("辛") || dayGan.equals("辛") || yearGan.equals("辛") ) ) {
        msg = "乙辛相冲。";
        arrAnalysis.add(msg);
    }
    else if( yearGan.equals("乙") && ( hourGan.equals("辛") || dayGan.equals("辛") || monthGan.equals("辛") ) ) {
        msg = "乙辛相冲。";
        arrAnalysis.add(msg);
    }

    if( hourGan.equals("丙") && ( dayGan.equals("壬") || monthGan.equals("壬") || yearGan.equals("壬") ) ) {
        msg = "丙壬相冲。";
        arrAnalysis.add(msg);
    }
    else if( dayGan.equals("丙") && ( hourGan.equals("壬") || monthGan.equals("壬") || yearGan.equals("壬") ) ) {
        msg = "丙壬相冲。";
        arrAnalysis.add(msg);
    }
    else if( monthGan.equals("丙") && ( hourGan.equals("壬") || dayGan.equals("壬") || yearGan.equals("壬") ) ) {
        msg = "丙壬相冲。";
        arrAnalysis.add(msg);
    }
    else if( yearGan.equals("丙") && ( hourGan.equals("壬") || dayGan.equals("壬") || monthGan.equals("壬") ) ) {
        msg = "丙壬相冲。";
        arrAnalysis.add(msg);
    }

    if( hourGan.equals("丁") && ( dayGan.equals("癸") || monthGan.equals("癸") || yearGan.equals("癸") ) ) {
        msg = "丁癸相冲。";
        arrAnalysis.add(msg);
    }
    else if( dayGan.equals("丁") && ( hourGan.equals("癸") || monthGan.equals("癸") || yearGan.equals("癸") ) ) {
        msg = "丁癸相冲。";
        arrAnalysis.add(msg);
    }
    else if( monthGan.equals("丁") && ( hourGan.equals("癸") || dayGan.equals("癸") || yearGan.equals("癸") ) ) {
        msg = "丁癸相冲。";
        arrAnalysis.add(msg);
    }
    else if( yearGan.equals("丁") && ( hourGan.equals("癸") || dayGan.equals("癸") || monthGan.equals("癸") ) ) {
        msg = "丁癸相冲。";
        arrAnalysis.add(msg);
    }
    //#endregion

    //#endregion

    //#region 大运 
    msg = "--- 大运刑冲合害 ---";
    arrAnalysis.add(msg);

    //#region 地支三会局
    if( bigZhi.equals("寅")) {
        if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
            if( hourZhi.equals("辰") || dayZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) {
                msg = "寅卯辰三会木局。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("卯")) {
        if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
            if( hourZhi.equals("辰") || dayZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) {
                msg = "寅卯辰三会木局。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("辰")) {
        if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
            if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
                msg = "寅卯辰三会木局。";
                arrAnalysis.add(msg);
            }
        }
    }

    if( bigZhi.equals("巳")) {
        if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
            if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
                msg = "巳午未三会火局。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("午")) {
        if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
            if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
                msg = "巳午未三会火局。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("未")) {
        if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
            if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
                msg = "巳午未三会火局。";
                arrAnalysis.add(msg);
            }
        }
    }

    if( bigZhi.equals("申")) {
        if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                msg = "申酉戌三会金局。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("酉")) {
        if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                msg = "申酉戌三会金局。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("戌")) {
        if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
            if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
                msg = "申酉戌三会金局。";
                arrAnalysis.add(msg);
            }
        }
    }

    if( bigZhi.equals("亥")) {
        if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
            if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
                msg = "亥子丑三会水局。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("子")) {
        if( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) {
            if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
                msg = "亥子丑三会水局。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("丑")) {
        if( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) {
            if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
                msg = "亥子丑三会水局。";
                arrAnalysis.add(msg);
            }
        }
    }

    //#endregion

    //#region 地支三合局

    if( bigZhi.equals("亥")) {
        if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
            if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
                msg = "亥卯未三合木局。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("卯")) {
        if( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) {
            if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
                msg = "亥卯未三合木局。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("未")) {
        if( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) {
            if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
                msg = "亥卯未三合木局。";
                arrAnalysis.add(msg);
            }
        }
    }

    if( bigZhi.equals("寅")) {
        if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                msg = "寅午戌三合火局。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("午")) {
        if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                msg = "寅午戌三合火局。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("戌")) {
        if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
            if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
                msg = "寅午戌三合火局。";
                arrAnalysis.add(msg);
            }
        }
    }

    if( bigZhi.equals("申")) {
        if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
            if( hourZhi.equals("辰") || dayZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) {
                msg = "申子辰三合水局。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("子")) {
        if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
            if( hourZhi.equals("辰") || dayZhi.equals("辰") || monthZhi.equals("辰") || yearZhi.equals("辰") ) {
                msg = "申子辰三合水局。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("辰")) {
        if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
            if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
                msg = "申子辰三合水局。";
                arrAnalysis.add(msg);}
        }
    }

    if( bigZhi.equals("巳")) {
        if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
            if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
                msg = "巳酉丑三合金局。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("酉")) {
        if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
            if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
                msg = "巳酉丑三合金局。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("丑")) {
        if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
            if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
                msg = "巳酉丑三合金局。";
                arrAnalysis.add(msg);
            }
        }
    }

    
    //#endregion

    //#region 地支六合

    if( bigZhi.equals("子") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
    monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
            msg = "子丑六合水局。";
            arrAnalysis.add(msg);
    }
    if( bigZhi.equals("丑") && ( hourZhi.equals("子") || dayZhi.equals("子") || 
    monthZhi.equals("子") || yearZhi.equals("子") ) ) {
            msg = "子丑六合水局。";
            arrAnalysis.add(msg);
    }

    if( bigZhi.equals("寅") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || 
    monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "寅亥六合木局。";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("亥") && ( hourZhi.equals("寅") || dayZhi.equals("寅") || 
    monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
        msg = "寅亥六合木局。";
        arrAnalysis.add(msg);
    }

    if( bigZhi.equals("卯") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
        monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
        msg = "卯戌六合火局。";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("戌") && ( hourZhi.equals("卯") || dayZhi.equals("卯") || 
        monthZhi.equals("卯") || yearZhi.equals("卯") ) ) {
        msg = "卯戌六合火局。";
        arrAnalysis.add(msg);
    }

    if( bigZhi.equals("辰") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || 
        monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "辰酉六合金局。";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("酉") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || 
        monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
        msg = "辰酉六合金局。";
        arrAnalysis.add(msg);
    }

    if( bigZhi.equals("巳") && ( hourZhi.equals("申") || dayZhi.equals("申") || 
        monthZhi.equals("申") || yearZhi.equals("申") ) ) {
        msg = "巳申六合水局。";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("申") && ( hourZhi.equals("巳") || dayZhi.equals("巳") || 
        monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
        msg = "巳申六合水局。";
        arrAnalysis.add(msg);
    }
        
    if( bigZhi.equals("午") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
        monthZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "午未六合土局。";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("未") && ( hourZhi.equals("午") || dayZhi.equals("午") || 
        monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "午未六合土局。";
        arrAnalysis.add(msg);
    }
    
    //#endregion

    /// 地支刑冲害 
    //#region 地支六冲
    if( bigZhi.equals("子") && ( hourZhi.equals("午") || dayZhi.equals("午") || 
    monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "子午相冲。";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("午") && ( hourZhi.equals("子") || dayZhi.equals("子") || 
    monthZhi.equals("子") || yearZhi.equals("子") ) ) {
        msg = "子午相冲。";
        arrAnalysis.add(msg);
    }

    if( bigZhi.equals("丑") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
            monthZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "丑未相冲。";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("未") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
    monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
        msg = "丑未相冲。";
        arrAnalysis.add(msg);
    }

    if( bigZhi.equals("寅") && ( hourZhi.equals("申") || dayZhi.equals("申") || 
            monthZhi.equals("申") || yearZhi.equals("申") ) ) {
        msg = "寅申相冲。";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("申") && ( hourZhi.equals("寅") || dayZhi.equals("寅") || 
    monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
        msg = "寅申相冲。";
        arrAnalysis.add(msg);
    }

    if( bigZhi.equals("卯") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || 
            monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "卯酉相冲。";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("酉") && ( hourZhi.equals("卯") || dayZhi.equals("卯") || 
    monthZhi.equals("卯") || yearZhi.equals("卯") ) ) {
        msg = "卯酉相冲。";
        arrAnalysis.add(msg);
    }

    if( bigZhi.equals("辰") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
            monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
        msg = "辰戌相冲。";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("戌") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || 
    monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
        msg = "辰戌相冲。";
        arrAnalysis.add(msg);
    }

    if( bigZhi.equals("巳") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || 
            monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "巳亥相冲。";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("亥") && ( hourZhi.equals("巳") || dayZhi.equals("巳") || 
    monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
        msg = "巳亥相冲。";
        arrAnalysis.add(msg);
    }

    //#endregion

    //#region 地址六害 
    if( bigZhi.equals("子") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
            monthZhi.equals("未") || yearZhi.equals("未") ) ) {
        msg = "子未相害。";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("未") && ( hourZhi.equals("子") || dayZhi.equals("子") || 
    monthZhi.equals("子") || yearZhi.equals("子") ) ) {
        msg = "子未相害。";
        arrAnalysis.add(msg);
    }

    if( bigZhi.equals("丑") && ( hourZhi.equals("午") || dayZhi.equals("午") || 
            monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "丑午相害。";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("午") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
    monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
        msg = "丑午相害。";
        arrAnalysis.add(msg);
    }

    if( bigZhi.equals("寅") && ( hourZhi.equals("巳") || dayZhi.equals("巳") || 
            monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
        msg = "寅巳相害。";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("巳") && ( hourZhi.equals("寅") || dayZhi.equals("寅") || 
    monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
        msg = "寅巳相害。";
        arrAnalysis.add(msg);
    }

    if( bigZhi.equals("卯") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || 
            monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
        msg = "卯辰相害。";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("辰") && ( hourZhi.equals("卯") || dayZhi.equals("卯") || 
    monthZhi.equals("卯") || yearZhi.equals("卯") ) ) {
        msg = "卯辰相害。";
        arrAnalysis.add(msg);
    }

    if( bigZhi.equals("申") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || 
    monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "申亥相害";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("亥") && ( hourZhi.equals("申") || dayZhi.equals("申") || 
    monthZhi.equals("申") || yearZhi.equals("申") ) ) {
        msg = "申亥相害";
        arrAnalysis.add(msg);
    }

    if( bigZhi.equals("酉") && ( yearZhi.equals("戌") || hourZhi.equals("戌") || 
            dayZhi.equals("戌") || monthZhi.equals("戌") ) ) {
        msg = "酉戌相害";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("戌") && ( yearZhi.equals("酉") || hourZhi.equals("酉") || 
    dayZhi.equals("酉") || monthZhi.equals("酉") ) ) {
        msg = "酉戌相害";
        arrAnalysis.add(msg);
    }
    
    //#endregion

    //#region 地支相刑 
    if( bigZhi.equals("寅")) {
        if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
            if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
                msg = "寅巳申三刑。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("巳")) {
        if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
            if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
                msg = "寅巳申三刑。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("申")) {
        if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
            if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
                msg = "寅巳申三刑。";
                arrAnalysis.add(msg);
            }
        }
    }

    if(bigZhi.equals("未")) {
        if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                msg = "未丑戌三刑。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("丑")) {
        if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || yearZhi.equals("戌") ) {
                msg = "未丑戌三刑。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( bigZhi.equals("戌")) {
        if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || yearZhi.equals("未") ) {
            if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || yearZhi.equals("丑") ) {
                msg = "未丑戌三刑。";
                arrAnalysis.add(msg);
            }
        }
    }

    if( bigZhi.equals("卯") && (hourZhi.equals("子") || dayZhi.equals("子") || 
            monthZhi.equals("子") || yearZhi.equals("子") ) ) {
        msg = "子卯二刑。";
        arrAnalysis.add(msg);
    }
    else if( bigZhi.equals("子") && (hourZhi.equals("卯") || dayZhi.equals("卯") || 
            monthZhi.equals("卯") || yearZhi.equals("卯") ) ) {
        msg = "子卯二刑。";
        arrAnalysis.add(msg);
    }

    if( bigZhi.equals("辰") && (hourZhi.equals("辰") || dayZhi.equals("辰") || 
            monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
        msg = "辰辰自刑。";
        arrAnalysis.add(msg);
    }

    if( bigZhi.equals("午") && (hourZhi.equals("午") || dayZhi.equals("午") || 
            monthZhi.equals("午") || yearZhi.equals("午") ) ) {
        msg = "午午自刑。";
        arrAnalysis.add(msg);
    }

    if( bigZhi.equals("酉") && ( hourZhi.equals("酉")  || dayZhi.equals("酉") || 
            monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
        msg = "酉酉自刑。";
        arrAnalysis.add(msg);
    }
    if( bigZhi.equals("亥") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || 
            monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
        msg = "亥亥自刑。";
        arrAnalysis.add(msg);
    }

    //#endregion

    //#region 天干五合
    if( bigGan.equals("甲") && ( hourGan.equals("己") ||  
    monthGan.equals("己") || yearGan.equals("己") ) ) {
        msg = "甲己合化土。";
        arrAnalysis.add(msg);
    }
    if( bigGan.equals("己") && ( hourGan.equals("甲") ||  
    monthGan.equals("甲") || yearGan.equals("甲") ) ) {
        msg = "甲己合化土。";
        arrAnalysis.add(msg);
    }

    if( bigGan.equals("乙") && ( hourGan.equals("庚") || 
    monthGan.equals("庚") || yearGan.equals("庚") ) ) {
        msg = "乙庚合化金。";
        arrAnalysis.add(msg);
    }
    if( bigGan.equals("庚") && ( hourGan.equals("乙") || 
    monthGan.equals("乙") || yearGan.equals("乙") ) ) {
        msg = "乙庚合化金。";
        arrAnalysis.add(msg);
    } 

    if( bigGan.equals("丙") && ( hourGan.equals("辛") ||  
    monthGan.equals("辛") || yearGan.equals("辛") ) ) {
        msg = "丙辛合化水。";
        arrAnalysis.add(msg);
    }
    if( bigGan.equals("辛") && ( hourGan.equals("丙") ||  
        monthGan.equals("丙") || yearGan.equals("丙") ) ) {
        msg = "丙辛合化水。";
        arrAnalysis.add(msg);
    }

    if( bigGan.equals("丁") && ( hourGan.equals("壬") || 
    monthGan.equals("壬") || yearGan.equals("壬") ) ) {
        msg = "丁壬合化木。";
        arrAnalysis.add(msg);
    }
    if( bigGan.equals("壬") && ( hourGan.equals("丁") ||  
    monthGan.equals("丁") || yearGan.equals("丁") ) ) {
        msg = "丁壬合化木。";
        arrAnalysis.add(msg);        
    }

    if( bigGan.equals("戊") && ( hourGan.equals("癸") ||  
    monthGan.equals("癸") || yearGan.equals("癸") ) ) {
        msg = "戊癸合化火。";
        arrAnalysis.add(msg);
    }
    if( bigGan.equals("癸") && ( hourGan.equals("戊") ||  
        monthGan.equals("戊") || yearGan.equals("戊") ) ) {
        msg = "戊癸合化火。";
        arrAnalysis.add(msg);
    }

    //#endregion

    //#region 天干四冲
    if( bigGan.equals("庚") && ( hourGan.equals("甲") || dayGan.equals("甲") || 
    monthGan.equals("甲") || yearGan.equals("甲") ) ) {
        msg = "甲庚相冲，";
        arrAnalysis.add(msg);
    }
    if( bigGan.equals("甲") && ( hourGan.equals("庚") || dayGan.equals("庚") || 
    monthGan.equals("庚") || yearGan.equals("庚") ) ) {
        msg = "甲庚相冲，";
        arrAnalysis.add(msg);
    }

    if( bigGan.equals("乙") && ( hourGan.equals("辛") || dayGan.equals("辛") || 
    monthGan.equals("辛") || yearGan.equals("辛") ) ) {
        msg = "乙辛相冲，";
        arrAnalysis.add(msg);
    }
    if( bigGan.equals("辛") && ( hourGan.equals("乙") || dayGan.equals("乙") || 
    monthGan.equals("乙") || yearGan.equals("乙") ) ) {
        msg = "乙辛相冲，";
        arrAnalysis.add(msg);
    }

    if( bigGan.equals("丙") && ( hourGan.equals("壬") || dayGan.equals("壬") || 
    monthGan.equals("壬") || yearGan.equals("壬") ) ) {
        msg = "丙壬相冲，";
        arrAnalysis.add(msg);
    }
    if( bigGan.equals("壬") && ( hourGan.equals("丙") || dayGan.equals("丙") || 
    monthGan.equals("丙") || yearGan.equals("丙") ) ) {
        msg = "丙壬相冲，";
        arrAnalysis.add(msg);
    } 

    if( bigGan.equals("丁") && ( hourGan.equals("癸") || dayGan.equals("癸") || 
    monthGan.equals("癸") || yearGan.equals("癸") ) ) {
        msg = "丁癸相冲，";
        arrAnalysis.add(msg);
    }
    if( bigGan.equals("癸") && ( hourGan.equals("丁") || dayGan.equals("丁") || 
    monthGan.equals("丁") || yearGan.equals("丁") ) ) {
        msg = "丁癸相冲，";
        arrAnalysis.add(msg);
    }
    //#endregion

    //#endregion

    //#region 流年 
    msg = "--- 流年刑冲合害 ---";
    arrAnalysis.add(msg);

    /// 大运地支合 
    //#region 地支三会局
    if( liuZhi.equals("寅") ) {
        if( bigZhi.equals("卯") && (hourZhi.equals("辰") || dayZhi.equals("辰") || 
        monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
            msg = "寅卯辰三合木局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("辰") && (hourZhi.equals("卯") || dayZhi.equals("卯") ||
        monthZhi.equals("卯") || yearZhi.equals("卯") ) ) {
            msg = "寅卯辰三合木局。";
            arrAnalysis.add(msg);
        }
    }
    else if( liuZhi.equals("卯")) {
        if( bigZhi.equals("寅") && (hourZhi.equals("辰") || dayZhi.equals("辰") || 
        monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
            msg = "寅卯辰三合木局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("辰") && (hourZhi.equals("寅") || dayZhi.equals("寅") ||
        monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
            msg = "寅卯辰三合木局。";
            arrAnalysis.add(msg);
        }
    }
    else if( liuZhi.equals("辰")) {
        if( bigZhi.equals("寅") && ( hourZhi.equals("卯") || dayZhi.equals("卯") || 
        monthZhi.equals("卯") || yearZhi.equals("卯") ) ) {
            msg = "寅卯辰三合木局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("卯") && ( hourZhi.equals("寅") || dayZhi.equals("寅") ||
        monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
            msg = "寅卯辰三合木局。";
            arrAnalysis.add(msg);
        }
    }

    if( liuZhi.equals("巳")) {
        if( bigZhi.equals("午") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
        monthZhi.equals("未") || yearZhi.equals("未") ) ) {
            msg = "巳午未三合火局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("未") && ( hourZhi.equals("午") || dayZhi.equals("午") ||
        monthZhi.equals("午") || yearZhi.equals("午") ) ) {
            msg = "巳午未三合火局。";
            arrAnalysis.add(msg);
        }
    }    
    else if( liuZhi.equals("午")) {
        if( bigZhi.equals("巳") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
            monthZhi.equals("未") || yearZhi.equals("未") ) ) {
            msg = "巳午未三合火局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("未") && ( hourZhi.equals("巳") || dayZhi.equals("巳") ||
        monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
            msg = "巳午未三合火局。";
            arrAnalysis.add(msg);
        }
    }
    else if( liuZhi.equals("未")) {
        if( bigZhi.equals("巳") && ( hourZhi.equals("午") || dayZhi.equals("午") || 
        monthZhi.equals("午") || yearZhi.equals("午") ) ) {
            msg = "巳午未三合火局。";
            arrAnalysis.add(msg);            
        }
        else if( bigZhi.equals("午") && ( hourZhi.equals("巳") || dayZhi.equals("巳") ||
        monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
            msg = "巳午未三合火局。";
            arrAnalysis.add(msg);
        }
    }

    if( liuZhi.equals("申")) {
        if( bigZhi.equals("酉") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
        monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
            msg = "申酉戌三合金局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("戌") && ( hourZhi.equals("酉") || dayZhi.equals("酉") ||
        monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
            msg = "申酉戌三合金局。";
            arrAnalysis.add(msg);
        }
    }
    else if( liuZhi.equals("酉")) {
        if( bigZhi.equals("申") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
        monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
            msg = "申酉戌三合金局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("戌") && ( hourZhi.equals("申") || dayZhi.equals("申") ||
        monthZhi.equals("申") || yearZhi.equals("申") ) ) {
            msg = "申酉戌三合金局。";
            arrAnalysis.add(msg);
        }
    }
    else if( liuZhi.equals("戌")) {
        if( bigZhi.equals("申") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || 
        monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
            msg = "申酉戌三合金局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("酉") && ( hourZhi.equals("申") || dayZhi.equals("申") ||
        monthZhi.equals("申") || yearZhi.equals("申") ) ) {
            msg = "申酉戌三合金局。";
            arrAnalysis.add(msg);
        }
    }

    if( liuZhi.equals("亥")) {
        if( bigZhi.equals("子") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
        monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
            msg = "亥子丑三合水局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("丑") && ( hourZhi.equals("子") || dayZhi.equals("子") ||
        monthZhi.equals("子") || yearZhi.equals("子") ) ) {
            msg = "亥子丑三合水局。";
            arrAnalysis.add(msg);
        }
    }
    else if( liuZhi.equals("子")) {
        if( bigZhi.equals("亥") || ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
        monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
            msg = "亥子丑三合水局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("丑") && ( hourZhi.equals("亥") || dayZhi.equals("亥") ||
        monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
            msg = "亥子丑三合水局。";
            arrAnalysis.add(msg);
        }        
    }
    else if( liuZhi.equals("丑")) {
        if( bigZhi.equals("亥") && ( hourZhi.equals("子") || dayZhi.equals("子") || 
        monthZhi.equals("子") || yearZhi.equals("子") ) ) {
            msg = "亥子丑三合水局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("子") && ( hourZhi.equals("亥") || dayZhi.equals("亥") ||
        monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
            msg = "亥子丑三合水局。";
            arrAnalysis.add(msg);
        }
    }

    //#endregion

    //#region 地支三合局

    if( liuZhi.equals("亥")) {
        if( bigZhi.equals("卯") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
        monthZhi.equals("未") || yearZhi.equals("未") ) ) {
            msg = "亥卯未三合木局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("未") && ( hourZhi.equals("卯") || dayZhi.equals("卯") ||
        monthZhi.equals("卯") || yearZhi.equals("卯") ) ) {
            msg = "亥卯未三合木局。";
            arrAnalysis.add(msg);
        }
    }
    else if( liuZhi.equals("卯")) {
        if( bigZhi.equals("亥") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
        monthZhi.equals("未") || yearZhi.equals("未") ) ) {
            msg = "亥卯未三合木局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("未") && ( hourZhi.equals("亥") || dayZhi.equals("亥") ||
        monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
            msg = "亥卯未三合木局。";
            arrAnalysis.add(msg);
        }
    }
    else if( liuZhi.equals("未")) {
        if( bigZhi.equals("亥") && ( hourZhi.equals("卯") || dayZhi.equals("卯") || 
        monthZhi.equals("卯") || yearZhi.equals("卯") ) ) {
            msg = "亥卯未三合木局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("卯") && ( hourZhi.equals("亥") || dayZhi.equals("亥") ||
        monthZhi.equals("亥") || yearZhi.equals("亥") ) ) {
            msg = "亥卯未三合木局。";
            arrAnalysis.add(msg);
        }
    }

    if( liuZhi.equals("寅")) {
        if( bigZhi.equals("午") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
        monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
            msg = "寅午戌三合火局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("戌") && ( hourZhi.equals("午") || dayZhi.equals("午") ||
        monthZhi.equals("午") || yearZhi.equals("午") ) ) {
            msg = "寅午戌三合火局。";
            arrAnalysis.add(msg);
        }
    }
    else if( liuZhi.equals("午")) {
        if( bigZhi.equals("寅") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
        monthZhi.equals("戌") || yearZhi.equals("戌") ) ) {
            msg = "寅午戌三合火局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("戌") && ( hourZhi.equals("寅") || dayZhi.equals("寅") ||
        monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
            msg = "寅午戌三合火局。";
            arrAnalysis.add(msg);
        }
    }
    else if( liuZhi.equals("戌")) {
        if( bigZhi.equals("寅") && ( hourZhi.equals("午") || dayZhi.equals("午") || 
        monthZhi.equals("午") || yearZhi.equals("午") ) ) {
            msg = "寅午戌三合火局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("午") && ( hourZhi.equals("寅") || dayZhi.equals("寅") ||
        monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
            msg = "寅午戌三合火局。";
            arrAnalysis.add(msg);
        }
    }

    if( liuZhi.equals("申")) {
        if( bigZhi.equals("子") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || 
        monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
            msg = "申子辰三合水局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("辰") && ( hourZhi.equals("子") || dayZhi.equals("子") ||
        monthZhi.equals("子") || yearZhi.equals("子") ) ) {
            msg = "申子辰三合水局。";
            arrAnalysis.add(msg);
        }
    }
    else if( liuZhi.equals("子")) {
        if( bigZhi.equals("申") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || 
        monthZhi.equals("辰") || yearZhi.equals("辰") ) ) {
            msg = "申子辰三合水局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("辰") && ( hourZhi.equals("申") || dayZhi.equals("申") ||
        monthZhi.equals("申") || yearZhi.equals("申") ) ) {
            msg = "申子辰三合水局。";
            arrAnalysis.add(msg);
        }
    }
    else if( liuZhi.equals("辰")) {
        if( bigZhi.equals("申") && ( hourZhi.equals("子") || dayZhi.equals("子") || 
        monthZhi.equals("子") || yearZhi.equals("子") ) ) {
            msg = "申子辰三合水局。";   
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("子") && ( hourZhi.equals("申") || dayZhi.equals("申") ||
        monthZhi.equals("申") || yearZhi.equals("申") ) ) {
            msg = "申子辰三合水局。";
            arrAnalysis.add(msg);
        }
    }

    if( liuZhi.equals("巳")) {
        if( bigZhi.equals("酉") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
        monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
            msg = "巳酉丑三合金局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("丑") && ( hourZhi.equals("酉") || dayZhi.equals("酉") ||
        monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
            msg = "巳酉丑三合金局。";
            arrAnalysis.add(msg);
        }
    }
    else if( liuZhi.equals("酉")) {
        if( bigZhi.equals("巳") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
        monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
            msg = "巳酉丑三合金局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("丑") && ( hourZhi.equals("巳") || dayZhi.equals("巳") ||
        monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
            msg = "巳酉丑三合金局。";
            arrAnalysis.add(msg);
        }
    }
    else if( liuZhi.equals("丑")) {
        if( bigZhi.equals("巳") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || 
        monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
            msg = "巳酉丑三合金局。";
            arrAnalysis.add(msg);
        }
        else if( bigZhi.equals("酉") && ( hourZhi.equals("巳") || dayZhi.equals("巳") ||
        monthZhi.equals("巳") || yearZhi.equals("巳") ) ) {
            msg = "巳酉丑三合金局。";
            arrAnalysis.add(msg);
        }
    }
    
    //#endregion

    //#region 地支六合

        if( liuZhi.equals("子") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
        monthZhi.equals("丑") || yearZhi.equals("丑") || bigZhi.equals("丑") ) ) {
            msg = "子丑六合土局。";
            arrAnalysis.add(msg);
        }
        if( liuZhi.equals("丑") && ( hourZhi.equals("子") || dayZhi.equals("子") || 
        monthZhi.equals("子") || yearZhi.equals("子") || bigZhi.equals("子") ) ) {
            msg = "子丑六合土局。";
            arrAnalysis.add(msg);
        }

        if( liuZhi.equals("寅") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || 
        monthZhi.equals("亥") || yearZhi.equals("亥") || bigZhi.equals("亥") ) ) {
            msg = "寅亥六合木局。";
            arrAnalysis.add(msg);
        }
        if( liuZhi.equals("亥") && ( hourZhi.equals("寅") || dayZhi.equals("寅") || 
        monthZhi.equals("寅") || yearZhi.equals("寅") || bigZhi.equals("寅") ) ) {
            msg = "寅亥六合木局。";
            arrAnalysis.add(msg);
        }

        if( liuZhi.equals("卯") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
        monthZhi.equals("戌") || yearZhi.equals("戌") || bigZhi.equals("戌") ) ) {
            msg = "卯戌六合火局。";
            arrAnalysis.add(msg);
        }
        if( liuZhi.equals("戌") && ( hourZhi.equals("卯") || dayZhi.equals("卯") || 
        monthZhi.equals("卯") || yearZhi.equals("卯") || bigZhi.equals("卯") ) ) {
            msg = "卯戌六合火局。";
            arrAnalysis.add(msg);
        }

        if( liuZhi.equals("辰") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || 
        monthZhi.equals("酉") || yearZhi.equals("酉") || bigZhi.equals("酉") ) ) {
            msg = "辰酉六合金局。";
            arrAnalysis.add(msg);
        }
        if( liuZhi.equals("酉") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || 
        monthZhi.equals("辰") || yearZhi.equals("辰") || bigZhi.equals("辰") ) ) {
            msg = "辰酉六合金局。";
            arrAnalysis.add(msg);
        }

        if( liuZhi.equals("巳") && ( hourZhi.equals("申") || dayZhi.equals("申") || 
        monthZhi.equals("申") || yearZhi.equals("申") || bigZhi.equals("申") ) ) {
            msg = "巳申六合水局。";
            arrAnalysis.add(msg);
        }
        if( liuZhi.equals("申") && ( hourZhi.equals("巳") || dayZhi.equals("巳") || 
        monthZhi.equals("巳") || yearZhi.equals("巳") || bigZhi.equals("巳") ) ) {
            msg = "巳申六合水局。";
            arrAnalysis.add(msg);
        }

        
        if( liuZhi.equals("午") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
        monthZhi.equals("未") || yearZhi.equals("未") || bigZhi.equals("未") ) ) {
            msg = "午未六合土局。";
            arrAnalysis.add(msg);
        }
        if( liuZhi.equals("未") && ( hourZhi.equals("午") || dayZhi.equals("午") || 
        monthZhi.equals("午") || yearZhi.equals("午") || bigZhi.equals("午") ) ) {
            msg = "午未六合土局。";
            arrAnalysis.add(msg);
        }
    

    //#endregion

    /// 地支刑冲害 
    //#region 地支六冲
    if( liuZhi.equals("子") && ( hourZhi.equals("午") || dayZhi.equals("午") || 
    monthZhi.equals("午") || yearZhi.equals("午") || bigZhi.equals("午") ) ) {
        msg = "子午相冲。";
        arrAnalysis.add(msg);
    }
    if( liuZhi.equals("午") && ( hourZhi.equals("子") || dayZhi.equals("子") || 
    monthZhi.equals("子") || yearZhi.equals("子") || bigZhi.equals("子") ) ) {
        msg = "子午相冲。";
        arrAnalysis.add(msg);
    }

    if( liuZhi.equals("丑") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
    monthZhi.equals("未") || yearZhi.equals("未") || bigZhi.equals("未") ) ) {
        msg = "丑未相冲。";
        arrAnalysis.add(msg);
    }
    if( liuZhi.equals("未") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
    monthZhi.equals("丑") || yearZhi.equals("丑") || bigZhi.equals("丑") ) ) {
        msg = "丑未相冲。";
        arrAnalysis.add(msg);
    }

    if( liuZhi.equals("寅") && ( hourZhi.equals("申") || dayZhi.equals("申") || 
    monthZhi.equals("申") || yearZhi.equals("申") || bigZhi.equals("申") ) ) {
        msg = "寅申相冲。";
        arrAnalysis.add(msg);
    }
    if( liuZhi.equals("申") && ( hourZhi.equals("寅") || dayZhi.equals("寅") || 
    monthZhi.equals("寅") || yearZhi.equals("寅") || bigZhi.equals("寅") ) ) {
        msg = "寅申相冲。";
        arrAnalysis.add(msg);
    }

    if( liuZhi.equals("卯") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || 
    monthZhi.equals("酉") || yearZhi.equals("酉") || bigZhi.equals("酉") ) ) {
        msg = "卯酉相冲。";
        arrAnalysis.add(msg);
    }
    if( liuZhi.equals("酉") && ( hourZhi.equals("卯") || dayZhi.equals("卯") || 
    monthZhi.equals("卯") || yearZhi.equals("卯") || bigZhi.equals("卯") ) ) {
        msg = "卯酉相冲。";
        arrAnalysis.add(msg);
    }

    if( liuZhi.equals("辰") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
            monthZhi.equals("戌") || yearZhi.equals("戌") || bigZhi.equals("戌") ) ) {
        msg = "辰戌相冲。";
        arrAnalysis.add(msg);
    }
    if( liuZhi.equals("戌") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || 
    monthZhi.equals("辰") || yearZhi.equals("辰") || bigZhi.equals("辰") ) ) {
        msg = "辰戌相冲。";
        arrAnalysis.add(msg);
    }

    if( liuZhi.equals("巳") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || 
    monthZhi.equals("亥") || yearZhi.equals("亥") || bigZhi.equals("亥") ) ) {
        msg = "巳亥相冲。";
        arrAnalysis.add(msg);
    }
    if( liuZhi.equals("亥") && ( hourZhi.equals("巳") || dayZhi.equals("巳") || 
    monthZhi.equals("巳") || yearZhi.equals("巳") || bigZhi.equals("巳") ) ) {
        msg = "巳亥相冲。";
        arrAnalysis.add(msg);
    }

    //#endregion

    //#region 地址六害 
    if( liuZhi.equals("子") && ( hourZhi.equals("未") || dayZhi.equals("未") || 
    monthZhi.equals("未") || yearZhi.equals("未") || bigZhi.equals("未") ) ) {
        msg = "子未相害。";
        arrAnalysis.add(msg);
    }
    if( liuZhi.equals("未") && ( hourZhi.equals("子") || dayZhi.equals("子") || 
    monthZhi.equals("子") || yearZhi.equals("子") || bigZhi.equals("子") ) ) {
        msg = "子未相害。";
        arrAnalysis.add(msg);
    }

    if( liuZhi.equals("丑") && ( hourZhi.equals("午") || dayZhi.equals("午") || 
    monthZhi.equals("午") || yearZhi.equals("午") || bigZhi.equals("午") ) ) {
        msg = "丑午相害。";
        arrAnalysis.add(msg);
    }
    if( liuZhi.equals("午") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
    monthZhi.equals("丑") || yearZhi.equals("丑") || bigZhi.equals("丑") ) ) {
        msg = "丑午相害。";
        arrAnalysis.add(msg);
    }

    if( liuZhi.equals("寅") && ( hourZhi.equals("巳") || dayZhi.equals("巳") || 
    monthZhi.equals("巳") || yearZhi.equals("巳") || bigZhi.equals("巳") ) ) {
        msg = "寅巳相害。";
        arrAnalysis.add(msg);
    }
    if( liuZhi.equals("巳") && ( hourZhi.equals("寅") || dayZhi.equals("寅") || 
    monthZhi.equals("寅") || yearZhi.equals("寅") || bigZhi.equals("寅") ) ) {
        msg = "寅巳相害。";
        arrAnalysis.add(msg);
    }

    if( liuZhi.equals("卯") && ( hourZhi.equals("辰") || dayZhi.equals("辰") || 
            monthZhi.equals("辰") || yearZhi.equals("辰") || bigZhi.equals("辰") ) ) {
        msg = "卯辰相害。";
        arrAnalysis.add(msg);
    }
    if( liuZhi.equals("辰") && ( hourZhi.equals("卯") || dayZhi.equals("卯") || 
    monthZhi.equals("卯") || yearZhi.equals("卯") || bigZhi.equals("卯") ) ) {
        msg = "卯辰相害。";
        arrAnalysis.add(msg);
    }

    if( liuZhi.equals("申") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || 
    monthZhi.equals("亥") || yearZhi.equals("亥") || bigZhi.equals("亥") ) ) {
        msg = "申亥相害。";
        arrAnalysis.add(msg);
    }
    if( liuZhi.equals("亥") && ( hourZhi.equals("申") || dayZhi.equals("申") || 
    monthZhi.equals("申") || yearZhi.equals("申") || bigZhi.equals("申") ) ) {
        msg = "申亥相害。";
        arrAnalysis.add(msg);
    }

    if( liuZhi.equals("酉") && ( hourZhi.equals("戌") || dayZhi.equals("戌") || 
    monthZhi.equals("戌") || yearZhi.equals("戌") || bigZhi.equals("戌") ) ) {
        msg = "酉戌相害。";
        arrAnalysis.add(msg);
    }
    if( liuZhi.equals("戌") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || 
    monthZhi.equals("酉") || yearZhi.equals("酉") || bigZhi.equals("酉") ) ) {
        msg = "酉戌相害。";
        arrAnalysis.add(msg);
    }
    
    //#endregion

    //#region 地支相刑 
    if( liuZhi.equals("寅")) {
        if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || 
        yearZhi.equals("巳") || bigZhi.equals("巳") ) {
            if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || 
            yearZhi.equals("申") || bigZhi.equals("申") ) {
                msg = "寅巳申三刑。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( liuZhi.equals("巳")) {
        if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || 
        yearZhi.equals("申") || bigZhi.equals("申") ) {
            if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || 
            yearZhi.equals("寅") || bigZhi.equals("寅")) {
                msg = "寅巳申三刑。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( liuZhi.equals("申")) {
        if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || 
        yearZhi.equals("寅") || bigZhi.equals("寅") ) {
            if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || 
            yearZhi.equals("巳") || bigZhi.equals("巳") ) {
                msg = "寅巳申三刑。";
                arrAnalysis.add(msg);
            }
        }
    }

    if(liuZhi.equals("未")) {
        if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || 
        yearZhi.equals("丑") || bigZhi.equals("丑") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || 
            yearZhi.equals("戌") || bigZhi.equals("戌") ) {
                msg = "未丑戌三刑。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( liuZhi.equals("丑")) {
        if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || 
        yearZhi.equals("未") || bigZhi.equals("未") ) {
            if( hourZhi.equals("戌") || dayZhi.equals("戌") || monthZhi.equals("戌") || 
            yearZhi.equals("戌") || bigZhi.equals("戌") ) {
                msg = "未丑戌三刑。";
                arrAnalysis.add(msg);
            }
        }
    }
    else if( liuZhi.equals("戌")) {
        if( hourZhi.equals("未") || dayZhi.equals("未") || monthZhi.equals("未") || 
        yearZhi.equals("未") || bigZhi.equals("未") ) {
            if( hourZhi.equals("丑") || dayZhi.equals("丑") || monthZhi.equals("丑") || 
            yearZhi.equals("丑") || bigZhi.equals("丑") ) {
                msg = "未丑戌三刑。";
                arrAnalysis.add(msg);
            }
        }
    }

    if( liuZhi.equals("卯") && (hourZhi.equals("子") || dayZhi.equals("子") || 
    monthZhi.equals("子") || yearZhi.equals("子") || bigZhi.equals("子") ) ) {
        msg = "子卯二刑。";
        arrAnalysis.add(msg);
    }
    else if( liuZhi.equals("子") && (hourZhi.equals("卯") || dayZhi.equals("卯") || 
            monthZhi.equals("卯") || yearZhi.equals("卯") || bigZhi.equals("卯") ) ) {
        msg = "子卯二刑。";
        arrAnalysis.add(msg);
    }

    if( liuZhi.equals("辰") && (hourZhi.equals("辰") || dayZhi.equals("辰") || 
    monthZhi.equals("辰") || yearZhi.equals("辰") || bigZhi.equals("辰") ) ) {
        msg = "辰辰自刑。";
        arrAnalysis.add(msg);
    }

    if( liuZhi.equals("午") && (hourZhi.equals("午") || dayZhi.equals("午") || 
    monthZhi.equals("午") || yearZhi.equals("午") || bigZhi.equals("午") ) ) {
        msg = "午午自刑。";
        arrAnalysis.add(msg);
    }

    if( liuZhi.equals("酉") && ( hourZhi.equals("酉")  || dayZhi.equals("酉") || 
    monthZhi.equals("酉") || yearZhi.equals("酉") || bigZhi.equals("酉") ) ) {
        msg = "酉酉自刑。";
        arrAnalysis.add(msg);
    }
    if( liuZhi.equals("亥") && ( hourZhi.equals("亥") || dayZhi.equals("亥") || 
    monthZhi.equals("亥") || yearZhi.equals("亥") || bigZhi.equals("亥")) ) {
        msg = "亥亥自刑。";
        arrAnalysis.add(msg);
    }

    //#endregion

    //#region 天干五合
    if( liuGan.equals("甲") && ( hourGan.equals("己") ||  
    monthGan.equals("己") || yearGan.equals("己") || bigGan.equals("己") ) ) {
        msg = "甲己合化土。";
        arrAnalysis.add(msg);
    }
    if( liuGan.equals("己") && ( hourGan.equals("甲") ||  
    monthGan.equals("甲") || yearGan.equals("甲") || bigGan.equals("甲") ) ) {
        msg = "甲己合化土。";
        arrAnalysis.add(msg);
    }

    if( liuGan.equals("乙") && ( hourGan.equals("庚") || 
    monthGan.equals("庚") || yearGan.equals("庚") || bigGan.equals("庚") ) ) {
        msg = "乙庚合化金。";
        arrAnalysis.add(msg);
    }
    if( liuGan.equals("庚") && ( hourGan.equals("乙") || 
    monthGan.equals("乙") || yearGan.equals("乙") || bigGan.equals("乙") ) ) {
        msg = "乙庚合化金。";
        arrAnalysis.add(msg);
    } 

    if( liuGan.equals("丙") && ( hourGan.equals("辛") ||  
    monthGan.equals("辛") || yearGan.equals("辛") || bigGan.equals("辛") ) ) {
        msg = "丙辛合化水。";
        arrAnalysis.add(msg);
    }
    if( liuGan.equals("辛") && ( hourGan.equals("丙") ||  
    monthGan.equals("丙") || yearGan.equals("丙") || bigGan.equals("丙") ) ) {
        msg = "丙辛合化水。";
        arrAnalysis.add(msg);
    }

    if( liuGan.equals("丁") && ( hourGan.equals("壬") || 
    monthGan.equals("壬") || yearGan.equals("壬") || bigGan.equals("壬") ) ) {
        msg = "丁壬合化木。";
        arrAnalysis.add(msg);
    }
    if( liuGan.equals("壬") && ( hourGan.equals("丁") ||  
    monthGan.equals("丁") || yearGan.equals("丁") || bigGan.equals("丁") ) ) {
        msg = "丁壬合化木。";
        arrAnalysis.add(msg);
    }

    if( liuGan.equals("戊") && ( hourGan.equals("癸") ||  
    monthGan.equals("癸") || yearGan.equals("癸") || bigGan.equals("癸") ) ) {
        msg = "戊癸合化火。";
        arrAnalysis.add(msg);
    }
    if( liuGan.equals("癸") && ( hourGan.equals("戊") ||  
    monthGan.equals("戊") || yearGan.equals("戊") || bigGan.equals("戊") ) ) {
        msg = "戊癸合化火。";
        arrAnalysis.add(msg);
    }

    //#endregion

    //#region 天干四冲
    if( liuGan.equals("庚") && ( hourGan.equals("甲") || dayGan.equals("甲") || 
    monthGan.equals("甲") || yearGan.equals("甲") || bigGan.equals("甲") ) ) {
        msg = "甲庚相冲。";
        arrAnalysis.add(msg);
    }
    if( liuGan.equals("甲") && ( hourGan.equals("庚") || dayGan.equals("庚") || 
    monthGan.equals("庚") || yearGan.equals("庚") || bigGan.equals("庚") ) ) {
        msg = "甲庚相冲。";
        arrAnalysis.add(msg);
    }

    if( liuGan.equals("乙") && ( hourGan.equals("辛") || dayGan.equals("辛") || 
    monthGan.equals("辛") || yearGan.equals("辛") || bigGan.equals("辛") ) ) {
        msg = "乙辛相冲。";
        arrAnalysis.add(msg);
    }
    if( liuGan.equals("辛") && ( hourGan.equals("乙") || dayGan.equals("乙") || 
    monthGan.equals("乙") || yearGan.equals("乙") || bigGan.equals("乙") ) ) {
        msg = "乙辛相冲。";
        arrAnalysis.add(msg);
    }

    if( liuGan.equals("丙") && ( hourGan.equals("壬") || dayGan.equals("壬") || 
    monthGan.equals("壬") || yearGan.equals("壬") || bigGan.equals("壬") ) ) {
        msg = "丙壬相冲。";
        arrAnalysis.add(msg);
    }
    if( liuGan.equals("壬") && ( hourGan.equals("丙") || dayGan.equals("丙") || 
    monthGan.equals("丙") || yearGan.equals("丙") || bigGan.equals("丙") ) ) {
        msg = "丙壬相冲。";
        arrAnalysis.add(msg);
    } 

    if( liuGan.equals("丁") && ( hourGan.equals("癸") || dayGan.equals("癸") || 
    monthGan.equals("癸") || yearGan.equals("癸") || bigGan.equals("癸") ) ) {
        msg = "丁癸相冲。";
        arrAnalysis.add(msg);
    }
    if( liuGan.equals("癸") && ( hourGan.equals("丁") || dayGan.equals("丁") || 
    monthGan.equals("丁") || yearGan.equals("丁") || bigGan.equals("丁") ) ) {
        msg = "丁癸相冲。";
        arrAnalysis.add(msg);
    }
    //#endregion

    //#endregion

    return arrAnalysis;
}

//#region mp analysis

public String fnAnalysisSelfMp() { /// 免费的八字命理分析 
    ArrayList<String> arrAnalysis = new ArrayList<String>();
    // 开始按 命格分析，本命强弱，五行喜忌，命格，婚宫，性格，子女，合冲等
    String msg;

    if( bazi == null ) {
        arrAnalysis.add("无数据");
        return JSON.toJSONString(arrAnalysis);
    }

    arrAnalysis.add("公历：" + bazi.birthday);
    arrAnalysis.add("农历：" + bazi.lunarDate);
    arrAnalysis.add("八字：" + bazi.yearGan + bazi.yearZhi + "年 " + bazi.monthGan + bazi.monthZhi + "月 " + bazi.dayGan + bazi.dayZhi + "日 " + bazi.hourGan + bazi.hourZhi + "时");
    if( bazi.sex.equals("男")) {
        msg = "性别：男生";
    }
    else {
        msg = "性别：女生";
    }
    arrAnalysis.add(msg);

    // 日干分析
    List<String> list;
    
    list = fnBaziAnalysis(bazi.sex, bazi.yearGan, bazi.yearZhi, bazi.monthGan, bazi.monthZhi, bazi.dayGan, bazi.dayZhi, bazi.hourGan, bazi.hourZhi);
    arrAnalysis.addAll(list);

    // 分析大运
    list = fnSelfPayBigFate2();
    arrAnalysis.addAll(list);

    // 分析流年
    list = fnSelfPayLiuNian2();
    arrAnalysis.addAll(list);
    
    String str = JSON.toJSONString(arrAnalysis);
    return str;
}

public List<String> fnDayFateAnalysis(String paipanCurDay ) { /// 免费的日运分析
    String rtn = "今日信息";
    Integer orderNo = 1;
    ArrayList<String> arrAnalysis = new ArrayList<String>();       
    arrAnalysis.add(rtn);

    BaZiFateAge baziDay = JSON.parseObject(paipanCurDay, BaZiFateAge.class);

    if( baziDay.dayGan.equals("甲") || baziDay.dayGan.equals("乙") ) {
        arrAnalysis.add(orderNo.toString() +  "、甲乙"); orderNo++;
        arrAnalysis.add("与亲友同学有事情。");

        arrAnalysis.add(orderNo.toString() +  "、丙丁"); orderNo++;
        arrAnalysis.add("有人帮忙，做事顺利。");

        arrAnalysis.add(orderNo.toString() +  "、戊己"); orderNo++;
        arrAnalysis.add("做事不顺，压力大。"); 

        arrAnalysis.add(orderNo.toString() +  "、庚辛"); orderNo++;
        arrAnalysis.add("有可能花钱或者赚钱。");

        arrAnalysis.add(orderNo.toString() +  "、壬癸"); orderNo++;
        arrAnalysis.add("需要付出。"); 
    }
    else if( baziDay.dayGan.equals("丙") || baziDay.dayGan.equals("丁") ) {
        arrAnalysis.add(orderNo.toString() +  "、甲乙"); orderNo++;
        arrAnalysis.add("需要付出。"); 

        arrAnalysis.add(orderNo.toString() +  "、丙丁"); orderNo++;
        arrAnalysis.add("与亲友同学有事情。");

        arrAnalysis.add(orderNo.toString() +  "、戊己"); orderNo++;
        arrAnalysis.add("有人帮忙，做事顺利。");

        arrAnalysis.add(orderNo.toString() +  "、庚辛"); orderNo++;
        arrAnalysis.add("做事不顺，压力大。"); 

        arrAnalysis.add(orderNo.toString() +  "、壬癸"); orderNo++;
        arrAnalysis.add("有可能花钱或者赚钱。");

    }
    else if( baziDay.dayGan.equals("戊") || baziDay.dayGan.equals("己") ) {
        arrAnalysis.add(orderNo.toString() +  "、甲乙"); orderNo++;
        arrAnalysis.add("有可能花钱或者赚钱。");

        arrAnalysis.add(orderNo.toString() +  "、丙丁"); orderNo++;
        arrAnalysis.add("需要付出。"); 

        arrAnalysis.add(orderNo.toString() +  "、戊己"); orderNo++;
        arrAnalysis.add("与亲友同学有事情。");

        arrAnalysis.add(orderNo.toString() +  "、庚辛"); orderNo++;
        arrAnalysis.add("有人帮忙，做事顺利。");

        arrAnalysis.add(orderNo.toString() +  "、壬癸"); orderNo++;
        arrAnalysis.add("做事不顺，压力大。"); 

    }
    else if( baziDay.dayGan.equals("庚") || baziDay.dayGan.equals("辛") ) {
        arrAnalysis.add(orderNo.toString() +  "、甲乙"); orderNo++;
        arrAnalysis.add("做事不顺，压力大。"); 

        arrAnalysis.add(orderNo.toString() +  "、丙丁"); orderNo++;
        arrAnalysis.add("有可能花钱或者赚钱。");

        arrAnalysis.add(orderNo.toString() +  "、戊己"); orderNo++;
        arrAnalysis.add("需要付出。"); 

        arrAnalysis.add(orderNo.toString() +  "、庚辛"); orderNo++;
        arrAnalysis.add("与亲友同学有事情。");

        arrAnalysis.add(orderNo.toString() +  "、壬癸"); orderNo++;
        arrAnalysis.add("有人帮忙，做事顺利。");
    }
    else if( baziDay.dayGan.equals("壬") || baziDay.dayGan.equals("癸") ) {
        arrAnalysis.add(orderNo.toString() +  "、甲乙"); orderNo++;
        arrAnalysis.add("有人帮忙，做事顺利。");

        arrAnalysis.add(orderNo.toString() +  "、丙丁"); orderNo++;
        arrAnalysis.add("做事不顺，压力大。"); 

        arrAnalysis.add(orderNo.toString() +  "、戊己"); orderNo++;
        arrAnalysis.add("有可能花钱或者赚钱。");

        arrAnalysis.add(orderNo.toString() +  "、庚辛"); orderNo++;
        arrAnalysis.add("需要付出。"); 

        arrAnalysis.add(orderNo.toString() +  "、壬癸"); orderNo++;
        arrAnalysis.add("与亲友同学有事情。");
    }

    return arrAnalysis;
}

public List<String> fnDayFateAnalysisPaid(String paipanCurDay ) { /// 收费的用户日运分析
    String rtn = "本人今日信息";
    Integer orderNo = 1;
    ArrayList<String> arrAnalysis = new ArrayList<String>();
    arrAnalysis.add(rtn);

    BaZiFateAge baziDay = JSON.parseObject(paipanCurDay, BaZiFateAge.class);

    if( baziDay.dayGan.equals("甲") || baziDay.dayGan.equals("乙") ) {
        if( bazi.dayGan.equals("甲") || bazi.dayGan.equals("乙") ) {
            arrAnalysis.add(orderNo.toString() +  "、 与亲友同学有事情。");
            orderNo++;
        }
        else if( bazi.dayGan.equals("丙") || bazi.dayGan.equals("丁") ) {
            arrAnalysis.add(orderNo.toString() +  "、 有人帮忙，做事顺利。");
            orderNo++;
        }
        else if( bazi.dayGan.equals("戊") || bazi.dayGan.equals("己") ) {
            arrAnalysis.add(orderNo.toString() +  "、 做事不顺，压力大。"); 
            orderNo++;
        }
        else if( bazi.dayGan.equals("庚") || bazi.dayGan.equals("辛") ) {
            arrAnalysis.add(orderNo.toString() +  "、 有可能花钱或者赚钱。");
            orderNo++;
        }
        else if( bazi.dayGan.equals("壬") || bazi.dayGan.equals("癸") ) {
            arrAnalysis.add(orderNo.toString() +  "、 需要付出。"); 
            orderNo++;
        }
    }
    else if( baziDay.dayGan.equals("丙") || baziDay.dayGan.equals("丁") ) {
        if( bazi.dayGan.equals("甲") || bazi.dayGan.equals("乙") ) {
            arrAnalysis.add(orderNo.toString() +  "、 需要付出。"); 
            orderNo++;
        }
        else if( bazi.dayGan.equals("丙") || bazi.dayGan.equals("丁") ) {
            arrAnalysis.add(orderNo.toString() +  "、 与亲友同学有事情。");
            orderNo++;
        }
        else if( bazi.dayGan.equals("戊") || bazi.dayGan.equals("己") ) {
            arrAnalysis.add(orderNo.toString() +  "、 有人帮忙，做事顺利。");
            orderNo++;
        }
        else if( bazi.dayGan.equals("庚") || bazi.dayGan.equals("辛") ) {
            arrAnalysis.add(orderNo.toString() +  "、 做事不顺，压力大。"); 
            orderNo++;
        }
        else if( bazi.dayGan.equals("壬") || bazi.dayGan.equals("癸") ) {
            arrAnalysis.add(orderNo.toString() +  "、 有可能花钱或者赚钱。");
            orderNo++;
        }
    }
    else if( baziDay.dayGan.equals("戊") || baziDay.dayGan.equals("己") ) {
        if( bazi.dayGan.equals("甲") || bazi.dayGan.equals("乙") ) {
            arrAnalysis.add(orderNo.toString() +  "、 有可能花钱或者赚钱。");
            orderNo++;
        }
        else if( bazi.dayGan.equals("丙") || bazi.dayGan.equals("丁") ) {
            arrAnalysis.add(orderNo.toString() +  "、 需要付出。"); 
            orderNo++;
        }
        else if( bazi.dayGan.equals("戊") || bazi.dayGan.equals("己") ) {
            arrAnalysis.add(orderNo.toString() +  "、 与亲友同学有事情。");
            orderNo++;
        }
        else if( bazi.dayGan.equals("庚") || bazi.dayGan.equals("辛") ) {
            arrAnalysis.add(orderNo.toString() +  "、 有人帮忙，做事顺利。");
            orderNo++;
        }
        else if( bazi.dayGan.equals("壬") || bazi.dayGan.equals("癸") ) {
            arrAnalysis.add(orderNo.toString() +  "、 做事不顺，压力大。"); 
            orderNo++;
        }
    }
    else if( baziDay.dayGan.equals("庚") || baziDay.dayGan.equals("辛") ) {
        if( bazi.dayGan.equals("甲") || bazi.dayGan.equals("乙") ) {
            arrAnalysis.add(orderNo.toString() +  "、 做事不顺，压力大。"); 
            orderNo++;
        }
        else if( bazi.dayGan.equals("丙") || bazi.dayGan.equals("丁") ) {
            arrAnalysis.add(orderNo.toString() +  "、 有可能花钱或者赚钱。");
            orderNo++;
        }
        else if( bazi.dayGan.equals("戊") || bazi.dayGan.equals("己") ) {
            arrAnalysis.add(orderNo.toString() +  "、 需要付出。"); 
            orderNo++;
        }
        else if( bazi.dayGan.equals("庚") || bazi.dayGan.equals("辛") ) {
            arrAnalysis.add(orderNo.toString() +  "、 与亲友同学有事情。");
            orderNo++;
        }
        else if( bazi.dayGan.equals("壬") || bazi.dayGan.equals("癸") ) {
            arrAnalysis.add(orderNo.toString() +  "、 有人帮忙，做事顺利。");
            orderNo++;
        }
    }
    else if( baziDay.dayGan.equals("壬") || baziDay.dayGan.equals("癸") ) {
        if( bazi.dayGan.equals("甲") || bazi.dayGan.equals("乙") ) {
            arrAnalysis.add(orderNo.toString() +  "、 有人帮忙，做事顺利。");
            orderNo++;
        }
        else if( bazi.dayGan.equals("丙") || bazi.dayGan.equals("丁") ) {
            arrAnalysis.add(orderNo.toString() +  "、 做事不顺，压力大。"); 
            orderNo++;
        }
        else if( bazi.dayGan.equals("戊") || bazi.dayGan.equals("己") ) {
            arrAnalysis.add(orderNo.toString() +  "、 有可能花钱或者赚钱。");
            orderNo++;
        }
        else if( bazi.dayGan.equals("庚") || bazi.dayGan.equals("辛") ) {
            arrAnalysis.add(orderNo.toString() +  "、 需要付出。"); 
            orderNo++;
        }
        else if( bazi.dayGan.equals("壬") || bazi.dayGan.equals("癸") ) {
            arrAnalysis.add(orderNo.toString() +  "、 与亲友同学有事情。");
            orderNo++;
        }
    }

    return arrAnalysis;
}

//#endregion
    

//#region tools 

    public String fnSelfGanHeChongFate(String gan, boolean key) { 
        /// 加上大运的天干合冲
        String str = "";

        //#region 天干五合
        if( gan.equals("甲") && ( bazi.hourGan.equals("己") || bazi.dayGan.equals("己") || 
                                            bazi.monthGan.equals("己") || bazi.yearGan.equals("己") ) ) {
            if( feTu > 0 ) {
                str = str + (key == true ? "甲己合化土，" : "")  +  "易安分守信。";
            }
            else {    
                str = str + (key == true ? "甲己合土未成，" : "");
            }
        }
        if( gan.equals("己") && ( bazi.hourGan.equals("甲") || bazi.dayGan.equals("甲") || 
                                            bazi.monthGan.equals("甲") || bazi.yearGan.equals("甲") ) ) {
            if( feTu > 0 ) {
                str = str + (key == true ? "甲己合化土，" : "")  +  "易安分守信。";
            }
            else {    
                str = str + (key == true ? "甲己合土未成，" : "");
            }
        }

        if( gan.equals("乙") && ( bazi.hourGan.equals("庚") || bazi.dayGan.equals("庚") || 
                                            bazi.monthGan.equals("庚") || bazi.yearGan.equals("庚") ) ) {
            if( feJin > 0 ) {
                str = str + (key == true ? "乙庚合化金，" : "")  +  "易有仁有义。";
            }
            else {                    
                str = str + (key == true ? "乙庚合金未成。" : "");
            }
        }
        if( gan.equals("庚") && ( bazi.hourGan.equals("乙") || bazi.dayGan.equals("乙") || 
                                            bazi.monthGan.equals("乙") || bazi.yearGan.equals("乙") ) ) {
            if( feJin > 0 ) {
                str = str + (key == true ? "乙庚合化金，" : "")  +  "易有仁有义。";
            }
            else {                    
                str = str + (key == true ? "乙庚合金未成。" : "");
            }
        } 

        if( gan.equals("丙") && ( bazi.hourGan.equals("辛") || bazi.dayGan.equals("辛") || 
                                            bazi.monthGan.equals("辛") || bazi.yearGan.equals("辛") ) ) {
            if( feShui > 0 ) {
                str = str + (key == true ? "丙辛合化水，" : "")  +  "易聪明贵气。";
            }
            else {                    
                str = str + (key == true ? "丙辛合水未成。" : "");
            }
        }
        if( gan.equals("辛") && ( bazi.hourGan.equals("丙") || bazi.dayGan.equals("丙") || 
                                            bazi.monthGan.equals("丙") || bazi.yearGan.equals("丙") ) ) {
            if( feShui > 0 ) {
                str = str + (key == true ? "丙辛合化水，" : "")  +  "易聪明贵气。";
            }
            else {                    
                str = str + (key == true ? "丙辛合水未成。" : "");
            }
        }

        if( gan.equals("丁") && ( bazi.hourGan.equals("壬") || bazi.dayGan.equals("壬") || 
                                            bazi.monthGan.equals("壬") || bazi.yearGan.equals("壬") ) ) {
            if( feMu > 0 ) {
                str = str + (key == true ? "丁壬合化木，" : "")  +  "虽然积极努力，但后果不确定。";
            }
            else {                    
                str = str + (key == true ? "丁壬合木未成，" : "");
            }
        }
        if( gan.equals("壬") && ( bazi.hourGan.equals("丁") || bazi.dayGan.equals("丁") || 
                                            bazi.monthGan.equals("丁") || bazi.yearGan.equals("丁") ) ) {
            if( feMu > 0 ) {
                str = str + (key == true ? "丁壬合化木，" : "")  +  "虽然积极努力，但后果不确定。";
            }
            else {                    
                str = str + (key == true ? "丁壬合木未成，" : "");
            }
        }

        if( gan.equals("戊") && ( bazi.hourGan.equals("癸") || bazi.dayGan.equals("癸") || 
                                            bazi.monthGan.equals("癸") || bazi.yearGan.equals("癸") ) ) {
            if( feHuo > 0 ) {
                str = str + (key == true ? "戊癸合化火，" : "")  +  "易俊秀薄情。";
            }
            else {                    
                str = str + (key == true ? "戊癸合火未成，" : "");
            }
        }
        if( gan.equals("癸") && ( bazi.hourGan.equals("戊") || bazi.dayGan.equals("戊") || 
                                            bazi.monthGan.equals("戊") || bazi.yearGan.equals("戊") ) ) {
            if( feHuo > 0 ) {
                str = str + (key == true ? "戊癸合化火，" : "")  +  "易俊秀薄情。";
            }
            else {                    
                str = str + (key == true ? "戊癸合火未成，" : "");
            }
        }
        //#endregion

        //#region 天干四冲
        if( gan.equals("庚") && ( bazi.hourGan.equals("甲") || bazi.dayGan.equals("甲") || 
                                            bazi.monthGan.equals("甲") || bazi.yearGan.equals("甲") ) ) {
            str = str + (key == true ? "甲庚相冲。" : "");
        }
        if( gan.equals("甲") && ( bazi.hourGan.equals("庚") || bazi.dayGan.equals("庚") || 
                                            bazi.monthGan.equals("庚") || bazi.yearGan.equals("庚") ) ) {
            str = str + (key == true ? "甲庚相冲。" : "");
        }

        if( gan.equals("乙") && ( bazi.hourGan.equals("辛") || bazi.dayGan.equals("辛") || 
                                            bazi.monthGan.equals("辛") || bazi.yearGan.equals("辛") ) ) {
            str = str + (key == true ? "乙辛相冲。" : "");
        }
        if( gan.equals("辛") && ( bazi.hourGan.equals("乙") || bazi.dayGan.equals("乙") || 
                                            bazi.monthGan.equals("乙") || bazi.yearGan.equals("乙") ) ) {
            str = str + (key == true ? "乙辛相冲。" : "");
        }

        if( gan.equals("丙") && ( bazi.hourGan.equals("壬") || bazi.dayGan.equals("壬") || 
                                            bazi.monthGan.equals("壬") || bazi.yearGan.equals("壬") ) ) {
            str = str + (key == true ? "丙壬相冲。" : "");
        }
        if( gan.equals("壬") && ( bazi.hourGan.equals("丙") || bazi.dayGan.equals("丙") || 
                                            bazi.monthGan.equals("丙") || bazi.yearGan.equals("丙") ) ) {
            str = str + (key == true ? "丙壬相冲。" : "");
        } 

        if( gan.equals("丁") && ( bazi.hourGan.equals("癸") || bazi.dayGan.equals("癸") || 
                                            bazi.monthGan.equals("癸") || bazi.yearGan.equals("癸") ) ) {
            str = str + (key == true ? "丁癸相冲。" : "");
        }
        if( gan.equals("癸") && ( bazi.hourGan.equals("丁") || bazi.dayGan.equals("丁") || 
                                            bazi.monthGan.equals("丁") || bazi.yearGan.equals("丁") ) ) {
            str = str + (key == true ? "丁癸相冲。" : "");
        }
        //#endregion

        return str;        
    }
    public String fnSelfZhiHeChongFate(String zhi, boolean key) {
        /// 加上大运的地支合冲
        String str = "";

        //#region 地支六合
        if( zhi.equals("子") && ( bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || 
                                            bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) ) {
            if( feGanTu > 0) {
                str = str + (key == true ? "子丑克合土。" : "");
            }
            else {
                str = str + (key == true ? "子丑克合土未成。" : "");
            }
        }
        if( zhi.equals("丑") && ( bazi.hourZhi.equals("子") || bazi.dayZhi.equals("子") || 
                                            bazi.monthZhi.equals("子") || bazi.yearZhi.equals("子") ) ) {
            if( feGanTu > 0) {
                str = str + (key == true ? "子丑克合土。" : "");
            }
            else {
                str = str + (key == true ? "子丑克合土未成。" : "");
            }
        }

        if( zhi.equals("寅") && ( bazi.hourZhi.equals("亥") || bazi.dayZhi.equals("亥") || 
                                            bazi.monthZhi.equals("亥") || bazi.yearZhi.equals("亥") ) ) {
            if( feGanMu > 0) {
                str = str + (key == true ? "寅亥生合木。" : "");
            }
            else {
                str = str + (key == true ? "寅亥生合木未成。" : "");
            }
        }
        if( zhi.equals("亥") && ( bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || 
                                            bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) ) {
            if( feGanMu > 0) {
                str = str + (key == true ? "寅亥生合木。" : "");
            }
            else {
                str = str + (key == true ? "寅亥生合木未成。" : "");
            }
        }

        if( zhi.equals("卯") && ( bazi.hourZhi.equals("戌") || bazi.dayZhi.equals("戌") || 
                                            bazi.monthZhi.equals("戌") || bazi.yearZhi.equals("戌") ) ) {
            if( feGanHuo > 0) {
                str = str + (key == true ? "卯戌克合火。" : "");
            }
            else {
                str = str + (key == true ? "卯戌克合火未成。" : "");
            }
        }
        if( zhi.equals("戌") && ( bazi.hourZhi.equals("卯") || bazi.dayZhi.equals("卯") || 
                                            bazi.monthZhi.equals("卯") || bazi.yearZhi.equals("卯") ) ) {
            if( feGanHuo > 0) {
                str = str + (key == true ? "卯戌克合火。" : "");
            }
            else {
                str = str + (key == true ? "卯戌克合火未成。" : "");
            }
        }

        if( zhi.equals("辰") && ( bazi.hourZhi.equals("酉") || bazi.dayZhi.equals("酉") || 
                                            bazi.monthZhi.equals("酉") || bazi.yearZhi.equals("酉") ) ) {
            if( feGanJin > 0) {
                str = str + (key == true ? "辰酉生合金。" : "");
            }
            else {
                str = str + (key == true ? "辰酉生合金未成。" : "");
            }
        }
        if( zhi.equals("酉") && ( bazi.hourZhi.equals("辰") || bazi.dayZhi.equals("辰") || 
                                            bazi.monthZhi.equals("辰") || bazi.yearZhi.equals("辰") ) ) {
            if( feGanJin > 0) {
                str = str + (key == true ? "辰酉生合金。" : "");
            }
            else {
                str = str + (key == true ? "辰酉生合金未成。" : "");
            }
        }

        if( zhi.equals("巳") && ( bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || 
                                            bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) ) {
            if( feGanShui > 0) {
                str = str + (key == true ? "巳申克合水。" : "");
            }
            else {
                str = str + (key == true ? "巳申克合水未成。" : "");
            }
        }
        if( zhi.equals("申") && ( bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || 
                                            bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) ) {
            if( feGanShui > 0) {
                str = str + (key == true ? "巳申克合水。" : "");
            }
            else {
                str = str + (key == true ? "巳申克合水未成。" : "");
            }
        }

        
        if( zhi.equals("午") && ( bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || 
                                            bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) ) {
            if( feGanTu > feGanHuo && feGanTu > 0) {
                str = str + (key == true ? "午未生合土。" : "");
            }
            else if( feGanTu < feGanHuo && feGanHuo > 0) {
                str = str + (key == true ? "午未生合火。" : "");
                str = str + "午未生合火，增加火的力量。";
            }
            else {
                str = str + (key == true ? "午未生合火土未成。" : "");
            }
        }
        if( zhi.equals("未") && ( bazi.hourZhi.equals("午") || bazi.dayZhi.equals("午") || 
                                            bazi.monthZhi.equals("午") || bazi.yearZhi.equals("午") ) ) {
            if( feGanTu > feGanHuo && feGanTu > 0) {
                str = str + (key == true ? "午未生合土。" : "");
            }
            else if( feGanTu < feGanHuo && feGanHuo > 0) {
                str = str + (key == true ? "午未生合火。" : "");
                str = str + "午未生合火，增加火的力量。";
            }
            else {
                str = str + (key == true ? "午未生合火土未成。" : "");
            }
        }
        
        //#endregion

        //#region 地支三会局
        if( zhi.equals("寅")) {
            if( bazi.hourZhi.equals("卯") || bazi.dayZhi.equals("卯") || bazi.monthZhi.equals("卯") || bazi.yearZhi.equals("卯") ) {
                if( bazi.hourZhi.equals("辰") || bazi.dayZhi.equals("辰") || bazi.monthZhi.equals("辰") || bazi.yearZhi.equals("辰") ) {
                    if( feGanMu > 0) {
                        str = str + (key == true ? "寅卯辰三会木。" : "");
                    }
                    else {
                        str = str + (key == true ? "寅卯辰三会木未成。" : "");
                    }
                }
            }
        }
        else if( zhi.equals("卯")) {
            if( bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) {
                if( bazi.hourZhi.equals("辰") || bazi.dayZhi.equals("辰") || bazi.monthZhi.equals("辰") || bazi.yearZhi.equals("辰") ) {
                    if( feGanMu > 0) {
                        str = str + (key == true ? "寅卯辰三会木。" : "");
                    }
                    else {
                        str = str + (key == true ? "寅卯辰三会木未成。" : "");
                    }
                }
            }
        }
        else if( zhi.equals("辰")) {
            if( bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) {
                if( bazi.hourZhi.equals("卯") || bazi.dayZhi.equals("卯") || bazi.monthZhi.equals("卯") || bazi.yearZhi.equals("卯") ) {
                    if( feGanMu > 0) {
                        str = str + (key == true ? "寅卯辰三会木。" : "");
                    }
                    else {
                        str = str + (key == true ? "寅卯辰三会木未成。" : "");
                    }
                }
            }
        }

        if( zhi.equals("巳")) {
            if( bazi.hourZhi.equals("午") || bazi.dayZhi.equals("午") || bazi.monthZhi.equals("午") || bazi.yearZhi.equals("午") ) {
                if( bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        str = str + (key == true ? "巳午未三会火。" : "");
                    }
                    else {
                        str = str + (key == true ? "巳午未三会火未成。" : "");
                    }
                }
            }
        }
        else if( zhi.equals("午")) {
            if( bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) {
                if( bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        str = str + (key == true ? "巳午未三会火。" : "");
                    }
                    else {
                        str = str + (key == true ? "巳午未三会火未成。" : "");
                    }
                }
            }
        }
        else if( zhi.equals("未")) {
            if( bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) {
                if( bazi.hourZhi.equals("午") || bazi.dayZhi.equals("午") || bazi.monthZhi.equals("午") || bazi.yearZhi.equals("午") ) {
                    if( feGanHuo > 0) {
                        str = str + (key == true ? "巳午未三会火。" : "");
                    }
                    else {
                        str = str + (key == true ? "巳午未三会火未成。" : "");
                    }
                }
            }
        }

        if( zhi.equals("申")) {
            if( bazi.hourZhi.equals("酉") || bazi.dayZhi.equals("酉") || bazi.monthZhi.equals("酉") || bazi.yearZhi.equals("酉") ) {
                if( bazi.hourZhi.equals("戌") || bazi.dayZhi.equals("戌") || bazi.monthZhi.equals("戌") || bazi.yearZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        str = str + (key == true ? "申酉戌三会金。" : "");
                    }
                    else {
                        str = str + (key == true ? "申酉戌三会金未成。" : "");
                    }
                }
            }
        }
        else if( zhi.equals("酉")) {
            if( bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) {
                if( bazi.hourZhi.equals("戌") || bazi.dayZhi.equals("戌") || bazi.monthZhi.equals("戌") || bazi.yearZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        str = str + (key == true ? "申酉戌三会金。" : "");
                    }
                    else {
                        str = str + (key == true ? "申酉戌三会金未成。" : "");
                    }
                }
            }
        }
        else if( zhi.equals("戌")) {
            if( bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) {
                if( bazi.hourZhi.equals("酉") || bazi.dayZhi.equals("酉") || bazi.monthZhi.equals("酉") || bazi.yearZhi.equals("酉") ) {
                    if( feGanJin > 0) {
                        str = str + (key == true ? "申酉戌三会金。" : "");
                    }
                    else {
                        str = str + (key == true ? "申酉戌三会金未成。" : "");
                    }
                }
            }
        }

        if( zhi.equals("亥")) {
            if( bazi.hourZhi.equals("子") || bazi.dayZhi.equals("子") || bazi.monthZhi.equals("子") || bazi.yearZhi.equals("子") ) {
                if( bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        str = str + (key == true ? "亥子丑三会水。" : "");
                    }
                    else {
                        str = str + (key == true ? "亥子丑三会水未成。" : "");
                    }
                }
            }
        }
        else if( zhi.equals("子")) {
            if( bazi.hourZhi.equals("亥") || bazi.dayZhi.equals("亥") || bazi.monthZhi.equals("亥") || bazi.yearZhi.equals("亥") ) {
                if( bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        str = str + (key == true ? "亥子丑三会水。" : "");
                    }
                    else {
                        str = str + (key == true ? "亥子丑三会水未成。" : "");
                    }
                }
            }
        }
        else if( zhi.equals("丑")) {
            if( bazi.hourZhi.equals("亥") || bazi.dayZhi.equals("亥") || bazi.monthZhi.equals("亥") || bazi.yearZhi.equals("亥") ) {
                if( bazi.hourZhi.equals("子") || bazi.dayZhi.equals("子") || bazi.monthZhi.equals("子") || bazi.yearZhi.equals("子") ) {
                    if( feGanShui > 0) {
                        str = str + (key == true ? "亥子丑三会水。" : "");
                    }
                    else {
                        str = str + (key == true ? "亥子丑三会水未成。" : "");
                    }
                }
            }
        }

        //#endregion

        //#region 地支三合局
        if( zhi.equals("亥")) {
            if( bazi.hourZhi.equals("卯") || bazi.dayZhi.equals("卯") || bazi.monthZhi.equals("卯") || bazi.yearZhi.equals("卯") ) {
                if( bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        str = str + (key == true ? "亥卯未三合木。" : "");
                    }
                    else {
                        str = str + (key == true ? "亥卯未三合木未成。" : "");
                    }
                }
            }
        }
        else if( zhi.equals("卯")) {
            if( bazi.hourZhi.equals("亥") || bazi.dayZhi.equals("亥") || bazi.monthZhi.equals("亥") || bazi.yearZhi.equals("亥") ) {
                if( bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        str = str + (key == true ? "亥卯未三合木。" : "");
                    }
                    else {
                        str = str + (key == true ? "亥卯未三合木未成。" : "");
                    }
                }
            }
        }
        else if( zhi.equals("未")) {
            if( bazi.hourZhi.equals("亥") || bazi.dayZhi.equals("亥") || bazi.monthZhi.equals("亥") || bazi.yearZhi.equals("亥") ) {
                if( bazi.hourZhi.equals("卯") || bazi.dayZhi.equals("卯") || bazi.monthZhi.equals("卯") || bazi.yearZhi.equals("卯") ) {
                    if( feGanMu > 0) {
                        str = str + (key == true ? "亥卯未三合木。" : "");
                    }
                    else {
                        str = str + (key == true ? "亥卯未三合木未成。" : "");
                    }
                }
            }
        }

        if( zhi.equals("寅")) {
            if( bazi.hourZhi.equals("午") || bazi.dayZhi.equals("午") || bazi.monthZhi.equals("午") || bazi.yearZhi.equals("午") ) {
                if( bazi.hourZhi.equals("戌") || bazi.dayZhi.equals("戌") || bazi.monthZhi.equals("戌") || bazi.yearZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        str = str + (key == true ? "寅午戌三合火。" : "");
                    }
                    else {
                        str = str + (key == true ? "寅午戌三合火未成。" : "");
                    }
                }
            }
        }
        else if( zhi.equals("午")) {
            if( bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) {
                if( bazi.hourZhi.equals("戌") || bazi.dayZhi.equals("戌") || bazi.monthZhi.equals("戌") || bazi.yearZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        str = str + (key == true ? "寅午戌三合火。" : "");
                    }
                    else {
                        str = str + (key == true ? "寅午戌三合火未成。" : "");
                    }
                }
            }
        }
        else if( zhi.equals("戌")) {
            if( bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) {
                if( bazi.hourZhi.equals("午") || bazi.dayZhi.equals("午") || bazi.monthZhi.equals("午") || bazi.yearZhi.equals("午") ) {
                    if( feGanHuo > 0) {
                        str = str + (key == true ? "寅午戌三合火。" : "");
                    }
                    else {
                        str = str + (key == true ? "寅午戌三合火未成。" : "");
                    }
                }
            }
        }

        if( zhi.equals("申")) {
            if( bazi.hourZhi.equals("子") || bazi.dayZhi.equals("子") || bazi.monthZhi.equals("子") || bazi.yearZhi.equals("子") ) {
                if( bazi.hourZhi.equals("辰") || bazi.dayZhi.equals("辰") || bazi.monthZhi.equals("辰") || bazi.yearZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        str = str + (key == true ? "申子辰三合水。" : "");
                    }
                    else {
                        str = str + (key == true ? "申子辰三合水未成。" : "");
                    }
                }
            }
        }
        else if( zhi.equals("子")) {
            if( bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) {
                if( bazi.hourZhi.equals("辰") || bazi.dayZhi.equals("辰") || bazi.monthZhi.equals("辰") || bazi.yearZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        str = str + (key == true ? "申子辰三合水。" : "");
                    }
                    else {
                        str = str + (key == true ? "申子辰三合水未成。" : "");
                    }
                }
            }
        }
        else if( zhi.equals("辰")) {
            if( bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) {
                if( bazi.hourZhi.equals("子") || bazi.dayZhi.equals("子") || bazi.monthZhi.equals("子") || bazi.yearZhi.equals("子") ) {
                    if( feGanShui > 0) {
                        str = str + (key == true ? "申子辰三合水。" : "");
                    }
                    else {
                        str = str + (key == true ? "申子辰三合水未成。" : "");
                    }
                }
            }
        }

        if( zhi.equals("巳")) {
            if( bazi.hourZhi.equals("酉") || bazi.dayZhi.equals("酉") || bazi.monthZhi.equals("酉") || bazi.yearZhi.equals("酉") ) {
                if( bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        str = str + (key == true ? "巳酉丑三合金。" : "");
                    }
                    else {
                        str = str + (key == true ? "巳酉丑三合金未成。" : "");
                    }
                }
            }
        }
        else if( zhi.equals("酉")) {
            if( bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) {
                if( bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        str = str + (key == true ? "巳酉丑三合金。" : "");
                    }
                    else {
                        str = str + (key == true ? "巳酉丑三合金未成。" : "");
                    }
                }
            }
        }
        else if( zhi.equals("丑")) {
            if( bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) {
                if( bazi.hourZhi.equals("酉") || bazi.dayZhi.equals("酉") || bazi.monthZhi.equals("酉") || bazi.yearZhi.equals("酉") ) {
                    if( feGanJin > 0) {
                        str = str + (key == true ? "巳酉丑三合金。" : "");
                    }
                    else {
                        str = str + (key == true ? "巳酉丑三合金未成。" : "");
                    }
                }
            }
        }

        //#endregion

        //#region 地支六冲
        if( zhi.equals("子") && ( bazi.hourZhi.equals("午") || bazi.dayZhi.equals("午") || 
                bazi.monthZhi.equals("午") || bazi.yearZhi.equals("午") ) ) {
            str = str + (key == true ? "子午相冲，" : "") + "易不安。";
        }
        if( zhi.equals("午") && ( bazi.hourZhi.equals("子") || bazi.dayZhi.equals("子") || 
                bazi.monthZhi.equals("子") || bazi.yearZhi.equals("子") ) ) {
            str = str + (key == true ? "子午相冲，" : "") + "易不安。";
        }

        if( zhi.equals("丑") && ( bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || 
                bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) ) {
            str = str + (key == true ? "丑未相冲，" : "") + "事多阻。";
        }
        if( zhi.equals("未") && ( bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || 
                bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) ) {
            str = str + (key == true ? "丑未相冲，" : "") + "事多阻。";
        }

        if( zhi.equals("寅") && ( bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || 
                bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) ) {
            str = str + (key == true ? "寅申相冲，" : "") + "多情或者管闲事。";
        }
        if( zhi.equals("申") && ( bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || 
                bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) ) {
            str = str + (key == true ? "寅申相冲，" : "") + "多情或者管闲事。";
        }

        if( zhi.equals("卯") && ( bazi.hourZhi.equals("酉") || bazi.dayZhi.equals("酉") || 
                bazi.monthZhi.equals("酉") || bazi.yearZhi.equals("酉") ) ) {
            str = str + (key == true ? "卯酉相冲，" : "") + "多劳碌，易情色纠纷。";
        }
        if( zhi.equals("酉") && ( bazi.hourZhi.equals("卯") || bazi.dayZhi.equals("卯") || 
                bazi.monthZhi.equals("卯") || bazi.yearZhi.equals("卯") ) ) {
            str = str + (key == true ? "卯酉相冲，" : "") + "多劳碌，易情色纠纷。";
        }

        if( zhi.equals("辰") && ( bazi.hourZhi.equals("戌") || bazi.dayZhi.equals("戌") || 
                bazi.monthZhi.equals("戌") || bazi.yearZhi.equals("戌") ) ) {
            str = str + (key == true ? "辰戌相冲，" : "") + "克亲人，帮他人。";
        }
        if( zhi.equals("戌") && ( bazi.hourZhi.equals("辰") || bazi.dayZhi.equals("辰") || 
                bazi.monthZhi.equals("辰") || bazi.yearZhi.equals("辰") ) ) {
            str = str + (key == true ? "辰戌相冲，" : "") + "克亲人，帮他人。";
        }

        if( zhi.equals("巳") && ( bazi.hourZhi.equals("亥") || bazi.dayZhi.equals("亥") || 
                bazi.monthZhi.equals("亥") || bazi.yearZhi.equals("亥") ) ) {
            str = str + (key == true ? "巳亥相冲，" : "") + "易帮他人。";
        }
        if( zhi.equals("亥") && ( bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || 
                bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) ) {
            str = str + (key == true ? "巳亥相冲，" : "") + "易帮他人。";
        }

        //#endregion

        //#region 地址六害 
        if( zhi.equals("子") && ( bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || 
                bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) ) {
            str = str + (key == true ? "子未相害，" : "") + "无助于子孙。";
        }
        if( zhi.equals("未") && ( bazi.hourZhi.equals("子") || bazi.dayZhi.equals("子") || 
                bazi.monthZhi.equals("子") || bazi.yearZhi.equals("子") ) ) {
            str = str + (key == true ? "子未相害，" : "") + "无助于子孙。";
        }

        if( zhi.equals("丑") && ( bazi.hourZhi.equals("午") || bazi.dayZhi.equals("午") || 
                bazi.monthZhi.equals("午") || bazi.yearZhi.equals("午") ) ) {
            str = str + (key == true ? "丑午相害，" : "") + "易怒，无耐心，大运逢弱易有伤残。";
        }
        if( zhi.equals("午") && ( bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || 
                bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) ) {
            str = str + (key == true ? "丑午相害，" : "") + "易怒，无耐心，大运逢弱易有伤残。";
        }

        if( zhi.equals("寅") && ( bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || 
                bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) ) {
            str = str + (key == true ? "寅巳相害，" : "") + "多疾病。";
        }
        if( zhi.equals("巳") && ( bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || 
                bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) ) {
            str = str + (key == true ? "寅巳相害，" : "") + "多疾病。";
        }

        if( zhi.equals("卯") && ( bazi.hourZhi.equals("辰") || bazi.dayZhi.equals("辰") || 
                bazi.monthZhi.equals("辰") || bazi.yearZhi.equals("辰") ) ) {
            str = str + (key == true ? "卯辰相害，" : "") + "易怒，无耐心，大运逢弱易有伤残。";
        }
        if( zhi.equals("辰") && ( bazi.hourZhi.equals("卯") || bazi.dayZhi.equals("卯") || 
                bazi.monthZhi.equals("卯") || bazi.yearZhi.equals("卯") ) ) {
            str = str + (key == true ? "卯辰相害，" : "") + "易怒，无耐心，大运逢弱易有伤残。";
        }

        if( zhi.equals("申") && ( bazi.hourZhi.equals("亥") || bazi.dayZhi.equals("亥") || 
                bazi.monthZhi.equals("亥") || bazi.yearZhi.equals("亥") ) ) {
                str = str + (key == true ? "申亥相害，" : "");
            }
        if( zhi.equals("亥") && ( bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || 
                bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) ) {
            str = str + (key == true ? "申亥相害，" : "");
        }

        if( zhi.equals("酉") && ( bazi.yearZhi.equals("戌") || bazi.hourZhi.equals("戌") || 
                bazi.dayZhi.equals("戌") || bazi.monthZhi.equals("戌") ) ) {
            str = str + (key == true ? "酉戌相害，" : "");
        }
        if( zhi.equals("戌") && ( bazi.yearZhi.equals("酉") || bazi.hourZhi.equals("酉") || 
                bazi.dayZhi.equals("酉") || bazi.monthZhi.equals("酉") ) ) {
            str = str + (key == true ? "酉戌相害，" : "");
        }
        
        //#endregion

        //#region 地支相刑 
        if( zhi.equals("寅")) {
            if( bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) {
                if( bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) {
                    str = str + (key == true ? "寅巳申三刑，" : "") + "易官司或是非，女不易怀孕或易流产。";
                }
            }
        }
        else if( zhi.equals("巳")) {
            if( bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) {
                if( bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) {
                    str = str + (key == true ? "寅巳申三刑，" : "") + "易官司或是非，女不易怀孕或易流产。";
                }
            }
        }
        else if( zhi.equals("申")) {
            if( bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) {
                if( bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) {
                    str = str + (key == true ? "寅巳申三刑，" : "") + "易官司或是非，女不易怀孕或易流产。";
                }
            }
        }

        if(zhi.equals("未")) {
            if( bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) {
                if( bazi.hourZhi.equals("戌") || bazi.dayZhi.equals("戌") || bazi.monthZhi.equals("戌") || bazi.yearZhi.equals("戌") ) {
                    str = str + (key == true ? "未丑戌三刑，" : "") + "易挫折，女易孤单。";
                }
            }
        }
        else if( zhi.equals("丑")) {
            if( bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) {
                if( bazi.hourZhi.equals("戌") || bazi.dayZhi.equals("戌") || bazi.monthZhi.equals("戌") || bazi.yearZhi.equals("戌") ) {
                    str = str + (key == true ? "未丑戌三刑，" : "") + "易挫折，女易孤单。";
                }
            }
        }
        else if( zhi.equals("戌")) {
            if( bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) {
                if( bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) {
                    str = str + (key == true ? "未丑戌三刑，" : "") + "易挫折，女易孤单。";
                }
            }
        }

        if( zhi.equals("卯") && (bazi.hourZhi.equals("子") || bazi.dayZhi.equals("子") || 
                bazi.monthZhi.equals("子") || bazi.yearZhi.equals("子") ) ) {
            str = str + (key == true ? "子卯二刑，" : "") + "与上级(辈)或者下级(辈)不和。";
        }
        else if( zhi.equals("子") && (bazi.hourZhi.equals("卯") || bazi.dayZhi.equals("卯") || 
                bazi.monthZhi.equals("卯") || bazi.yearZhi.equals("卯") ) ) {
            str = str + (key == true ? "子卯二刑，" : "") + "与上级(辈)或者下级(辈)不和。";
        }

        if( zhi.equals("辰") && (bazi.hourZhi.equals("辰") || bazi.dayZhi.equals("辰") || 
                bazi.monthZhi.equals("辰") || bazi.yearZhi.equals("辰") ) ) {
            str = str + (key == true ? "辰辰自刑，" : "") + "有始无终，常陷困境。";
        }

        if( zhi.equals("午") && (bazi.hourZhi.equals("午") || bazi.dayZhi.equals("午") || 
                bazi.monthZhi.equals("午") || bazi.yearZhi.equals("午") ) ) {
            str = str + (key == true ? "午午自刑，" : "") + "有始无终，常陷困境。";
        }

        if( zhi.equals("酉") && ( bazi.hourZhi.equals("酉")  || bazi.dayZhi.equals("酉") || 
                bazi.monthZhi.equals("酉") || bazi.yearZhi.equals("酉") ) ) {
            str = str + (key == true ? "酉酉自刑，" : "") + "有始无终，常陷困境。";
        }
        if( zhi.equals("亥") && ( bazi.hourZhi.equals("亥") || bazi.dayZhi.equals("亥") || 
                bazi.monthZhi.equals("亥") || bazi.yearZhi.equals("亥") ) ) {
            str = str + (key == true ? "亥亥自刑，" : "") + "有始无终，常陷困境。";
        }

        //#endregion

        return str;        
    }

    public String fnSelfGanHeChongLiu(String yunGan, String gan, boolean key) { 
        /// 加上大运，流年的天干合冲
        String str = "";

        //#region 天干五合
        if( gan.equals("甲") && ( yunGan.equals("己") || bazi.hourGan.equals("己") || bazi.dayGan.equals("己") || 
                bazi.monthGan.equals("己") || bazi.yearGan.equals("己") ) ) {
            if( feTu > 0 ) {
                str = str + (key == true ? "甲己合化土，" : "")  +  "易安分守信。";
            }
            else {    
                str = str + (key == true ? "甲己合土未成，" : "");
            }
        }
        if( gan.equals("己") && ( yunGan.equals("甲") || bazi.hourGan.equals("甲") || bazi.dayGan.equals("甲") || 
                bazi.monthGan.equals("甲") || bazi.yearGan.equals("甲") ) ) {
            if( feTu > 0 ) {
                str = str + (key == true ? "甲己合化土，" : "")  +  "易安分守信。";
            }
            else {    
                str = str + (key == true ? "甲己合土未成，" : "");
            }
        }

        if( gan.equals("乙") && ( yunGan.equals("庚") || bazi.hourGan.equals("庚") || bazi.dayGan.equals("庚") || 
                bazi.monthGan.equals("庚") || bazi.yearGan.equals("庚") ) ) {
            if( feJin > 0 ) {
                str = str + (key == true ? "乙庚合化金，" : "")  +  "易有仁有义。";
            }
            else {                    
                str = str + (key == true ? "乙庚合金未成。" : "");
            }
        }
        if( gan.equals("庚") && ( yunGan.equals("乙") || bazi.hourGan.equals("乙") || bazi.dayGan.equals("乙") || 
                bazi.monthGan.equals("乙") || bazi.yearGan.equals("乙") ) ) {
            if( feJin > 0 ) {
                str = str + (key == true ? "乙庚合化金，" : "")  +  "易有仁有义。";
            }
            else {                    
                str = str + (key == true ? "乙庚合金未成。" : "");
            }
        } 

        if( gan.equals("丙") && ( yunGan.equals("辛") || bazi.hourGan.equals("辛") || bazi.dayGan.equals("辛") || 
                bazi.monthGan.equals("辛") || bazi.yearGan.equals("辛") ) ) {
            if( feShui > 0 ) {
                str = str + (key == true ? "丙辛合化水，" : "")  +  "易聪明贵气。";
            }
            else {                    
                str = str + (key == true ? "丙辛合水未成。" : "");
            }
        }
        if( gan.equals("辛") && ( yunGan.equals("丙") || bazi.hourGan.equals("丙") || bazi.dayGan.equals("丙") || 
                bazi.monthGan.equals("丙") || bazi.yearGan.equals("丙") ) ) {
            if( feShui > 0 ) {
                str = str + (key == true ? "丙辛合化水，" : "")  +  "易聪明贵气。";
            }
            else {                    
                str = str + (key == true ? "丙辛合水未成。" : "");
            }
        }

        if( gan.equals("丁") && ( yunGan.equals("壬") || bazi.hourGan.equals("壬") || bazi.dayGan.equals("壬") || 
                bazi.monthGan.equals("壬") || bazi.yearGan.equals("壬") ) ) {
            if( feMu > 0 ) {
                str = str + (key == true ? "丁壬合化木，" : "")  +  "虽然积极努力，但后果不确定。";
            }
            else {                    
                str = str + (key == true ? "丁壬合木未成，" : "");
            }
        }
        if( gan.equals("壬") && ( yunGan.equals("丁") || bazi.hourGan.equals("丁") || bazi.dayGan.equals("丁") || 
                bazi.monthGan.equals("丁") || bazi.yearGan.equals("丁") ) ) {
            if( feMu > 0 ) {
                str = str + (key == true ? "丁壬合化木，" : "")  +  "虽然积极努力，但后果不确定。";
            }
            else {                    
                str = str + (key == true ? "丁壬合木未成，" : "");
            }
        }

        if( gan.equals("戊") && ( yunGan.equals("癸") || bazi.hourGan.equals("癸") || bazi.dayGan.equals("癸") || 
                bazi.monthGan.equals("癸") || bazi.yearGan.equals("癸") ) ) {
            if( feHuo > 0 ) {
                str = str + (key == true ? "戊癸合化火，" : "")  +  "易俊秀薄情。";
            }
            else {                    
                str = str + (key == true ? "戊癸合火未成，" : "");
            }
        }
        if( gan.equals("癸") && ( yunGan.equals("戊") || bazi.hourGan.equals("戊") || bazi.dayGan.equals("戊") || 
                bazi.monthGan.equals("戊") || bazi.yearGan.equals("戊") ) ) {
            if( feHuo > 0 ) {
                str = str + (key == true ? "戊癸合化火，" : "")  +  "易俊秀薄情。";
            }
            else {                    
                str = str + (key == true ? "戊癸合火未成，" : "");
            }
        }
        //#endregion

        //#region 天干四冲
        if( gan.equals("庚") && ( yunGan.equals("甲") || bazi.hourGan.equals("甲") || bazi.dayGan.equals("甲") || 
                bazi.monthGan.equals("甲") || bazi.yearGan.equals("甲") ) ) {
            str = str + (key == true ? "甲庚相冲。" : "");
        }
        if( gan.equals("甲") && ( yunGan.equals("庚") || bazi.hourGan.equals("庚") || bazi.dayGan.equals("庚") || 
                bazi.monthGan.equals("庚") || bazi.yearGan.equals("庚") ) ) {
            str = str + (key == true ? "甲庚相冲。" : "");
        }

        if( gan.equals("乙") && ( yunGan.equals("辛") || bazi.hourGan.equals("辛") || bazi.dayGan.equals("辛") || 
                bazi.monthGan.equals("辛") || bazi.yearGan.equals("辛") ) ) {
            str = str + (key == true ? "乙辛相冲。" : "");
        }
        if( gan.equals("辛") && ( yunGan.equals("乙") || bazi.hourGan.equals("乙") || bazi.dayGan.equals("乙") || 
                bazi.monthGan.equals("乙") || bazi.yearGan.equals("乙") ) ) {
            str = str + (key == true ? "乙辛相冲。" : "");
        }

        if( gan.equals("丙") && ( yunGan.equals("壬") || bazi.hourGan.equals("壬") || bazi.dayGan.equals("壬") || 
                bazi.monthGan.equals("壬") || bazi.yearGan.equals("壬") ) ) {
            str = str + (key == true ? "丙壬相冲。" : "");
        }
        if( gan.equals("壬") && ( yunGan.equals("丙") || bazi.hourGan.equals("丙") || bazi.dayGan.equals("丙") || 
                bazi.monthGan.equals("丙") || bazi.yearGan.equals("丙") ) ) {
            str = str + (key == true ? "丙壬相冲。" : "");
        } 

        if( gan.equals("丁") && ( yunGan.equals("癸") || bazi.hourGan.equals("癸") || bazi.dayGan.equals("癸") || 
                bazi.monthGan.equals("癸") || bazi.yearGan.equals("癸") ) ) {
            str = str + (key == true ? "丁癸相冲。" : "");
        }
        if( gan.equals("癸") && ( yunGan.equals("丁") || bazi.hourGan.equals("丁") || bazi.dayGan.equals("丁") || 
                bazi.monthGan.equals("丁") || bazi.yearGan.equals("丁") ) ) {
            str = str + (key == true ? "丁癸相冲。" : "");
        }
        //#endregion

        return str;        
    }
    public String fnSelfZhiHeChongLiu(String yunZhi, String zhi, boolean key) {
        /// 加上大运的地支合冲
        String str = "";

        //#region 地支六合
        if( zhi.equals("子") && ( yunZhi.equals("丑") || bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || 
                bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) ) {
            if( feGanTu > 0) {
                str = str + (key == true ? "子丑克合土。" : "");
            }
            else {
                str = str + (key == true ? "子丑克合土未成。" : "");
            }
        }
        if( zhi.equals("丑") && ( yunZhi.equals("子") || bazi.hourZhi.equals("子") || bazi.dayZhi.equals("子") || 
                bazi.monthZhi.equals("子") || bazi.yearZhi.equals("子") ) ) {
            if( feGanTu > 0) {
                str = str + (key == true ? "子丑克合土。" : "");
            }
            else {
                str = str + (key == true ? "子丑克合土未成。" : "");
            }
        }

        if( zhi.equals("寅") && ( yunZhi.equals("亥") || bazi.hourZhi.equals("亥") || bazi.dayZhi.equals("亥") || 
                bazi.monthZhi.equals("亥") || bazi.yearZhi.equals("亥") ) ) {
            if( feGanMu > 0) {
                str = str + (key == true ? "寅亥生合木。" : "");
            }
            else {
                str = str + (key == true ? "寅亥生合木未成。" : "");
            }
        }
        if( zhi.equals("亥") && ( yunZhi.equals("寅") || bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || 
                bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) ) {
            if( feGanMu > 0) {
                str = str + (key == true ? "寅亥生合木。" : "");
            }
            else {
                str = str + (key == true ? "寅亥生合木未成。" : "");
            }
        }

        if( zhi.equals("卯") && ( yunZhi.equals("戌") || bazi.hourZhi.equals("戌") || bazi.dayZhi.equals("戌") || 
                bazi.monthZhi.equals("戌") || bazi.yearZhi.equals("戌") ) ) {
            if( feGanHuo > 0) {
                str = str + (key == true ? "卯戌克合火。" : "");
            }
            else {
                str = str + (key == true ? "卯戌克合火未成。" : "");
            }
        }
        if( zhi.equals("戌") && ( yunZhi.equals("卯") || bazi.hourZhi.equals("卯") || bazi.dayZhi.equals("卯") || 
                bazi.monthZhi.equals("卯") || bazi.yearZhi.equals("卯") ) ) {
            if( feGanHuo > 0) {
                str = str + (key == true ? "卯戌克合火。" : "");
            }
            else {
                str = str + (key == true ? "卯戌克合火未成。" : "");
            }
        }

        if( zhi.equals("辰") && ( yunZhi.equals("酉") || bazi.hourZhi.equals("酉") || bazi.dayZhi.equals("酉") || 
                bazi.monthZhi.equals("酉") || bazi.yearZhi.equals("酉") ) ) {
            if( feGanJin > 0) {
                str = str + (key == true ? "辰酉生合金。" : "");
            }
            else {
                str = str + (key == true ? "辰酉生合金未成。" : "");
            }
        }
        if( zhi.equals("酉") && ( yunZhi.equals("辰") || bazi.hourZhi.equals("辰") || bazi.dayZhi.equals("辰") || 
                bazi.monthZhi.equals("辰") || bazi.yearZhi.equals("辰") ) ) {
            if( feGanJin > 0) {
                str = str + (key == true ? "辰酉生合金。" : "");
            }
            else {
                str = str + (key == true ? "辰酉生合金未成。" : "");
            }
        }

        if( zhi.equals("巳") && ( yunZhi.equals("申") || bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || 
                bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) ) {
            if( feGanShui > 0) {
                str = str + (key == true ? "巳申克合水。" : "");
            }
            else {
                str = str + (key == true ? "巳申克合水未成。" : "");
            }
        }
        if( zhi.equals("申") && ( yunZhi.equals("巳") || bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || 
                bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) ) {
            if( feGanShui > 0) {
                str = str + (key == true ? "巳申克合水。" : "");
            }
            else {
                str = str + (key == true ? "巳申克合水未成。" : "");
            }
        }

        
        if( zhi.equals("午") && ( yunZhi.equals("未") || bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || 
                bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) ) {
            if( feGanTu > feGanHuo && feGanTu > 0) {
                str = str + (key == true ? "午未生合土。" : "");
            }
            else if( feGanTu < feGanHuo && feGanHuo > 0) {
                str = str + (key == true ? "午未生合火。" : "");
                str = str + "午未生合火，增加火的力量。";
            }
            else {
                str = str + (key == true ? "午未生合火土未成。" : "");
            }
        }
        if( zhi.equals("未") && ( yunZhi.equals("午") || bazi.hourZhi.equals("午") || bazi.dayZhi.equals("午") || 
                bazi.monthZhi.equals("午") || bazi.yearZhi.equals("午") ) ) {
            if( feGanTu > feGanHuo && feGanTu > 0) {
                str = str + (key == true ? "午未生合土。" : "");
            }
            else if( feGanTu < feGanHuo && feGanHuo > 0) {
                str = str + (key == true ? "午未生合火。" : "");
                str = str + "午未生合火，增加火的力量。";
            }
            else {
                str = str + (key == true ? "午未生合火土未成。" : "");
            }
        }
        
        //#endregion

        //#region 地支三会局
        if( zhi.equals("寅")) {
            if( yunZhi.equals("卯") && (bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || 
                    bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) ) {
                if( feGanMu > 0) {
                    str = str + (key == true ? "寅卯辰三会木。" : "");
                }
                else {
                    str = str + (key == true ? "寅卯辰三会木未成。" : "");
                }
            }
            if( (yunZhi.equals("未") && bazi.hourZhi.equals("卯") || bazi.dayZhi.equals("卯") || 
                    bazi.monthZhi.equals("卯") || bazi.yearZhi.equals("卯") ) ) {
                if( feGanMu > 0) {
                    str = str + (key == true ? "寅卯辰三会木。" : "");
                }
                else {
                    str = str + (key == true ? "寅卯辰三会木未成。" : "");
                }
            }
        }
        else if( zhi.equals("卯")) {
            if( yunZhi.equals("寅") && ( bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || 
                    bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) ) {
                if( feGanMu > 0) {
                    str = str + (key == true ? "寅卯辰三会木。" : "");
                }
                else {
                    str = str + (key == true ? "寅卯辰三会木未成。" : "");
                }
            }
            if( yunZhi.equals("未") && ( bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || 
                    bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) ) {
                if( feGanMu > 0) {
                    str = str + (key == true ? "寅卯辰三会木。" : "");
                }
                else {
                    str = str + (key == true ? "寅卯辰三会木未成。" : "");
                }
            }
        }
        else if( zhi.equals("未")) {
            if( yunZhi.equals("寅") && ( bazi.hourZhi.equals("卯") || bazi.dayZhi.equals("卯") || 
                    bazi.monthZhi.equals("卯") || bazi.yearZhi.equals("卯") ) ) {
                if( feGanMu > 0) {
                    str = str + (key == true ? "寅卯辰三会木。" : "");
                }
                else {
                    str = str + (key == true ? "寅卯辰三会木未成。" : "");
                }                
            }
            if( yunZhi.equals("卯") && ( bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || 
                    bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) ) {
                if( feGanMu > 0) {
                    str = str + (key == true ? "寅卯辰三会木。" : "");
                }
                else {
                    str = str + (key == true ? "寅卯辰三会木未成。" : "");
                }                
            }
        }

        if( zhi.equals("巳")) {
            if( yunZhi.equals("午") && ( bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || 
                    bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) ) {
                if( feGanHuo > 0) {
                    str = str + (key == true ? "巳午未三会火。" : "");
                }
                else {
                    str = str + (key == true ? "巳午未三会火未成。" : "");
                }
            }
            if( yunZhi.equals("未") && ( bazi.hourZhi.equals("午") || bazi.dayZhi.equals("午") || 
                    bazi.monthZhi.equals("午") || bazi.yearZhi.equals("午") ) ) {
                if( feGanHuo > 0) {
                    str = str + (key == true ? "巳午未三会火。" : "");
                }
                else {
                    str = str + (key == true ? "巳午未三会火未成。" : "");
                }
            }
        }
        else if( zhi.equals("午")) {
            if( yunZhi.equals("巳") && ( bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || 
                    bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) ) {
                if( feGanHuo > 0) {
                    str = str + (key == true ? "巳午未三会火。" : "");
                }
                else {
                    str = str + (key == true ? "巳午未三会火未成。" : "");
                }
            }
            if( yunZhi.equals("未") && ( bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || 
                    bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) ) {
                if( feGanHuo > 0) {
                    str = str + (key == true ? "巳午未三会火。" : "");
                }
                else {
                    str = str + (key == true ? "巳午未三会火未成。" : "");
                }
            }
        }
        else if( zhi.equals("未")) {
            if( yunZhi.equals("巳") && ( bazi.hourZhi.equals("午") || bazi.dayZhi.equals("午") || 
                    bazi.monthZhi.equals("午") || bazi.yearZhi.equals("午") ) ) {
                if( feGanHuo > 0) {
                    str = str + (key == true ? "巳午未三会火。" : "");
                }
                else {
                    str = str + (key == true ? "巳午未三会火未成。" : "");
                }
            }
            if( yunZhi.equals("午") && ( bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || 
                    bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) ) {
                if( feGanHuo > 0) {
                    str = str + (key == true ? "巳午未三会火。" : "");
                }
                else {
                    str = str + (key == true ? "巳午未三会火未成。" : "");
                }
            }
        }

        if( zhi.equals("申")) {
            if( yunZhi.equals("酉") && ( bazi.hourZhi.equals("戌") || bazi.dayZhi.equals("戌") || 
                    bazi.monthZhi.equals("戌") || bazi.yearZhi.equals("戌") ) ) {
                if( feGanJin > 0) {
                    str = str + (key == true ? "申酉戌三会金。" : "");
                }
                else {
                    str = str + (key == true ? "申酉戌三会金未成。" : "");
                }
            }
            if( yunZhi.equals("戌") && ( bazi.hourZhi.equals("酉") || bazi.dayZhi.equals("酉") || 
                    bazi.monthZhi.equals("酉") || bazi.yearZhi.equals("酉") ) ) {
                if( feGanJin > 0) {
                    str = str + (key == true ? "申酉戌三会金。" : "");
                }
                else {
                    str = str + (key == true ? "申酉戌三会金未成。" : "");
                }
            }
        }
        else if( zhi.equals("酉")) {
            if( yunZhi.equals("申") && ( bazi.hourZhi.equals("戌") || bazi.dayZhi.equals("戌") || 
                    bazi.monthZhi.equals("戌") || bazi.yearZhi.equals("戌") ) ) {
                if( feGanJin > 0) {
                    str = str + (key == true ? "申酉戌三会金。" : "");
                }
                else {
                    str = str + (key == true ? "申酉戌三会金未成。" : "");
                }
            }
            if( yunZhi.equals("戌") && ( bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || 
                    bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) ) {
                if( feGanJin > 0) {
                    str = str + (key == true ? "申酉戌三会金。" : "");
                }
                else {
                    str = str + (key == true ? "申酉戌三会金未成。" : "");
                }
            }
        }
        else if( zhi.equals("戌")) {
            if( yunZhi.equals("申") && ( bazi.hourZhi.equals("酉") || bazi.dayZhi.equals("酉") || 
                    bazi.monthZhi.equals("酉") || bazi.yearZhi.equals("酉") ) ) {
                if( feGanJin > 0) {
                    str = str + (key == true ? "申酉戌三会金。" : "");
                }
                else {
                    str = str + (key == true ? "申酉戌三会金未成。" : "");
                }
            }
            if( yunZhi.equals("酉") && ( bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || 
                    bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) ) {
                if( feGanJin > 0) {
                    str = str + (key == true ? "申酉戌三会金。" : "");
                }
                else {
                    str = str + (key == true ? "申酉戌三会金未成。" : "");
                }
            }
        }

        if( zhi.equals("亥")) {
            if( yunZhi.equals("子") && ( bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || 
                    bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) ) {
                if( feGanShui > 0) {
                    str = str + (key == true ? "亥子丑三会水。" : "");
                }
                else {
                    str = str + (key == true ? "亥子丑三会水未成。" : "");
                }
            }
            if( yunZhi.equals("丑") && ( bazi.hourZhi.equals("子") || bazi.dayZhi.equals("子") || 
                    bazi.monthZhi.equals("子") || bazi.yearZhi.equals("子") ) ) {
                if( feGanShui > 0) {
                    str = str + (key == true ? "亥子丑三会水。" : "");
                }
                else {
                    str = str + (key == true ? "亥子丑三会水未成。" : "");
                }
            }
        }
        else if( zhi.equals("子")) {
            if( yunZhi.equals("亥") && ( bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || 
                    bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) ) {
                if( feGanShui > 0) {
                    str = str + (key == true ? "亥子丑三会水。" : "");
                }
                else {
                    str = str + (key == true ? "亥子丑三会水未成。" : "");
                }
            }
            if( yunZhi.equals("丑") && ( bazi.hourZhi.equals("亥") || bazi.dayZhi.equals("亥") || 
                    bazi.monthZhi.equals("亥") || bazi.yearZhi.equals("亥") ) ) {
                if( feGanShui > 0) {
                    str = str + (key == true ? "亥子丑三会水。" : "");
                }
                else {
                    str = str + (key == true ? "亥子丑三会水未成。" : "");
                }
            }
        }
        else if( zhi.equals("丑")) {
            if( yunZhi.equals("亥") && ( bazi.hourZhi.equals("子") || bazi.dayZhi.equals("子") || 
                    bazi.monthZhi.equals("子") || bazi.yearZhi.equals("子") ) ) {
                if( feGanShui > 0) {
                    str = str + (key == true ? "亥子丑三会水。" : "");
                }
                else {
                    str = str + (key == true ? "亥子丑三会水未成。" : "");
                }
            }
            if( yunZhi.equals("子") && ( bazi.hourZhi.equals("亥") || bazi.dayZhi.equals("亥") || 
                    bazi.monthZhi.equals("亥") || bazi.yearZhi.equals("亥") ) ) {
                if( feGanShui > 0) {
                    str = str + (key == true ? "亥子丑三会水。" : "");
                }
                else {
                    str = str + (key == true ? "亥子丑三会水未成。" : "");
                }
            }
        }

        //#endregion

        //#region 地支三合局
        if( zhi.equals("亥")) {
            if( yunZhi.equals("卯") && ( bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || 
                    bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) ) {
                if( feGanMu > 0) {
                    str = str + (key == true ? "亥卯未三合木。" : "");
                }
                else {
                    str = str + (key == true ? "亥卯未三合木未成。" : "");
                }                
            }
            if( yunZhi.equals("未") && ( bazi.hourZhi.equals("卯") || bazi.dayZhi.equals("卯") || 
                    bazi.monthZhi.equals("卯") || bazi.yearZhi.equals("卯") ) ) {
                if( feGanMu > 0) {
                    str = str + (key == true ? "亥卯未三合木。" : "");
                }
                else {
                    str = str + (key == true ? "亥卯未三合木未成。" : "");
                }                
            }
        }
        else if( zhi.equals("卯")) {
            if( yunZhi.equals("亥") && ( bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || 
                    bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) ) {
                if( feGanMu > 0) {
                    str = str + (key == true ? "亥卯未三合木。" : "");
                }
                else {
                    str = str + (key == true ? "亥卯未三合木未成。" : "");
                }
            }
            if( yunZhi.equals("未") && ( bazi.hourZhi.equals("亥") || bazi.dayZhi.equals("亥") || 
                    bazi.monthZhi.equals("亥") || bazi.yearZhi.equals("亥") ) ) {
                if( feGanMu > 0) {
                    str = str + (key == true ? "亥卯未三合木。" : "");
                }
                else {
                    str = str + (key == true ? "亥卯未三合木未成。" : "");
                }
            }
        }
        else if( zhi.equals("未")) {
            if( yunZhi.equals("亥") && ( bazi.hourZhi.equals("卯") || bazi.dayZhi.equals("卯") || 
                    bazi.monthZhi.equals("卯") || bazi.yearZhi.equals("卯") ) ) {
                if( feGanMu > 0) {
                    str = str + (key == true ? "亥卯未三合木。" : "");
                }
                else {
                    str = str + (key == true ? "亥卯未三合木未成。" : "");
                }
            }
            if( yunZhi.equals("卯") && ( bazi.hourZhi.equals("亥") || bazi.dayZhi.equals("亥") || 
                    bazi.monthZhi.equals("亥") || bazi.yearZhi.equals("亥") ) ) {
                if( feGanMu > 0) {
                    str = str + (key == true ? "亥卯未三合木。" : "");
                }
                else {
                    str = str + (key == true ? "亥卯未三合木未成。" : "");
                }
            }
        }

        if( zhi.equals("寅")) {
            if( yunZhi.equals("午") && ( bazi.hourZhi.equals("戌") || bazi.dayZhi.equals("戌") || 
                    bazi.monthZhi.equals("戌") || bazi.yearZhi.equals("戌") ) ) {
                if( feGanHuo > 0) {
                    str = str + (key == true ? "寅午戌三合火。" : "");
                }
                else {
                    str = str + (key == true ? "寅午戌三合火未成。" : "");
                }
            }
            if( yunZhi.equals("戌") && ( bazi.hourZhi.equals("午") || bazi.dayZhi.equals("午") || 
                    bazi.monthZhi.equals("午") || bazi.yearZhi.equals("午") ) ) {
                if( feGanHuo > 0) {
                    str = str + (key == true ? "寅午戌三合火。" : "");
                }
                else {
                    str = str + (key == true ? "寅午戌三合火未成。" : "");
                }
            }
        }
        else if( zhi.equals("午")) {
            if( yunZhi.equals("寅") && ( bazi.hourZhi.equals("戌") || bazi.dayZhi.equals("戌") || 
                    bazi.monthZhi.equals("戌") || bazi.yearZhi.equals("戌") ) ) {
                if( feGanHuo > 0) {
                    str = str + (key == true ? "寅午戌三合火。" : "");
                }
                else {
                    str = str + (key == true ? "寅午戌三合火未成。" : "");
                }
            }
            if( yunZhi.equals("戌") && ( bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || 
                    bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) ) {
                if( feGanHuo > 0) {
                    str = str + (key == true ? "寅午戌三合火。" : "");
                }
                else {
                    str = str + (key == true ? "寅午戌三合火未成。" : "");
                }
            }
        }
        else if( zhi.equals("戌")) {
            if( yunZhi.equals("寅") && ( bazi.hourZhi.equals("午") || bazi.dayZhi.equals("午") || 
                    bazi.monthZhi.equals("午") || bazi.yearZhi.equals("午") ) ) {
                if( feGanHuo > 0) {
                    str = str + (key == true ? "寅午戌三合火。" : "");
                }
                else {
                    str = str + (key == true ? "寅午戌三合火未成。" : "");
                }
            }
            if( yunZhi.equals("午") && ( bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || 
                    bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) ) {
                if( feGanHuo > 0) {
                    str = str + (key == true ? "寅午戌三合火。" : "");
                }
                else {
                    str = str + (key == true ? "寅午戌三合火未成。" : "");
                }
            }
        }

        if( zhi.equals("申")) {
            if( yunZhi.equals("子") && ( bazi.hourZhi.equals("辰") || bazi.dayZhi.equals("辰") || 
                    bazi.monthZhi.equals("辰") || bazi.yearZhi.equals("辰") ) ) {
                if( feGanShui > 0) {
                    str = str + (key == true ? "申子辰三合水。" : "");
                }
                else {
                    str = str + (key == true ? "申子辰三合水未成。" : "");
                }
            }
            if( yunZhi.equals("辰") && ( bazi.hourZhi.equals("子") || bazi.dayZhi.equals("子") || 
                    bazi.monthZhi.equals("子") || bazi.yearZhi.equals("子") ) ) {
                if( feGanShui > 0) {
                    str = str + (key == true ? "申子辰三合水。" : "");
                }
                else {
                    str = str + (key == true ? "申子辰三合水未成。" : "");
                }
            }
        }
        else if( zhi.equals("子")) {
            if( yunZhi.equals("申") && ( bazi.hourZhi.equals("辰") || bazi.dayZhi.equals("辰") || 
                    bazi.monthZhi.equals("辰") || bazi.yearZhi.equals("辰") ) ) {
                if( feGanShui > 0) {
                    str = str + (key == true ? "申子辰三合水。" : "");
                }
                else {
                    str = str + (key == true ? "申子辰三合水未成。" : "");
                }
            }
            if( yunZhi.equals("辰") && ( bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || 
                    bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) ) {
                if( feGanShui > 0) {
                    str = str + (key == true ? "申子辰三合水。" : "");
                }
                else {
                    str = str + (key == true ? "申子辰三合水未成。" : "");
                }
            }
        }
        else if( zhi.equals("辰")) {
            if( yunZhi.equals("申") && ( bazi.hourZhi.equals("子") || bazi.dayZhi.equals("子") || 
                    bazi.monthZhi.equals("子") || bazi.yearZhi.equals("子") ) ) {
                if( feGanShui > 0) {
                    str = str + (key == true ? "申子辰三合水。" : "");
                }
                else {
                    str = str + (key == true ? "申子辰三合水未成。" : "");
                }
            }
            if( yunZhi.equals("子") && ( bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || 
                    bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) ) {
                if( feGanShui > 0) {
                    str = str + (key == true ? "申子辰三合水。" : "");
                }
                else {
                    str = str + (key == true ? "申子辰三合水未成。" : "");
                }
            }
        }

        if( zhi.equals("巳")) {
            if( yunZhi.equals("酉") && ( bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || 
                    bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) ) {
                if( feGanJin > 0) {
                    str = str + (key == true ? "巳酉丑三合金。" : "");
                }
                else {
                    str = str + (key == true ? "巳酉丑三合金未成。" : "");
                }
            }
            if( yunZhi.equals("丑") && ( bazi.hourZhi.equals("酉") || bazi.dayZhi.equals("酉") || 
                    bazi.monthZhi.equals("酉") || bazi.yearZhi.equals("酉") ) ) {
                if( feGanJin > 0) {
                    str = str + (key == true ? "巳酉丑三合金。" : "");
                }
                else {
                    str = str + (key == true ? "巳酉丑三合金未成。" : "");
                }
            }
        }
        else if( zhi.equals("酉")) {
            if( yunZhi.equals("巳") && ( bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || 
                    bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) ) {
                if( feGanJin > 0) {
                    str = str + (key == true ? "巳酉丑三合金。" : "");
                }
                else {
                    str = str + (key == true ? "巳酉丑三合金未成。" : "");
                }
            }
            if( yunZhi.equals("丑") && ( bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || 
                    bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) ) {
                if( feGanJin > 0) {
                    str = str + (key == true ? "巳酉丑三合金。" : "");
                }
                else {
                    str = str + (key == true ? "巳酉丑三合金未成。" : "");
                }
            }
        }
        else if( zhi.equals("丑")) {
            if( yunZhi.equals("巳") && ( bazi.hourZhi.equals("酉") || bazi.dayZhi.equals("酉") || 
                    bazi.monthZhi.equals("酉") || bazi.yearZhi.equals("酉") ) ) {
                if( feGanJin > 0) {
                    str = str + (key == true ? "巳酉丑三合金。" : "");
                }
                else {
                    str = str + (key == true ? "巳酉丑三合金未成。" : "");
                }
            }
            if( yunZhi.equals("酉") && ( bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || 
                    bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) ) {
                if( feGanJin > 0) {
                    str = str + (key == true ? "巳酉丑三合金。" : "");
                }
                else {
                    str = str + (key == true ? "巳酉丑三合金未成。" : "");
                }
            }
        }

        //#endregion

        //#region 地支六冲
        if( zhi.equals("子") && ( yunZhi.equals("午") || bazi.hourZhi.equals("午") || bazi.dayZhi.equals("午") || 
                bazi.monthZhi.equals("午") || bazi.yearZhi.equals("午") ) ) {
            str = str + (key == true ? "子午相冲，" : "") + "易不安。";
        }
        if( zhi.equals("午") && ( yunZhi.equals("子") || bazi.hourZhi.equals("子") || bazi.dayZhi.equals("子") || 
                bazi.monthZhi.equals("子") || bazi.yearZhi.equals("子") ) ) {
            str = str + (key == true ? "子午相冲，" : "") + "易不安。";
        }

        if( zhi.equals("丑") && ( yunZhi.equals("未") || bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || 
                bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) ) {
            str = str + (key == true ? "丑未相冲，" : "") + "事多阻。";
        }
        if( zhi.equals("未") && ( yunZhi.equals("丑") || bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || 
                bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) ) {
            str = str + (key == true ? "丑未相冲，" : "") + "事多阻。";
        }

        if( zhi.equals("寅") && ( yunZhi.equals("申") || bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || 
                bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) ) {
            str = str + (key == true ? "寅申相冲，" : "") + "多情或者管闲事。";
        }
        if( zhi.equals("申") && ( yunZhi.equals("寅") || bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || 
                bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) ) {
            str = str + (key == true ? "寅申相冲，" : "") + "多情或者管闲事。";
        }

        if( zhi.equals("卯") && ( yunZhi.equals("酉") || bazi.hourZhi.equals("酉") || bazi.dayZhi.equals("酉") || 
                bazi.monthZhi.equals("酉") || bazi.yearZhi.equals("酉") ) ) {
            str = str + (key == true ? "卯酉相冲，" : "") + "多劳碌，易情色纠纷。";
        }
        if( zhi.equals("酉") && ( yunZhi.equals("卯") || bazi.hourZhi.equals("卯") || bazi.dayZhi.equals("卯") || 
                bazi.monthZhi.equals("卯") || bazi.yearZhi.equals("卯") ) ) {
            str = str + (key == true ? "卯酉相冲，" : "") + "多劳碌，易情色纠纷。";
        }

        if( zhi.equals("辰") && ( yunZhi.equals("戌") || bazi.hourZhi.equals("戌") || bazi.dayZhi.equals("戌") || 
                bazi.monthZhi.equals("戌") || bazi.yearZhi.equals("戌") ) ) {
            str = str + (key == true ? "辰戌相冲，" : "") + "克亲人，帮他人。";
        }
        if( zhi.equals("戌") && ( yunZhi.equals("辰") || bazi.hourZhi.equals("辰") || bazi.dayZhi.equals("辰") || 
                bazi.monthZhi.equals("辰") || bazi.yearZhi.equals("辰") ) ) {
            str = str + (key == true ? "辰戌相冲，" : "") + "克亲人，帮他人。";
        }

        if( zhi.equals("巳") && ( yunZhi.equals("亥") || bazi.hourZhi.equals("亥") || bazi.dayZhi.equals("亥") || 
                bazi.monthZhi.equals("亥") || bazi.yearZhi.equals("亥") ) ) {
            str = str + (key == true ? "巳亥相冲，" : "") + "易帮他人。";
        }
        if( zhi.equals("亥") && ( yunZhi.equals("巳") || bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || 
                bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) ) {
            str = str + (key == true ? "巳亥相冲，" : "") + "易帮他人。";
        }

        //#endregion

        //#region 地址六害 
        if( zhi.equals("子") && ( yunZhi.equals("未") || bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || 
                bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) ) {
            str = str + (key == true ? "子未相害，" : "") + "无助于子孙。";
        }
        if( zhi.equals("未") && ( yunZhi.equals("子") || bazi.hourZhi.equals("子") || bazi.dayZhi.equals("子") || 
                bazi.monthZhi.equals("子") || bazi.yearZhi.equals("子") ) ) {
            str = str + (key == true ? "子未相害，" : "") + "无助于子孙。";
        }

        if( zhi.equals("丑") && ( yunZhi.equals("午") || bazi.hourZhi.equals("午") || bazi.dayZhi.equals("午") || 
                bazi.monthZhi.equals("午") || bazi.yearZhi.equals("午") ) ) {
            str = str + (key == true ? "丑午相害，" : "") + "易怒，无耐心，大运逢弱易有伤残。";
        }
        if( zhi.equals("午") && ( yunZhi.equals("丑") || bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || 
                bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) ) {
            str = str + (key == true ? "丑午相害，" : "") + "易怒，无耐心，大运逢弱易有伤残。";
        }

        if( zhi.equals("寅") && ( yunZhi.equals("巳") || bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || 
                bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) ) {
            str = str + (key == true ? "寅巳相害，" : "") + "多疾病。";
        }
        if( zhi.equals("巳") && ( yunZhi.equals("寅") || bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || 
                bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) ) {
            str = str + (key == true ? "寅巳相害，" : "") + "多疾病。";
        }

        if( zhi.equals("卯") && ( yunZhi.equals("辰") || bazi.hourZhi.equals("辰") || bazi.dayZhi.equals("辰") || 
                bazi.monthZhi.equals("辰") || bazi.yearZhi.equals("辰") ) ) {
            str = str + (key == true ? "卯辰相害，" : "") + "易怒，无耐心，大运逢弱易有伤残。";
        }
        if( zhi.equals("辰") && ( yunZhi.equals("卯") || bazi.hourZhi.equals("卯") || bazi.dayZhi.equals("卯") || 
                bazi.monthZhi.equals("卯") || bazi.yearZhi.equals("卯") ) ) {
            str = str + (key == true ? "卯辰相害，" : "") + "易怒，无耐心，大运逢弱易有伤残。";
        }

        if( zhi.equals("申") && ( yunZhi.equals("亥") || bazi.hourZhi.equals("亥") || bazi.dayZhi.equals("亥") || 
                bazi.monthZhi.equals("亥") || bazi.yearZhi.equals("亥") ) ) {
                str = str + (key == true ? "申亥相害，" : "");
            }
        if( zhi.equals("亥") && ( yunZhi.equals("申") || bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || 
                bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) ) {
            str = str + (key == true ? "申亥相害，" : "");
        }

        if( zhi.equals("酉") && ( yunZhi.equals("戌") || bazi.yearZhi.equals("戌") || bazi.hourZhi.equals("戌") || 
                bazi.dayZhi.equals("戌") || bazi.monthZhi.equals("戌") ) ) {
            str = str + (key == true ? "酉戌相害，" : "");
        }
        if( zhi.equals("戌") && ( yunZhi.equals("酉") || bazi.yearZhi.equals("酉") || bazi.hourZhi.equals("酉") || 
                bazi.dayZhi.equals("酉") || bazi.monthZhi.equals("酉") ) ) {
            str = str + (key == true ? "酉戌相害，" : "");
        }
        
        //#endregion

        //#region 地支相刑 
        if( zhi.equals("寅")) {
            if( yunZhi.equals("巳") && ( bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || 
                    bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) ) {
                str = str + (key == true ? "寅巳申三刑，" : "") + "易官司或是非，女不易怀孕或易流产。";
            }
            if( yunZhi.equals("申") && ( bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || 
                    bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) ) {
                str = str + (key == true ? "寅巳申三刑，" : "") + "易官司或是非，女不易怀孕或易流产。";
            }
        }
        else if( zhi.equals("巳")) {
            if( yunZhi.equals("申") && ( bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || 
                    bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) ) {
                str = str + (key == true ? "寅巳申三刑，" : "") + "易官司或是非，女不易怀孕或易流产。";                
            }
            if( yunZhi.equals("寅") && ( bazi.hourZhi.equals("申") || bazi.dayZhi.equals("申") || 
                    bazi.monthZhi.equals("申") || bazi.yearZhi.equals("申") ) ) {
                str = str + (key == true ? "寅巳申三刑，" : "") + "易官司或是非，女不易怀孕或易流产。";                
            }
        }
        else if( zhi.equals("申")) {
            if( yunZhi.equals("寅") && ( bazi.hourZhi.equals("巳") || bazi.dayZhi.equals("巳") || 
                    bazi.monthZhi.equals("巳") || bazi.yearZhi.equals("巳") ) ) {
                str = str + (key == true ? "寅巳申三刑，" : "") + "易官司或是非，女不易怀孕或易流产。";
            }
            if( yunZhi.equals("巳") && ( bazi.hourZhi.equals("寅") || bazi.dayZhi.equals("寅") || 
                    bazi.monthZhi.equals("寅") || bazi.yearZhi.equals("寅") ) ) {
                str = str + (key == true ? "寅巳申三刑，" : "") + "易官司或是非，女不易怀孕或易流产。";
            }
        }

        if(zhi.equals("未")) {
            if( yunZhi.equals("丑") && ( bazi.hourZhi.equals("戌") || bazi.dayZhi.equals("戌") || 
                    bazi.monthZhi.equals("戌") || bazi.yearZhi.equals("戌") ) ) {
                str = str + (key == true ? "未丑戌三刑，" : "") + "易挫折，女易孤单。";
            }
            if( yunZhi.equals("戌") && ( bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || 
                    bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) ) {
                str = str + (key == true ? "未丑戌三刑，" : "") + "易挫折，女易孤单。";
            }
        }
        else if( zhi.equals("丑")) {
            if( yunZhi.equals("未") && ( bazi.hourZhi.equals("戌") || bazi.dayZhi.equals("戌") || 
                    bazi.monthZhi.equals("戌") || bazi.yearZhi.equals("戌") ) ) {
                str = str + (key == true ? "未丑戌三刑，" : "") + "易挫折，女易孤单。";
            }
            if( yunZhi.equals("戌") && ( bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || 
                    bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) ) {
                str = str + (key == true ? "未丑戌三刑，" : "") + "易挫折，女易孤单。";
            }
        }
        else if( zhi.equals("戌")) {
            if( yunZhi.equals("未") && ( bazi.hourZhi.equals("丑") || bazi.dayZhi.equals("丑") || 
                    bazi.monthZhi.equals("丑") || bazi.yearZhi.equals("丑") ) ) {
                str = str + (key == true ? "未丑戌三刑，" : "") + "易挫折，女易孤单。";
            }
            if( yunZhi.equals("丑") && ( bazi.hourZhi.equals("未") || bazi.dayZhi.equals("未") || 
                    bazi.monthZhi.equals("未") || bazi.yearZhi.equals("未") ) ) {
                str = str + (key == true ? "未丑戌三刑，" : "") + "易挫折，女易孤单。";
            }
        }

        if( zhi.equals("卯") && (yunZhi.equals("子") || bazi.hourZhi.equals("子") || bazi.dayZhi.equals("子") || 
                bazi.monthZhi.equals("子") || bazi.yearZhi.equals("子") ) ) {
            str = str + (key == true ? "子卯二刑，" : "") + "与上级(辈)或者下级(辈)不和。";
        }
        else if( zhi.equals("子") && (yunZhi.equals("卯") || bazi.hourZhi.equals("卯") || bazi.dayZhi.equals("卯") || 
                bazi.monthZhi.equals("卯") || bazi.yearZhi.equals("卯") ) ) {
            str = str + (key == true ? "子卯二刑，" : "") + "与上级(辈)或者下级(辈)不和。";
        }

        if( zhi.equals("辰") && (yunZhi.equals("辰") || bazi.hourZhi.equals("辰") || bazi.dayZhi.equals("辰") || 
                bazi.monthZhi.equals("辰") || bazi.yearZhi.equals("辰") ) ) {
            str = str + (key == true ? "辰辰自刑，" : "") + "有始无终，常陷困境。";
        }

        if( zhi.equals("午") && (yunZhi.equals("午") || bazi.hourZhi.equals("午") || bazi.dayZhi.equals("午") || 
                bazi.monthZhi.equals("午") || bazi.yearZhi.equals("午") ) ) {
            str = str + (key == true ? "午午自刑，" : "") + "有始无终，常陷困境。";
        }

        if( zhi.equals("酉") && (yunZhi.equals("酉") || bazi.hourZhi.equals("酉")  || bazi.dayZhi.equals("酉") || 
                bazi.monthZhi.equals("酉") || bazi.yearZhi.equals("酉") ) ) {
            str = str + (key == true ? "酉酉自刑，" : "") + "有始无终，常陷困境。";
        }
        if( zhi.equals("亥") && (yunZhi.equals("亥") || bazi.hourZhi.equals("亥") || bazi.dayZhi.equals("亥") || 
                bazi.monthZhi.equals("亥") || bazi.yearZhi.equals("亥") ) ) {
            str = str + (key == true ? "亥亥自刑，" : "") + "有始无终，常陷困境。";
        }

        //#endregion

        return str;        
    }


    public int fnDzcgFindGuanCai(boolean guan) {
        int iRtn = 0;
        int ii;
        if( guan == true ) {
            for( ii = 0 ; ii < bazi.dzcgYearList.length ; ii++ ) {
                if( bazi.dzcgYearList[ii].ss.equals("官") || bazi.dzcgYearList[ii].ss.equals("煞")) {
                    iRtn++;
                }
            }
            for( ii = 0 ; ii < bazi.dzcgMonthList.length ; ii++ ) {
                if( bazi.dzcgMonthList[ii].ss.equals("官") || bazi.dzcgMonthList[ii].ss.equals("煞") ) {
                    iRtn++;
                }
            }
            for( ii = 0 ; ii < bazi.dzcgDayList.length ; ii++ ) {
                if( bazi.dzcgDayList[ii].ss.equals("官") || bazi.dzcgDayList[ii].ss.equals("煞") ) {
                    iRtn++;
                }
            }
            for( ii = 0 ; ii < bazi.dzcgHourList.length ; ii++ ) {
                if( bazi.dzcgHourList[ii].ss.equals("官") || bazi.dzcgHourList[ii].ss.equals("煞") ) {
                    iRtn++;
                }
            }
        }
        else {
            for( ii = 0 ; ii < bazi.dzcgYearList.length ; ii++ ) {
                if( bazi.dzcgYearList[ii].ss.equals("财") || bazi.dzcgYearList[ii].ss.equals("才")) {
                    iRtn++;
                }
            }
            for( ii = 0 ; ii < bazi.dzcgMonthList.length ; ii++ ) {
                if( bazi.dzcgMonthList[ii].ss.equals("财") || bazi.dzcgMonthList[ii].ss.equals("才") ) {
                    iRtn++;
                }
            }
            for( ii = 0 ; ii < bazi.dzcgDayList.length ; ii++ ) {
                if( bazi.dzcgDayList[ii].ss.equals("财") || bazi.dzcgDayList[ii].ss.equals("才") ) {
                    iRtn++;
                }
            }
            for( ii = 0 ; ii < bazi.dzcgHourList.length ; ii++ ) {
                if( bazi.dzcgHourList[ii].ss.equals("财") || bazi.dzcgHourList[ii].ss.equals("才") ) {
                    iRtn++;
                }
            }            
        }
        return iRtn;
    }

    public String fnSelfPayBigFateWangShuai(String gan, String zhi) {
        /// 地支旺衰
        //状态 甲 丙 戊 庚 壬 乙 丁 己 辛 癸
        //长生 亥 寅 寅 巳 申 午 酉 酉 子 卯
        //沐浴 子 卯 卯 午 酉 巳 申 申 亥 寅
        //冠带 丑 辰 辰 未 戌 辰 未 未 戌 丑
        //临官 寅 巳 巳 申 亥 卯 午 午 酉 子
        //帝旺 卯 午 午 酉 子 寅 巳 巳 申 亥
        //衰   辰 未 未 戌 丑 丑 辰 辰 未 戌
        //病   巳 申 申 亥 寅 子 卯 卯 午 酉
        //死   午 酉 酉 子 卯 亥 寅 寅 巳 申
        //墓   未 戌 戌 丑 辰 戌 丑 丑 辰 未
        //绝   申 亥 亥 寅 巳 酉 子 子 卯 午
        //胎   酉 子 子 卯 午 申 亥 亥 寅 巳
        //养   戌 丑 丑 辰 未 未 戌 戌 丑 辰

        String str = "";

        String[] wangShuai = new String[] {"长生", "沐浴", "冠带", "临官", "帝旺", "　衰", "　病", "　死", "　墓", "　绝", "　胎", "　养"};
        String jia  = "亥子丑寅卯辰巳午未申酉戌";
        String yi   = "午巳辰卯寅丑子亥戌酉申未";
        String bing = "寅卯辰巳午未申酉戌亥子丑";
        String ding = "酉申未午巳辰卯寅丑子亥戌";
        String wu   = "寅卯辰巳午未申酉戌亥子丑";
        String ji   = "酉申未午巳辰卯寅丑子亥戌";
        String geng = "巳午未申酉戌亥子丑寅卯辰";
        String xin  = "子亥戌酉申未午巳辰卯寅丑";
        String ren  = "申酉戌亥子丑寅卯辰巳午未";
        String gui  = "卯寅丑子亥戌酉申未午巳辰";

        if( gan.equals("甲") ) {
            int idxZhi = jia.indexOf(zhi);
            if( idxZhi >= 0 && idxZhi < 12) {
                str = wangShuai[idxZhi];
            }
        }
        else if( gan.equals("乙") ) {
            int idxZhi = yi.indexOf(zhi);
            if( idxZhi >= 0 && idxZhi < 12) {
                str = wangShuai[idxZhi];
            }
        }
        else if( gan.equals("丙") ) {
            int idxZhi = bing.indexOf(zhi);
            if( idxZhi >= 0 && idxZhi < 12) {
                str = wangShuai[idxZhi];
            }
        }
        else if( gan.equals("丁") ) {
            int idxZhi = ding.indexOf(zhi);
            if( idxZhi >= 0 && idxZhi < 12) {
                str = wangShuai[idxZhi];
            }
        }
        else if( gan.equals("戊") ) {
            int idxZhi = wu.indexOf(zhi);
            if( idxZhi >= 0 && idxZhi < 12) {
                str = wangShuai[idxZhi];
            }
        }
        else if( gan.equals("己") ) {
            int idxZhi = ji.indexOf(zhi);
            if( idxZhi >= 0 && idxZhi < 12) {
                str = wangShuai[idxZhi];
            }
        }
        else if( gan.equals("庚") ) {
            int idxZhi = geng.indexOf(zhi);
            if( idxZhi >= 0 && idxZhi < 12) {
                str = wangShuai[idxZhi];
            }
        }
        else if( gan.equals("辛") ) {
            int idxZhi = xin.indexOf(zhi);
            if( idxZhi >= 0 && idxZhi < 12) {
                str = wangShuai[idxZhi];
            }
        }
        else if( gan.equals("壬") ) {
            int idxZhi = ren.indexOf(zhi);
            if( idxZhi >= 0 && idxZhi < 12) {
                str = wangShuai[idxZhi];
            }
        }
        else if( gan.equals("癸") ) {
            int idxZhi = gui.indexOf(zhi);
            if( idxZhi >= 0 && idxZhi < 12) {
                str = wangShuai[idxZhi];
            }
        }
        
        return str;
    }

    public String fnSelfPayBigFateShiShen(String gan, String zhi, boolean key, int fate) {
        /// 算每一个大运的运程, 把大运合算进来以后，重新计算十神

        String  str = "";

        String yearGan = bazi.yearGan;
        String yearZhi = bazi.yearZhi;
        String monthGan = bazi.monthGan;
        String monthZhi = bazi.monthZhi;
        String dayGan = bazi.dayGan;
        String dayZhi = bazi.dayZhi;
        String hourGan = bazi.hourGan;
        String hourZhi = bazi.hourZhi;
        String yunGan = gan;
        String yunZhi = zhi;

        String shenYearGan = "";
        String shenYearZhi = "";
        String shenMonthGan = "";
        String shenMonthZhi = "";
        String shenDayZhi = "";
        String shenHourGan = "";
        String shenHourZhi = "";
        String shenYunGan = "";
        String shenYunZhi = "";

        Integer guan = 0;
        Integer sha = 0;
        Integer yin = 0;
        Integer xiao = 0;
        Integer bi = 0;
        Integer jie = 0;
        Integer shi = 0;
        Integer shang = 0;
        Integer caiz = 0;
        Integer caip = 0;
        Integer sheng = 1;
        Integer ke = 0;

        /// 根据天干五合，重新计算天干的五行
        //#region 天干五合
        if( gan.equals("甲") && ( hourGan.equals("己") || dayGan.equals("己") || 
                                            monthGan.equals("己") || yearGan.equals("己") ) ) {
            if( feTu > 0 ) {
                yunGan = "己";
                if( key == true ) str = str + "天干由甲己合化土，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
            }
        }
        if( gan.equals("己") ) {
            if( hourGan.equals("甲") ) {
                if( feTu > 0 ) {
                    hourGan = "己";
                }
            }
            else if( monthGan.equals("甲") ) {
                if( feTu > 0 ) {
                    monthGan = "己";
                }
            }
            else if( yearGan.equals("甲") ) {
                if( feTu > 0 ) {
                    yearGan = "己";
                }
            }
        }

        if( gan.equals("乙") && ( hourGan.equals("庚") || dayGan.equals("庚") || 
                                            monthGan.equals("庚") || yearGan.equals("庚") ) ) {
            if( feJin > 0 ) {
                yunGan = "庚";
                if( key == true ) str = str + "天干由乙庚合化金，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
            }
        }
        if( gan.equals("庚") ) {
            if( hourGan.equals("乙") ) {
                if( feJin > 0 ) {
                    hourGan = "庚";
                }
            }
            else if( monthGan.equals("乙") ) {
                if( feJin > 0 ) {
                    monthGan = "庚";
                }
            }
            else if( yearGan.equals("乙") ) {
                if( feJin > 0 ) {
                    yearGan = "庚";
                }
            }
        } 

        if( gan.equals("丙") ) {
            if( hourGan.equals("辛") ) {
                if( feShui > 0 ) {
                    hourGan = "壬";
                    yunGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( dayGan.equals("辛") ) {
                if( feShui > 0 ) {
                    yunGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( monthGan.equals("辛") ) {
                if( feShui > 0 ) {
                    monthGan = "壬";
                    yunGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( yearGan.equals("辛") ) {
                if( feShui > 0 ) {
                    yearGan = "壬";
                    yunGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
        }
        if( gan.equals("辛") ) {
            if( hourGan.equals("丙") ) {
                if( feShui > 0 ) {
                    hourGan = "壬";
                    yunGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( dayGan.equals("丙") ) {
                if( feShui > 0 ) {
                    yunGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( monthGan.equals("丙") ) {
                if( feShui > 0 ) {
                    monthGan = "壬";
                    yunGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( yearGan.equals("丙") ) {
                if( feShui > 0 ) {
                    yearGan = "壬";
                    yunGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
        }

        if( gan.equals("丁") ) {
            if( hourGan.equals("壬") ) {
                if( feMu > 0 ) {
                    hourGan = "乙";
                    yunGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( dayGan.equals("壬") ) {
                if( feMu > 0 ) {
                    yunGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( monthGan.equals("壬") ) {
                if( feMu > 0 ) {
                    monthGan = "乙";
                    yunGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( yearGan.equals("壬") ) {
                if( feMu > 0 ) {
                    yearGan = "乙";
                    yunGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
        }
        if( gan.equals("壬") ) {
            if( hourGan.equals("丁") ) {
                if( feMu > 0 ) {
                    hourGan = "乙";
                    yunGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( dayGan.equals("丁") ) {
                if( feMu > 0 ) {
                    yunGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( monthGan.equals("丁") ) {
                if( feMu > 0 ) {
                    monthGan = "乙";
                    yunGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( yearGan.equals("丁") ) {
                if( feMu > 0 ) {
                    yearGan = "乙";
                    yunGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
        }

        if( gan.equals("戊") ) {
            if( hourGan.equals("癸") ) {
                if( feHuo > 0 ) {
                    hourGan = "丁";
                    yunGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( dayGan.equals("癸") ) {
                if( feHuo > 0 ) {
                    yunGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( monthGan.equals("癸") ) {
                if( feHuo > 0 ) {
                    monthGan = "丁";
                    yunGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( yearGan.equals("癸") ) {
                if( feHuo > 0 ) {
                    yearGan = "丁";
                    yunGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
        }
        if( gan.equals("癸") ) {
            if( hourGan.equals("戊") ) {
                if( feHuo > 0 ) {
                    hourGan = "丁";
                    yunGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( dayGan.equals("戊") ) {
                if( feHuo > 0 ) {
                    yunGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( monthGan.equals("戊") ) {
                if( feHuo > 0 ) {
                    monthGan = "丁";
                    yunGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( yearGan.equals("戊") ) {
                if( feHuo > 0 ) {
                    yearGan = "丁";
                    yunGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
        }
        //#endregion

        //#region 地支六合
        if( zhi.equals("子") && ( hourZhi.equals("丑") || dayZhi.equals("丑") || 
                                            monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
            if( feGanTu > 0) {
                yunZhi = "丑";
                if( key == true ) str = str + "地支由子丑合化土，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
            }
        }
        if( zhi.equals("丑") ) {
            if( hourZhi.equals("子") ) {
                if( feGanTu > 0) {
                    hourZhi = "丑";
                    yunZhi = "丑";
                }
            }
            else if( dayZhi.equals("子") ) {
                if( feGanTu > 0) {
                    dayZhi = "丑";
                    yunZhi = "丑";
                }
            }
            else if( monthZhi.equals("子") ) {
                if( feGanTu > 0) {
                    monthZhi = "丑";
                    yunZhi = "丑";
                }
            }
            else if( yearZhi.equals("子") ) {
                if( feGanTu > 0) {
                    yearZhi = "丑";
                    yunZhi = "丑";
                }
            }
        }

        if( zhi.equals("亥") && ( hourZhi.equals("寅") || dayZhi.equals("寅") || 
                                            monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
            if( feGanMu > 0) {
                yunZhi = "寅";
                if( key == true ) str = str + "地支由亥寅合化木，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
            }
        }
        if( zhi.equals("寅") ) {
            if( hourZhi.equals("亥") ) {
                if( feGanMu > 0) {
                    hourZhi = "寅";
                }    
            }
            else if( dayZhi.equals("亥") ) {
                if( feGanMu > 0) {
                    dayZhi = "寅";
                }
            }
            else if( monthZhi.equals("亥") ) {
                if( feGanMu > 0) {
                    monthZhi = "寅";
                }
            }
            else if( yearZhi.equals("亥") ) {
                if( feGanMu > 0) {
                    yearZhi = "寅";
                }
            }
        }

        if( zhi.equals("卯") ) {
            if ( hourZhi.equals("戌") ) {
                if( feGanHuo > 0) {
                    yunZhi = "巳";
                    hourZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }
            }
            else if( dayZhi.equals("戌") ) {
                if( feGanHuo > 0) {
                    yunZhi = "巳";
                    dayZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }
            }
            else if( monthZhi.equals("戌") ) {
                if( feGanHuo > 0) {
                    yunZhi = "巳";
                    monthZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }
            } 
            else if( yearZhi.equals("戌") ) {
                if( feGanHuo > 0) {
                    yunZhi = "巳";
                    yearZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }
            }
        }
        if( zhi.equals("戌") ) {
            if ( hourZhi.equals("卯") ) {
                if( feGanHuo > 0) {
                    yunZhi = "巳";
                    hourZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }
            }
            else if( dayZhi.equals("卯") ) {
                if( feGanHuo > 0) {
                    yunZhi = "巳";
                    dayZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }
            }
            else if( monthZhi.equals("卯") ) {
                if( feGanHuo > 0) {
                    yunZhi = "巳";
                    monthZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }
            } 
            else if( yearZhi.equals("卯") ) {
                if( feGanHuo > 0) {
                    yunZhi = "巳";
                    yearZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }
            }
        }

        if( zhi.equals("辰") && ( hourZhi.equals("酉") || dayZhi.equals("酉") || 
                                            monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
            if( feGanJin > 0) {
                yunZhi = "酉";
                if( key == true ) str = str + "地支由辰酉合化金，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
            }
        }
        if( zhi.equals("酉") ) {
            if( hourZhi.equals("辰") ) {
                if( feGanJin > 0) {
                    hourZhi = "酉";
                }
            }
            else if( dayZhi.equals("辰") ) {
                if( feGanJin > 0) {
                    dayZhi = "酉";
                }
            } 
            else if( monthZhi.equals("辰") ) {
                if( feGanJin > 0) {
                    monthZhi = "酉";
                }
            }
            else if( yearZhi.equals("辰") ) {
                if( feGanJin > 0) {
                    yearZhi = "酉";
                }
            }   
        }

        if( zhi.equals("巳") ) {
            if( hourZhi.equals("申") ) {
                if( feGanShui > 0) {
                    yunZhi = "癸";
                    hourZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }    
            } 
            else if( dayZhi.equals("申") ) {
                if( feGanShui > 0) {
                    yunZhi = "癸";
                    dayZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }    
            } 
            else if( monthZhi.equals("申") ) {
                if( feGanShui > 0) {
                    yunZhi = "癸";
                    monthZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }    
            } 
            else if( yearZhi.equals("申") )  {
                if( feGanShui > 0) {
                    yunZhi = "癸";
                    yearZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }    
            }
        }
        if( zhi.equals("申") ) {
            if( hourZhi.equals("巳") ) {
                if( feGanShui > 0) {
                    yunZhi = "癸";
                    hourZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }    
            } 
            else if( dayZhi.equals("巳") ) {
                if( feGanShui > 0) {
                    yunZhi = "癸";
                    dayZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }    
            } 
            else if( monthZhi.equals("巳") ) {
                if( feGanShui > 0) {
                    yunZhi = "癸";
                    monthZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }    
            } 
            else if( yearZhi.equals("巳") )  {
                if( feGanShui > 0) {
                    yunZhi = "癸";
                    yearZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }    
            }
        }

        /// 午未合土火，他们本来就是土火
        if( zhi.equals("未") ) {
            if( hourZhi.equals("午") ) {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    yunZhi = "未";
                    hourZhi = "未";
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    yunZhi = "午";
                    hourZhi = "午";
                    if( key == true ) str = str + "地支由午未合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }
            }
            else if( dayZhi.equals("午") ) {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    yunZhi = "未";
                    dayZhi = "未";
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    yunZhi = "午";
                    dayZhi = "午";
                    if( key == true ) str = str + "地支由午未合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }
            }  
            else if( monthZhi.equals("午") ) {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    yunZhi = "未";
                    monthZhi = "未";
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    yunZhi = "午";
                    monthZhi = "午";
                    if( key == true ) str = str + "地支由午未合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }
            } 
            else if( yearZhi.equals("午") ) {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    yunZhi = "未";
                    yearZhi = "未";
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    yunZhi = "午";
                    yearZhi = "午";
                    if( key == true ) str = str + "地支由午未合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }
            }
        }
        if( zhi.equals("午") ) {
            if( hourZhi.equals("未") ) {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    yunZhi = "未";
                    hourZhi = "未";
                    if( key == true ) str = str + "地支由午未合化土，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    yunZhi = "午";
                    hourZhi = "午";
                }
            } 
            else if( dayZhi.equals("未") ) {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    yunZhi = "未";
                    dayZhi = "未";
                    if( key == true ) str = str + "地支由午未合化土，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    yunZhi = "午";
                    dayZhi = "午";
                }
            }  
            else if( monthZhi.equals("未") ) {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    yunZhi = "未";
                    monthZhi = "未";
                    if( key == true ) str = str + "地支由午未合化土，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    yunZhi = "午";
                    monthZhi = "午";
                }
            } 
            else if( yearZhi.equals("未") )  {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    yunZhi = "未";
                    yearZhi = "未";
                    if( key == true ) str = str + "地支由午未合化土，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    yunZhi = "午";
                    yearZhi = "午";
                }
            }
        }

        //#endregion

        //#region 地支三会局
        if( zhi.equals("寅")) {
            if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
                if( hourZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        hourZhi = "卯";
                    }
                } 
                else if( dayZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        dayZhi = "卯";
                    }
                } 
                else if( monthZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        monthZhi = "卯";
                    }
                } 
                else if( yearZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        yearZhi = "卯";
                    }
                }
            }
        }
        else if( zhi.equals("卯")) {
            if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
                if( hourZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        hourZhi = "卯";
                    }
                } 
                else if( dayZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        dayZhi = "卯";
                    }
                } 
                else if( monthZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        monthZhi = "卯";
                    }
                } 
                else if( yearZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        yearZhi = "卯";
                    }
                }
            }
        }
        else if( zhi.equals("未")) {
            if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
                if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
                    if( feGanMu > 0) {
                        yunZhi = "卯";
                        if( key == true ) str = str + "地支由寅卯辰会木，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                }
            }
        }

        if( zhi.equals("巳")) {
            if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
                if( hourZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        hourZhi = "巳";
                    }
                } 
                else if( dayZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        dayZhi = "巳";
                    }
                } 
                else if( monthZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        monthZhi = "巳";
                    }
                } 
                else if( yearZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        yearZhi = "巳";
                    }
                }
            }
        }
        else if( zhi.equals("午")) {
            if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
                if( hourZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        hourZhi = "巳";
                    }
                } 
                else if( dayZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        dayZhi = "巳";
                    }
                } 
                else if( monthZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        monthZhi = "巳";
                    }
                } 
                else if( yearZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        yearZhi = "巳";
                    }
                }
            }
        }
        else if( zhi.equals("未")) {
            if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
                if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
                    if( feGanHuo > 0) {
                        yunZhi = "巳";
                        if( key == true ) str = str + "地支由巳午未会火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                }
            }
        }

        if( zhi.equals("申")) {
            if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
                if( hourZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        hourZhi = "酉";
                    }
                } 
                else if( dayZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        dayZhi = "酉";
                    }
                } 
                else if( monthZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        monthZhi = "酉";
                    }
                } 
                else if( yearZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        yearZhi = "酉";
                    }
                }
            }
        }
        else if( zhi.equals("酉")) {
            if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
                if( hourZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        hourZhi = "酉";
                    }
                } 
                else if( dayZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        dayZhi = "酉";
                    }
                } 
                else if( monthZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        monthZhi = "酉";
                    }
                } 
                else if( yearZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        yearZhi = "酉";
                    }
                }
            }
        }
        else if( zhi.equals("戌")) {
            if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
                if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
                    if( feGanJin > 0) {
                        yunZhi = "酉";
                        if( key == true ) str = str + "地支由辰酉戌会金，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                }
            }
        }

        if( zhi.equals("亥")) {
            if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
                if( hourZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        hourZhi = "亥";
                    }
                } 
                else if( dayZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        dayZhi = "亥";
                    }
                } 
                else if( monthZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        monthZhi = "亥";
                    }
                } 
                else if( yearZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        yearZhi = "亥";
                    }
                }
            }
        }
        else if( zhi.equals("子")) {
            if( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) {
                if( hourZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        hourZhi = "亥";
                    }
                } 
                else if( dayZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        dayZhi = "亥";
                    }
                } 
                else if( monthZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        monthZhi = "亥";
                    }
                } 
                else if( yearZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        yearZhi = "亥";
                    }
                }
            }
        }
        else if( zhi.equals("丑")) {
            if( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) {
                if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
                    if( feGanShui > 0) {
                        yunZhi = "亥";
                        if( key == true ) str = str + "地支由亥子丑会水，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                }
            }
        }

        //#endregion

        //#region 地支三合局
        if( zhi.equals("寅")) {
            if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
                if( hourZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        yunZhi = "午";
                        hourZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( dayZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        yunZhi = "午";
                        dayZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( monthZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        yunZhi = "午";
                        monthZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( yearZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        yunZhi = "午";
                        yearZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                }
            }
        }
        else if( zhi.equals("戌")) {
            if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
                if( hourZhi.equals("寅") ) {
                    if( feGanHuo > 0) {
                        yunZhi = "午";
                        hourZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( dayZhi.equals("寅") ) {
                    if( feGanHuo > 0) {
                        yunZhi = "午";
                        dayZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( monthZhi.equals("寅") ) {
                    if( feGanHuo > 0) {
                        yunZhi = "午";
                        monthZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( yearZhi.equals("寅") ) {
                    if( feGanHuo > 0) {
                        yunZhi = "午";
                        yearZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                }
            }
        }
        else if( zhi.equals("午")) {
            if( hourZhi.equals("寅") ) {
                if( dayZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        hourZhi = "午";
                        dayZhi = "午";
                    }
                } 
                else if( monthZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        hourZhi = "午";
                        monthZhi = "午";
                    }
                } 
                else if( yearZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        hourZhi = "午";
                        yearZhi = "午";
                    }
                }
            } 
            else if( dayZhi.equals("寅") ) {
                if( hourZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        dayZhi = "午";
                        hourZhi = "午";
                    }
                } 
                else if( monthZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        dayZhi = "午";
                        monthZhi = "午";
                    }
                } 
                else if( yearZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        dayZhi = "午";
                        yearZhi = "午";
                    }
                }
            } 
            else if( monthZhi.equals("寅") ) {
                if( hourZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        monthZhi = "午";
                        hourZhi = "午";
                    }
                } 
                else if( dayZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        monthZhi = "午";
                        dayZhi = "午";
                    }
                } 
                else if( yearZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        monthZhi = "午";
                        yearZhi = "午";
                    }
                }
            } 
            else if( yearZhi.equals("寅") ) {
                if( hourZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        yearZhi = "午";
                        hourZhi = "午";
                    }
                } 
                else if( dayZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        yearZhi = "午";
                        dayZhi = "午";
                    }
                } 
                else if( monthZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        yearZhi = "午";
                        monthZhi = "午";
                    }
                } 
            }
        }

        if( zhi.equals("亥")) {
            if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
                if( hourZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        yunZhi = "卯";
                        hourZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( dayZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        yunZhi = "卯";
                        dayZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( monthZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        yunZhi = "卯";
                        monthZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( yearZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        yunZhi = "卯";
                        yearZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                }
            }
        }
        else if( zhi.equals("未")) {
            if( bazi.hourZhi.equals("卯") || bazi.dayZhi.equals("卯") || bazi.monthZhi.equals("卯") || bazi.yearZhi.equals("卯") ) {
                if( hourZhi.equals("亥") ) {
                    if( feGanMu > 0) {
                        yunZhi = "卯";
                        hourZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( dayZhi.equals("亥") ) {
                    if( feGanMu > 0) {
                        yunZhi = "卯";
                        dayZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( monthZhi.equals("亥") ) {
                    if( feGanMu > 0) {
                        yunZhi = "卯";
                        monthZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( yearZhi.equals("亥") ) {
                    if( feGanMu > 0) {
                        yunZhi = "卯";
                        yearZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                }
            }
        }
        else if( zhi.equals("卯")) {
            if( hourZhi.equals("亥") ) {
                if( dayZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        hourZhi = "卯";
                        dayZhi = "卯";
                    }
                } 
                else if( monthZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        hourZhi = "卯";
                        monthZhi = "卯";
                    }
                } 
                else if( yearZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        hourZhi = "卯";
                        yearZhi = "卯";
                    }
                }
            } 
            else if( dayZhi.equals("亥") ) {
                if( hourZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        dayZhi = "卯";
                        hourZhi = "卯";
                    }
                } 
                else if( monthZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        dayZhi = "卯";
                        monthZhi = "卯";
                    }
                } 
                else if( yearZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        dayZhi = "卯";
                        yearZhi = "卯";
                    }
                }
            } 
            else if( monthZhi.equals("亥") ) {
                if( hourZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        monthZhi = "卯";
                        hourZhi = "卯";
                    }
                } 
                else if( dayZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        monthZhi = "卯";
                        dayZhi = "卯";
                    }
                } 
                else if( yearZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        monthZhi = "卯";
                        yearZhi = "卯";
                    }
                }
            } 
            else if( yearZhi.equals("亥") ) {
                if( hourZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        yearZhi = "卯";
                        hourZhi = "卯";
                    }
                } 
                else if( dayZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        yearZhi = "卯";
                        dayZhi = "卯";
                    }
                } 
                else if( monthZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        yearZhi = "卯";
                        monthZhi = "卯";
                    }
                }
            }
        }

        if( zhi.equals("申")) {
            if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
                if( hourZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        yunZhi = "子";
                        hourZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( dayZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        yunZhi = "子";
                        dayZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( monthZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        yunZhi = "子";
                        monthZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( yearZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        yunZhi = "子";
                        yearZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                }
            }
        }
        else if( zhi.equals("辰")) {
            if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
                if( hourZhi.equals("申") ) {
                    if( feGanShui > 0) {
                        yunZhi = "子";
                        hourZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( dayZhi.equals("申") ) {
                    if( feGanShui > 0) {
                        yunZhi = "子";
                        dayZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( monthZhi.equals("申") ) {
                    if( feGanShui > 0) {
                        yunZhi = "子";
                        monthZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( yearZhi.equals("申") ) {
                    if( feGanShui > 0) {
                        yunZhi = "子";
                        yearZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                }
            }
        }
        else if( zhi.equals("子")) {
            if( hourZhi.equals("申") ) {
                if( dayZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        hourZhi = "子";
                        dayZhi = "子";
                    }
                } 
                else if( monthZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        hourZhi = "子";
                        monthZhi = "子";
                    }
                } 
                else if( yearZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        hourZhi = "子";
                        yearZhi = "子";
                    }
                }
            } 
            else if( dayZhi.equals("申") ) {
                if( hourZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        dayZhi = "子";
                        hourZhi = "子";
                    }
                } 
                else if( monthZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        dayZhi = "子";
                        monthZhi = "子";
                    }
                } 
                else if( yearZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        dayZhi = "子";
                        yearZhi = "子";
                    }
                }
            } 
            else if( monthZhi.equals("申") ) {
                if( hourZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        monthZhi = "子";
                        hourZhi = "子";
                    }
                } 
                else if( dayZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        monthZhi = "子";
                        dayZhi = "子";
                    }
                } 
                else if( yearZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        monthZhi = "子";
                        yearZhi = "子";
                    }
                }
            } 
            else if( yearZhi.equals("申") ) {
                if( hourZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        yearZhi = "子";
                        hourZhi = "子";
                    }
                } 
                else if( dayZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        yearZhi = "子";
                        dayZhi = "子";
                    }
                } 
                else if( monthZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        yearZhi = "子";
                        monthZhi = "子";
                    }
                } 
            }
        }

        if( zhi.equals("巳")) {
            if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
                if( hourZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        yunZhi = "酉";
                        hourZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( dayZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        yunZhi = "酉";
                        dayZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( monthZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        yunZhi = "酉";
                        monthZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( yearZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        yunZhi = "酉";
                        yearZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                }
            }
        }
        else if( zhi.equals("丑")) {
            if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
                if( hourZhi.equals("巳") ) {
                    if( feGanJin > 0) {
                        yunZhi = "酉";
                        hourZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( dayZhi.equals("巳") ) {
                    if( feGanJin > 0) {
                        yunZhi = "酉";
                        dayZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( monthZhi.equals("巳") ) {
                    if( feGanJin > 0) {
                        yunZhi = "酉";
                        monthZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                } 
                else if( yearZhi.equals("巳") ) {
                    if( feGanJin > 0) {
                        yunZhi = "酉";
                        yearZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，改为" + fnComputeShishen(dayGan, yunZhi) + "运，"; 
                    }
                }
            }
        }
        else if( zhi.equals("酉")) {
            if( hourZhi.equals("巳") ) {
                if( dayZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        hourZhi = "酉";
                        dayZhi = "酉";
                    }
                } 
                else if( monthZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        hourZhi = "酉";
                        monthZhi = "酉";
                    }
                } 
                else if( yearZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        hourZhi = "酉";
                        yearZhi = "酉";
                    }
                }
            } 
            else if( dayZhi.equals("巳") ) {
                if( hourZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        dayZhi = "酉";
                        hourZhi = "酉";
                    }
                } 
                else if( monthZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        dayZhi = "酉";
                        monthZhi = "酉";
                    }
                } 
                else if( yearZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        dayZhi = "酉";
                        yearZhi = "酉";
                    }
                }
            } 
            else if( monthZhi.equals("巳") ) {
                if( hourZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        monthZhi = "酉";
                        hourZhi = "酉";
                    }
                } 
                else if( dayZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        monthZhi = "酉";
                        dayZhi = "酉";
                    }
                } 
                else if( yearZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        monthZhi = "酉";
                        yearZhi = "酉";
                    }
                }
            }
            else if( yearZhi.equals("巳") ) {
                if( hourZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        yearZhi = "酉";
                        hourZhi = "酉";
                    }
                } 
                else if( dayZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        yearZhi = "酉";
                        dayZhi = "酉";
                    }
                } 
                else if( monthZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        yearZhi = "酉";
                        monthZhi = "酉";
                    }
                } 
            }
        }

        //#endregion

        shenYearGan = fnComputeShishen(dayGan, yearGan);
        shenYearZhi = fnComputeShishen(dayGan, yearZhi);
        shenMonthGan = fnComputeShishen(dayGan, monthGan);
        shenMonthZhi = fnComputeShishen(dayGan, monthZhi);
        shenDayZhi = fnComputeShishen(dayGan, dayZhi);
        shenHourGan = fnComputeShishen(dayGan, hourGan);
        shenHourZhi = fnComputeShishen(dayGan, hourZhi);
        shenYunGan = fnComputeShishen(dayGan, yunGan);
        shenYunZhi = fnComputeShishen(dayGan, yunZhi);

        if( gan.equals(yunGan) ) {
            if( key == true ) str = str + "天干大运为" + shenYunGan + "运，";
        }
        if( zhi.equals(yunZhi) ) {
            if( key == true ) str = str + "地支大运为" + shenYunZhi + "运，";
        }

        //#region 统计十神个数，生克个数
        ///年干
        if( shenYearGan.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenYearGan.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenYearGan.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenYearGan.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenYearGan.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenYearGan.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenYearGan.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenYearGan.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenYearGan.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenYearGan.equals("才") ) {
            caip++;
            ke++;
        }

        ///年支
        if( shenYearZhi.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenYearZhi.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenYearZhi.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenYearZhi.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenYearZhi.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenYearZhi.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenYearZhi.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenYearZhi.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenYearZhi.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenYearZhi.equals("才") ) {
            caip++;
            ke++;
        }
        
        ///月干
        if( shenMonthGan.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenMonthGan.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenMonthGan.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenMonthGan.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenMonthGan.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenMonthGan.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenMonthGan.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenMonthGan.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenMonthGan.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenMonthGan.equals("才") ) {
            caip++;
            ke++;
        }

        ///月支
        if( shenMonthZhi.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenMonthZhi.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenMonthZhi.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenMonthZhi.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenMonthZhi.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenMonthZhi.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenMonthZhi.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenMonthZhi.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenMonthZhi.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenMonthZhi.equals("才") ) {
            caip++;
            ke++;
        }

        ///日支
        if( shenDayZhi.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenDayZhi.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenDayZhi.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenDayZhi.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenDayZhi.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenDayZhi.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenDayZhi.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenDayZhi.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenDayZhi.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenDayZhi.equals("才") ) {
            caip++;
            ke++;
        }

        ///时干
        if( shenHourGan.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenHourGan.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenHourGan.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenHourGan.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenHourGan.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenHourGan.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenHourGan.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenHourGan.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenHourGan.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenHourGan.equals("才") ) {
            caip++;
            ke++;
        }

        ///时支
        if( shenHourZhi.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenHourZhi.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenHourZhi.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenHourZhi.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenHourZhi.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenHourZhi.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenHourZhi.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenHourZhi.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenHourZhi.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenHourZhi.equals("才") ) {
            caip++;
            ke++;
        }

        ///运干
        if( shenYunGan.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenYunGan.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenYunGan.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenYunGan.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenYunGan.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenYunGan.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenYunGan.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenYunGan.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenYunGan.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenYunGan.equals("才") ) {
            caip++;
            ke++;
        }

        ///运支
        if( shenYunZhi.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenYunZhi.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenYunZhi.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenYunZhi.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenYunZhi.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenYunZhi.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenYunZhi.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenYunZhi.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenYunZhi.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenYunZhi.equals("才") ) {
            caip++;
            ke++;
        }

        //#endregion

        /// 克   官主财印食官
        /// 生   印主食财官印 

        if( key == true) str = str + "走" + shenYunGan + shenYunZhi + "运：";
        if( fate == 0 || fate == 1 ) { /// 第一，第二个大运
            if( shenYunGan.equals("官") || shenYunGan.equals("煞")) {
                if( shenYunZhi.equals("官") || shenYunZhi.equals("煞")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "学习一般，虽然调皮但是讨人喜欢。";
                    }
                    else { /// 身弱
                        str = str + "学习一般，爱惹事情。";
                    }
                }
                else if( shenYunZhi.equals("印") || shenYunZhi.equals("枭")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "比较懂事，学习好。";
                    }
                    else { /// 身弱
                        str = str + "比较调皮，学习好。";
                    }
                }
                else if( shenYunZhi.equals("比") || shenYunZhi.equals("劫")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "比较懂事，比较要强。";
                    }
                    else { /// 身弱
                        str = str + "爱惹事，比较任性。";
                    }
                }
                else if( shenYunZhi.equals("食") || shenYunZhi.equals("伤")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "比较懂事，有才艺，表现好。";
                    }
                    else { /// 身弱
                        str = str + "比较调皮，易有病。";
                    }
                }
                else if( shenYunZhi.equals("财") || shenYunZhi.equals("才")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "比较懂事，讨人喜欢，不爱学习。";
                    }
                    else { /// 身弱
                        str = str + "爱惹事。不爱学习。易有病。";
                    }
                }
                if(fate == 1) str = str + "有可能当学生干部。";            
            }
            else if( shenYunGan.equals("印") || shenYunGan.equals("枭")) {
                if( shenYunZhi.equals("官") || shenYunZhi.equals("煞")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "比较懂事，学习好。";
                    }
                    else { /// 身弱
                        str = str + "比较调皮，学习好。";
                    }
                    if(fate == 1) str = str + "有可能当学生干部。";                
                }
                else if( shenYunZhi.equals("印") || shenYunZhi.equals("枭")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "爱学习。比较要强。";
                    }
                    else { /// 身弱
                        str = str + "学习好，有个性。";
                    }
                }
                else if( shenYunZhi.equals("比") || shenYunZhi.equals("劫")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "学习好，比较调皮，表现好。";
                    }
                    else { /// 身弱
                        str = str + "学习好，比较要强。";
                    }
                }
                else if( shenYunZhi.equals("食") || shenYunZhi.equals("伤")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "学习好，表现好。";
                    }
                    else { /// 身弱
                        str = str + "学习好，有些任性。";
                    }
                }
                else if( shenYunZhi.equals("财") || shenYunZhi.equals("才")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "学习有波动，最后往好的方向发展。";
                    }
                    else { /// 身弱
                        str = str + "学习有波动，最后往坏的方向发展。";
                    }
                }
            }
            else if( shenYunGan.equals("比") || shenYunGan.equals("劫")) {
                if( shenYunZhi.equals("官") || shenYunZhi.equals("煞")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "比较懂事，有些要强。";
                    }
                    else { /// 身弱
                        str = str + "爱惹事，有些任性。";
                    }
                    if(fate == 1) str = str + "有可能当学生干部。";
                }
                else if( shenYunZhi.equals("印") || shenYunZhi.equals("枭")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "学习好，比较调皮，表现好。";
                    }
                    else { /// 身弱
                        str = str + "学习好，比较要强。";
                    }

                }
                else if( shenYunZhi.equals("比") || shenYunZhi.equals("劫")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "学习一般，比较任性。";
                    }
                    else { /// 身弱
                        str = str + "学习一般，比较要强。";
                    }
                }
                else if( shenYunZhi.equals("食") || shenYunZhi.equals("伤")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "学习一般，比较要强，表现好。";
                    }
                    else { /// 身弱
                        str = str + "学习一般，比较要强，有些任性。";
                    }
                }
                else if( shenYunZhi.equals("财") || shenYunZhi.equals("才")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "不爱学习，比较任性。";
                    }
                    else { /// 身弱
                        str = str + "不爱学习，比较要强。";
                    }
                }
            }
            else if( shenYunGan.equals("食") || shenYunGan.equals("伤")) {
                if( shenYunZhi.equals("官") || shenYunZhi.equals("煞")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "比较懂事，有才艺，表现好。";
                    }
                    else { /// 身弱
                        str = str + "比较调皮，易有病。";
                    }
                    if(fate == 1) str = str + "有可能当学生干部。";
                }
                else if( shenYunZhi.equals("印") || shenYunZhi.equals("枭")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "学习好，表现好。";
                    }
                    else { /// 身弱
                        str = str + "学习好，有些任性。";
                    }
                }
                else if( shenYunZhi.equals("比") || shenYunZhi.equals("劫")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "学习一般，比较要强，表现好。";
                    }
                    else { /// 身弱
                        str = str + "学习一般，比较要强，有些任性。";
                    }
                }
                else if( shenYunZhi.equals("食") || shenYunZhi.equals("伤")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "学习一般，有才艺，表现好。";
                    }
                    else { /// 身弱
                        str = str + "学习一般，有些任性，易有病。";
                    }
                }
                else if( shenYunZhi.equals("财") || shenYunZhi.equals("才")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "不爱学习，有才艺，表现好。";
                    }
                    else { /// 身弱
                        str = str + "不爱学习，有些任性，易有病。";
                    }
                }
            }
            else if( shenYunGan.equals("财") || shenYunGan.equals("才")) {
                if( shenYunZhi.equals("官") || shenYunZhi.equals("煞")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "比较懂事，讨人喜欢，不爱学习。";
                    }
                    else { /// 身弱
                        str = str + "爱惹事。不爱学习。易有病。";
                    }
                    if(fate == 1) str = str + "有可能当学生干部。";
                }
                else if( shenYunZhi.equals("印") || shenYunZhi.equals("枭")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "学习有波动，最后往好的方向发展。";
                    }
                    else { /// 身弱
                        str = str + "学习有波动，最后往坏的方向发展。";
                    }
                }
                else if( shenYunZhi.equals("比") || shenYunZhi.equals("劫")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "不爱学习，比较任性。";
                    }
                    else { /// 身弱
                        str = str + "不爱学习，比较要强。";
                    }
                }
                else if( shenYunZhi.equals("食") || shenYunZhi.equals("伤")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "不爱学习，有才艺，表现好。";
                    }
                    else { /// 身弱
                        str = str + "不爱学习，有些任性，易有病。";
                    }
                }
                else if( shenYunZhi.equals("财") || shenYunZhi.equals("才")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "不爱学习。";
                    }
                    else { /// 身弱
                        str = str + "不爱学习，易有病。";
                    }
                }
            }

            return str;
        }

        if( shenYunGan.equals("官") || shenYunGan.equals("煞")) {
            if( shenYunZhi.equals("官") || shenYunZhi.equals("煞")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 大运相对较好，事业有发展。";
                    if( (bi + jie ) >= 2 ) {
                        str = str + "有同事或者朋友帮忙解决事业问题。";
                    }
                    if( (yin + xiao ) >= 2 ) {
                        str = str + "有长辈或者贵人帮忙解决事业问题。";
                    }
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str + (key == true ? "走官官运：" : "") + "大运相对较好，事业有发展。";
                    }
                    else {
                        str = str + (key == true ? " 走官官运：" : "") + "大运相对不好，即使有仕途，但工作压力变大，或者会有官司缠身。";
                    }
                    if( shang > 0 && (yin + xiao) == 0 ) {
                        str = str + (key == true ? "有伤官，" : "") + "有官司缠身的概率较大。";
                    }
                }
                if( !shenYunGan.equals(shenYunZhi) ) {
                    str = str + (key == true ? "官杀混杂，" : "") + "事业易有波折。";
                }

                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + (key == true ? "女生走官运，" : "") + "可能会有婚姻变动。";                 
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                        if( ke > sheng ) {
                            str = str + "易有情色纠纷。";
                        }
                    }
                }
            }
            else if( shenYunZhi.equals("印") || shenYunZhi.equals("枭")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 大运相对较好，事业有发展，有贵人相助。在学业，技术等方面可有提高。对财运不好。可能会名誉受损。";
                }
                else { /// 身弱
                    str = str + " 大运相对一般，事业有发展。学业，技术等方面可有提高。对财运不好。";
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + "女生走官运，可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
            else if( shenYunZhi.equals("比") || shenYunZhi.equals("劫")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 大运相对较好，事业发展较好，有同事或者朋友相助。";
                }
                else { /// 身弱
                    str = str + " 大运相对一般，事业有发展。财运可能会变好一些。";
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + "女生走官运，可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
            else if( shenYunZhi.equals("食") || shenYunZhi.equals("伤")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (yin + xiao) > 0) {
                        if( (caip + caiz) > 0 ) {
                            str = str + (key == true ? " 有印克制食伤，": "") + "大运相对较好，财运官运都有发展。";
                        }
                        else {
                            str = str + (key == true ? " 有印克制食伤，": "") + "大运相对还行，事业有发展。";
                        }
                    }
                    else {
                        str = str + (key == true ? " 无印克制，": "") + "大运相对一般，事业有波动，但是往好的方向发展。";
                    }
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str + " 大运相对较好，事业有波动，但是往好的方向发展。";
                    }
                    else {
                        str = str + " 大运相对不好，事业下行，还有可能官司缠身。易得伤病。";
                    }
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + "女生走官运，可能会有异性缘，但不易成婚。";
                    }
                    else {
                        str = str + "有异性缘，也容易伤及家庭。";
                    }
                }
            }
            else if( shenYunZhi.equals("财") || shenYunZhi.equals("才")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 大运相对较好，财运官运都有发展。";
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str+ " 大运相对较好，财运官运都有发展。";
                    }
                    else {
                        str = str + " 大运相对不好，事业有波动，财运有波动，或者往好的方向发展则很辛苦，或者往不好方向发展。天克地冲易得伤病。";
                    }
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + "女生走官运，可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
        }
        else if( shenYunGan.equals("印") || shenYunGan.equals("枭")) {
            if( shenYunZhi.equals("官") || shenYunZhi.equals("煞")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 大运相对较好，事业有发展，有贵人相助。在学业，技术等方面可有提高。对财运不好。可能会名誉受损。";
                }
                else { /// 身弱
                    str = str + " 大运相对一般，事业有发展。学业，技术等方面可有提高。对财运不好。";
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + "女生走官运，可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
            else if( shenYunZhi.equals("印") || shenYunZhi.equals("枭")) {
                if( sheng >= ke  ) {  /// 身强
                    if( zpSheng < zpKe ) {
                        str = str + "大运相对较好，财运官运都有发展。在学业，技术等方面可有提高。";
                    }
                    else {
                        str = str + " 大运相对不好，在学业，技术等方面可有提高。对财运不好。可能会名誉受损。";
                    }
                }
                else { /// 身弱
                    str = str + " 大运相对较好，学业，技术等方面可有提高。有人相帮，各个方面都会顺利。财运不佳。";
                }
            }
            else if( shenYunZhi.equals("比") || shenYunZhi.equals("劫")) {
                if( sheng >= ke  ) {  /// 身强
                    if( zpSheng < zpKe ) {
                        str = str + "大运相对较好，财运官运都有发展。在学业，技术等方面可有提高。";
                    }
                    else {
                        str = str + " 大运相对不好，在学业，技术等方面可有提高。对财运不好，被亲朋所累。可能会名誉受损。";
                    }
                }
                else { /// 身弱
                    str = str + " 大运相对较好，学业，技术等方面可有提高。有人相帮，有同事朋友相助，各个方面都会顺利。";
                }
            }
            else if( shenYunZhi.equals("食") || shenYunZhi.equals("伤")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (caip + caiz) > 0 ) {
                        str = str + " 大运相对较好，在学业，技术等方面可有提高。财运较好。";
                    }
                    else {
                        str = str + " 大运相对一般，在学业，技术等方面可有提高。事业会有波动，相对向好的方向发展。";
                    }
                }
                else { /// 身弱
                    str = str + " 大运相对一般，学业，技术等方面可有提高。财运会有发展的机会。";
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) > 0 ) {
                        str = str + "对家庭或婚姻有不好的影响。";
                    }
                }
            }
            else if( shenYunZhi.equals("财") || shenYunZhi.equals("才")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (shi + shang) > 0 ) {
                        str = str + " 大运相对较好，在学业，技术等方面可有提高。财运较好。";
                    }
                    else {
                        str = str + " 大运相对一般，在学业，技术等方面可有提高。财运会有波动，相对向好的方向发展。";
                    }
                }
                else { /// 身弱
                    str = str + " 大运相对一般，学业，技术等方面可有提高。或者财运或者事业会有不好的影响。";
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
        }
        else if( shenYunGan.equals("比") || shenYunGan.equals("劫")) {
            if( shenYunZhi.equals("官") || shenYunZhi.equals("煞")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 大运相对较好，事业发展较好，有同事或者朋友相助。";
                }
                else { /// 身弱
                    str = str + " 大运相对一般，事业有发展。财运可能会变好一些。";
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + "女生走官运，可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
            else if( shenYunZhi.equals("印") || shenYunZhi.equals("枭")) {
                if( sheng >= ke  ) {  /// 身强
                    if( zpSheng < zpKe ) {
                        str = str + "大运相对较好，财运官运都有发展。在学业，技术等方面可有提高。";
                    }
                    else {
                        str = str + " 大运相对不好，在学业，技术等方面可有提高。对财运不好，被亲朋所累。可能会名誉受损。";
                    }
                }
                else { /// 身弱
                    str = str + " 大运相对较好，学业，技术等方面可有提高。有人相帮，有同事朋友相助，各个方面都会顺利。";
                }
            }
            else if( shenYunZhi.equals("比") || shenYunZhi.equals("劫")) {
                if( sheng >= ke  ) {  /// 身强
                    if( zpSheng < zpKe ) {
                        str = str + "大运相对较好，财运官运都有发展。";
                    }
                    else {
                        str = str + " 大运相对不好，对财运不好，被亲朋所累。";
                    }
                }
                else { /// 身弱
                    str = str + " 大运相对一般，有同事朋友相助，事业相对顺利。财运相对变好一些。";
                }
            }
            else if( shenYunZhi.equals("食") || shenYunZhi.equals("伤")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (caip + caiz) > 0) {
                        str = str + " 大运相对一般，有财运，易被亲朋所累。";
                    }
                    else {
                        str = str + " 大运相对一般，被亲朋所累，事业往不利的方向有点儿波动。";
                    }
                }
                else { /// 身弱
                    str = str + " 大运相对不好，虽然有同事朋友相助，事业有波动相对向不利方向发展。或者易破财，易得伤病。";
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) > 0 ) {
                        str = str + "对家庭或婚姻有不好的影响。";
                    }
                }
            }
            else if( shenYunZhi.equals("财") || shenYunZhi.equals("才")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 大运相对较好，会有财运，小心亲朋夺财。";
                }
                else { /// 身弱
                    str = str + " 大运相对一般，会有点儿财运，但要小心努力获取。";
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
        }
        else if( shenYunGan.equals("食") || shenYunGan.equals("伤")) {
            if( shenYunZhi.equals("官") || shenYunZhi.equals("煞")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (yin + xiao) > 0) {
                        if( (caip + caiz) > 0 ) {
                            str = str + " 大运相对较好，有印克制食伤，财运官运都有发展。";
                        }
                        else {
                            str = str + " 大运相对一般，有印克制食伤，事业有发展。";
                        }
                    }
                    else {
                        str = str + (key == true ? " 无印克制，": "") + "大运相对一般，事业有波动，但是往好的方向发展。";
                    }
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str + "大运相对较好，事业有波动，但是往好的方向发展。";
                    }
                    else {
                        str = str + " 大运相对不好，事业下行，还有可能官司缠身。易得伤病。";
                    }
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + "女生走官运，可能会有异性缘，但不易成婚。";
                    }
                    else {
                        str = str + "有异性缘，也容易伤及家庭。";
                    }
                }
            }
            else if( shenYunZhi.equals("印") || shenYunZhi.equals("枭")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (caip + caiz) > 0 ) {
                        str = str + " 大运相对较好，在学业，技术等方面可有提高。财运较好。";
                    }
                    else {
                        str = str + " 大运相对一般，在学业，技术等方面可有提高。事业会有波动，相对向好的方向发展。";
                    }
                }
                else { /// 身弱
                    str = str + " 大运相对一般，学业，技术等方面可有提高。财运会有发展的机会。";
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) > 0 ) {
                        str = str + "对家庭或婚姻有不好的影响。";
                    }
                }
            }
            else if( shenYunZhi.equals("比") || shenYunZhi.equals("劫")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (caip + caiz) > 0) {
                        str = str + " 大运相对一般，有财运，被亲朋所累。";
                    }
                    else {
                        str = str + " 大运相对一般，被亲朋所累，事业往不利的方向有点儿波动。";
                    }
                }
                else { /// 身弱
                    str = str + " 大运相对不好，虽有同事朋友相助，事业有波动相对向不利方向发展。或者易破财，易得伤病。";
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) > 0 ) {
                        str = str + "对家庭或婚姻有不好的影响。";
                    }
                }
            }
            else if( shenYunZhi.equals("食") || shenYunZhi.equals("伤")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (caip + caiz) > 0) {
                        str = str + " 大运相对一般，有财运，事业上能有发展。";
                    }
                    else {
                        str = str + " 大运相对一般，在事业上有表现得机会，事业能得到发展。易得小伤小病。";
                    }
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str + "大运相对较好，事业、财运上能有发展。";
                    }
                    else {
                        str = str + " 大运相对不好，对事业不好。易破财，易得伤病。";
                    }
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) > 0 ) {
                        str = str + "对家庭或婚姻有不好的影响。";
                    }
                }
            }
            else if( shenYunZhi.equals("财") || shenYunZhi.equals("才")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 大运相对较好，有财运。事业有发展。";
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str + "大运相对较好，事业、财运上能有发展。";
                    }
                    else {
                        str = str + " 大运相对不好，对事业不好。易破财，易得伤病。";
                    }
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) > 0 ) {
                        str = str + "对家庭或婚姻有不好的影响。";
                    }
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
        }
        else if( shenYunGan.equals("财") || shenYunGan.equals("才")) {
            if( shenYunZhi.equals("官") || shenYunZhi.equals("煞")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 大运相对较好，财运官运都有发展。";
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str + "大运相对较好，财运官运都有发展。";
                    }
                    else {
                        str = str + " 大运相对不好，事业有波动，财运有波动，或者往好的方向发展则很辛苦，或者往不好方向发展。天冲地克易得伤病。";
                    }
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + "女生走官运，可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
            else if( shenYunZhi.equals("印") || shenYunZhi.equals("枭")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (shi + shang) > 0 ) {
                        str = str + " 大运相对较好，在学业，技术等方面可有提高。财运较好。";
                    }
                    else {
                        str = str + " 大运相对一般，在学业，技术等方面可有提高。财运会有波动，相对向好的方向发展。";
                    }
                }
                else { /// 身弱
                    str = str + " 大运相对一般，学业，技术等方面可有提高。或者财运或者事业会有不好的影响。";
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
            else if( shenYunZhi.equals("比") || shenYunZhi.equals("劫")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 大运相对较好，会有财运，小心亲朋夺财。";
                }
                else { /// 身弱
                    str = str + " 大运相对一般，会有点儿财运，但要小心努力获取。";
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
            else if( shenYunZhi.equals("食") || shenYunZhi.equals("伤")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 大运相对较好，有财运。事业有发展。";
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str + "大运相对较好，事业、财运上能有发展。";
                    }
                    else {
                        str = str + " 大运相对不好，对事业不好。易破财，易得伤病。";
                    }
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) > 0 ) {
                        str = str + "对家庭或婚姻有不好的影响。";
                    }
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
            else if( shenYunZhi.equals("财") || shenYunZhi.equals("才")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 大运相对较好，有财运，事业有发展。";
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str + "大运相对较好，事业、财运上能有发展。";
                    }
                    else {
                        str = str + " 大运相对不好，对事业不好。易破财。";
                    }
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
        }
        
        return str;
    }

    public String fnSelfPayLiuNianShiShen(String gan, String zhi, String yGan, String yZhi, boolean key, Integer age) {
        /// 算每一个流年的运程, 把大运合流年的合算进来以后，重新计算十神

        String  str = "";

        String yearGan = bazi.yearGan;
        String yearZhi = bazi.yearZhi;
        String monthGan = bazi.monthGan;
        String monthZhi = bazi.monthZhi;
        String dayGan = bazi.dayGan;
        String dayZhi = bazi.dayZhi;
        String hourGan = bazi.hourGan;
        String hourZhi = bazi.hourZhi;
        String yunGan = yGan;
        String yunZhi = yZhi;
        String liuGan = gan;
        String liuZhi = zhi;
        String shenYearGan = "";
        String shenYearZhi = "";
        String shenMonthGan = "";
        String shenMonthZhi = "";
        String shenDayZhi = "";
        String shenHourGan = "";
        String shenHourZhi = "";
        String shenYunGan = "";
        String shenYunZhi = "";
        String shenLiuGan = "";
        String shenLiuZhi = "";

        Integer guan = 0;
        Integer sha = 0;
        Integer yin = 0;
        Integer xiao = 0;
        Integer bi = 0;
        Integer jie = 0;
        Integer shi = 0;
        Integer shang = 0;
        Integer caiz = 0;
        Integer caip = 0;
        Integer sheng = 1;
        Integer ke = 0;

        /// 根据天干五合，重新计算天干的五行

        //#region 天干五合
        if( gan.equals("甲") && ( yGan.equals("己") || hourGan.equals("己") || dayGan.equals("己") || 
                monthGan.equals("己") || yearGan.equals("己") ) ) {
            if( feTu > 0 ) {
                liuGan = "己";
                if( key == true ) str = str + "天干由甲己合化土，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
            }
        }
        if( gan.equals("己") ) {
            if( hourGan.equals("甲") ) {
                if( feTu > 0 ) {
                    hourGan = "己";
                }
            }
            else if( monthGan.equals("甲") ) {
                if( feTu > 0 ) {
                    monthGan = "己";
                }
            }
            else if( yearGan.equals("甲") ) {
                if( feTu > 0 ) {
                    yearGan = "己";
                }
            }
            else if( yGan.equals("甲") ) {
                if( feTu > 0 ) {
                    yunGan = "己";
                }
            }
        }

        if( gan.equals("乙") && (  yGan.equals("庚") || hourGan.equals("庚") || dayGan.equals("庚") || 
                monthGan.equals("庚") || yearGan.equals("庚") ) ) {
            if( feJin > 0 ) {
                liuGan = "庚";
                if( key == true ) str = str + "天干由乙庚合化金，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
            }
        }
        if( gan.equals("庚") ) {
            if( hourGan.equals("乙") ) {
                if( feJin > 0 ) {
                    hourGan = "庚";
                }
            }
            else if( monthGan.equals("乙") ) {
                if( feJin > 0 ) {
                    monthGan = "庚";
                }
            }
            else if( yearGan.equals("乙") ) {
                if( feJin > 0 ) {
                    yearGan = "庚";
                }
            }
            else if( yGan.equals("乙") ) {
                if( feJin > 0 ) {
                    yunGan = "庚";
                }
            }
        } 

        if( gan.equals("丙") ) {
            if( hourGan.equals("辛") ) {
                if( feShui > 0 ) {
                    hourGan = "壬";
                    liuGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( dayGan.equals("辛") ) {
                if( feShui > 0 ) {
                    liuGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( monthGan.equals("辛") ) {
                if( feShui > 0 ) {
                    monthGan = "壬";
                    liuGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( yearGan.equals("辛") ) {
                if( feShui > 0 ) {
                    yearGan = "壬";
                    liuGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( yGan.equals("辛") ) {
                if( feShui > 0 ) {
                    yunGan = "壬";
                    liuGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
        }
        if( gan.equals("辛") ) {
            if( hourGan.equals("丙") ) {
                if( feShui > 0 ) {
                    hourGan = "壬";
                    liuGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，流年天干改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( dayGan.equals("丙") ) {
                if( feShui > 0 ) {
                    liuGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( monthGan.equals("丙") ) {
                if( feShui > 0 ) {
                    monthGan = "壬";
                    liuGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，流年天干改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( yearGan.equals("丙") ) {
                if( feShui > 0 ) {
                    yearGan = "壬";
                    liuGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( yGan.equals("丙") ) {
                if( feShui > 0 ) {
                    yunGan = "壬";
                    liuGan = "壬";
                    if( key == true ) str = str + "天干由丙辛合化水，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
        }

        if( gan.equals("丁") ) {
            if( hourGan.equals("壬") ) {
                if( feMu > 0 ) {
                    hourGan = "乙";
                    liuGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，流年天干改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( dayGan.equals("壬") ) {
                if( feMu > 0 ) {
                    liuGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( monthGan.equals("壬") ) {
                if( feMu > 0 ) {
                    monthGan = "乙";
                    liuGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( yearGan.equals("壬") ) {
                if( feMu > 0 ) {
                    yearGan = "乙";
                    liuGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，流年天干改为" + fnComputeShishen(dayGan, yunGan) + "运，"; 
                }
            }
            else if( yGan.equals("壬") ) {
                if( feMu > 0 ) {
                    yunGan = "乙";
                    liuGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
        }
        if( gan.equals("壬") ) {
            if( hourGan.equals("丁") ) {
                if( feMu > 0 ) {
                    hourGan = "乙";
                    liuGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( dayGan.equals("丁") ) {
                if( feMu > 0 ) {
                    liuGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( monthGan.equals("丁") ) {
                if( feMu > 0 ) {
                    monthGan = "乙";
                    liuGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( yearGan.equals("丁") ) {
                if( feMu > 0 ) {
                    yearGan = "乙";
                    liuGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( yGan.equals("丁") ) {
                if( feMu > 0 ) {
                    yunGan = "乙";
                    liuGan = "乙";
                    if( key == true ) str = str + "天干由丁壬合化木，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
        }

        if( gan.equals("戊") ) {
            if( hourGan.equals("癸") ) {
                if( feHuo > 0 ) {
                    hourGan = "丁";
                    liuGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( dayGan.equals("癸") ) {
                if( feHuo > 0 ) {
                    liuGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( monthGan.equals("癸") ) {
                if( feHuo > 0 ) {
                    monthGan = "丁";
                    liuGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( yearGan.equals("癸") ) {
                if( feHuo > 0 ) {
                    yearGan = "丁";
                    liuGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( yGan.equals("癸") ) {
                if( feHuo > 0 ) {
                    yunGan = "丁";
                    liuGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
        }
        if( gan.equals("癸") ) {
            if( hourGan.equals("戊") ) {
                if( feHuo > 0 ) {
                    hourGan = "丁";
                    liuGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( dayGan.equals("戊") ) {
                if( feHuo > 0 ) {
                    liuGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( monthGan.equals("戊") ) {
                if( feHuo > 0 ) {
                    monthGan = "丁";
                    liuGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( yearGan.equals("戊") ) {
                if( feHuo > 0 ) {
                    yearGan = "丁";
                    liuGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
            else if( yGan.equals("戊") ) {
                if( feHuo > 0 ) {
                    yunGan = "丁";
                    liuGan = "丁";
                    if( key == true ) str = str + "天干由戊癸合化火，流年天干改为" + fnComputeShishen(dayGan, liuGan) + "运，"; 
                }
            }
        }
        //#endregion

        //#region 地支六合
        if( zhi.equals("子") && ( yZhi.equals("丑") || hourZhi.equals("丑") || dayZhi.equals("丑") || 
                                            monthZhi.equals("丑") || yearZhi.equals("丑") ) ) {
            if( feGanTu > 0) {
                liuZhi = "丑";
                if( key == true ) str = str + "地支由子丑合化土，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
            }
        }
        if( zhi.equals("丑") ) {
            if( hourZhi.equals("子") ) {
                if( feGanTu > 0) {
                    hourZhi = "丑";
                    liuZhi = "丑";
                }
            }
            else if( dayZhi.equals("子") ) {
                if( feGanTu > 0) {
                    dayZhi = "丑";
                    liuZhi = "丑";
                }
            }
            else if( monthZhi.equals("子") ) {
                if( feGanTu > 0) {
                    monthZhi = "丑";
                    liuZhi = "丑";
                }
            }
            else if( yearZhi.equals("子") ) {
                if( feGanTu > 0) {
                    yearZhi = "丑";
                    liuZhi = "丑";
                }
            }
            else if( yZhi.equals("子") ) {
                if( feGanTu > 0) {
                    yunZhi = "丑";
                    liuZhi = "丑";
                }
            }
        }

        if( zhi.equals("亥") && ( yZhi.equals("寅") || hourZhi.equals("寅") || dayZhi.equals("寅") || 
                                            monthZhi.equals("寅") || yearZhi.equals("寅") ) ) {
            if( feGanMu > 0) {
                liuZhi = "寅";
                if( key == true ) str = str + "地支由亥寅合化木，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
            }
        }
        if( zhi.equals("寅") ) {
            if( hourZhi.equals("亥") ) {
                if( feGanMu > 0) {
                    hourZhi = "寅";
                }    
            }
            else if( dayZhi.equals("亥") ) {
                if( feGanMu > 0) {
                    dayZhi = "寅";
                }
            }
            else if( monthZhi.equals("亥") ) {
                if( feGanMu > 0) {
                    monthZhi = "寅";
                }
            }
            else if( yearZhi.equals("亥") ) {
                if( feGanMu > 0) {
                    yearZhi = "寅";
                }
            }
            else if( yZhi.equals("亥") ) {
                if( feGanMu > 0) {
                    yunZhi = "寅";
                }
            }
        }

        if( zhi.equals("卯") ) {
            if ( hourZhi.equals("戌") ) {
                if( feGanHuo > 0) {
                    liuZhi = "巳";
                    hourZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
            }
            else if( dayZhi.equals("戌") ) {
                if( feGanHuo > 0) {
                    liuZhi = "巳";
                    dayZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
            }
            else if( monthZhi.equals("戌") ) {
                if( feGanHuo > 0) {
                    liuZhi = "巳";
                    monthZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
            } 
            else if( yearZhi.equals("戌") ) {
                if( feGanHuo > 0) {
                    liuZhi = "巳";
                    yearZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
            }
            else if( yZhi.equals("戌") ) {
                if( feGanHuo > 0) {
                    liuZhi = "巳";
                    yunZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
            }
        }
        if( zhi.equals("戌") ) {
            if ( hourZhi.equals("卯") ) {
                if( feGanHuo > 0) {
                    liuZhi = "巳";
                    hourZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
            }
            else if( dayZhi.equals("卯") ) {
                if( feGanHuo > 0) {
                    liuZhi = "巳";
                    dayZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
            }
            else if( monthZhi.equals("卯") ) {
                if( feGanHuo > 0) {
                    liuZhi = "巳";
                    monthZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
            } 
            else if( yearZhi.equals("卯") ) {
                if( feGanHuo > 0) {
                    liuZhi = "巳";
                    yearZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
            }
            else if( yZhi.equals("卯") ) {
                if( feGanHuo > 0) {
                    liuZhi = "巳";
                    yunZhi = "巳";
                    if( key == true ) str = str + "地支由卯戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
            }
        }

        if( zhi.equals("辰") && ( yZhi.equals("酉") || hourZhi.equals("酉") || dayZhi.equals("酉") || 
                                            monthZhi.equals("酉") || yearZhi.equals("酉") ) ) {
            if( feGanJin > 0) {
                liuZhi = "酉";
                if( key == true ) str = str + "地支由辰酉合化金，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
            }
        }
        if( zhi.equals("酉") ) {
            if( hourZhi.equals("辰") ) {
                if( feGanJin > 0) {
                    hourZhi = "酉";
                }
            }
            else if( dayZhi.equals("辰") ) {
                if( feGanJin > 0) {
                    dayZhi = "酉";
                }
            } 
            else if( monthZhi.equals("辰") ) {
                if( feGanJin > 0) {
                    monthZhi = "酉";
                }
            }
            else if( yearZhi.equals("辰") ) {
                if( feGanJin > 0) {
                    yearZhi = "酉";
                }
            }   
            else if( yZhi.equals("辰") ) {
                if( feGanJin > 0) {
                    yunZhi = "酉";
                }
            }   
        }

        if( zhi.equals("巳") ) {
            if( hourZhi.equals("申") ) {
                if( feGanShui > 0) {
                    liuZhi = "癸";
                    hourZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }    
            } 
            else if( dayZhi.equals("申") ) {
                if( feGanShui > 0) {
                    liuZhi = "癸";
                    dayZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }    
            } 
            else if( monthZhi.equals("申") ) {
                if( feGanShui > 0) {
                    liuZhi = "癸";
                    monthZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }    
            } 
            else if( yearZhi.equals("申") )  {
                if( feGanShui > 0) {
                    liuZhi = "癸";
                    yearZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }    
            }
            else if( yZhi.equals("申") )  {
                if( feGanShui > 0) {
                    liuZhi = "癸";
                    yunZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }    
            }
        }
        if( zhi.equals("申") ) {
            if( hourZhi.equals("巳") ) {
                if( feGanShui > 0) {
                    liuZhi = "癸";
                    hourZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }    
            } 
            else if( dayZhi.equals("巳") ) {
                if( feGanShui > 0) {
                    liuZhi = "癸";
                    dayZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }    
            } 
            else if( monthZhi.equals("巳") ) {
                if( feGanShui > 0) {
                    liuZhi = "癸";
                    monthZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }    
            } 
            else if( yearZhi.equals("巳") )  {
                if( feGanShui > 0) {
                    liuZhi = "癸";
                    yearZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }    
            }
            else if( yZhi.equals("巳") )  {
                if( feGanShui > 0) {
                    liuZhi = "癸";
                    yunZhi = "癸";
                    if( key == true ) str = str + "地支由巳申合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }    
            }
        }

        /// 午未合土火，他们本来就是土火
        if( zhi.equals("未") ) {
            if( hourZhi.equals("午") ) {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    liuZhi = "未";
                    hourZhi = "未";
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    liuZhi = "午";
                    hourZhi = "午";
                    if( key == true ) str = str + "地支由午未合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
            }
            else if( dayZhi.equals("午") ) {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    liuZhi = "未";
                    dayZhi = "未";
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    liuZhi = "午";
                    dayZhi = "午";
                    if( key == true ) str = str + "地支由午未合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
            }  
            else if( monthZhi.equals("午") ) {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    liuZhi = "未";
                    monthZhi = "未";
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    liuZhi = "午";
                    monthZhi = "午";
                    if( key == true ) str = str + "地支由午未合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
            } 
            else if( yearZhi.equals("午") ) {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    liuZhi = "未";
                    yearZhi = "未";
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    liuZhi = "午";
                    yearZhi = "午";
                    if( key == true ) str = str + "地支由午未合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
            }
            else if( yZhi.equals("午") ) {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    liuZhi = "未";
                    yunZhi = "未";
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    liuZhi = "午";
                    yunZhi = "午";
                    if( key == true ) str = str + "地支由午未合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
            }
        }
        if( zhi.equals("午") ) {
            if( hourZhi.equals("未") ) {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    liuZhi = "未";
                    hourZhi = "未";
                    if( key == true ) str = str + "地支由午未合化土，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    liuZhi = "午";
                    hourZhi = "午";
                }
            } 
            else if( dayZhi.equals("未") ) {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    liuZhi = "未";
                    dayZhi = "未";
                    if( key == true ) str = str + "地支由午未合化土，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    liuZhi = "午";
                    dayZhi = "午";
                }
            }  
            else if( monthZhi.equals("未") ) {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    liuZhi = "未";
                    monthZhi = "未";
                    if( key == true ) str = str + "地支由午未合化土，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    yunZhi = "午";
                    monthZhi = "午";
                }
            } 
            else if( yearZhi.equals("未") )  {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    liuZhi = "未";
                    yearZhi = "未";
                    if( key == true ) str = str + "地支由午未合化土，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    liuZhi = "午";
                    yearZhi = "午";
                }
            }
            else if( yZhi.equals("未") )  {
                if( feGanTu > feGanHuo && feGanTu > 0) {
                    liuZhi = "未";
                    yunZhi = "未";
                    if( key == true ) str = str + "地支由午未合化土，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                }
                else if( feGanTu < feGanHuo && feGanHuo > 0) {
                    liuZhi = "午";
                    yunZhi = "午";
                }
            }
        }

        //#endregion

        //#region 地支三会局
        if( zhi.equals("寅")) {
            if( yZhi.equals("卯") ) {
                if( hourZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        hourZhi = "卯";
                    }
                } 
                else if( dayZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        dayZhi = "卯";
                    }
                } 
                else if( monthZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        monthZhi = "卯";
                    }
                } 
                else if( yearZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        yearZhi = "卯";
                    }
                }
            }
            if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
                if( yZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        yunZhi = "卯";
                    }
                } 
            }
        }
        else if( zhi.equals("卯")) {
            if( yZhi.equals("寅") ) {
                if( hourZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        hourZhi = "卯";
                    }
                } 
                else if( dayZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        dayZhi = "卯";
                    }
                } 
                else if( monthZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        monthZhi = "卯";
                    }
                } 
                else if( yearZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        yearZhi = "卯";
                    }
                }
            }
            if( hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
                if( yZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        yZhi = "卯";
                    }
                } 
            }
        }
        else if( zhi.equals("未")) {
            if( yZhi.equals("寅") || hourZhi.equals("寅") || dayZhi.equals("寅") || monthZhi.equals("寅") || yearZhi.equals("寅") ) {
                if( yZhi.equals("卯") || hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
                    if( feGanMu > 0) {
                        liuZhi = "卯";
                        if( key == true ) str = str + "地支由寅卯辰会木，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                }
            }
        }

        if( zhi.equals("巳")) {
            if( yZhi.equals("午") ) {
                if( hourZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        hourZhi = "巳";
                    }
                } 
                else if( dayZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        dayZhi = "巳";
                    }
                } 
                else if( monthZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        monthZhi = "巳";
                    }
                } 
                else if( yearZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        yearZhi = "巳";
                    }
                }
            }
            if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
                if( yZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        yunZhi = "巳";
                    }
                } 
            }
        }
        else if( zhi.equals("午")) {
            if( yZhi.equals("巳") ) {
                if( hourZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        hourZhi = "巳";
                    }
                } 
                else if( dayZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        dayZhi = "巳";
                    }
                } 
                else if( monthZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        monthZhi = "巳";
                    }
                } 
                else if( yearZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        yearZhi = "巳";
                    }
                }
            }
            if( hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
                if( yZhi.equals("未") ) {
                    if( feGanHuo > 0) {
                        yunZhi = "巳";
                    }
                } 
            }
        }
        else if( zhi.equals("未")) {
            if( yZhi.equals("巳") || hourZhi.equals("巳") || dayZhi.equals("巳") || monthZhi.equals("巳") || yearZhi.equals("巳") ) {
                if( yZhi.equals("午") || hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
                    if( feGanHuo > 0) {
                        liuZhi = "巳";
                        if( key == true ) str = str + "地支由巳午未会火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                }
            }
        }

        if( zhi.equals("申")) {
            if( yZhi.equals("酉") ) {
                if( hourZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        hourZhi = "酉";
                    }
                } 
                else if( dayZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        dayZhi = "酉";
                    }
                } 
                else if( monthZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        monthZhi = "酉";
                    }
                } 
                else if( yearZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        yearZhi = "酉";
                    }
                }
            }
            if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
                if( yZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        yunZhi = "酉";
                    }
                } 
            }
        }
        else if( zhi.equals("酉")) {
            if( yZhi.equals("申") ) {
                if( hourZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        hourZhi = "酉";
                    }
                } 
                else if( dayZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        dayZhi = "酉";
                    }
                } 
                else if( monthZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        monthZhi = "酉";
                    }
                } 
                else if( yearZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        yearZhi = "酉";
                    }
                }
            }
            if( hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
                if( yZhi.equals("戌") ) {
                    if( feGanJin > 0) {
                        yunZhi = "酉";
                    }
                } 
            }
        }
        else if( zhi.equals("戌")) {
            if( yZhi.equals("申") || hourZhi.equals("申") || dayZhi.equals("申") || monthZhi.equals("申") || yearZhi.equals("申") ) {
                if( yZhi.equals("酉") || hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
                    if( feGanJin > 0) {
                        liuZhi = "酉";
                        if( key == true ) str = str + "地支由辰酉戌会金，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                }
            }
        }

        if( zhi.equals("亥")) {
            if( yZhi.equals("子") ) {
                if( hourZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        hourZhi = "亥";
                    }
                } 
                else if( dayZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        dayZhi = "亥";
                    }
                } 
                else if( monthZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        monthZhi = "亥";
                    }
                } 
                else if( yearZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        yearZhi = "亥";
                    }
                }
            }
            if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
                if( yZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        yunZhi = "亥";
                    }
                } 
            }
        }
        else if( zhi.equals("子")) {
            if( yZhi.equals("亥") ) {
                if( hourZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        hourZhi = "亥";
                    }
                } 
                else if( dayZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        dayZhi = "亥";
                    }
                } 
                else if( monthZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        monthZhi = "亥";
                    }
                } 
                else if( yearZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        yearZhi = "亥";
                    }
                }
            }
            if( hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) {
                if( yZhi.equals("丑") ) {
                    if( feGanShui > 0) {
                        yunZhi = "亥";
                    }
                } 
            }
        }
        else if( zhi.equals("丑")) {
            if( yZhi.equals("亥") || hourZhi.equals("亥") || dayZhi.equals("亥") || monthZhi.equals("亥") || yearZhi.equals("亥") ) {
                if( yZhi.equals("子") || hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
                    if( feGanShui > 0) {
                        liuZhi = "亥";
                        if( key == true ) str = str + "地支由亥子丑会水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                }
            }
        }

        //#endregion

        //#region 地支三合局
        if( zhi.equals("寅")) {
            if( yZhi.equals("午") ) {
                if( hourZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        liuZhi = "午";
                        hourZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( dayZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        liuZhi = "午";
                        dayZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( monthZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        liuZhi = "午";
                        monthZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( yearZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        liuZhi = "午";
                        yearZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                }
            }
            if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
                if( yZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        liuZhi = "午";
                        yunZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
            }
        }
        else if( zhi.equals("戌")) {
            if( yZhi.equals("午") ) {
                if( hourZhi.equals("寅") ) {
                    if( feGanHuo > 0) {
                        liuZhi = "午";
                        hourZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( dayZhi.equals("寅") ) {
                    if( feGanHuo > 0) {
                        liuZhi = "午";
                        dayZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( monthZhi.equals("寅") ) {
                    if( feGanHuo > 0) {
                        liuZhi = "午";
                        monthZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( yearZhi.equals("寅") ) {
                    if( feGanHuo > 0) {
                        liuZhi = "午";
                        yearZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                }
            }
            if( hourZhi.equals("午") || dayZhi.equals("午") || monthZhi.equals("午") || yearZhi.equals("午") ) {
                if( yZhi.equals("寅") ) {
                    if( feGanHuo > 0) {
                        liuZhi = "午";
                        yunZhi = "午";
                        if( key == true ) str = str + "地支由寅午戌合化火，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
            }
        }
        else if( zhi.equals("午")) {
            if( hourZhi.equals("寅") ) {
                if( dayZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        hourZhi = "午";
                        dayZhi = "午";
                    }
                } 
                else if( monthZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        hourZhi = "午";
                        monthZhi = "午";
                    }
                } 
                else if( yearZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        hourZhi = "午";
                        yearZhi = "午";
                    }
                }
                else if( yZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        hourZhi = "午";
                        yunZhi = "午";
                    }
                }
            } 
            else if( dayZhi.equals("寅") ) {
                if( hourZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        dayZhi = "午";
                        hourZhi = "午";
                    }
                } 
                else if( monthZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        dayZhi = "午";
                        monthZhi = "午";
                    }
                } 
                else if( yearZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        dayZhi = "午";
                        yearZhi = "午";
                    }
                }
                else if( yZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        dayZhi = "午";
                        yunZhi = "午";
                    }
                }
            } 
            else if( monthZhi.equals("寅") ) {
                if( hourZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        monthZhi = "午";
                        hourZhi = "午";
                    }
                } 
                else if( dayZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        monthZhi = "午";
                        dayZhi = "午";
                    }
                } 
                else if( yearZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        monthZhi = "午";
                        yearZhi = "午";
                    }
                }
                else if( yZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        monthZhi = "午";
                        yunZhi = "午";
                    }
                }
            } 
            else if( yearZhi.equals("寅") ) {
                if( hourZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        yearZhi = "午";
                        hourZhi = "午";
                    }
                } 
                else if( dayZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        yearZhi = "午";
                        dayZhi = "午";
                    }
                } 
                else if( monthZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        yearZhi = "午";
                        monthZhi = "午";
                    }
                } 
                else if( yZhi.equals("戌") ) {
                    if( feGanHuo > 0) {
                        monthZhi = "午";
                        yunZhi = "午";
                    }
                }
            }
        }

        if( zhi.equals("亥")) {
            if( yZhi.equals("卯") ) {
                if( hourZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        liuZhi = "卯";
                        hourZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( dayZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        liuZhi = "卯";
                        dayZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( monthZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        liuZhi = "卯";
                        monthZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( yearZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        liuZhi = "卯";
                        yearZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                }
            }
            if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
                if( yZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        liuZhi = "卯";
                        yunZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
            }
        }
        else if( zhi.equals("未")) {
            if( yZhi.equals("卯") ) {
                if( hourZhi.equals("亥") ) {
                    if( feGanMu > 0) {
                        liuZhi = "卯";
                        hourZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( dayZhi.equals("亥") ) {
                    if( feGanMu > 0) {
                        liuZhi = "卯";
                        dayZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( monthZhi.equals("亥") ) {
                    if( feGanMu > 0) {
                        liuZhi = "卯";
                        monthZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( yearZhi.equals("亥") ) {
                    if( feGanMu > 0) {
                        liuZhi = "卯";
                        yearZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                }
            }
            if( hourZhi.equals("卯") || dayZhi.equals("卯") || monthZhi.equals("卯") || yearZhi.equals("卯") ) {
                if( yZhi.equals("亥") ) {
                    if( feGanMu > 0) {
                        liuZhi = "卯";
                        yunZhi = "卯";
                        if( key == true ) str = str + "地支由亥卯未合化木，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
            }
        }
        else if( zhi.equals("卯")) {
            if( hourZhi.equals("亥") ) {
                if( dayZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        hourZhi = "卯";
                        dayZhi = "卯";
                    }
                } 
                else if( monthZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        hourZhi = "卯";
                        monthZhi = "卯";
                    }
                } 
                else if( yearZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        hourZhi = "卯";
                        yearZhi = "卯";
                    }
                }
                else if( yZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        hourZhi = "卯";
                        yunZhi = "卯";
                    }
                }
            } 
            else if( dayZhi.equals("亥") ) {
                if( hourZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        dayZhi = "卯";
                        hourZhi = "卯";
                    }
                } 
                else if( monthZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        dayZhi = "卯";
                        monthZhi = "卯";
                    }
                } 
                else if( yearZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        dayZhi = "卯";
                        yearZhi = "卯";
                    }
                }
                else if( yZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        hourZhi = "卯";
                        yunZhi = "卯";
                    }
                }
            } 
            else if( monthZhi.equals("亥") ) {
                if( hourZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        monthZhi = "卯";
                        hourZhi = "卯";
                    }
                } 
                else if( dayZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        monthZhi = "卯";
                        dayZhi = "卯";
                    }
                } 
                else if( yearZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        monthZhi = "卯";
                        yearZhi = "卯";
                    }
                }
                else if( yZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        hourZhi = "卯";
                        yunZhi = "卯";
                    }
                }
            } 
            else if( yearZhi.equals("亥") ) {
                if( hourZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        yearZhi = "卯";
                        hourZhi = "卯";
                    }
                } 
                else if( dayZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        yearZhi = "卯";
                        dayZhi = "卯";
                    }
                } 
                else if( monthZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        yearZhi = "卯";
                        monthZhi = "卯";
                    }
                }
                else if( yZhi.equals("未") ) {
                    if( feGanMu > 0) {
                        hourZhi = "卯";
                        yunZhi = "卯";
                    }
                }
            }
        }

        if( zhi.equals("申")) {
            if( yZhi.equals("子") ) {
                if( hourZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        liuZhi = "子";
                        hourZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( dayZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        liuZhi = "子";
                        dayZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( monthZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        liuZhi = "子";
                        monthZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( yearZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        liuZhi = "子";
                        yearZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                }
            }
            if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
                if( yZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        liuZhi = "子";
                        yunZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
            }
        }
        else if( zhi.equals("辰")) {
            if( yZhi.equals("子") ) {
                if( hourZhi.equals("申") ) {
                    if( feGanShui > 0) {
                        liuZhi = "子";
                        hourZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( dayZhi.equals("申") ) {
                    if( feGanShui > 0) {
                        liuZhi = "子";
                        dayZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( monthZhi.equals("申") ) {
                    if( feGanShui > 0) {
                       liuZhi = "子";
                        monthZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( yearZhi.equals("申") ) {
                    if( feGanShui > 0) {
                        liuZhi = "子";
                        yearZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                }
            }
            if( hourZhi.equals("子") || dayZhi.equals("子") || monthZhi.equals("子") || yearZhi.equals("子") ) {
                if( yZhi.equals("申") ) {
                    if( feGanShui > 0) {
                        liuZhi = "子";
                        yunZhi = "子";
                        if( key == true ) str = str + "地支由申子辰合化水，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
            }
        }
        else if( zhi.equals("子")) {
            if( hourZhi.equals("申") ) {
                if( dayZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        hourZhi = "子";
                        dayZhi = "子";
                    }
                } 
                else if( monthZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        hourZhi = "子";
                        monthZhi = "子";
                    }
                } 
                else if( yearZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        hourZhi = "子";
                        yearZhi = "子";
                    }
                }
                else if( yZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        hourZhi = "子";
                        yunZhi = "子";
                    }
                }
            } 
            else if( dayZhi.equals("申") ) {
                if( hourZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        dayZhi = "子";
                        hourZhi = "子";
                    }
                } 
                else if( monthZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        dayZhi = "子";
                        monthZhi = "子";
                    }
                } 
                else if( yearZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        dayZhi = "子";
                        yearZhi = "子";
                    }
                }
                else if( yZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        hourZhi = "子";
                        yunZhi = "子";
                    }
                }
            } 
            else if( monthZhi.equals("申") ) {
                if( hourZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        monthZhi = "子";
                        hourZhi = "子";
                    }
                } 
                else if( dayZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        monthZhi = "子";
                        dayZhi = "子";
                    }
                } 
                else if( yearZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        monthZhi = "子";
                        yearZhi = "子";
                    }
                }
                else if( yZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        hourZhi = "子";
                        yunZhi = "子";
                    }
                }
            } 
            else if( yearZhi.equals("申") ) {
                if( hourZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        yearZhi = "子";
                        hourZhi = "子";
                    }
                } 
                else if( dayZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        yearZhi = "子";
                        dayZhi = "子";
                    }
                } 
                else if( monthZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        yearZhi = "子";
                        monthZhi = "子";
                    }
                } 
                else if( yZhi.equals("辰") ) {
                    if( feGanShui > 0) {
                        hourZhi = "子";
                        yunZhi = "子";
                    }
                }
            }
        }

        if( zhi.equals("巳")) {
            if( yZhi.equals("酉") ) {
                if( hourZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        liuZhi = "酉";
                        hourZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( dayZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        liuZhi = "酉";
                        dayZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( monthZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        liuZhi = "酉";
                        monthZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( yearZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        liuZhi = "酉";
                        yearZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                }
            }
            if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
                if( yZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        liuZhi = "酉";
                        yunZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
            }
        }
        else if( zhi.equals("丑")) {
            if( yZhi.equals("酉") ) {
                if( hourZhi.equals("巳") ) {
                    if( feGanJin > 0) {
                        liuZhi = "酉";
                        hourZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( dayZhi.equals("巳") ) {
                    if( feGanJin > 0) {
                        liuZhi = "酉";
                        dayZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( monthZhi.equals("巳") ) {
                    if( feGanJin > 0) {
                        liuZhi = "酉";
                        monthZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
                else if( yearZhi.equals("巳") ) {
                    if( feGanJin > 0) {
                        liuZhi = "酉";
                        yearZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                }
            }
            if( hourZhi.equals("酉") || dayZhi.equals("酉") || monthZhi.equals("酉") || yearZhi.equals("酉") ) {
                if( yZhi.equals("巳") ) {
                    if( feGanJin > 0) {
                        liuZhi = "酉";
                        yunZhi = "酉";
                        if( key == true ) str = str + "地支由巳酉丑合化金，流年地支改为" + fnComputeShishen(dayGan, liuZhi) + "运，"; 
                    }
                } 
            }
        }
        else if( zhi.equals("酉")) {
            if( hourZhi.equals("巳") ) {
                if( dayZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        hourZhi = "酉";
                        dayZhi = "酉";
                    }
                } 
                else if( monthZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        hourZhi = "酉";
                        monthZhi = "酉";
                    }
                } 
                else if( yearZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        hourZhi = "酉";
                        yearZhi = "酉";
                    }
                }
                else if( yZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        hourZhi = "酉";
                        yunZhi = "酉";
                    }
                }
            } 
            else if( dayZhi.equals("巳") ) {
                if( hourZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        dayZhi = "酉";
                        hourZhi = "酉";
                    }
                } 
                else if( monthZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        dayZhi = "酉";
                        monthZhi = "酉";
                    }
                } 
                else if( yearZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        dayZhi = "酉";
                        yearZhi = "酉";
                    }
                }
                else if( yZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        hourZhi = "酉";
                        yunZhi = "酉";
                    }
                }
            } 
            else if( monthZhi.equals("巳") ) {
                if( hourZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        monthZhi = "酉";
                        hourZhi = "酉";
                    }
                } 
                else if( dayZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        monthZhi = "酉";
                        dayZhi = "酉";
                    }
                } 
                else if( yearZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        monthZhi = "酉";
                        yearZhi = "酉";
                    }
                }
                else if( yZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        hourZhi = "酉";
                        yunZhi = "酉";
                    }
                }
            }
            else if( yearZhi.equals("巳") ) {
                if( hourZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        yearZhi = "酉";
                        hourZhi = "酉";
                    }
                } 
                else if( dayZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        yearZhi = "酉";
                        dayZhi = "酉";
                    }
                } 
                else if( monthZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        yearZhi = "酉";
                        monthZhi = "酉";
                    }
                } 
                else if( yZhi.equals("丑") ) {
                    if( feGanJin > 0) {
                        hourZhi = "酉";
                        yunZhi = "酉";
                    }
                }
            }
        }

        //#endregion

        shenYearGan = fnComputeShishen(dayGan, yearGan);
        shenYearZhi = fnComputeShishen(dayGan, yearZhi);
        shenMonthGan = fnComputeShishen(dayGan, monthGan);
        shenMonthZhi = fnComputeShishen(dayGan, monthZhi);
        shenDayZhi = fnComputeShishen(dayGan, dayZhi);
        shenHourGan = fnComputeShishen(dayGan, hourGan);
        shenHourZhi = fnComputeShishen(dayGan, hourZhi);
        shenYunGan = fnComputeShishen(dayGan, yunGan);
        shenYunZhi = fnComputeShishen(dayGan, yunZhi);
        shenLiuGan = fnComputeShishen(dayGan, liuGan);
        shenLiuZhi = fnComputeShishen(dayGan, liuZhi);

        if( gan.equals(yunGan) ) {
            if( key == true ) str = str + "天干流年为" + shenYunGan + "运，";
        }
        if( zhi.equals(yunZhi) ) {
            if( key == true ) str = str + "地支流年为" + shenYunZhi + "运，";
        }

        //#region 统计十神个数，生克个数
        ///年干
        if( shenYearGan.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenYearGan.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenYearGan.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenYearGan.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenYearGan.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenYearGan.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenYearGan.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenYearGan.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenYearGan.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenYearGan.equals("才") ) {
            caip++;
            ke++;
        }

        ///年支
        if( shenYearZhi.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenYearZhi.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenYearZhi.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenYearZhi.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenYearZhi.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenYearZhi.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenYearZhi.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenYearZhi.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenYearZhi.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenYearZhi.equals("才") ) {
            caip++;
            ke++;
        }
        
        ///月干
        if( shenMonthGan.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenMonthGan.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenMonthGan.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenMonthGan.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenMonthGan.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenMonthGan.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenMonthGan.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenMonthGan.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenMonthGan.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenMonthGan.equals("才") ) {
            caip++;
            ke++;
        }

        ///月支
        if( shenMonthZhi.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenMonthZhi.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenMonthZhi.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenMonthZhi.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenMonthZhi.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenMonthZhi.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenMonthZhi.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenMonthZhi.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenMonthZhi.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenMonthZhi.equals("才") ) {
            caip++;
            ke++;
        }

        ///日支
        if( shenDayZhi.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenDayZhi.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenDayZhi.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenDayZhi.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenDayZhi.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenDayZhi.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenDayZhi.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenDayZhi.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenDayZhi.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenDayZhi.equals("才") ) {
            caip++;
            ke++;
        }

        ///时干
        if( shenHourGan.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenHourGan.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenHourGan.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenHourGan.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenHourGan.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenHourGan.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenHourGan.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenHourGan.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenHourGan.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenHourGan.equals("才") ) {
            caip++;
            ke++;
        }

        ///时支
        if( shenHourZhi.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenHourZhi.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenHourZhi.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenHourZhi.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenHourZhi.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenHourZhi.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenHourZhi.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenHourZhi.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenHourZhi.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenHourZhi.equals("才") ) {
            caip++;
            ke++;
        }

        ///运干
        if( shenYunGan.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenYunGan.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenYunGan.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenYunGan.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenYunGan.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenYunGan.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenYunGan.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenYunGan.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenYunGan.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenYunGan.equals("才") ) {
            caip++;
            ke++;
        }

        ///运支
        if( shenYunZhi.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenYunZhi.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenYunZhi.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenYunZhi.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenYunZhi.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenYunZhi.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenYunZhi.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenYunZhi.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenYunZhi.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenYunZhi.equals("才") ) {
            caip++;
            ke++;
        }

        ///流年干
        if( shenLiuGan.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenLiuGan.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenLiuGan.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenLiuGan.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenLiuGan.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenLiuGan.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenLiuGan.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenLiuGan.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenLiuGan.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenLiuGan.equals("才") ) {
            caip++;
            ke++;
        }

        ///运支
        if( shenLiuZhi.equals("官") ) {
            guan++;
            ke++;
        }
        if( shenLiuZhi.equals("煞") ) {
            sha++;
            ke++;
        }
        if( shenLiuZhi.equals("印") ) {
            yin++;
            sheng++;
        }
        if( shenLiuZhi.equals("枭") ) {
            xiao++;
            sheng++;            
        }
        if( shenLiuZhi.equals("比") ) {
            bi++;
            sheng++;
        }
        if( shenLiuZhi.equals("劫") ) {
            jie++;
            sheng++;
        }
        if( shenLiuZhi.equals("食") ) {
            shi++;
            ke++;
        }
        if( shenLiuZhi.equals("伤") ) {
            shang++;
            ke++;
        }
        if( shenLiuZhi.equals("财") ) {
            caiz++;
            ke++;
        }
        if( shenLiuZhi.equals("才") ) {
            caip++;
            ke++;
        }

        //#endregion

        /// 克   官主财印食官
        /// 生   印主食财官印 

        if( fnComputeTianYi(bazi.dayGan, gan) ) {
            str = str + "有天乙贵人相帮。";
        }
        else if( fnComputeTianYi(bazi.dayGan, zhi) ) {
            str = str + "有天乙贵人相帮。";
        }

        if( fnComputeYiMa(bazi.dayZhi, zhi) ) {
            str = str + "驿马：事业有变动，或者生活有变迁，或者长期出差在外。";
        }
        else if( fnComputeYiMa(bazi.yearZhi, zhi) ) {
            str = str + "驿马：事业有变动，或者生活有变迁，或者长期出差在外。";
        }

        if( key == true ) str = str + "走" + shenLiuGan + shenLiuZhi + "运：";

        if( age < 23 ) {

            if( shenLiuGan.equals("官") || shenLiuGan.equals("煞")) {
                if( shenLiuZhi.equals("官") || shenLiuZhi.equals("煞")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，学习一般，虽然调皮但是讨人喜欢。";
                    }
                    else { /// 身弱
                        str = str + "本年，学习一般，爱惹事情。";
                    }
                }
                else if( shenLiuZhi.equals("印") || shenLiuZhi.equals("枭")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，比较懂事，学习好。";
                    }
                    else { /// 身弱
                        str = str + "本年，比较调皮，学习好。";
                    }
                }
                else if( shenLiuZhi.equals("比") || shenLiuZhi.equals("劫")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，比较懂事，比较要强。";
                    }
                    else { /// 身弱
                        str = str + "本年，爱惹事，比较任性。";
                    }
                }
                else if( shenLiuZhi.equals("食") || shenLiuZhi.equals("伤")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，比较懂事，有才艺，表现好。";
                    }
                    else { /// 身弱
                        str = str + "本年，比较调皮，易有病。";
                    }
                }
                else if( shenLiuZhi.equals("财") || shenLiuZhi.equals("才")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，比较懂事，讨人喜欢，不爱学习。";
                    }
                    else { /// 身弱
                        str = str + "本年，爱惹事。不爱学习。易有病。";
                    }
                }
                str = str + "有可能当学生干部。";
            }
            else if( shenLiuGan.equals("印") || shenLiuGan.equals("枭")) {
                if( shenLiuZhi.equals("官") || shenLiuZhi.equals("煞")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，比较懂事，学习好。";
                    }
                    else { /// 身弱
                        str = str + "本年，比较调皮，学习好。";
                    }
                    str = str + "有可能当学生干部。";
                }
                else if( shenLiuZhi.equals("印") || shenLiuZhi.equals("枭")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，爱学习。比较要强。";
                    }
                    else { /// 身弱
                        str = str + "本年，学习好，有个性。";
                    }
                }
                else if( shenLiuZhi.equals("比") || shenLiuZhi.equals("劫")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，学习好，比较调皮，表现好。";
                    }
                    else { /// 身弱
                        str = str + "本年，学习好，比较要强。";
                    }
                }
                else if( shenLiuZhi.equals("食") || shenLiuZhi.equals("伤")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，学习好，表现好。";
                    }
                    else { /// 身弱
                        str = str + "本年，学习好，有些任性。";
                    }
                }
                else if( shenLiuZhi.equals("财") || shenLiuZhi.equals("才")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，学习有波动，最后往好的方向发展。";
                    }
                    else { /// 身弱
                        str = str + "本年，学习有波动，最后往坏的方向发展。";
                    }
                }
            }
            else if( shenLiuGan.equals("比") || shenLiuGan.equals("劫")) {
                if( shenLiuZhi.equals("官") || shenLiuZhi.equals("煞")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，比较懂事，有些要强。";
                    }
                    else { /// 身弱
                        str = str + "本年，爱惹事，有些任性。";
                    }
                    str = str + "有可能当学生干部。";
                }
                else if( shenLiuZhi.equals("印") || shenLiuZhi.equals("枭")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，学习好，比较调皮，表现好。";
                    }
                    else { /// 身弱
                        str = str + "本年，学习好，比较要强。";
                    }

                }
                else if( shenLiuZhi.equals("比") || shenLiuZhi.equals("劫")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，学习一般，比较任性。";
                    }
                    else { /// 身弱
                        str = str + "本年，学习一般，比较要强。";
                    }
                }
                else if( shenLiuZhi.equals("食") || shenLiuZhi.equals("伤")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，学习一般，比较要强，表现好。";
                    }
                    else { /// 身弱
                        str = str + "本年，学习一般，比较要强，有些任性。";
                    }
                }
                else if( shenLiuZhi.equals("财") || shenLiuZhi.equals("才")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，不爱学习，比较任性。";
                    }
                    else { /// 身弱
                        str = str + "本年，不爱学习，比较要强。";
                    }
                }
            }
            else if( shenLiuGan.equals("食") || shenLiuGan.equals("伤")) {
                if( shenLiuZhi.equals("官") || shenLiuZhi.equals("煞")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，比较懂事，有才艺，表现好。";
                    }
                    else { /// 身弱
                        str = str + "本年，比较调皮，易有病。";
                    }
                    str = str + "有可能当学生干部。";
                }
                else if( shenLiuZhi.equals("印") || shenLiuZhi.equals("枭")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，学习好，表现好。";
                    }
                    else { /// 身弱
                        str = str + "本年，学习好，有些任性。";
                    }
                }
                else if( shenLiuZhi.equals("比") || shenLiuZhi.equals("劫")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，学习一般，比较要强，表现好。";
                    }
                    else { /// 身弱
                        str = str + "本年，学习一般，比较要强，有些任性。";
                    }
                }
                else if( shenLiuZhi.equals("食") || shenLiuZhi.equals("伤")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，学习一般，有才艺，表现好。";
                    }
                    else { /// 身弱
                        str = str + "本年，学习一般，有些任性，易有病。";
                    }
                }
                else if( shenLiuZhi.equals("财") || shenLiuZhi.equals("才")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，不爱学习，有才艺，表现好。";
                    }
                    else { /// 身弱
                        str = str + "本年，不爱学习，有些任性，易有病。";
                    }
                }
            }
            else if( shenLiuGan.equals("财") || shenLiuGan.equals("才")) {
                if( shenLiuZhi.equals("官") || shenLiuZhi.equals("煞")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，比较懂事，讨人喜欢，不爱学习。";
                    }
                    else { /// 身弱
                        str = str + "本年，爱惹事。不爱学习。易有病。";
                    }
                    str = str + "有可能当学生干部。";
                }
                else if( shenLiuZhi.equals("印") || shenLiuZhi.equals("枭")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，学习有波动，最后往好的方向发展。";
                    }
                    else { /// 身弱
                        str = str + "本年，学习有波动，最后往坏的方向发展。";
                    }
                }
                else if( shenLiuZhi.equals("比") || shenLiuZhi.equals("劫")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，不爱学习，比较任性。";
                    }
                    else { /// 身弱
                        str = str + "本年，不爱学习，比较要强。";
                    }
                }
                else if( shenLiuZhi.equals("食") || shenLiuZhi.equals("伤")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，不爱学习，有才艺，表现好。";
                    }
                    else { /// 身弱
                        str = str + "本年，不爱学习，有些任性，易有病。";
                    }
                }
                else if( shenLiuZhi.equals("财") || shenLiuZhi.equals("才")) {
                    if( sheng >= ke  ) {  /// 身强
                        str = str + "本年，不爱学习。";
                    }
                    else { /// 身弱
                        str = str + "本年，不爱学习，易有病。";
                    }
                }
            }

            return str;
        }
        if( shenLiuGan.equals("官") || shenLiuGan.equals("煞")) {
            if( shenLiuZhi.equals("官") || shenLiuZhi.equals("煞")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 本年事业会变化，往好的方向发展。";
                    if( (bi + jie ) >= 2 ) {
                        str = str + "有同事或者朋友帮忙解决事业问题。";
                    }
                    if( (yin + xiao ) >= 2 ) {
                        str = str + "有长辈或者贵人帮忙解决事业问题。";
                    }
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str + "本年事业会有变化，往好的方向发展。";
                    }
                    else {
                        str = str + " 本年相对不好，事业会有变动，即使事业变好，但工作压力也会变大，或者会有官司缠身。";
                    }
                    if( shang > 0 && (yin + xiao) == 0 ) {
                        str = str + (key == true ? "有伤官，" : "") + "本年相对不好，事业会有变动，有官司缠身的概率较大。";
                    }
                }

                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + (key == true ? "女生走官运，" : "") + "可能会有婚姻变动。";                 
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                        if( ke > sheng ) {
                            str = str + "易有情色纠纷。";
                        }
                    }
                }
            }
            else if( shenLiuZhi.equals("印") || shenLiuZhi.equals("枭")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 本年相对较好，事业有发展，有贵人相助。在学业，技术等方面可有提高。对财运不好。可能会名誉受损。";
                }
                else { /// 身弱
                    str = str + " 本年相对一般，事业有发展，也比较辛苦。学业，技术等方面可有提高。对财运不好。";
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + "女生走官运，可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
            else if( shenLiuZhi.equals("比") || shenLiuZhi.equals("劫")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 本年相对较好，事业有变化，发展较好，有同事或者朋友相助。";
                }
                else { /// 身弱
                    str = str + " 本年相对一般，即使事业有发展，但也比较辛苦。财运可能会变好一些。";
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + "女生走官运，可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
            else if( shenLiuZhi.equals("食") || shenLiuZhi.equals("伤")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (yin + xiao) > 0) {
                        if( (caip + caiz) > 0 ) {
                            str = str + (key == true ? " 有印克制食伤，": "") + "本年相对较好，事业财运都有变化，财运官运都往好的方向有发展。";
                        }
                        else {
                            str = str + (key == true ? " 有印克制食伤，": "") + "本年相对还行，事业有变化，往好的方向发展。";
                        }
                    }
                    else {
                        str = str + (key == true ? " 无印克制，": "") + "本年相对一般，事业有波动，如果往好的方向发展，就会压力变大。";
                    }
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str + " 本年相对较好，事业有波动，但是往好的方向发展，工作压力也会变大。";
                    }
                    else {
                        str = str + " 本年相对不好，事业有变化，如果往好的方向发展就会工作压力变大，或者往不好方向发展，或者有可能官司缠身。易得伤病。";
                    }
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + "女生走官运，可能会有异性缘，但不易成婚。";
                    }
                    else {
                        str = str + "有异性缘，也容易伤及家庭。";
                    }
                }
            }
            else if( shenLiuZhi.equals("财") || shenLiuZhi.equals("才")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 本年相对较好，财运官运都变化，都会往好的方向发展。";
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str + " 本年相对较好，财运官运都会往好的方向发展。";
                    }
                    else {
                        str = str + " 本年相对不好，事业有波动，财运有波动，或者往好的方向发展则很辛苦，或者往不好方向发展。天克地冲易得伤病。";
                    }
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + "女生走官运，可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
        }
        else if( shenLiuGan.equals("印") || shenLiuGan.equals("枭")) {
            if( shenLiuZhi.equals("官") || shenLiuZhi.equals("煞")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 本年相对较好，事业有发展，有贵人相助。在学业，技术等方面可有提高。对财运不好。可能会名誉受损。";
                }
                else { /// 身弱
                    str = str + " 本年相对一般，事业有变化。学业，技术等方面可有提高。对财运不好。";
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + "女生走官运，可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
            else if( shenLiuZhi.equals("印") || shenLiuZhi.equals("枭")) {
                if( sheng >= ke  ) {  /// 身强
                    if( zpSheng < zpKe ) {
                        str = str + "本年相对较好，财运官运都有发展。在学业，技术等方面可有提高。";
                    }
                    else {
                        str = str + " 本年相对不好，在学业，技术等方面可有提高。对财运不好。可能会名誉受损。";
                    }
                }
                else { /// 身弱
                    str = str + " 本年相对较好，学业，技术等方面可有提高。有人相帮，各个方面都会顺利。财运不佳。";
                }
            }
            else if( shenLiuZhi.equals("比") || shenLiuZhi.equals("劫")) {
                if( sheng >= ke  ) {  /// 身强
                    if( zpSheng < zpKe ) {
                        str = str + "本年相对较好，财运官运都会顺利。在学业，技术等方面可有提高。";
                    }
                    else {
                        str = str + " 本年相对不好，在学业，技术等方面可有提高。对财运不好，被亲朋所累。可能会名誉受损。";
                    }
                }
                else { /// 身弱
                    str = str + " 本年相对较好，学业，技术等方面可有提高。有人相帮，有同事朋友相助，各个方面都会顺利。";
                }
            }
            else if( shenLiuZhi.equals("食") || shenLiuZhi.equals("伤")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (caip + caiz) > 0 ) {
                        str = str + " 本年相对较好，在学业，技术等方面可有提高。财运较好。事业也可能会有变化。";
                    }
                    else {
                        str = str + " 本年相对一般，在学业，技术等方面可有提高。事业会有波动，相对向好的方向发展。";
                    }
                }
                else { /// 身弱
                    str = str + " 本年相对一般，学业，技术等方面可有提高。财运会有发展的机会。";
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) > 0 ) {
                        str = str + "对家庭或婚姻有不好的影响。";
                    }
                }
            }
            else if( shenLiuZhi.equals("财") || shenLiuZhi.equals("才")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (shi + shang) > 0 ) {
                        str = str + " 本年相对较好，在学业，技术等方面可有提高。财运较好。";
                    }
                    else {
                        str = str + " 本年相对一般，在学业，技术等方面可有提高。财运会有波动，相对向好的方向发展。";
                    }
                }
                else { /// 身弱
                    str = str + " 本年相对一般，学业，技术等方面可有提高。或者财运或者事业会有不好的影响。";
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
        }
        else if( shenLiuGan.equals("比") || shenLiuGan.equals("劫")) {
            if( shenLiuZhi.equals("官") || shenLiuZhi.equals("煞")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 本年相对较好，事业有变化，往好的方向发展较好，有同事或者朋友相助。";
                }
                else { /// 身弱
                    str = str + " 本年相对一般，事业有发展。财运可能会变好一些。";
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + "女生走官运，可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
            else if( shenLiuZhi.equals("印") || shenLiuZhi.equals("枭")) {
                if( sheng >= ke  ) {  /// 身强
                    if( zpSheng < zpKe ) {
                        str = str + "本年相对较好，财运官运都有发展。在学业，技术等方面可有提高。";
                    }
                    else {
                        str = str + " 本年相对不好，在学业，技术等方面可有提高。对财运不好，被亲朋所累。可能会名誉受损。";
                    }
                }
                else { /// 身弱
                    str = str + " 本年相对较好，学业，技术等方面可有提高。有人相帮，有同事朋友相助，各个方面都会顺利。";
                }
            }
            else if( shenLiuZhi.equals("比") || shenLiuZhi.equals("劫")) {
                if( sheng >= ke  ) {  /// 身强
                    if( zpSheng < zpKe ) {
                        str = str + "本年相对较好，财运官运都有发展。";
                    }
                    else {
                        str = str + " 本年相对不好，对财运不好，被亲朋所累。";
                    }
                }
                else { /// 身弱
                    str = str + " 本年相对一般，有同事朋友相助，事业相对顺利。财运相对变好一些。";
                }
            }
            else if( shenLiuZhi.equals("食") || shenLiuZhi.equals("伤")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (caip + caiz) > 0) {
                        str = str + " 本年相对一般，有财运变化，，易被亲朋所累。";
                    }
                    else {
                        str = str + " 本年相对一般，被亲朋所累，事业往不利的方向有点儿波动。";
                    }
                }
                else { /// 身弱
                    str = str + " 本年相对不好，虽然有同事朋友相助，事业有波动相对向不利方向发展。或者易破财，易得伤病。";
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) > 0 ) {
                        str = str + "对家庭或婚姻有不好的影响。";
                    }
                }
            }
            else if( shenLiuZhi.equals("财") || shenLiuZhi.equals("才")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 本年相对较好，会有财运，小心亲朋夺财。";
                }
                else { /// 身弱
                    str = str + " 本年相对一般，会有点儿财运，但要小心努力获取。";
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
        }
        else if( shenLiuGan.equals("食") || shenLiuGan.equals("伤")) {
            if( shenLiuZhi.equals("官") || shenLiuZhi.equals("煞")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (yin + xiao) > 0) {
                        if( (caip + caiz) > 0 ) {
                            str = str + (key == true ? " 有印克制食伤，": "") + "本年相对较好，财运官运都会有变化，都往好的方向发展。";
                        }
                        else {
                            str = str + (key == true ? " 有印克制食伤，": "") + "本年相对一般，事业有变化，虽然可能会有波动，还是往好的方向发展。";
                        }
                    }
                    else {
                        str = str + (key == true ? " 无印克制，": "") + "本年相对一般，事业有波动，但是往好的方向发展。";
                    }
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str + "本年相对较好，事业有波动，但是往好的方向发展。";
                    }
                    else {
                        str = str + " 本年相对不好，事业下行，还有可能官司缠身。易得伤病。";
                    }
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + "女生走官运，可能会有异性缘，但不易成婚。";
                    }
                    else {
                        str = str + "有异性缘，也容易伤及家庭。";
                    }
                }
            }
            else if( shenLiuZhi.equals("印") || shenLiuZhi.equals("枭")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (caip + caiz) > 0 ) {
                        str = str + " 本年相对较好，在学业，技术等方面可有提高。财运有变化，往好的方向发展。";
                    }
                    else {
                        str = str + " 本年相对一般，在学业，技术等方面可有提高。事业会有波动，相对向好的方向发展。";
                    }
                }
                else { /// 身弱
                    str = str + " 本年相对一般，学业，技术等方面可有提高。财运会有发展的机会，需要小心努力获取。";
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) > 0 ) {
                        str = str + "对家庭或婚姻有不好的影响。";
                    }
                }
            }
            else if( shenLiuZhi.equals("比") || shenLiuZhi.equals("劫")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (caip + caiz) > 0) {
                        str = str + " 本年相对一般，会有财运，易被亲朋所累。";
                    }
                    else {
                        str = str + " 本年相对一般，被亲朋所累，事业往不利的方向有点儿波动。";
                    }
                }
                else { /// 身弱
                    str = str + " 本年相对不好，虽有同事朋友相助，事业有波动相对向不利方向发展。或者易破财，易得伤病。";
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) > 0 ) {
                        str = str + "对家庭或婚姻有不好的影响。";
                    }
                }
            }
            else if( shenLiuZhi.equals("食") || shenLiuZhi.equals("伤")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (caip + caiz) > 0) {
                        str = str + " 本年相对一般，有财运，事业上能有发展。";
                    }
                    else {
                        str = str + " 本年相对一般，在事业上有表现得机会，事业能得到发展。易得小伤小病。";
                    }
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str + "本年相对较好，事业、财运上能有发展。";
                    }
                    else {
                        str = str + " 本年相对不好，对事业不好。易破财，易得伤病。";
                    }
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) > 0 ) {
                        str = str + "对家庭或婚姻有不好的影响。";
                    }
                }
            }
            else if( shenLiuZhi.equals("财") || shenLiuZhi.equals("才")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 本年相对较好，有财运。事业有发展。";
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str + "本年相对较好，事业、财运上能有发展。";
                    }
                    else {
                        str = str + " 本年相对不好，对事业不好。有财运，需要辛苦获得，或者易破财，易得伤病。";
                    }
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) > 0 ) {
                        str = str + "对家庭或婚姻有不好的影响。";
                    }
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
        }
        else if( shenLiuGan.equals("财") || shenLiuGan.equals("才")) {
            if( shenLiuZhi.equals("官") || shenLiuZhi.equals("煞")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 本年相对较好，财运官运都有变化，都会往好的方向发展。";
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str +"本年相对较好，财运官运都有发展。";
                    }
                    else {
                        str = str + " 本年相对不好，事业有波动，财运有波动，或者往好的方向发展则很辛苦，或者往不好方向发展。天冲地克易得伤病。";
                    }
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) == 0 ) {
                        str = str + "女生走官运，可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
            else if( shenLiuZhi.equals("印") || shenLiuZhi.equals("枭")) {
                if( sheng >= ke  ) {  /// 身强
                    if( (shi + shang) > 0 ) {
                        str = str + " 本年相对较好，在学业，技术等方面可有提高。财运有变化，会往好的方向发展。";
                    }
                    else {
                        str = str + " 本年相对一般，在学业，技术等方面可有提高。财运会有波动，相对向好的方向发展。";
                    }
                }
                else { /// 身弱
                    str = str + " 本年相对一般，学业，技术等方面可有提高。或者财运或者事业有变化，或者有发展但很辛苦，或者会有不好的影响。";
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
            else if( shenLiuZhi.equals("比") || shenLiuZhi.equals("劫")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 本年相对较好，会有财运，小心亲朋夺财。";
                }
                else { /// 身弱
                    str = str + "本年相对一般，会有点儿财运，但要小心努力获取。";
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
            else if( shenLiuZhi.equals("食") || shenLiuZhi.equals("伤")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + " 本年相对较好，有财运和事业有变化，都往好的方向发展。";
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str + "本年相对较好，事业、财运上能有发展。";
                    }
                    else {
                        str = str + " 本年相对不好，财运和事业都有变化，或者很辛苦的有发展，或者走往不好的方向发展。易破财，易得伤病。";
                    }
                }
                if( bazi.sex.equals("女")) {
                    if( (guan + sha) > 0 ) {
                        str = str + "对家庭或婚姻有不好的影响。";
                    }
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
            else if( shenLiuZhi.equals("财") || shenLiuZhi.equals("才")) {
                if( sheng >= ke  ) {  /// 身强
                    str = str + "本年相对较好，有财运，事业有发展。";
                }
                else { /// 身弱
                    if( zpSheng >= zpKe ) {
                        str = str + "本年相对较好，事业、财运上能有发展。";
                    }
                    else {
                        str = str + "本年相对不好，财运和事业都有变化，或者很辛苦的有发展，或者往不好方向发展。易破财。";
                    }
                }
                if( bazi.sex.equals("男")) {
                    if( (caip + caiz) == 0 ) {
                        str = str + "可能会有婚姻变动。";
                    }
                    else {
                        str = str + "有异性缘，或者婚姻有变动。";
                    }
                }
            }
        }
        
        return str;
    }

    public List<String> fnSelfPayBigFate(boolean key) {
        //// 分析大运
        List<String> list = new ArrayList<>();
        String str = "　";
        list.add(str);
        str = "     大运分析     ";
        list.add(str);
        str = "----";
        list.add(str);

        DayunLiunian dln;
        String yearGan, yearZhi;
        for( int ii = 0 ; ii < bazi.bigyunList.length ; ii++ ) {
            if( ii > 0 ) {
                if( (bazi.bigyunList[ii].year + 9) >= predictLiuNianEnd ) break;
            }
            
            dln = bazi.bigyunList[ii];
            yearGan = fnComputeShishen(bazi.dayGan, dln.tg);
            yearZhi = fnComputeShishen(bazi.dayGan, dln.dz);
            if( key == true ) {
                str = dln.year + "年 " + (dln.age < 10 ? "0" + dln.age: dln.age.toString()) + "岁开始 " + dln.tg + dln.dz + "大运：行" + 
                yearGan + yearZhi + "运， " + fnSelfPayBigFateWangShuai(bazi.dayGan, dln.dz) +"。 ";
            }
            else {
                Integer yearend = dln.year + 9;
                str = dln.year + "~" + yearend + "年 " + fnSelfPayBigFateWangShuai(bazi.dayGan, dln.dz);
            }

            list.add(str);
            str =  fnSelfGanHeChongFate(dln.tg, key) + fnSelfZhiHeChongFate(dln.dz, key);
            list.add(str);
            str = fnSelfPayBigFateShiShen( dln.tg, dln.dz, key, ii);
            list.add(str);
            str = "　";
            list.add(str);
        }

        return list;
    }

    public List<String> fnSelfPayLiuNian(boolean key) {
        //// 分析流年
        List<String> list = new ArrayList<>();
        String str = "     流年分析     ";
        list.add(str);
        str = "----";
        list.add(str);

        DayunLiunian dln;
        String yearGan, yearZhi;
        for( int ii = 0 ; ii < bazi.bigyunList.length ; ii++ ) {
            dln = bazi.bigyunList[ii];
            for( int jj = 0 ; jj < 10 ; jj++ ) {

                if( (bazi.bigyunList[ii].year + jj) < predictLiuNianBegin ) continue;
                if( (bazi.bigyunList[ii].year + jj) > predictLiuNianEnd ) break;


                yearGan = dln.liunian.substring(jj * 2, jj * 2 +1);
                yearZhi = dln.liunian.substring(jj * 2 + 1, jj * 2 + 2);
                str = (dln.year + jj) + "年 " + ((dln.age + jj) < 10 ? "0" + (dln.age + jj): (dln.age + jj)) + "岁 " + yearGan + yearZhi + " 流年：";

                list.add(str);

                str =  fnSelfGanHeChongLiu(dln.tg, yearGan, key) + fnSelfZhiHeChongLiu(dln.dz, yearZhi, key);
                list.add(str);
    
                str = fnSelfPayLiuNianShiShen( yearGan, yearZhi, dln.tg, dln.dz, key, dln.age + jj);
                list.add(str);

                str = "　";
                list.add(str);
                    
            }  
            if( (bazi.bigyunList[ii].year + 10) > predictLiuNianEnd ) break;

        }

        return list;
    }


    //// 其他工具
    public String fnComputeShishen(String daytg, String gz) {
        String rtn = "";
        String tg = "甲乙丙丁戊己庚辛壬癸"; //char of TianGan
        String dz = "子丑寅卯辰巳午未申酉戌亥"; //char of DiZhi
        int dayIdx = tg.indexOf(daytg);
        if( dayIdx == -1 ) return rtn;
        int gzIdx = tg.indexOf(gz);
        
        if( gzIdx >= 0 )   { //// 天干十神
            //    局主天干　甲　　乙 　丙　 丁　 戊　 己　 庚　 辛　 壬　 癸 
            ////  甲 　　　比肩 劫财 偏印 正印 七杀 正官 偏财 正财 食神 伤官 
            ////  乙 　　　劫财 比肩 正印 偏印 正官 七杀 正财 偏财 伤官 食神 
            ////  丙 　　　食神 伤官 比肩 劫财 偏印 正印 七杀 正官 偏财 正财 
            ////  丁 　　　伤官 食神 劫财 比肩 正印 偏印 正官 七杀 正财 偏财 
            ////  戊 　　　偏财 正财 食神 伤官 比肩 劫财 偏印 正印 七杀 正官 
            ////  己 　　　正财 偏财 伤官 食神 劫财 比肩 正印 偏印 正官 七杀 
            ////  庚 　　　七杀 正官 偏财 正财 食神 伤官 比肩 劫财 偏印 正印 
            ////  辛 　　　正官 七杀 正财 偏财 伤官 食神 劫财 比肩 正印 偏印 
            ////  壬 　　　偏印 正印 七杀 正官 偏财 正财 食神 伤官 比肩 劫财 
            ////  癸 　　　正印 偏印 正官 七杀 正财 偏财 伤官 食神 劫财 比肩 
            
                switch( dayIdx ) {
                  case 0: //// 甲
                    switch( gzIdx ) {
                      case 0: //// 甲
                        rtn = "比";
                        break;
                      case 1: //// 乙
                        rtn = "劫";
                        break;
                      case 2: //// 丙
                        rtn = "食";
                        break;
                      case 3: //// 丁
                        rtn = "伤";
                        break;
                      case 4: //// 戊
                        rtn = "才";
                        break;
                      case 5: //// 己
                        rtn = "财";
                        break;
                      case 6: //// 庚
                        rtn = "煞";
                        break;
                      case 7: //// 辛
                        rtn = "官";
                        break;
                      case 8: //// 壬
                        rtn = "枭";
                        break;
                      case 9: //// 癸
                        rtn = "印";
                        break;
                      default:
                        break;
                    }
                    break;
                  case 1: //// 乙
                    switch( gzIdx ) {
                      case 0: //// 甲
                        rtn = "劫";
                        break;
                      case 1: //// 乙
                        rtn = "比";
                        break;
                      case 2: //// 丙
                        rtn = "伤";
                        break;
                      case 3: //// 丁
                        rtn = "食";
                        break;
                      case 4: //// 戊
                        rtn = "财";
                        break;
                      case 5: //// 己
                        rtn = "才";
                        break;
                      case 6: //// 庚
                        rtn = "官";
                        break;
                      case 7: //// 辛
                        rtn = "煞";
                        break;
                      case 8: //// 壬
                        rtn = "印";
                        break;
                      case 9: //// 癸
                        rtn = "枭";
                        break;
                      default:
                        break;
                    }
                    break;
                  case 2: //// 丙
                    switch( gzIdx ) {
                      case 0: //// 甲
                        rtn = "枭";
                        break;
                      case 1: //// 乙
                        rtn = "印";
                        break;
                      case 2: //// 丙
                        rtn = "比";
                        break;
                      case 3: //// 丁
                        rtn = "劫";
                        break;
                      case 4: //// 戊
                        rtn = "食";
                        break;
                      case 5: //// 己
                        rtn = "伤";
                        break;
                      case 6: //// 庚
                        rtn = "才";
                        break;
                      case 7: //// 辛
                        rtn = "财";
                        break;
                      case 8: //// 壬
                        rtn = "煞";
                        break;
                      case 9: //// 癸
                        rtn = "官";
                        break;
                      default:
                        break;
                    }
                    break;
                  case 3: //// 丁
                    switch( gzIdx ) {
                      case 0: //// 甲
                        rtn = "印";
                        break;
                      case 1: //// 乙
                        rtn = "枭";
                        break;
                      case 2: //// 丙
                        rtn = "劫";
                        break;
                      case 3: //// 丁
                        rtn = "比";
                        break;
                      case 4: //// 戊
                        rtn = "伤";
                        break;
                      case 5: //// 己
                        rtn = "食";
                        break;
                      case 6: //// 庚
                        rtn = "财";
                        break;
                      case 7: //// 辛
                        rtn = "才";
                        break;
                      case 8: //// 壬
                        rtn = "官";
                        break;
                      case 9: //// 癸
                        rtn = "煞";
                        break;
                      default:
                        break;
                    }
                    break;
                  case 4: //// 戊
                    switch( gzIdx ) {
                      case 0: //// 甲
                        rtn = "煞";
                        break;
                      case 1: //// 乙
                        rtn = "官";
                        break;
                      case 2: //// 丙
                        rtn = "枭";
                        break;
                      case 3: //// 丁
                        rtn = "印";
                        break;
                      case 4: //// 戊
                        rtn = "比";
                        break;
                      case 5: //// 己
                        rtn = "劫";
                        break;
                      case 6: //// 庚
                        rtn = "食";
                        break;
                      case 7: //// 辛
                        rtn = "伤";
                        break;
                      case 8: //// 壬
                        rtn = "才";
                        break;
                      case 9: //// 癸
                        rtn = "财";
                        break;
                      default:
                        break;
                    }      
                    break;
                  case 5: //// 己
                    switch( gzIdx ) {
                      case 0: //// 甲
                        rtn = "官";
                        break;
                      case 1: //// 乙
                        rtn = "煞";
                        break;
                      case 2: //// 丙
                        rtn = "印";
                        break;
                      case 3: //// 丁
                        rtn = "枭";
                        break;
                      case 4: //// 戊
                        rtn = "劫";
                        break;
                      case 5: //// 己
                        rtn = "比";
                        break;
                      case 6: //// 庚
                        rtn = "伤";
                        break;
                      case 7: //// 辛
                        rtn = "食";
                        break;
                      case 8: //// 壬
                        rtn = "财";
                        break;
                      case 9: //// 癸
                        rtn = "才";
                        break;
                      default:
                        break;
                    }
                    break;
                  case 6: //// 庚
                    switch( gzIdx ) {
                      case 0: //// 甲
                        rtn = "才";
                        break;
                      case 1: //// 乙
                        rtn = "财";
                        break;
                      case 2: //// 丙
                        rtn = "煞";
                        break;
                      case 3: //// 丁
                        rtn = "官";
                        break;
                      case 4: //// 戊
                        rtn = "枭";
                        break;
                      case 5: //// 己
                        rtn = "印";
                        break;
                      case 6: //// 庚
                        rtn = "比";
                        break;
                      case 7: //// 辛
                        rtn = "劫";
                        break;
                      case 8: //// 壬
                        rtn = "食";
                        break;
                      case 9: //// 癸
                        rtn = "伤";
                        break;
                      default:
                        break;
                    }      
                    break;
                  case 7: //// 辛
                    switch( gzIdx ) {
                      case 0: //// 甲
                        rtn = "财";
                        break;
                      case 1: //// 乙
                        rtn = "才";
                        break;
                      case 2: //// 丙
                        rtn = "官";
                        break;
                      case 3: //// 丁
                        rtn = "煞";
                        break;
                      case 4: //// 戊
                        rtn = "印";
                        break;
                      case 5: //// 己
                        rtn = "枭";
                        break;
                      case 6: //// 庚
                        rtn = "劫";
                        break;
                      case 7: //// 辛
                        rtn = "比";
                        break;
                      case 8: //// 壬
                        rtn = "伤";
                        break;
                      case 9: //// 癸
                        rtn = "食";
                        break;
                      default:
                        break;
                    }
                    break;
                  case 8: //// 壬
                    switch( gzIdx ) {
                      case 0: //// 甲
                        rtn = "食";
                        break;
                      case 1: //// 乙
                        rtn = "伤";
                        break;
                      case 2: //// 丙
                        rtn = "才";
                        break;
                      case 3: //// 丁
                        rtn = "财";
                        break;
                      case 4: //// 戊
                        rtn = "煞";
                        break;
                      case 5: //// 己
                        rtn = "官";
                        break;
                      case 6: //// 庚
                        rtn = "枭";
                        break;
                      case 7: //// 辛
                        rtn = "印";
                        break;
                      case 8: //// 壬
                        rtn = "比";
                        break;
                      case 9: //// 癸
                        rtn = "劫";
                        break;
                      default:
                        break;
                    }
                    break;
                  case 9: //// 癸
                    switch( gzIdx ) {
                      case 0: //// 甲
                        rtn = "伤";
                        break;
                      case 1: //// 乙
                        rtn = "食";
                        break;
                      case 2: //// 丙
                        rtn = "财";
                        break;
                      case 3: //// 丁
                        rtn = "才";
                        break;
                      case 4: //// 戊
                        rtn = "官";
                        break;
                      case 5: //// 己
                        rtn = "煞";
                        break;
                      case 6: //// 庚
                        rtn = "印";
                        break;
                      case 7: //// 辛
                        rtn = "枭";
                        break;
                      case 8: //// 壬
                        rtn = "劫";
                        break;
                      case 9: //// 癸
                        rtn = "比";
                        break;
                      default:
                        break;
                    }
                    break;
                  default:
                    break;
                }
              }  
              else {
                gzIdx = dz.indexOf(gz);
                if( gzIdx >= 0 ) { //// 地支十神
            // 局主地支　甲　　乙 　丙　 丁　 戊　 己　 庚　 辛　 壬　 癸
            // 子 　　　正印 偏印 正官 七杀 正财 偏财 伤官 食神 劫财 比肩 
            // 丑 　　　正财 偏财 伤官 食神 劫财 比肩 正印 偏印 正官 七杀 
            // 寅 　　　比肩 劫财 偏印 正印 七杀 正官 偏财 正财 食神 伤官 
            // 卯　　　 劫财 比肩 正印 偏印 正官 七杀 正财 偏财 伤官 食神 
            // 辰　　　 偏财 正财 食神 伤官 比肩 劫财 偏印 正印 七杀 正官 
            // 巳　　　 伤官 食神 劫财 比肩 正印 偏印 正官 七杀 正财 偏财 
            // 午　　　 食神 伤官 比肩 劫财 偏印 正印 七杀 正官 偏财 正财 
            // 未　　　 正财 偏财 伤官 食神 劫财 比肩 正印 偏印 正官 七杀 
            // 申　　　 七杀 正官 偏财 正财 食神 伤官 比肩 劫财 偏印 正印 
            // 酉　　　 正官 七杀 正财 偏财 伤官 食神 劫财 比肩 正印 偏印 
            // 戌　　　 偏财 正财 食神 伤官 比肩 劫财 偏印 正印 七杀 正官 
            // 亥　　　 偏印 正印 七杀 正官 偏财 正财 食神 伤官 比肩 劫财      
                  switch( dayIdx ) {
                    case 0: //// 甲
                      switch( gzIdx ) {
                        case 0: //// 子
                          rtn = "印";
                          break;
                        case 1: //// 丑
                          rtn = "财";
                          break;
                        case 2: //// 寅
                          rtn = "比";
                          break;
                        case 3: //// 卯
                          rtn = "劫";
                          break;
                        case 4: //// 辰
                          rtn = "才";
                          break;
                        case 5: //// 巳
                          rtn = "伤";
                          break;
                        case 6: //// 午
                          rtn = "食";
                          break;
                        case 7: //// 未
                          rtn = "财";
                          break;
                        case 8: //// 申
                          rtn = "煞";
                          break;
                        case 9: //// 酉
                          rtn = "官";
                          break;
                        case 10: //// 戌
                          rtn = "才";
                          break;
                        case 11: //// 亥
                          rtn = "枭";
                          break;
                        default:
                          break;
                      }
                      break;
                    case 1: //// 乙
                      switch( gzIdx ) {
                        case 0: //// 子
                          rtn = "枭";
                          break;
                        case 1: //// 丑
                          rtn = "才";
                          break;
                        case 2: //// 寅
                          rtn = "劫";
                          break;
                        case 3: //// 卯
                          rtn = "比";
                          break;
                        case 4: //// 辰
                          rtn = "财";
                          break;
                        case 5: //// 巳
                          rtn = "食";
                          break;
                        case 6: //// 午
                          rtn = "伤";
                          break;
                        case 7: //// 未
                          rtn = "才";
                          break;
                        case 8: //// 申
                          rtn = "官";
                          break;
                        case 9: //// 酉
                          rtn = "煞";
                          break;
                        case 10: //// 戌
                          rtn = "财";
                          break;
                        case 11: //// 亥
                          rtn = "印";
                          break;
                      }
                      break;
                    case 2: //// 丙
                      switch( gzIdx ) {
                        case 0: //// 子
                          rtn = "官";
                          break;
                        case 1: //// 丑
                          rtn = "伤";
                          break;
                        case 2: //// 寅
                          rtn = "枭";
                          break;
                        case 3: //// 卯
                          rtn = "印";
                          break;
                        case 4: //// 辰
                          rtn = "食";
                          break;
                        case 5: //// 巳
                          rtn = "劫";
                          break;
                        case 6: //// 午
                          rtn = "比";
                          break;
                        case 7: //// 未
                          rtn = "伤";
                          break;
                        case 8: //// 申
                          rtn = "才";
                          break;
                        case 9: //// 酉
                          rtn = "财";
                          break;
                        case 10: //// 戌
                          rtn = "食";
                          break;
                        case 11: //// 亥
                          rtn = "煞";
                          break;
                      }
                      break;
                    case 3: //// 丁
                      switch( gzIdx ) {
                        case 0: //// 子
                          rtn = "煞";
                          break;
                        case 1: //// 丑
                          rtn = "食";
                          break;
                        case 2: //// 寅
                          rtn = "印";
                          break;
                        case 3: //// 卯
                          rtn = "枭";
                          break;
                        case 4: //// 辰
                          rtn = "伤";
                          break;
                        case 5: //// 巳
                          rtn = "比";
                          break;
                        case 6: //// 午
                          rtn = "劫";
                          break;
                        case 7: //// 未
                          rtn = "食";
                          break;
                        case 8: //// 申
                          rtn = "财";
                          break;
                        case 9: //// 酉
                          rtn = "才";
                          break;
                        case 10: //// 戌
                          rtn = "伤";
                          break;
                        case 11: //// 亥
                          rtn = "官";
                          break;
                      }
                      break;
                    case 4: //// 戊
                      switch( gzIdx ) {
                        case 0: //// 子
                          rtn = "财";
                          break;
                        case 1: //// 丑
                          rtn = "劫";
                          break;
                        case 2: //// 寅
                          rtn = "煞";
                          break;
                        case 3: //// 卯
                          rtn = "官";
                          break;
                        case 4: //// 辰
                          rtn = "比";
                          break;
                        case 5: //// 巳
                          rtn = "印";
                          break;
                        case 6: //// 午
                          rtn = "枭";
                          break;
                        case 7: //// 未
                          rtn = "劫";
                          break;
                        case 8: //// 申
                          rtn = "食";
                          break;
                        case 9: //// 酉
                          rtn = "伤";
                          break;
                        case 10: //// 戌
                          rtn = "比";
                          break;
                        case 11: //// 亥
                          rtn = "才";
                          break;
                      }
                      break;
                    case 5: //// 己
                      switch( gzIdx ) {
                        case 0: //// 子
                          rtn = "才";
                          break;
                        case 1: //// 丑
                          rtn = "比";
                          break;
                        case 2: //// 寅
                          rtn = "官";
                          break;
                        case 3: //// 卯
                          rtn = "煞";
                          break;
                        case 4: //// 辰
                          rtn = "劫";
                          break;
                        case 5: //// 巳
                          rtn = "枭";
                          break;
                        case 6: //// 午
                          rtn = "印";
                          break;
                        case 7: //// 未
                          rtn = "比";
                          break;
                        case 8: //// 申
                          rtn = "伤";
                          break;
                        case 9: //// 酉
                          rtn = "食";
                          break;
                        case 10: //// 戌
                          rtn = "劫";
                          break;
                        case 11: //// 亥
                          rtn = "财";
                          break;
                      }
                      break;
                    case 6: //// 庚
                      switch( gzIdx ) {
                        case 0: //// 子
                          rtn = "伤";
                          break;
                        case 1: //// 丑
                          rtn = "印";
                          break;
                        case 2: //// 寅
                          rtn = "才";
                          break;
                        case 3: //// 卯
                          rtn = "财";
                          break;
                        case 4: //// 辰
                          rtn = "枭";
                          break;
                        case 5: //// 巳
                          rtn = "官";
                          break;
                        case 6: //// 午
                          rtn = "煞";
                          break;
                        case 7: //// 未
                          rtn = "印";
                          break;
                        case 8: //// 申
                          rtn = "比";
                          break;
                        case 9: //// 酉
                          rtn = "劫";
                          break;
                        case 10: //// 戌
                          rtn = "枭";
                          break;
                        case 11: //// 亥
                          rtn = "食";
                          break;
                      }
                      break;
                    case 7: //// 辛
                      switch( gzIdx ) {
                        case 0: //// 子
                          rtn = "食";
                          break;
                        case 1: //// 丑
                          rtn = "枭";
                          break;
                        case 2: //// 寅
                          rtn = "财";
                          break;
                        case 3: //// 卯
                          rtn = "才";
                          break;
                        case 4: //// 辰
                          rtn = "印";
                          break;
                        case 5: //// 巳
                          rtn = "煞";
                          break;
                        case 6: //// 午
                          rtn = "官";
                          break;
                        case 7: //// 未
                          rtn = "枭";
                          break;
                        case 8: //// 申
                          rtn = "劫";
                          break;
                        case 9: //// 酉
                          rtn = "比";
                          break;
                        case 10: //// 戌
                          rtn = "印";
                          break;
                        case 11: //// 亥
                          rtn = "伤";
                          break;
                      }
                      break;
                    case 8: //// 壬
                      switch( gzIdx ) {
                        case 0: //// 子
                          rtn = "劫";
                          break;
                        case 1: //// 丑
                          rtn = "官";
                          break;
                        case 2: //// 寅
                          rtn = "食";
                          break;
                        case 3: //// 卯
                          rtn = "伤";
                          break;
                        case 4: //// 辰
                          rtn = "煞";
                          break;
                        case 5: //// 巳
                          rtn = "财";
                          break;
                        case 6: //// 午
                          rtn = "才";
                          break;
                        case 7: //// 未
                          rtn = "官";
                          break;
                        case 8: //// 申
                          rtn = "枭";
                          break;
                        case 9: //// 酉
                          rtn = "印";
                          break;
                        case 10: //// 戌
                          rtn = "煞";
                          break;
                        case 11: //// 亥
                          rtn = "比";
                          break;
                      }
                      break;
                    case 9: //// 癸
                      switch( gzIdx ) {
                        case 0: //// 子
                          rtn = "比";
                          break;
                        case 1: //// 丑
                          rtn = "煞";
                          break;
                        case 2: //// 寅
                          rtn = "伤";
                          break;
                        case 3: //// 卯
                          rtn = "食";
                          break;
                        case 4: //// 辰
                          rtn = "官";
                          break;
                        case 5: //// 巳
                          rtn = "才";
                          break;
                        case 6: //// 午
                          rtn = "财";
                          break;
                        case 7: //// 未
                          rtn = "煞";
                          break;
                        case 8: //// 申
                          rtn = "印";
                          break;
                        case 9: //// 酉
                          rtn = "枭";
                          break;
                        case 10: //// 戌
                          rtn = "官";
                          break;
                        case 11: //// 亥
                          rtn = "劫";
                          break;
                      }
                      break;        
                  }
                }
              }
                  
        return rtn;
    }

    public String fnComputeDzcg(String daytg, String dz) {
        String rtn = "";
        switch(daytg) {
            case "甲":
                switch(dz) {
                    case "子":
                        rtn = "[{\"tg\":\"癸\",\"ss\":\"印\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "丑":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"癸\",\"ss\":\"印\",\"color\":\"#10c0b0\"},{\"tg\":\"辛\",\"ss\":\"官\",\"color\":\"white\"}]";
                        break;
                    case "寅":
                        rtn = "[{\"tg\":\"甲\",\"ss\":\"比\",\"color\":\"green\"},{\"tg\":\"丙\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"}]";
                        break;
                    case "卯":
                        rtn = "[{\"tg\":\"乙\",\"ss\":\"劫\",\"color\":\"green\"}]";
                        break;
                    case "辰":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"乙\",\"ss\":\"劫\",\"color\":\"green\"},{\"tg\":\"癸\",\"ss\":\"印\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "巳":
                        rtn = "[{\"tg\":\"丙\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"庚\",\"ss\":\"煞\",\"color\":\"white\"}]";
                        break;
                    case "午":
                        rtn = "[{\"tg\":\"丁\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"己\",\"ss\":\"财\",\"color\":\"grey\"}]";
                        break;
                    case "未":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"丁\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"乙\",\"ss\":\"劫\",\"color\":\"green\"}]";
                        break;
                    case "申":
                        rtn = "[{\"tg\":\"庚\",\"ss\":\"煞\",\"color\":\"white\"},{\"tg\":\"壬\",\"ss\":\"枭\",\"color\":\"#10c0b0\"},{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"}]";
                        break;
                    case "酉":
                        rtn = "[{\"tg\":\"辛\",\"ss\":\"官\",\"color\":\"white\"}]";
                        break;
                    case "戌":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"辛\",\"ss\":\"官\",\"color\":\"white\"},{\"tg\":\"丁\",\"ss\":\"伤\",\"color\":\"red\"}]";
                        break;
                    case "亥":
                        rtn = "[{\"tg\":\"壬\",\"ss\":\"枭\",\"color\":\"#10c0b0\"},{\"tg\":\"甲\",\"ss\":\"比\",\"color\":\"green\"}]";
                        break;
                    default:
                        break;
                }
                break;
            case "乙":
                switch(dz) {
                    case "子":
                        rtn = "[{\"tg\":\"癸\",\"ss\":\"枭\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "丑":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"癸\",\"ss\":\"枭\",\"color\":\"#10c0b0\"},{\"tg\":\"辛\",\"ss\":\"煞\",\"color\":\"white\"}]";
                        break;
                    case "寅":
                        rtn = "[{\"tg\":\"甲\",\"ss\":\"劫\",\"color\":\"green\"},{\"tg\":\"丙\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"}]";
                        break;
                    case "卯":
                        rtn = "[{\"tg\":\"乙\",\"ss\":\"比\",\"color\":\"green\"}]";
                        break;
                    case "辰":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"乙\",\"ss\":\"比\",\"color\":\"green\"},{\"tg\":\"癸\",\"ss\":\"枭\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "巳":
                        rtn = "[{\"tg\":\"丙\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"庚\",\"ss\":\"官\",\"color\":\"white\"}]";
                        break;
                    case "午":
                        rtn = "[{\"tg\":\"丁\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"己\",\"ss\":\"才\",\"color\":\"grey\"}]";
                        break;
                    case "未":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"丁\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"乙\",\"ss\":\"比\",\"color\":\"green\"}]";
                        break;
                    case "申":
                        rtn = "[{\"tg\":\"庚\",\"ss\":\"官\",\"color\":\"white\"},{\"tg\":\"壬\",\"ss\":\"印\",\"color\":\"#10c0b0\"},{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"}]";
                        break;
                    case "酉":
                        rtn = "[{\"tg\":\"辛\",\"ss\":\"煞\",\"color\":\"white\"}]";
                        break;
                    case "戌":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"辛\",\"ss\":\"煞\",\"color\":\"white\"},{\"tg\":\"丁\",\"ss\":\"食\",\"color\":\"red\"}]";
                        break;
                    case "亥":
                        rtn = "[{\"tg\":\"壬\",\"ss\":\"印\",\"color\":\"#10c0b0\"},{\"tg\":\"甲\",\"ss\":\"劫\",\"color\":\"green\"}]";
                        break;
                    default:
                        break;
                }
                break;
            case "丙":
                switch(dz) {
                    case "子":
                        rtn = "[{\"tg\":\"癸\",\"ss\":\"印\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "丑":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"癸\",\"ss\":\"印\",\"color\":\"#10c0b0\"},{\"tg\":\"辛\",\"ss\":\"官\",\"color\":\"white\"}]";
                        break;
                    case "寅":
                        rtn = "[{\"tg\":\"甲\",\"ss\":\"比\",\"color\":\"green\"},{\"tg\":\"丙\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"}]";
                        break;
                    case "卯":
                        rtn = "[{\"tg\":\"乙\",\"ss\":\"劫\",\"color\":\"green\"}]";
                        break;
                    case "辰":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"乙\",\"ss\":\"劫\",\"color\":\"green\"},{\"tg\":\"癸\",\"ss\":\"印\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "巳":
                        rtn = "[{\"tg\":\"丙\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"庚\",\"ss\":\"煞\",\"color\":\"white\"}]";
                        break;
                    case "午":
                        rtn = "[{\"tg\":\"丁\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"己\",\"ss\":\"财\",\"color\":\"grey\"}]";
                        break;
                    case "未":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"丁\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"乙\",\"ss\":\"劫\",\"color\":\"green\"}]";
                        break;
                    case "申":
                        rtn = "[{\"tg\":\"庚\",\"ss\":\"煞\",\"color\":\"white\"},{\"tg\":\"壬\",\"ss\":\"枭\",\"color\":\"#10c0b0\"},{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"}]";
                        break;
                    case "酉":
                        rtn = "[{\"tg\":\"辛\",\"ss\":\"官\",\"color\":\"white\"}]";
                        break;
                    case "戌":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"辛\",\"ss\":\"官\",\"color\":\"white\"},{\"tg\":\"丁\",\"ss\":\"伤\",\"color\":\"red\"}]";
                        break;
                    case "亥":
                        rtn = "[{\"tg\":\"壬\",\"ss\":\"枭\",\"color\":\"#10c0b0\"},{\"tg\":\"甲\",\"ss\":\"比\",\"color\":\"green\"}]";
                        break;
                    default:
                        break;
                }
                break;
            case "丁":
                switch(dz) {
                    case "子":
                        rtn = "[{\"tg\":\"癸\",\"ss\":\"枭\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "丑":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"癸\",\"ss\":\"枭\",\"color\":\"#10c0b0\"},{\"tg\":\"辛\",\"ss\":\"煞\",\"color\":\"white\"}]";
                        break;
                    case "寅":
                        rtn = "[{\"tg\":\"甲\",\"ss\":\"劫\",\"color\":\"green\"},{\"tg\":\"丙\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"}]";
                        break;
                    case "卯":
                        rtn = "[{\"tg\":\"乙\",\"ss\":\"比\",\"color\":\"green\"}]";
                        break;
                    case "辰":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"乙\",\"ss\":\"比\",\"color\":\"green\"},{\"tg\":\"癸\",\"ss\":\"枭\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "巳":
                        rtn = "[{\"tg\":\"丙\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"庚\",\"ss\":\"官\",\"color\":\"white\"}]";
                        break;
                    case "午":
                        rtn = "[{\"tg\":\"丁\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"己\",\"ss\":\"才\",\"color\":\"grey\"}]";
                        break;
                    case "未":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"丁\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"乙\",\"ss\":\"比\",\"color\":\"green\"}]";
                        break;
                    case "申":
                        rtn = "[{\"tg\":\"庚\",\"ss\":\"官\",\"color\":\"white\"},{\"tg\":\"壬\",\"ss\":\"印\",\"color\":\"#10c0b0\"},{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"}]";
                        break;
                    case "酉":
                        rtn = "[{\"tg\":\"辛\",\"ss\":\"煞\",\"color\":\"white\"}]";
                        break;
                    case "戌":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"辛\",\"ss\":\"煞\",\"color\":\"white\"},{\"tg\":\"丁\",\"ss\":\"食\",\"color\":\"red\"}]";
                        break;
                    case "亥":  
                        rtn = "[{\"tg\":\"壬\",\"ss\":\"印\",\"color\":\"#10c0b0\"},{\"tg\":\"甲\",\"ss\":\"劫\",\"color\":\"green\"}]";
                        break;  
                    default:
                        break;
                }
                break;
            case "戊":
                switch(dz) {
                    case "子":
                        rtn = "[{\"tg\":\"癸\",\"ss\":\"印\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "丑":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"癸\",\"ss\":\"印\",\"color\":\"#10c0b0\"},{\"tg\":\"辛\",\"ss\":\"官\",\"color\":\"white\"}]";
                        break;
                    case "寅":
                        rtn = "[{\"tg\":\"甲\",\"ss\":\"比\",\"color\":\"green\"},{\"tg\":\"丙\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"}]";
                        break;
                    case "卯":
                        rtn = "[{\"tg\":\"乙\",\"ss\":\"劫\",\"color\":\"green\"}]";
                        break;
                    case "辰":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"乙\",\"ss\":\"劫\",\"color\":\"green\"},{\"tg\":\"癸\",\"ss\":\"印\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "巳":
                        rtn = "[{\"tg\":\"丙\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"庚\",\"ss\":\"煞\",\"color\":\"white\"}]";
                        break;
                    case "午":
                        rtn = "[{\"tg\":\"丁\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"己\",\"ss\":\"财\",\"color\":\"grey\"}]";
                        break;
                    case "未":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"丁\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"乙\",\"ss\":\"劫\",\"color\":\"green\"}]";
                        break;
                    case "申":
                        rtn = "[{\"tg\":\"庚\",\"ss\":\"煞\",\"color\":\"white\"},{\"tg\":\"壬\",\"ss\":\"枭\",\"color\":\"#10c0b0\"},{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"}]";
                        break;
                    case "酉":
                        rtn = "[{\"tg\":\"辛\",\"ss\":\"官\",\"color\":\"white\"}]";
                        break;
                    case "戌":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"辛\",\"ss\":\"官\",\"color\":\"white\"},{\"tg\":\"丁\",\"ss\":\"伤\",\"color\":\"red\"}]";
                        break;
                    case "亥":
                        rtn = "[{\"tg\":\"壬\",\"ss\":\"枭\",\"color\":\"#10c0b0\"},{\"tg\":\"甲\",\"ss\":\"比\",\"color\":\"green\"}]";
                        break;
                    default:       
                        break;
                }
                break;
            case "己":
                switch(dz) {
                    case "子":
                        rtn = "[{\"tg\":\"癸\",\"ss\":\"枭\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "丑":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"癸\",\"ss\":\"枭\",\"color\":\"#10c0b0\"},{\"tg\":\"辛\",\"ss\":\"煞\",\"color\":\"white\"}]";
                        break;
                    case "寅":
                        rtn = "[{\"tg\":\"甲\",\"ss\":\"劫\",\"color\":\"green\"},{\"tg\":\"丙\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"}]";
                        break;
                    case "卯":
                        rtn = "[{\"tg\":\"乙\",\"ss\":\"比\",\"color\":\"green\"}]";
                        break;
                    case "辰":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"乙\",\"ss\":\"比\",\"color\":\"green\"},{\"tg\":\"癸\",\"ss\":\"枭\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "巳":
                        rtn = "[{\"tg\":\"丙\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"庚\",\"ss\":\"官\",\"color\":\"white\"}]";
                        break;
                    case "午":
                        rtn = "[{\"tg\":\"丁\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"己\",\"ss\":\"才\",\"color\":\"grey\"}]";
                        break;
                    case "未":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"丁\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"乙\",\"ss\":\"比\",\"color\":\"green\"}]";
                        break;
                    case "申":
                        rtn = "[{\"tg\":\"庚\",\"ss\":\"官\",\"color\":\"white\"},{\"tg\":\"壬\",\"ss\":\"印\",\"color\":\"#10c0b0\"},{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"}]";
                        break;
                    case "酉":
                        rtn = "[{\"tg\":\"辛\",\"ss\":\"煞\",\"color\":\"white\"}]";
                        break;
                    case "戌":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"辛\",\"ss\":\"煞\",\"color\":\"white\"},{\"tg\":\"丁\",\"ss\":\"食\",\"color\":\"red\"}]";
                        break;
                    case "亥":
                        rtn = "[{\"tg\":\"壬\",\"ss\":\"印\",\"color\":\"#10c0b0\"},{\"tg\":\"甲\",\"ss\":\"劫\",\"color\":\"green\"}]";
                        break;
                    default:
                        break;
                }
                break;
            case "庚":
                switch(dz) {
                    case "子":
                        rtn = "[{\"tg\":\"癸\",\"ss\":\"印\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "丑":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"癸\",\"ss\":\"印\",\"color\":\"#10c0b0\"},{\"tg\":\"辛\",\"ss\":\"官\",\"color\":\"white\"}]";
                        break;
                    case "寅":
                        rtn = "[{\"tg\":\"甲\",\"ss\":\"比\",\"color\":\"green\"},{\"tg\":\"丙\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"}]";
                        break;
                    case "卯":
                        rtn = "[{\"tg\":\"乙\",\"ss\":\"劫\",\"color\":\"green\"}]";
                        break;
                    case "辰":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"乙\",\"ss\":\"劫\",\"color\":\"green\"},{\"tg\":\"癸\",\"ss\":\"印\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "巳":
                        rtn = "[{\"tg\":\"丙\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"庚\",\"ss\":\"煞\",\"color\":\"white\"}]";
                        break;
                    case "午":
                        rtn = "[{\"tg\":\"丁\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"己\",\"ss\":\"财\",\"color\":\"grey\"}]";
                        break;
                    case "未":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"丁\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"乙\",\"ss\":\"劫\",\"color\":\"green\"}]";
                        break;
                    case "申":
                        rtn = "[{\"tg\":\"庚\",\"ss\":\"煞\",\"color\":\"white\"},{\"tg\":\"壬\",\"ss\":\"枭\",\"color\":\"#10c0b0\"},{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"}]";
                        break;
                    case "酉":
                        rtn = "[{\"tg\":\"辛\",\"ss\":\"官\",\"color\":\"white\"}]";
                        break;
                    case "戌":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"辛\",\"ss\":\"官\",\"color\":\"white\"},{\"tg\":\"丁\",\"ss\":\"伤\",\"color\":\"red\"}]";
                        break;
                    case "亥":
                        rtn = "[{\"tg\":\"壬\",\"ss\":\"枭\",\"color\":\"#10c0b0\"},{\"tg\":\"甲\",\"ss\":\"比\",\"color\":\"green\"}]";
                        break;
                    default:
                        break;
                }
                break;
            case "辛":
                switch(dz) {
                    case "子":
                        rtn = "[{\"tg\":\"癸\",\"ss\":\"枭\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "丑":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"癸\",\"ss\":\"枭\",\"color\":\"#10c0b0\"},{\"tg\":\"辛\",\"ss\":\"煞\",\"color\":\"white\"}]";
                        break;
                    case "寅":
                        rtn = "[{\"tg\":\"甲\",\"ss\":\"劫\",\"color\":\"green\"},{\"tg\":\"丙\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"}]";
                        break;
                    case "卯":
                        rtn = "[{\"tg\":\"乙\",\"ss\":\"比\",\"color\":\"green\"}]";
                        break;
                    case "辰":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"乙\",\"ss\":\"比\",\"color\":\"green\"},{\"tg\":\"癸\",\"ss\":\"枭\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "巳":
                        rtn = "[{\"tg\":\"丙\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"庚\",\"ss\":\"官\",\"color\":\"white\"}]";
                        break;
                    case "午":
                        rtn = "[{\"tg\":\"丁\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"己\",\"ss\":\"才\",\"color\":\"grey\"}]";
                        break;
                    case "未":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"丁\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"乙\",\"ss\":\"比\",\"color\":\"green\"}]";
                        break;
                    case "申":
                        rtn = "[{\"tg\":\"庚\",\"ss\":\"官\",\"color\":\"white\"},{\"tg\":\"壬\",\"ss\":\"印\",\"color\":\"#10c0b0\"},{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"}]";
                        break;
                    case "酉":
                        rtn = "[{\"tg\":\"辛\",\"ss\":\"煞\",\"color\":\"white\"}]";
                        break;
                    case "戌":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"辛\",\"ss\":\"煞\",\"color\":\"white\"},{\"tg\":\"丁\",\"ss\":\"食\",\"color\":\"red\"}]";
                        break;
                    case "亥":
                        rtn = "[{\"tg\":\"壬\",\"ss\":\"印\",\"color\":\"#10c0b0\"},{\"tg\":\"甲\",\"ss\":\"劫\",\"color\":\"green\"}]";
                        break;
                    default:
                        break;
                }
                break;
            case "壬":
                switch(dz) {
                    case "子":
                        rtn = "[{\"tg\":\"癸\",\"ss\":\"印\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "丑":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"癸\",\"ss\":\"印\",\"color\":\"#10c0b0\"},{\"tg\":\"辛\",\"ss\":\"官\",\"color\":\"white\"}]";
                        break;
                    case "寅":
                        rtn = "[{\"tg\":\"甲\",\"ss\":\"比\",\"color\":\"green\"},{\"tg\":\"丙\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"}]";
                        break;
                    case "卯":
                        rtn = "[{\"tg\":\"乙\",\"ss\":\"劫\",\"color\":\"green\"}]";
                        break;
                    case "辰":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"乙\",\"ss\":\"劫\",\"color\":\"green\"},{\"tg\":\"癸\",\"ss\":\"印\",\"color\":\"#10c0b0\"}]";
                        break;
                    case "巳":
                        rtn = "[{\"tg\":\"丙\",\"ss\":\"食\",\"color\":\"red\"},{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"庚\",\"ss\":\"煞\",\"color\":\"white\"}]";
                        break;
                    case "午":
                        rtn = "[{\"tg\":\"丁\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"己\",\"ss\":\"财\",\"color\":\"grey\"}]";
                        break;
                    case "未":
                        rtn = "[{\"tg\":\"己\",\"ss\":\"财\",\"color\":\"grey\"},{\"tg\":\"丁\",\"ss\":\"伤\",\"color\":\"red\"},{\"tg\":\"乙\",\"ss\":\"劫\",\"color\":\"green\"}]";
                        break;
                    case "申":
                        rtn = "[{\"tg\":\"庚\",\"ss\":\"煞\",\"color\":\"white\"},{\"tg\":\"壬\",\"ss\":\"枭\",\"color\":\"#10c0b0\"},{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"}]";
                        break;
                    case "酉":
                        rtn = "[{\"tg\":\"辛\",\"ss\":\"官\",\"color\":\"white\"}]";
                        break;
                    case "戌":
                        rtn = "[{\"tg\":\"戊\",\"ss\":\"才\",\"color\":\"grey\"},{\"tg\":\"辛\",\"ss\":\"官\",\"color\":\"white\"},{\"tg\":\"丁\",\"ss\":\"伤\",\"color\":\"red\"}]";
                        break;
                    case "亥":
                        rtn = "[{\"tg\":\"壬\",\"ss\":\"枭\",\"color\":\"#10c0b0\"},{\"tg\":\"甲\",\"ss\":\"比\",\"color\":\"green\"}]";
                        break;
                    default:
                        break;
                }
                break;
            default:
                break;
        }
        return rtn;
    }

    public String fnGz2Wu(String gz) {
        String rtn = "";
        switch(gz) {
            case "甲":
                rtn = "阳木";
                break;
            case "乙":
                rtn = "阴木";
                break;
            case "丙":
                rtn = "阳火";
                break;
            case "丁":
                rtn = "阴火";
                break;
            case "戊":
                rtn = "阳土";
                break;
            case "己":
                rtn = "阴土";
                break;
            case "庚":
                rtn = "阳金";
                break;
            case "辛":
                rtn = "阴金";
                break;
            case "壬":
                rtn = "阳水";
                break;
            case "癸":
                rtn = "阴水";
                break;
            case "子":
                rtn = "阳水";
                break;
            case "丑":
                rtn = "阴土";
                break;
            case "寅":
                rtn = "阳木";
                break;
            case "卯":
                rtn = "阴木";
                break;
            case "辰":
                rtn = "阳土";
                break;
            case "巳":
                rtn = "阴火";
                break;
            case "午":
                rtn = "阳火";
                break;
            case "未":
                rtn = "阴土";
                break;
            case "申":
                rtn = "阳金";
                break;
            case "酉":
                rtn = "阴金";
                break;
            case "戌":
                rtn = "阳土";
                break;
            case "亥":
                rtn = "阴水";
                break;
            default:
                break;
        }
        return rtn;
    }

    public String fnComputeXiYong(Integer zpSheng, Integer zpKe) {
        String rtn = "";
        if(zpKe > zpSheng) {
            if(bazi.dayGan.equals("甲") || bazi.dayGan.equals("乙")) {
                rtn = "水";
                shenXyz = "印";
                shenXyp = "枭";
            }
            if(bazi.dayGan.equals("丙") || bazi.dayGan.equals("丁")) {
                rtn = "木";
                shenXyz = "印";
                shenXyp = "枭";
            }
            if(bazi.dayGan.equals("戊") || bazi.dayGan.equals("己")) {
                rtn = "火";
                shenXyz = "印";
                shenXyp = "枭";
            }
            if(bazi.dayGan.equals("庚") || bazi.dayGan.equals("辛")) {
                rtn = "土";
                shenXyz = "印";
                shenXyp = "枭";
            }
            if(bazi.dayGan.equals("壬") || bazi.dayGan.equals("癸")) {
                rtn = "金";
                shenXyz = "印";
                shenXyp = "枭";
            }
        } else {
            if( (shenBi + shenJie) > (shenYin + shenXiao) ) { /// 比劫多于印，用财冲比劫，克印
                if( (shenCaip + shenCaiz) < (shenShi + shenShang) ) {
                    if(bazi.dayGan.equals("甲") || bazi.dayGan.equals("乙")) {
                        rtn = "土";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                    if(bazi.dayGan.equals("丙") || bazi.dayGan.equals("丁")) {
                        rtn = "金";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                    if(bazi.dayGan.equals("戊") || bazi.dayGan.equals("己")) {
                        rtn = "水";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                    if(bazi.dayGan.equals("庚") || bazi.dayGan.equals("辛")) {
                        rtn = "木";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                    if(bazi.dayGan.equals("壬") || bazi.dayGan.equals("癸")) {
                        rtn = "火";
                        shenXyz = "财";
                        shenXyp = "才";
                    }
                }
                else {
                    if(bazi.dayGan.equals("甲") || bazi.dayGan.equals("乙")) {
                        rtn = "火";
                        shenXyz = "食";
                        shenXyp = "伤";
                    }
                    if(bazi.dayGan.equals("丙") || bazi.dayGan.equals("丁")) {
                        rtn = "土";
                        shenXyz = "食";
                        shenXyp = "伤";
                    }
                    if(bazi.dayGan.equals("戊") || bazi.dayGan.equals("己")) {
                        rtn = "金";
                        shenXyz = "食";
                        shenXyp = "伤";
                    }
                    if(bazi.dayGan.equals("庚") || bazi.dayGan.equals("辛")) {
                        rtn = "水";
                        shenXyz = "食";
                        shenXyp = "伤";
                    }
                    if(bazi.dayGan.equals("壬") || bazi.dayGan.equals("癸")) {
                        rtn = "木";
                        shenXyz = "食";
                        shenXyp = "伤";
                    }    
                }
            }
            else if( (shenCaip + shenCaiz) > (shenShi + shenShang) ) {  /// 财多于食伤, 用食伤
                if(bazi.dayGan.equals("甲") || bazi.dayGan.equals("乙")) {
                    rtn = "火";
                    shenXyz = "食";
                    shenXyp = "伤";
                }
                if(bazi.dayGan.equals("丙") || bazi.dayGan.equals("丁")) {
                    rtn = "土";
                    shenXyz = "食";
                    shenXyp = "伤";
                }
                if(bazi.dayGan.equals("戊") || bazi.dayGan.equals("己")) {
                    rtn = "金";
                    shenXyz = "食";
                    shenXyp = "伤";
                }
                if(bazi.dayGan.equals("庚") || bazi.dayGan.equals("辛")) {
                    rtn = "水";
                    shenXyz = "食";
                    shenXyp = "伤";
                }
                if(bazi.dayGan.equals("壬") || bazi.dayGan.equals("癸")) {
                    rtn = "木";
                    shenXyz = "食";
                    shenXyp = "伤";
                }

            }
            else if( (shenCaip + shenCaiz) < (shenGuan + shenSha) ) {  /// 有食伤，有官，无财
                if(bazi.dayGan.equals("甲") || bazi.dayGan.equals("乙")) {
                    rtn = "土";
                    shenXyz = "财";
                    shenXyp = "才";
                }
                if(bazi.dayGan.equals("丙") || bazi.dayGan.equals("丁")) {
                    rtn = "金";
                    shenXyz = "财";
                    shenXyp = "才";
                }
                if(bazi.dayGan.equals("戊") || bazi.dayGan.equals("己")) {
                    rtn = "水";
                    shenXyz = "财";
                    shenXyp = "才";
                }
                if(bazi.dayGan.equals("庚") || bazi.dayGan.equals("辛")) {
                    rtn = "木";
                    shenXyz = "财";
                    shenXyp = "才";
                }
                if(bazi.dayGan.equals("壬") || bazi.dayGan.equals("癸")) {
                    rtn = "火";
                    shenXyz = "财";
                    shenXyp = "才";
                }
            }
            else {  //// 有食伤，有财多于官，用官
                if(bazi.dayGan.equals("甲") || bazi.dayGan.equals("乙")) {
                    rtn = "金";
                    shenXyz = "官";
                    shenXyp = "煞";
                }
                if(bazi.dayGan.equals("丙") || bazi.dayGan.equals("丁")) {
                    rtn = "水";
                    shenXyz = "官";
                    shenXyp = "煞";
                }
                if(bazi.dayGan.equals("戊") || bazi.dayGan.equals("己")) {
                    rtn = "木";
                    shenXyz = "官";
                    shenXyp = "煞";
                }
                if(bazi.dayGan.equals("庚") || bazi.dayGan.equals("辛")) {
                    rtn = "火";
                    shenXyz = "官";
                    shenXyp = "煞";
                }
                if(bazi.dayGan.equals("壬") || bazi.dayGan.equals("癸")) {
                    rtn = "土";
                    shenXyz = "官";
                    shenXyp = "煞";
                }
            }
        }
        return rtn;
    }

    public String fnWuHelp(String wx) {
        String rtn = "喜用不明。";
        if(wx.equals("金")) {
            rtn = "选择西方位，选择白色或黄色，可佩戴金银，可有帮助。";
        }
        if(wx.equals("木")) {
            rtn = "选择东方位，选择绿色，可佩木属性的手串，首饰，可有帮助。";
        }
        if(wx.equals("水")) {
            rtn = "选择北方位，选择黑色，环境有水，可有帮助。";
        }
        if(wx.equals("火")) {
            rtn = "选择南方位，选择红色，可有帮助。";
        }
        if(wx.equals("土")) {
            rtn = "选择中间方位，选择棕色，可佩戴玉石类首饰，可有帮助。";
        }
        return rtn;
    }    

//#endregion


}

////----------------  zi ping file end -------------------